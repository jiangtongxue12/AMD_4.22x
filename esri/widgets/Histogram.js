// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/maybe ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ../chunks/ResizeObserver ./Widget ./Histogram/HistogramViewModel ./support/widgetUtils ./support/decorators/messageBundle ../core/Logger ./support/jsxFactory ../intl/substitute".split(" "),function(x,l,f,A,r,L,M,N,n,B,
C,D,E,O,F,P,g,G){var w;f=w=function(y){function t(a,c){var b=y.call(this,a,c)||this;b._bgFillId=null;b._containerNode=null;b._containerOffsetHeight=0;b._containerOffsetWidth=0;b._defaultBarColor="#d8d8d8";b._observer=null;b.average=null;b.barCreatedFunction=null;b.bins=null;b.dataLines=null;b.dataLineCreatedFunction=null;b.dataLineUpdatedFunction=null;b.label=void 0;b.labelFormatFunction=null;b.max=null;b.messages=null;b.min=null;b.state=null;b.viewModel=new E;b._observer=new C.ResizeObserver(()=>
{b._storeContainerDimensions();b.scheduleRender()});b._bgFillId=`${b.id}-bg-fill`;return b}x._inheritsLoose(t,y);var d=t.prototype;d.destroy=function(){this._containerNode&&this._observer.unobserve(this._containerNode)};t.fromHistogramResult=function(a){const {bins:c,maxValue:b,minValue:h}=a;return new w({bins:c,max:b,min:h})};d.render=function(){const {label:a,layout:c,state:b}=this,h=this.classes("esri-histogram","esri-widget","horizontal"===c?"esri-histogram--horizontal":"esri-histogram--vertical",
"disabled"===b?"esri-disabled":null);return g.tsx("div",{"aria-label":a,afterCreate:this._afterContainerNodeCreate,bind:this,class:h,"data-node-ref":"_containerNode"},"ready"===b?this.renderContent():null)};d.renderContent=function(){if(this._containerNode){var a=this._bgFillId,c=`clip-path: url(#${a})`;return g.tsx("div",{class:"esri-histogram__content"},g.tsx("svg",{class:"esri-histogram__svg",xmlns:"http://www.w3.org/2000/svg"},g.tsx("defs",null,this.renderFillDefinition(a)),g.tsx("g",{style:c},
this.renderBarsGroup()),this.renderLinesGroup()))}};d.renderBarsGroup=function(){return g.tsx("g",{class:this.classes("esri-histogram__bars")},this.renderBars())};d.renderBars=function(){const {layout:a,viewModel:{binRange:c,range:b}}=this;if(c&&b){var h=c/b,[e,k]=this._getContainerDimensions();if(0!==e||0!==k)if(0===e&&0!==k)this.scheduleRender();else{var [m,q]="vertical"===a?[e*h,k]:[e,k*h];return this._getBarDimensions(m,q).map(([u,v],p)=>this.renderBar(p,u,v))}}};d.renderBar=function(a,c,b){const {bins:h,
layout:e,max:k,messages:m,viewModel:{range:q}}=this,[u,v]=this._getContainerDimensions();var p=h.slice()[a];const {count:H,maxValue:z,minValue:I}=p;p=k-z;const [J,K]="vertical"===e?[0,u/q*p]:[v-b-v/q*p,u-c];p=G.substitute(m.barLabel,{count:H,maxValue:z,minValue:I});return g.tsx("rect",{"aria-label":p,afterCreate:this._afterBarCreate,bind:this,class:"esri-histogram__bar","data-index":a,fill:this._defaultBarColor,height:c,role:"img","shape-rendering":"crispEdges","stroke-width":"0",width:b,x:J,y:K})};
d.renderLinesGroup=function(){return g.tsx("g",{class:this.classes("esri-histogram__data-lines")},this.renderAverageLine(),this.renderCustomLines())};d.renderAverageLine=function(){const {average:a}=this;if(A.isSome(a)){var c=[g.tsx("tspan",{class:this.classes("esri-histogram__average-symbol")},"x\u0304 "),g.tsx("tspan",{class:this.classes("esri-histogram__average-label")},this.labelFormatFunction?this.labelFormatFunction(a,"average"):a)];return g.tsx("g",{afterCreate:this._afterLinesSubgroupCreate,
afterUpdate:this._afterLinesSubgroupUpdate,bind:this,class:this.classes("esri-histogram__data-lines-subgroup")},g.tsx("title",{key:"title"},a),this.renderLine(a,this.classes("esri-histogram__average-data-line")),this.renderLabel(a,c))}};d.renderCustomLines=function(){if(this.dataLines&&this.dataLines.length)return this.dataLines.map(({value:a,label:c},b)=>this.renderLineSubgroup(b,a,c))};d.renderLineSubgroup=function(a,c,b){return g.tsx("g",{afterCreate:this._afterLinesSubgroupCreate,afterUpdate:this._afterLinesSubgroupUpdate,
bind:this,class:this.classes("esri-histogram__data-lines-subgroup"),"data-index":a},g.tsx("title",{key:"title"},c),this.renderLine(c),this.renderLabel(c,b))};d.renderLine=function(a,c){const [b,h,e,k]=this._getLinePosition(a);return g.tsx("line",{class:this.classes("esri-histogram__data-line",c),x1:b,x2:h,y1:e,y2:k,"shape-rendering":"crispEdges"})};d.renderLabel=function(a,c,b){const [h,e]=this._getLabelPosition(a);return g.tsx("text",{class:this.classes("esri-histogram__label",b),"text-anchor":"end",
transform:"horizontal"===this.layout?"rotate(270)":null,x:h,y:e-2},c)};d.renderFillDefinition=function(a){const [c,b]=this._getContainerDimensions();return g.tsx("clipPath",{id:a},g.tsx("rect",{x:"0",y:"0",width:b,height:c}))};d._afterContainerNodeCreate=function(a){this._containerNode&&this._observer.unobserve(this._containerNode);this._containerNode=a;this._observer.observe(this._containerNode);this._storeContainerDimensions()};d._afterBarCreate=function(a){if(this.barCreatedFunction){const c=a.dataset?
parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.barCreatedFunction(isNaN(c)?null:c,a)}};d._afterLinesSubgroupCreate=function(a){if(this.dataLineCreatedFunction){const c=a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.dataLineCreatedFunction(a.childNodes[0],a.childNodes[1]?a.childNodes[1]:null,isNaN(c)?null:c)}};d._afterLinesSubgroupUpdate=function(a){if(this.dataLineUpdatedFunction){const c=
a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.dataLineUpdatedFunction(a.childNodes[0],a.childNodes[1]?a.childNodes[1]:null,isNaN(c)?null:c)}};d._storeContainerDimensions=function(){const {_containerNode:a}=this;a&&(this._containerOffsetHeight=a.offsetHeight,this._containerOffsetWidth=a.offsetWidth)};d._getContainerDimensions=function(){return[this._containerOffsetHeight,this._containerOffsetWidth]};d._getBarDimensions=function(a,
c){const {bins:b,layout:h}=this,e=b?b.map(m=>m.count):[],k=Math.max.apply(Math,e);return e.map(m=>"vertical"===h?[a/e.length,0!==k?m/k*c:0]:[0!==k?m/k*a:0,c/e.length])};d._getLinePosition=function(a){const {layout:c,min:b,viewModel:{range:h}}=this;a=Math.round((a-b)/h*100)/100;const [e,k]=this._getContainerDimensions(),[m,q]=[a*k||1,e-a*e||1];return"vertical"===c?[0,"100%",q,q]:[m,m,"100%",0]};d._getLabelPosition=function(a){const {layout:c,min:b,viewModel:{range:h}}=this;a=Math.round((a-b)/h*100)/
100;const [e,k]=this._getContainerDimensions();return"vertical"===c?[k,e-a*e]:[0,a*k]};x._createClass(t,[{key:"layout",set:function(a){"vertical"!==a&&(a="horizontal");this._set("layout",a)}}]);return t}(D);l.__decorate([n.property()],f.prototype,"_containerOffsetHeight",void 0);l.__decorate([n.property()],f.prototype,"_containerOffsetWidth",void 0);l.__decorate([r.aliasOf("viewModel.average")],f.prototype,"average",void 0);l.__decorate([n.property()],f.prototype,"barCreatedFunction",void 0);l.__decorate([r.aliasOf("viewModel.bins")],
f.prototype,"bins",void 0);l.__decorate([n.property()],f.prototype,"dataLines",void 0);l.__decorate([n.property()],f.prototype,"dataLineCreatedFunction",void 0);l.__decorate([n.property()],f.prototype,"dataLineUpdatedFunction",void 0);l.__decorate([n.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],f.prototype,"label",void 0);l.__decorate([r.aliasOf("viewModel.labelFormatFunction")],f.prototype,"labelFormatFunction",void 0);l.__decorate([n.property({value:"horizontal"})],f.prototype,
"layout",null);l.__decorate([r.aliasOf("viewModel.max")],f.prototype,"max",void 0);l.__decorate([n.property(),F.messageBundle("esri/widgets/Histogram/t9n/Histogram")],f.prototype,"messages",void 0);l.__decorate([r.aliasOf("viewModel.min")],f.prototype,"min",void 0);l.__decorate([r.aliasOf("viewModel.state")],f.prototype,"state",void 0);l.__decorate([n.property()],f.prototype,"viewModel",void 0);return f=w=l.__decorate([B.subclass("esri.widgets.Histogram")],f)});