// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/sources/WFSSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/HandleOwner ../../../core/has ../../../core/Loadable ../../../core/maybe ../../../core/promiseUtils ../../../core/workers/workers ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/typeUtils ./support/clientSideDefaults ../../ogc/wfsUtils ../../../rest/support/FeatureSet ../../../geometry/Extent".split(" "),
function(r,f,E,v,B,A,I,S,C,N,K,L,O,F,l,P,T,n,d,k){r.WFSSource=function(t){function x(){var p=t.apply(this,arguments)||this;p.capabilities=T.createCapabilities(!1,!1);p.type="wfs";p.refresh=N.debounce(function(){var g=f._asyncToGenerator(function*(w){yield p.load();({extent:w}=yield p._connection.invoke("refresh",w));p.sourceJSON.extent=w;return{dataChanged:!0,updates:{extent:p.sourceJSON.extent}}});return function(w){return g.apply(this,arguments)}}());return p}f._inheritsLoose(x,t);var z=x.prototype;
z.load=function(p){var g;p=null!=(g=C.isSome(p)&&p.signal)?g:null;this.addResolvingPromise(this._startWorker({signal:p}));return Promise.resolve(this)};z.destroy=function(){var p;null==(p=this._connection)?void 0:p.close();this._connection=null};z.openPorts=function(){var p=f._asyncToGenerator(function*(){yield this.load();return this._connection.openPorts()});return function(){return p.apply(this,arguments)}}();z.queryFeatures=function(){var p=f._asyncToGenerator(function*(g,w={}){yield this.load(w);
g=yield this._connection.invoke("queryFeatures",g?g.toJSON():null,w);return d.fromJSON(g)});return function(g){return p.apply(this,arguments)}}();z.queryFeaturesJSON=function(){var p=f._asyncToGenerator(function*(g,w={}){yield this.load(w);return this._connection.invoke("queryFeatures",g?g.toJSON():null,w)});return function(g){return p.apply(this,arguments)}}();z.queryFeatureCount=function(){var p=f._asyncToGenerator(function*(g,w={}){yield this.load(w);return this._connection.invoke("queryFeatureCount",
g?g.toJSON():null,w)});return function(g){return p.apply(this,arguments)}}();z.queryObjectIds=function(){var p=f._asyncToGenerator(function*(g,w={}){yield this.load(w);return this._connection.invoke("queryObjectIds",g?g.toJSON():null,w)});return function(g){return p.apply(this,arguments)}}();z.queryExtent=function(){var p=f._asyncToGenerator(function*(g,w={}){yield this.load(w);g=yield this._connection.invoke("queryExtent",g?g.toJSON():null,w);return{count:g.count,extent:k.fromJSON(g.extent)}});return function(g){return p.apply(this,
arguments)}}();z.querySnapping=function(){var p=f._asyncToGenerator(function*(g,w={}){yield this.load(w);return this._connection.invoke("querySnapping",g,w)});return function(g){return p.apply(this,arguments)}}();z._createLoadOptions=function(){var p=f._asyncToGenerator(function*(g){const {url:w,customParameters:G,name:y,namespaceUri:J,spatialReference:R,fields:Q,geometryType:M,swapXY:H}=this.layer;if(!w)throw new B("wfs-layer:missing-url","WFSLayer must be created with a url");this.wfsCapabilities||
(this.wfsCapabilities=yield n.getCapabilities(w,{customParameters:G,...g}));g="fields geometryType name namespaceUri spatialReference swapXY".split(" ").some(Y=>null==this.layer[Y])?yield n.getWFSLayerInfo(this.wfsCapabilities,y,J,{spatialReference:R,customParameters:G,signal:null==g?void 0:g.signal}):{...n.prepareWFSLayerFields(Q),geometryType:M,name:y,namespaceUri:J,spatialReference:R,swapXY:H};const Z=C.unwrap(n.findFeatureType(this.wfsCapabilities.readFeatureTypes(),g.name,g.namespaceUri)),da=
P.featureGeometryTypeKebabDictionary.toJSON(g.geometryType);return{customParameters:G,featureType:Z,fields:g.fields.map(Y=>Y.toJSON()),geometryField:g.geometryField,geometryType:da,getFeatureUrl:this.wfsCapabilities.operations.GetFeature.url,getFeatureOutputFormat:this.wfsCapabilities.operations.GetFeature.outputFormat,objectIdField:g.objectIdField,spatialReference:g.spatialReference.toJSON(),swapXY:g.swapXY}});return function(g){return p.apply(this,arguments)}}();z._startWorker=function(){var p=
f._asyncToGenerator(function*(g){const [w,G]=yield N.eachAlways([this._createLoadOptions(g),K.open("WFSSourceWorker",{...g,strategy:I("feature-layers-workers")?"dedicated":"local"})]);var y=w.error||G.error||null;const J=G.value||null;if(y)throw J&&J.close(),y;y=w.value;this._connection=G.value;({extent:g}=yield this._connection.invoke("load",y,g));this.sourceJSON={extent:g,fields:y.fields,geometryType:y.geometryType,objectIdField:y.objectIdField,geometryField:y.geometryField,drawingInfo:T.createDrawingInfo(y.geometryType),
name:y.featureType.title,wfsInfo:{name:y.featureType.name,featureUrl:y.getFeatureUrl,maxFeatures:3E3,swapXY:y.swapXY,supportedSpatialReferences:y.featureType.supportedSpatialReferences,version:"2.0.0",wfsNamespace:y.featureType.namespaceUri}}});return function(g){return p.apply(this,arguments)}}();return x}(A.HandleOwnerMixin(S));E.__decorate([L.property()],r.WFSSource.prototype,"capabilities",void 0);E.__decorate([L.property({constructOnly:!0})],r.WFSSource.prototype,"layer",void 0);E.__decorate([L.property()],
r.WFSSource.prototype,"sourceJSON",void 0);E.__decorate([L.property()],r.WFSSource.prototype,"type",void 0);E.__decorate([L.property()],r.WFSSource.prototype,"wfsCapabilities",void 0);r.WFSSource=E.__decorate([l.subclass("esri.layers.graphics.sources.WFSSource")],r.WFSSource);r.default=r.WFSSource;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/ogc/wfsUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/Error ../../core/iteratorUtils ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../geometry/projection ../../geometry/support/spatialReferenceUtils ../../geometry/support/typeUtils ../graphics/sources/geojson/geojson ./dateUtils ./xmlUtils ../support/Field ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(r,f,E,v,B,A,I,S,C,N,K,L,O,F,l,P,T,n){function d(){d=f._asyncToGenerator(function*(b,c){c=yield v(b,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetCapabilities",VERSION:"2.0.0",...null==c?void 0:c.customParameters},signal:null==c?void 0:c.signal});c=k(c.data);C.isHTTPSProtocol(b)&&(C.hasSameOrigin(b,c.operations.DescribeFeatureType.url,!0)&&(c.operations.DescribeFeatureType.url=C.toHTTPS(c.operations.DescribeFeatureType.url)),C.hasSameOrigin(b,c.operations.GetFeature.url,!0)&&(c.operations.GetFeature.url=
C.toHTTPS(c.operations.GetFeature.url)));return c});return d.apply(this,arguments)}function k(b){b=aa(b);ia(b);W(b);b=b.firstElementChild;const c=A.cache(x(b));return{operations:t(b),get featureTypes(){return Array.from(c())},readFeatureTypes:c}}function t(b){let c=!1;const e={GetCapabilities:{url:""},DescribeFeatureType:{url:""},GetFeature:{url:"",outputFormat:null,supportsPagination:!1}};l.visitXML(b,{OperationsMetadata:{Operation:m=>{switch(m.getAttribute("name")){case "GetCapabilities":return{DCP:{HTTP:{Get:h=>
{e.GetCapabilities.url=h.getAttribute("xlink:href")}}}};case "DescribeFeatureType":return{DCP:{HTTP:{Get:h=>{e.DescribeFeatureType.url=h.getAttribute("xlink:href")}}}};case "GetFeature":return{DCP:{HTTP:{Get:h=>{e.GetFeature.url=h.getAttribute("xlink:href")}}},Parameter:h=>{if("outputFormat"===h.getAttribute("name"))return{AllowedValues:{Value:a=>{a=a.textContent;ja.has(a.toLowerCase())&&(e.GetFeature.outputFormat=a)}}}}}}},Constraint:m=>{switch(m.getAttribute("name")){case "KVPEncoding":return{DefaultValue:h=>
{c="true"===h.textContent.toLowerCase()}};case "ImplementsResultPaging":return{DefaultValue:h=>{e.GetFeature.supportsPagination="true"===h.textContent.toLowerCase()}}}}}});if(!c)throw new B("wfs-layer:kvp-encoding-not-supported","WFS service doesn't support key/value pair (KVP) encoding");if(I.isNone(e.GetFeature.outputFormat))throw new B("wfs-layer:geojson-not-supported","WFS service doesn't support GeoJSON output format");return e}function x(b){return l.iterateXML(b,{FeatureTypeList:{FeatureType:c=>
{const e={typeName:"undefined:undefined",name:"",title:"",description:"",extent:null,namespacePrefix:"",namespaceUri:"",supportedSpatialReferences:[]},m=new Set([4326]),h=a=>{var q,u;a=parseInt(null==(q=a.textContent.match(/(?<wkid>\d+$)/i))?void 0:null==(u=q.groups)?void 0:u.wkid,10);Number.isNaN(a)||m.add(a)};l.visitXML(c,{Name:a=>{const {name:q,prefix:u}=ba(a.textContent);e.typeName=`${u}:${q}`;e.name=q;e.namespacePrefix=u;e.namespaceUri=a.lookupNamespaceURI(u)},Abstract:a=>{e.description=a.textContent},
Title:a=>{e.title=a.textContent},WGS84BoundingBox:a=>{e.extent=z(a)},DefaultSRS:h,DefaultCRS:h,OtherSRS:h,OtherCRS:h});e.title||(e.title=e.name);e.supportedSpatialReferences.push(...m);return e}}})}function z(b){let c,e,m,h;for(const a of b.children)switch(a.localName){case "LowerCorner":[c,e]=a.textContent.split(" ").map(q=>Number.parseFloat(q));break;case "UpperCorner":[m,h]=a.textContent.split(" ").map(q=>Number.parseFloat(q))}return{xmin:c,ymin:e,xmax:m,ymax:h,spatialReference:K.WGS84}}function p(b,
c,e){return A.find(b,m=>e?m.name===c&&m.namespaceUri===e:m.typeName===c||m.name===c)}function g(){g=f._asyncToGenerator(function*(b,c,e,m={}){var h;const {featureType:a,extent:q}=yield w(b,c,e,m),{fields:u,geometryType:D,swapXY:ca,objectIdField:X,geometryField:U}=yield y(b,a.typeName,m);return{url:b.operations.GetCapabilities.url,name:a.name,namespaceUri:a.namespaceUri,fields:u,geometryField:U,geometryType:D,objectIdField:X,spatialReference:null!=(h=m.spatialReference)?h:T.WGS84,extent:q,swapXY:ca,
wfsCapabilities:b,customParameters:m.customParameters}});return g.apply(this,arguments)}function w(b,c,e){return G.apply(this,arguments)}function G(){G=f._asyncToGenerator(function*(b,c,e,m={}){const {spatialReference:h=T.WGS84}=m;b=b.readFeatureTypes();e=c?p(b,c,e):b.next().value;if(I.isNone(e)){if(c)throw new B("wfs-layer:feature-type-not-found",`The type '${c}' could not be found in the service`);throw new B("wfs-layer:empty-service","The service is empty");}c=new n({...e.extent,spatialReference:h});
if(!K.equals(h,K.WGS84))try{yield N.initializeProjection(K.WGS84,h,void 0,m),c=N.project(c,K.WGS84)}catch{throw new B("wfs-layer:unsupported-spatial-reference","Projection not supported");}return{extent:c,spatialReference:h,featureType:e}});return G.apply(this,arguments)}function y(b,c){return J.apply(this,arguments)}function J(){J=f._asyncToGenerator(function*(b,c,e={}){const [m,h]=yield S.eachAlways([H(b.operations.DescribeFeatureType.url,c,e),Q(b,c,e)]);if(m.error||h.error)throw new B("wfs-layer:getWFSLayerTypeInfo-error",
`An error occurred while getting info about the feature type '${c}'`,{error:m.error||h.error});const {fields:a,errors:q}=m.value;b=m.value.geometryType||h.value.geometryType;e=h.value.swapXY;if(I.isNone(b))throw new B("wfs-layer:unknown-geometry-type",`The geometry type could not be determined for type '${c}`,{typeName:c,geometryType:b,fields:a,errors:q});return{...R(a),geometryType:b,swapXY:e}});return J.apply(this,arguments)}function R(b){var c;const e=b.find(h=>"geometry"===h.type);let m=b.find(h=>
"oid"===h.type);b=b.filter(h=>"geometry"!==h.type);m||(m=new P({name:"__esri_wfs_id__",type:"oid",alias:"__esri_wfs_id__"}),b.unshift(m));return{geometryField:null!=(c=null==e?void 0:e.name)?c:null,objectIdField:m.name,fields:b}}function Q(b,c){return M.apply(this,arguments)}function M(){M=f._asyncToGenerator(function*(b,c,e={}){var m;let h,a=!1;const [q,u]=yield Promise.all([V(b.operations.GetFeature.url,c,b.operations.GetFeature.outputFormat,{...e,count:1}),v(b.operations.GetFeature.url,{responseType:"text",
query:ea(c,void 0,{...e,count:1}),signal:null==e?void 0:e.signal})]);if(b="FeatureCollection"===q.type&&(null==(m=q.features[0])?void 0:m.geometry)){h=L.featureGeometryTypeKebabDictionary.fromJSON(O.getGeometryType(b.type));switch(b.type){case "Point":var D=b.coordinates;break;case "LineString":case "MultiPoint":D=b.coordinates[0];break;case "MultiLineString":case "Polygon":D=b.coordinates[0][0];break;case "MultiPolygon":D=b.coordinates[0][0][0]}if(b=/<[^>]*pos[^>]*> *(-?\d+(?:\.\d+)?) (-?\d+(?:\.\d+)?)/.exec(u.data))m=
D[0].toFixed(3),D=D[1].toFixed(3),c=parseFloat(b[1]).toFixed(3),b=parseFloat(b[2]).toFixed(3),m===b&&D===c&&(a=!0)}return{geometryType:h,swapXY:a}});return M.apply(this,arguments)}function H(b,c,e){return Z.apply(this,arguments)}function Z(){Z=f._asyncToGenerator(function*(b,c,e){b=yield v(b,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"DescribeFeatureType",VERSION:"2.0.0",TYPENAME:c,...null==e?void 0:e.customParameters},signal:null==e?void 0:e.signal});return da(c,b.data)});return Z.apply(this,
arguments)}function da(b,c){const {name:e}=ba(b);c=aa(c);W(c);const m=A.find(l.iterateXML(c.firstElementChild,{element:h=>({name:h.getAttribute("name"),typeName:ba(h.getAttribute("type")).name})}),({name:h})=>h===e);if(I.isSome(m)){const h=A.find(l.iterateXML(c.firstElementChild,{complexType:a=>a}),a=>a.getAttribute("name")===m.typeName);if(I.isSome(h))return Y(h)}throw new B("wfs-layer:feature-type-not-found",`Type '${b}' not found in document`,{document:(new XMLSerializer).serializeToString(c)});
}function Y(b){var c,e;const m=[],h=[];let a;var q=l.iterateXML(b,{complexContent:{extension:{sequence:{element:u=>u}}}});for(const u of q){q=u.getAttribute("name");if(!q)continue;let D,ca;u.hasAttribute("type")?D=ba(u.getAttribute("type")).name:l.visitXML(u,{simpleType:{restriction:ka=>{D=ba(ka.getAttribute("base")).name;return{maxLength:la=>{ca=+la.getAttribute("value")}}}}});if(!D)continue;const X="true"===u.getAttribute("nillable");let U=!1;switch(D.toLowerCase()){case "integer":case "nonpositiveinteger":case "negativeinteger":case "long":case "int":case "short":case "byte":case "nonnegativeinteger":case "unsignedlong":case "unsignedint":case "unsignedshort":case "unsignedbyte":case "positiveinteger":h.push(new P({name:q,
alias:q,type:"integer",nullable:X}));break;case "float":case "double":case "decimal":h.push(new P({name:q,alias:q,type:"double",nullable:X}));break;case "boolean":case "string":case "gyearmonth":case "gyear":case "gmonthday":case "gday":case "gmonth":case "anyuri":case "qname":case "notation":case "normalizedstring":case "token":case "language":case "idrefs":case "entities":case "nmtoken":case "nmtokens":case "name":case "ncname":case "id":case "idref":case "entity":case "duration":case "time":h.push(new P({name:q,
alias:q,type:"string",nullable:X,length:null!=(c=ca)?c:255}));break;case "datetime":case "date":h.push(new P({name:q,alias:q,type:"date",nullable:X,length:null!=(e=ca)?e:36}));break;case "pointpropertytype":a="point";U=!0;break;case "multipointpropertytype":a="multipoint";U=!0;break;case "curvepropertytype":case "multicurvepropertytype":case "multilinestringpropertytype":a="polyline";U=!0;break;case "surfacepropertytype":case "multisurfacepropertytype":case "multipolygonpropertytype":a="polygon";
U=!0;break;case "geometrypropertytype":case "multigeometrypropertytype":U=!0;m.push(new B("wfs-layer:unknown-geometry-type",`geometry type '${D}' is not supported`,{type:(new XMLSerializer).serializeToString(b)}));break;default:m.push(new B("wfs-layer:unknown-field-type",`Unknown field type '${D}'`,{type:(new XMLSerializer).serializeToString(b)}))}U&&h.push(new P({name:q,alias:q,type:"geometry",nullable:X}))}for(const u of h)if("integer"===u.type&&!u.nullable&&ma.has(u.name.toLowerCase())){u.type=
"oid";break}return{geometryType:a,fields:h,errors:m}}function V(b,c,e,m){return fa.apply(this,arguments)}function fa(){fa=f._asyncToGenerator(function*(b,c,e,m){({data:b}=yield v(b,{responseType:"text",query:ea(c,e,m),signal:null==m?void 0:m.signal}));b=b.replace(/": +(-?\d+),(\d+)(,)?/g,'": $1.$2$3');try{var h;if(null!=m&&null!=(h=m.dateFields)&&h.length){const a=new Set(m.dateFields);return JSON.parse(b,(q,u)=>a.has(q)?F.parseDate(u):u)}return JSON.parse(b)}catch(a){throw new B("wfs-layer:malformed-json",
"Error while parsing the\u00a0response",{response:b,error:a});}});return fa.apply(this,arguments)}function ea(b,c,e){return{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:b,OUTPUTFORMAT:c,SRSNAME:"EPSG:4326",STARTINDEX:null==e?void 0:e.startIndex,COUNT:null==e?void 0:e.count,...null==e?void 0:e.customParameters}}function ha(){ha=f._asyncToGenerator(function*(b,c,e){b=yield v(b,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:c,RESULTTYPE:"hits",
...null==e?void 0:e.customParameters},signal:null==e?void 0:e.signal});b=aa(b.data);W(b);b=Number.parseFloat(b.firstElementChild.getAttribute("numberMatched"));return Number.isNaN(b)?0:b});return ha.apply(this,arguments)}function aa(b){return(new DOMParser).parseFromString(b.trim(),"text/xml")}function ba(b){const [c,e]=b.split(":");return{prefix:e?c:"",name:null!=e?e:c}}function ia(b){if((b=b.firstElementChild.getAttribute("version"))&&"2.0.0"!==b)throw new B("wfs-layer:unsupported-wfs-version",
`Unsupported WFS version ${b}. Supported version: ${"2.0.0"}`);}function W(b){let c,e;l.visitXML(b.firstElementChild,{Exception:m=>{c=m.getAttribute("exceptionCode");return{ExceptionText:h=>{e=h.textContent}}}});if(c)throw new B(`wfs-layer:${c}`,e);}const ja=new Set(["json","application/json","geojson","application/json; subtype\x3dgeojson"]),ma=new Set(["objectid","fid"]);r.WFS_OID_FIELD_NAME="__esri_wfs_id__";r.describeFeatureType=H;r.findFeatureType=p;r.getCapabilities=function(b,c){return d.apply(this,
arguments)};r.getFeature=V;r.getFeatureCount=function(b,c,e){return ha.apply(this,arguments)};r.getFeatureTypeInfo=w;r.getWFSLayerInfo=function(b,c,e){return g.apply(this,arguments)};r.parseDescribeFeatureTypeResponse=da;r.parseGetCapabilitiesResponse=k;r.prepareWFSLayerFields=R;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/iteratorUtils":function(){define(["exports"],function(r){r.cache=function(f){const E=[];return function*(){yield*E;for(const v of f)E.push(v),yield v}};r.find=
function(f,E){for(const v of f)if(null!=v&&E(v))return v};r.isIterable=function(f){return null!=f&&"function"===typeof f[Symbol.iterator]};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature","../../OptimizedGeometry","../../../support/fieldUtils"],function(r,f,E,v,B){function*A(d){switch(d.type){case "Feature":yield d;break;case "FeatureCollection":for(const k of d.features)k&&
(yield k)}}function*I(d){if(!d)return null;switch(d.type){case "Point":yield d.coordinates;break;case "LineString":case "MultiPoint":yield*d.coordinates;break;case "MultiLineString":case "Polygon":for(const k of d.coordinates)yield*k;break;case "MultiPolygon":for(const k of d.coordinates)for(const t of k)yield*t}}function*S(d,k={}){const {geometryType:t,objectIdField:x}=k;for(const p of d){var z;const {geometry:g,properties:w,id:G}=p;if(g&&n[g.type]!==t)continue;d=w||{};let y=null!=(z=d[x])?z:null;
x&&null!=G&&!d[x]&&(d[x]=y=G);yield new E.default(g?L(new v,g,k):null,d,null,y)}}function C(d){for(const k of d)if(2<k.length)return!0;return!1}function N(d){let k=0;for(let t=0;t<d.length;t++){const x=d[t],z=d[(t+1)%d.length];k+=x[0]*z[1]-z[0]*x[1]}return 0>=k}function K(d){const k=d[0],t=d[d.length-1];k[0]===t[0]&&k[1]===t[1]&&k[2]===t[2]||d.push(k);return d}function L(d,k,t){switch(k.type){case "LineString":return l(d,k.coordinates,t),d;case "MultiLineString":for(const z of k.coordinates)l(d,z,
t);return d;case "MultiPoint":return l(d,k.coordinates,t),d;case "MultiPolygon":for(var x of k.coordinates)for(O(d,x[0],t),k=1;k<x.length;k++)F(d,x[k],t);return d;case "Point":return T(d,k.coordinates,t),d;case "Polygon":x=k.coordinates;O(d,x[0],t);for(k=1;k<x.length;k++)F(d,x[k],t);return d}}function O(d,k,t){k=K(k);N(k)?l(d,k,t):P(d,k,t)}function F(d,k,t){k=K(k);N(k)?P(d,k,t):l(d,k,t)}function l(d,k,t){for(const x of k)T(d,x,t);d.lengths.push(k.length)}function P(d,k,t){for(let x=k.length-1;0<=
x;x--)T(d,k[x],t);d.lengths.push(k.length)}function T(d,k,t){const [x,z,p]=k;d.coords.push(x,z);t.hasZ&&d.coords.push(p||0)}const n={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};r.createOptimizedFeatures=function(d,k){return Array.from(S(A(d),k))};r.getGeometryType=function(d){return n[d]};r.inferLayerProperties=function(d,k={}){const t=[];var x=
new Set;const z=new Set;var p=!1;let g=null,w=!1,G=void 0;({geometryType:k=null}=k);var y=!1;for(const J of A(d)){const {geometry:R,properties:Q,id:M}=J;if(R&&(k||(k=n[R.type]),n[R.type]!==k))continue;p||(p=I(R),p=C(p));!w&&(w=null!=M)&&(G=typeof M,g=Object.keys(Q).filter(H=>Q[H]===M));w&&null!=M&&(1<g.length?g=g.filter(H=>Q[H]===M):1===g.length&&(g=Q[g[0]]===M?g:[]));if(!y&&Q){d=!0;for(const H in Q)if(!x.has(H))if(y=Q[H],null==y)d=!1,z.add(H);else{a:switch(typeof y){case "string":y="esriFieldTypeString";
break a;case "number":y="esriFieldTypeDouble";break a;default:y="unknown"}"unknown"===y?z.add(H):(z.delete(H),x.add(H),t.push({name:H,alias:H,type:y}))}y=d}}if(x=g&&1===g.length&&g[0]||null)for(const J of t)if(J.name===x&&B.isNumericField(J)){J.type="esriFieldTypeOID";break}return{fields:t,geometryType:k,hasZ:p,objectIdFieldName:x,objectIdFieldType:G,unknownFields:Array.from(z)}};r.validateGeoJSON=function(d){if(!d)throw new f("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==d.type&&
"FeatureCollection"!==d.type)throw new f("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:d});({crs:d}=d);if(d){var k="string"===typeof d?d:"name"===d.type?d.properties.name:"EPSG"===d.type?d.properties.code:null,t=/.*(CRS84H?|4326)$/i;if(!k||!t.test(k))throw new f("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:d});}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/ogc/dateUtils":function(){define(["exports"],
function(r){function f(v){v=(new Date(v)).getTime();return Number.isNaN(v)?null:v}const E=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/;r.parseDate=function(v){var B;var A,I,S,C=E.exec(v);if(C){C=C.groups;var N=+C.year,K=+C.month-1,L=+C.day,O=+(null!=(A=C.hours)?A:0);A=+(null!=(I=C.minutes)?I:0);I=+(null!=(S=C.seconds)?S:0);if(23<
O||59<A||59<I)var F=null;else F=(S=null!=(F=C.ms)?F:"0")?+S.padEnd(3,"0").substring(0,3):0,F=C.isUTC?Date.UTC(N,K,L,O,A,I,F):C.offsetSign?6E4*("+"===C.offsetSign?-1:1)*(60*+C.offsetHours+ +C.offsetMinutes)+Date.UTC(N,K,L,O,A,I,F):(new Date(N,K,L,O,A,I,F)).getTime(),F=Number.isNaN(F)?null:F}else F=null;return null!=(B=F)?B:f(v)};r.parseJSDate=f;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/ogc/xmlUtils":function(){define(["exports"],function(r){function f(v,B){for(const A of v.children)A.localName in
B&&(v=B[A.localName],"function"===typeof v?(v=v(A))&&f(A,v):f(A,v))}function*E(v,B){for(const A of v.children)A.localName in B&&(v=B[A.localName],"function"===typeof v?yield v(A):yield*E(A,v))}r.iterateXML=E;r.visitXML=f;Object.defineProperty(r,"__esModule",{value:!0})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../geometry ../PopupTemplate ../renderers/ClassBreaksRenderer ../renderers/DictionaryRenderer ../renderers/DotDensityRenderer ../renderers/HeatmapRenderer ../renderers/Renderer ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/jsonUtils ../renderers/support/types ../core/maybe ../core/MultiOriginJSONSupport ../core/object ../core/urlUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../geometry/support/typeUtils ./Layer ./graphics/sources/WFSSource ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/FeatureEffectLayer ./mixins/OperationalLayer ./mixins/OrderedLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./ogc/wfsUtils ./support/commonProperties ./support/featureReductionUtils ./support/Field ./support/fieldProperties ./support/fieldUtils ./support/LabelClass ./support/labelingInfo ../rest/support/Query ../support/popupUtils ../geometry/Extent ../geometry/SpatialReference".split(" "),function(r,
f,E,v,B,A,I,S,C,N,K,L,O,F,l,P,T,n,d,k,t,x,z,p,g,w,G,y,J,R,Q,M,H,Z,da,Y,V,fa,ea,ha,aa,ba,ia,W,ja,ma,b){var c;E=ha.defineFieldProperties();l=c=function(e){function m(a){a=e.call(this,a)||this;a.capabilities=null;a.copyright=null;a.customParameters=null;a.definitionExpression=null;a.displayField=null;a.elevationInfo=null;a.featureReduction=null;a.featureUrl=void 0;a.fields=null;a.fieldsIndex=null;a.fullExtent=null;a.geometryType=null;a.labelsVisible=!0;a.labelingInfo=null;a.legendEnabled=!0;a.objectIdField=
null;a.operationalLayerType="WFS";a.maxFeatures=3E3;a.mode=0;a.name=null;a.namespaceUri=null;a.outFields=null;a.popupEnabled=!0;a.popupTemplate=null;a.screenSizePerspectiveEnabled=!0;a.source=new w.default({layer:r._assertThisInitialized(a)});a.spatialReference=b.WGS84;a.spatialReferences=[4326];a.swapXY=void 0;a.title="WFS";a.type="wfs";a.url=null;a.version=void 0;return a}r._inheritsLoose(m,e);m.fromWFSLayerInfo=function(a){const {customParameters:q,fields:u,geometryField:D,geometryType:ca,name:X,
namespaceUri:U,objectIdField:ka,spatialReference:la,swapXY:na,url:oa,wfsCapabilities:pa}=a;return new c({customParameters:q,fields:u,geometryField:D,geometryType:ca,name:X,namespaceUri:U,objectIdField:ka,spatialReference:la,swapXY:na,url:oa,wfsCapabilities:pa})};var h=m.prototype;h.destroy=function(){var a;null==(a=this.source)?void 0:a.destroy()};h.load=function(a){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WFS"]},a).then(()=>this.source.load(a)).then(()=>{this.read(this.source.sourceJSON,
{origin:"service",url:this.parsedUrl});this.revert("objectIdField fields timeInfo spatialReference name namespaceUri".split(" "),"service");aa.fixRendererFields(this.renderer,this.fieldsIndex);aa.fixTimeInfoFields(this.timeInfo,this.fieldsIndex)}));return Promise.resolve(this)};h.writeFields=function(a,q,u){a=a.filter(D=>D.name!==Y.WFS_OID_FIELD_NAME);this.geometryField&&a.unshift(new ea({name:this.geometryField,alias:this.geometryField,type:"geometry"}));P.setDeepValue(u,a.map(D=>D.toJSON()),q)};
h.createPopupTemplate=function(a){return ja.createPopupTemplate(this,a)};h.createQuery=function(){const a=new W;a.returnGeometry=!0;a.outFields=["*"];a.where=this.definitionExpression||"1\x3d1";const {timeOffset:q,timeExtent:u}=this;a.timeExtent=null!=q&&null!=u?u.offset(-q.value,q.unit):u||null;return a};h.getFieldDomain=function(a,q){var u;return null==(u=this.getField(a))?void 0:u.domain};h.getField=function(a){return this.fieldsIndex.get(a)};h.queryFeatures=function(a,q){return this.load().then(()=>
this.source.queryFeatures(W.from(a)||this.createQuery(),q)).then(u=>{if(null!=u&&u.features)for(const D of u.features)D.layer=D.sourceLayer=this;return u})};h.queryObjectIds=function(a,q){return this.load().then(()=>this.source.queryObjectIds(W.from(a)||this.createQuery(),q))};h.queryFeatureCount=function(a,q){return this.load().then(()=>this.source.queryFeatureCount(W.from(a)||this.createQuery(),q))};h.queryExtent=function(a,q){return this.load().then(()=>this.source.queryExtent(W.from(a)||this.createQuery(),
q))};h.hasDataChanged=function(){var a=r._asyncToGenerator(function*(){try{const {dataChanged:q,updates:u}=yield this.source.refresh(this.customParameters);F.isSome(u)&&this.read(u,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0});return q}catch{}return!1});return function(){return a.apply(this,arguments)}}();r._createClass(m,[{key:"createQueryVersion",get:function(){this.commitProperty("definitionExpression");this.commitProperty("timeExtent");this.commitProperty("timeOffset");this.commitProperty("geometryType");
this.commitProperty("capabilities");return(this._get("createQueryVersion")||0)+1}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"parsedUrl",get:function(){return this.url?T.urlToObject(this.url):null}},{key:"renderer",set:function(a){aa.fixRendererFields(a,this.fieldsIndex);this._set("renderer",a)}}]);return m}(Q.OrderedLayer(y.CustomParametersMixin(J.FeatureEffectLayer(G.BlendLayer(da.TemporalLayer(H.RefreshableLayer(Z.ScaleRangeLayer(R.OperationalLayer(M.PortalLayer(l.MultiOriginJSONMixin(g)))))))))));
f.__decorate([n.property({readOnly:!0,aliasOf:"source.capabilities"})],l.prototype,"capabilities",void 0);f.__decorate([n.property({type:String})],l.prototype,"copyright",void 0);f.__decorate([n.property({readOnly:!0})],l.prototype,"createQueryVersion",null);f.__decorate([n.property({json:{name:"wfsInfo.customParameters",write:{ignoreOrigin:!0}}})],l.prototype,"customParameters",void 0);f.__decorate([n.property({readOnly:!0})],l.prototype,"defaultPopupTemplate",null);f.__decorate([n.property({type:String,
json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],l.prototype,"definitionExpression",void 0);f.__decorate([n.property({type:String})],l.prototype,"displayField",void 0);f.__decorate([n.property(V.elevationInfo)],l.prototype,"elevationInfo",void 0);f.__decorate([n.property(fa.featureReductionProperty)],l.prototype,"featureReduction",void 0);f.__decorate([n.property({type:String,readOnly:!0,json:{name:"wfsInfo.featureUrl",write:{ignoreOrigin:!0,isRequired:!0}}})],
l.prototype,"featureUrl",void 0);f.__decorate([n.property({type:[ea],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],l.prototype,"fields",void 0);f.__decorate([z.writer("fields")],l.prototype,"writeFields",null);f.__decorate([n.property(E.fieldsIndex)],l.prototype,"fieldsIndex",void 0);f.__decorate([n.property({type:ma,json:{name:"extent"}})],l.prototype,"fullExtent",void 0);f.__decorate([n.property()],l.prototype,"geometryField",void 0);
f.__decorate([n.property({type:String,json:{read:{source:"layerDefinition.geometryType",reader:p.featureGeometryTypeKebabDictionary.read},write:{target:"layerDefinition.geometryType",writer:p.featureGeometryTypeKebabDictionary.write,ignoreOrigin:!0},origins:{service:{read:p.featureGeometryTypeKebabDictionary.read}}}})],l.prototype,"geometryType",void 0);f.__decorate([n.property({type:String})],l.prototype,"id",void 0);f.__decorate([n.property(V.labelsVisible)],l.prototype,"labelsVisible",void 0);
f.__decorate([n.property({type:[ba],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:ia.reader},write:!0}})],l.prototype,"labelingInfo",void 0);f.__decorate([n.property(V.legendEnabled)],l.prototype,"legendEnabled",void 0);f.__decorate([n.property({type:["show","hide"]})],l.prototype,"listMode",void 0);f.__decorate([n.property({type:String})],l.prototype,"objectIdField",void 0);f.__decorate([n.property({type:["WFS"]})],l.prototype,"operationalLayerType",void 0);f.__decorate([n.property({type:t.Integer,
json:{name:"wfsInfo.maxFeatures",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"maxFeatures",void 0);f.__decorate([n.property({type:[0],readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],l.prototype,"mode",void 0);f.__decorate([n.property({type:String,json:{name:"wfsInfo.name",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"name",void 0);f.__decorate([n.property({type:String,json:{name:"wfsInfo.wfsNamespace",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,
"namespaceUri",void 0);f.__decorate([n.property(V.opacityDrawingInfo)],l.prototype,"opacity",void 0);f.__decorate([n.property(E.outFields)],l.prototype,"outFields",void 0);f.__decorate([n.property({readOnly:!0})],l.prototype,"parsedUrl",null);f.__decorate([n.property(V.popupEnabled)],l.prototype,"popupEnabled",void 0);f.__decorate([n.property({type:v,json:{name:"popupInfo",write:!0}})],l.prototype,"popupTemplate",void 0);f.__decorate([n.property({types:O.rendererTypes,json:{origins:{service:{name:"drawingInfo.renderer"},
"web-scene":{types:O.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:{ignoreOrigin:!0}}})],l.prototype,"renderer",null);f.__decorate([n.property(V.screenSizePerspectiveEnabled)],l.prototype,"screenSizePerspectiveEnabled",void 0);f.__decorate([n.property({readOnly:!0})],l.prototype,"source",void 0);f.__decorate([n.property({type:b,json:{name:"layerDefinition.spatialReference",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"extent.spatialReference"}}}})],
l.prototype,"spatialReference",void 0);f.__decorate([n.property({readOnly:!0,type:[t.Integer],json:{name:"wfsInfo.supportedSpatialReferences",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"spatialReferences",void 0);f.__decorate([n.property({type:Boolean,value:!1,json:{name:"wfsInfo.swapXY",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"swapXY",void 0);f.__decorate([n.property({json:{write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"name"}}}})],l.prototype,"title",void 0);
f.__decorate([n.property({json:{read:!1},readOnly:!0})],l.prototype,"type",void 0);f.__decorate([n.property(V.url)],l.prototype,"url",void 0);f.__decorate([n.property({type:String,readOnly:!0,json:{name:"wfsInfo.version",write:{ignoreOrigin:!0,isRequired:!0}}})],l.prototype,"version",void 0);f.__decorate([n.property({aliasOf:"source.wfsCapabilities"})],l.prototype,"wfsCapabilities",void 0);return l=c=f.__decorate([x.subclass("esri.layers.WFSLayer")],l)});