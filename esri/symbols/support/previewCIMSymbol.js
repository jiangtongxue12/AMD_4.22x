// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/screenUtils ../cim/CIMSymbolRasterizer ./cimSymbolUtils ./renderUtils".split(" "),function(h,p,q,r,k,t){function f(){f=p._asyncToGenerator(function*(a,e={}){const {size:g,maxSize:l,node:m,opacity:n}=e,{feature:u,fieldMap:v,geometryType:w,style:x}=e.cimOptions||e;var c=k.getCIMSymbolSize(a),d=Math.min(null!=g?g:c,null!=l?l:q.px2pt(120));d!==c&&(a=a.clone(),k.scaleCIMSymbolTo(a,d,{preserveOutlineWidth:!0}));var b=3;a&&a.data&&a.data.symbol&&
"CIMPointSymbol"!==a.data.symbol.type&&(b=1);c=yield y.rasterizeCIMSymbolAsync(a,u,v,w,{scaleFactor:b,style:x});a=document.createElement("canvas");a.width=c.imageData.width;a.height=c.imageData.height;a.getContext("2d").putImageData(c.imageData,0,0);c=a.width/b;b=a.height/b;if(null==g?0:null!=(null==e?void 0:e.scale)?null==e?0:e.scale:1)b=c/b,c=1>=b?Math.ceil(d*b):d,b=1>=b?d:Math.ceil(d/b);d=new Image(c,b);d.src=a.toDataURL();null!=n&&(d.style.opacity=`${n}`);a=d;null!=e.effectView&&(a=t.renderSymbol([[{shape:{type:"image",
x:0,y:0,width:c,height:b,src:d.src},fill:null,stroke:null,offset:[0,0]}]],[c,b],{effectView:e.effectView}));m&&m.appendChild(a);return a});return f.apply(this,arguments)}const y=new r.CIMSymbolRasterizer(null,!0);h.previewCIMSymbol=function(a){return f.apply(this,arguments)};Object.defineProperty(h,"__esModule",{value:!0})});