// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(n,z,p,q,k,A,r,t,u,g,v){function w(a,c,d,e,h){var f=a.data;const x={portal:d&&d.portal||A.getDefault(),url:k.urlToObject(a.baseUrl),origin:"portal-item"};f=f.items.find(b=>b.name===c);if(!f)return Promise.reject(new q("symbolstyleutils:symbol-name-not-found",`The symbol name '${c}' could not be found`,
{symbolName:c}));let l=r.fromJSON(g.symbolUrlFromStyleItem(f,e),x),m=f.thumbnail&&f.thumbnail.href;const y=f.thumbnail&&f.thumbnail.imageData;p.isDevEnvironment()&&(l=p.adjustStaticAGOUrl(l),m=p.adjustStaticAGOUrl(m));const B={portal:d.portal,url:k.urlToObject(k.removeFile(l)),origin:"portal-item"};return g.requestJSON(l,h).then(b=>{b="cimRef"===e?g.makeCIMSymbolRef(b.data):b.data;if((b=t.fromJSON(b,B))&&z.isSymbol3D(b)){if(m){const C=r.fromJSON(m,x);b.thumbnail=new v.default({url:C})}else y&&(b.thumbnail=
new v.default({url:`data:image/png;base64,${y}`}));a.styleUrl?b.styleOrigin=new u({portal:d.portal,styleUrl:a.styleUrl,name:c}):a.styleName&&(b.styleOrigin=new u({portal:d.portal,styleName:a.styleName,name:c}))}return b})}function D(a,c,d){const e=g.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,a.name);return g.requestJSON(e,d).then(h=>{h=g.makeCIMSymbolRef(h.data);return t.fromJSON(h,{portal:c.portal,url:k.urlToObject(k.removeFile(e)),origin:"portal-item"})})}n.fetchSymbolFromStyle=w;n.resolveWebStyleSymbol=
function(a,c,d,e){return a.name?a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?D(a,c,e):g.fetchStyle(a,c,e).then(h=>w(h,a.name,c,d,e)):Promise.reject(new q("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};Object.defineProperty(n,"__esModule",{value:!0})});