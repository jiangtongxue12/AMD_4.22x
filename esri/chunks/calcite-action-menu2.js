// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("exports ./componentsUtils ./dom ./array2 ./observers ./calcite-action2 ./calcite-icon2 ./calcite-loader2 ./calcite-popover2 ./key".split(" "),function(h,f,k,q,v,w,x,y,z,A){function m(){["calcite-tooltip-manager"].forEach(a=>{switch(a){case "calcite-tooltip-manager":customElements.get(a)||customElements.define(a,n)}})}function r(){"calcite-action-menu calcite-action calcite-icon calcite-loader calcite-popover calcite-tooltip-manager".split(" ").forEach(a=>{switch(a){case "calcite-action-menu":customElements.get(a)||
customElements.define(a,h.CalciteActionMenu);break;case "calcite-action":customElements.get(a)||w.defineCustomElement();break;case "calcite-icon":customElements.get(a)||x.defineCustomElement();break;case "calcite-loader":customElements.get(a)||y.defineCustomElement();break;case "calcite-popover":customElements.get(a)||z.defineCustomElement();break;case "calcite-tooltip-manager":customElements.get(a)||m()}})}let n=class extends HTMLElement{constructor(){super();this.__registerHost();this.__attachShadow();
this.hoverTimeouts=new WeakMap;this.selector="[data-calcite-tooltip-reference]";this.queryTooltip=a=>{var b;const {selector:c,el:d}=this;a=null===(b=a.closest(c))||void 0===b?void 0:b.getAttribute("data-calcite-tooltip-reference");return k.queryElementRoots(d,`#${a}`)};this.clearHoverTimeout=a=>{const {hoverTimeouts:b}=this;b.has(a)&&(window.clearTimeout(b.get(a)),b.delete(a))};this.closeExistingTooltip=()=>{const {tooltipEl:a}=this;a&&this.toggleTooltip(a,!1)};this.focusTooltip=({tooltip:a,value:b})=>
{this.closeExistingTooltip();b&&this.clearHoverTimeout(a);this.toggleTooltip(a,b)};this.toggleTooltip=(a,b)=>{if(a.open=b)this.tooltipEl=a};this.hoverToggle=({tooltip:a,value:b})=>{const {hoverTimeouts:c}=this;c.delete(a);b&&this.closeExistingTooltip();this.toggleTooltip(a,b)};this.hoverTooltip=({tooltip:a,value:b})=>{this.clearHoverTimeout(a);const {hoverTimeouts:c}=this,d=window.setTimeout(()=>this.hoverToggle({tooltip:a,value:b}),500);c.set(a,d)};this.activeTooltipHover=a=>{const {tooltipEl:b,
hoverTimeouts:c}=this,{type:d}=a;b&&("mouseover"===d&&a.composedPath().includes(b)?this.clearHoverTimeout(b):"mouseout"!==d||c.has(b)||this.hoverTooltip({tooltip:b,value:!1}))};this.hoverEvent=(a,b)=>{const c=this.queryTooltip(a.target);this.activeTooltipHover(a);c&&this.hoverTooltip({tooltip:c,value:b})};this.focusEvent=(a,b)=>{(a=this.queryTooltip(a.target))&&a!==this.clickedTooltip?this.focusTooltip({tooltip:a,value:b}):this.clickedTooltip=null}}render(){return f.h("slot",null)}keyUpHandler(a){"Escape"===
A.getKey(a.key)&&({tooltipEl:a}=this,a&&(this.clearHoverTimeout(a),this.toggleTooltip(a,!1)))}mouseEnterShow(a){this.hoverEvent(a,!0)}mouseLeaveHide(a){this.hoverEvent(a,!1)}clickHandler(a){(this.clickedTooltip=a=this.queryTooltip(a.target))&&this.toggleTooltip(a,!1)}focusShow(a){this.focusEvent(a,!0)}blurHide(a){this.focusEvent(a,!1)}get el(){return this}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:300ms}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:block}"}};
n=f.proxyCustomElement(n,[1,"calcite-tooltip-manager",{selector:[1]},[[4,"keyup","keyUpHandler"],[3,"mouseover","mouseEnterShow"],[3,"mouseout","mouseLeaveHide"],[2,"click","clickHandler"],[2,"focus","focusShow"],[2,"blur","blurHide"]]]);m();const l={tooltip:"tooltip",trigger:"trigger"},t=["ArrowUp","ArrowDown"],u=["ArrowUp","ArrowDown","End","Home"];h.CalciteActionMenu=class extends HTMLElement{constructor(){super();this.__registerHost();this.__attachShadow();this.calciteActionMenuOpenChange=f.createEvent(this,
"calciteActionMenuOpenChange",7);this.open=this.expanded=!1;this.overlayPositioning="absolute";this.placement="auto";this.actionElements=[];this.mutationObserver=v.createObserver("mutation",()=>this.getActions());this.guid=`calcite-action-menu-${k.guid()}`;this.menuId=`${this.guid}-menu`;this.menuButtonId=`${this.guid}-menu-button`;this.activeMenuItemIndex=-1;this.connectMenuButtonEl=()=>{const {el:a,menuButtonId:b,menuId:c,open:d,label:g}=this,e=k.getSlotted(a,l.trigger)||this.defaultMenuButtonEl;
this.menuButtonEl!==e&&(this.disconnectMenuButtonEl(),this.menuButtonEl=e,this.setTooltipReferenceElement(),e&&(e.active=d,e.setAttribute("aria-controls",c),e.setAttribute("aria-expanded",d.toString()),e.setAttribute("aria-haspopup","true"),e.id||(e.id=b),e.label||(e.label=g),e.text||(e.text=g),e.addEventListener("click",this.menuButtonClick),e.addEventListener("keydown",this.menuButtonKeyDown),e.addEventListener("keyup",this.menuButtonKeyUp)))};this.disconnectMenuButtonEl=()=>{const {menuButtonEl:a}=
this;a&&(a.removeEventListener("click",this.menuButtonClick),a.removeEventListener("keydown",this.menuButtonKeyDown),a.removeEventListener("keyup",this.menuButtonKeyUp))};this.setDefaultMenuButtonEl=a=>{this.defaultMenuButtonEl=a;this.connectMenuButtonEl()};this.handleCalciteActionClick=()=>{this.open=!1;this.setFocus()};this.menuButtonClick=()=>{this.toggleOpen()};this.setTooltipReferenceElement=()=>{const {el:a,expanded:b,menuButtonEl:c}=this;var d=k.getSlotted(a,l.tooltip);d="SLOT"===(null===d||
void 0===d?void 0:d.tagName)?d.assignedElements()[0]:d;"CALCITE-TOOLTIP"===(null===d||void 0===d?void 0:d.tagName)&&(d.referenceElement=b?null:c)};this.updateAction=(a,b)=>{const {guid:c,activeMenuItemIndex:d}=this,g=`${c}-action-${b}`;a.tabIndex=-1;a.setAttribute("role","menuitem");a.id||(a.id=g);a.active=b===d};this.updateActions=a=>{null===a||void 0===a?void 0:a.forEach(this.updateAction)};this.getActions=()=>{var {el:a}=this;const b=this.getAssignedElements().filter(c=>"CALCITE-ACTION"===c.tagName&&
"trigger"!==c.slot);a=b.length?b:Array.from(a.querySelectorAll("calcite-action:not([slot\x3dtrigger])"));this.updateActions(a);this.actionElements=a;this.connectMenuButtonEl()};this.menuButtonKeyUp=a=>{const {key:b}=a,{actionElements:c}=this;this.isValidKey(b,t)&&(a.preventDefault(),c.length&&(this.toggleOpen(!0),this.handleActionNavigation(b,c)))};this.menuButtonKeyDown=a=>{const {key:b}=a;this.isValidKey(b,t)&&a.preventDefault()};this.menuActionsContainerKeyDown=a=>{const {key:b}=a,{actionElements:c,
activeMenuItemIndex:d}=this;"Tab"===b?this.open=!1:" "===b||"Enter"===b?(a.preventDefault(),(a=c[d])?a.click():this.toggleOpen(!1)):this.isValidKey(b,u)&&a.preventDefault()};this.menuActionsContainerKeyUp=a=>{const {key:b}=a,{actionElements:c}=this;"Escape"===b?this.toggleOpen(!1):this.isValidKey(b,u)&&(a.preventDefault(),c.length&&this.handleActionNavigation(b,c))};this.handleActionNavigation=(a,b)=>{const c=this.activeMenuItemIndex;"Home"===a&&(this.activeMenuItemIndex=0);"End"===a&&(this.activeMenuItemIndex=
b.length-1);"ArrowUp"===a&&(this.activeMenuItemIndex=q.getRoundRobinIndex(Math.max(c-1,-1),b.length));"ArrowDown"===a&&(this.activeMenuItemIndex=q.getRoundRobinIndex(c+1,b.length))};this.toggleOpenEnd=()=>{this.setFocus();this.el.removeEventListener("calcitePopoverOpen",this.toggleOpenEnd)};this.toggleOpen=(a=!this.open)=>{this.el.addEventListener("calcitePopoverOpen",this.toggleOpenEnd);this.open=a}}connectedCallback(){var a;null===(a=this.mutationObserver)||void 0===a?void 0:a.observe(this.el,{childList:!0,
subtree:!0});this.getActions()}disconnectedCallback(){var a;null===(a=this.mutationObserver)||void 0===a?void 0:a.disconnect();this.disconnectMenuButtonEl()}expandedHandler(){this.open=!1;this.setTooltipReferenceElement()}openHandler(a){this.activeMenuItemIndex=this.open?0:-1;this.menuButtonEl&&(this.menuButtonEl.active=a);this.calciteActionMenuOpenChange.emit(a)}closeCalciteActionMenuOnClick(a){a.composedPath().includes(this.el)||(this.open=!1)}activeMenuItemIndexHandler(){this.updateActions(this.actionElements)}async setFocus(){k.focusElement(this.open?
this.menuEl:this.menuButtonEl)}renderMenuButton(){const {el:a,label:b,scale:c}=this,d=f.h("slot",{name:l.trigger},f.h("calcite-action",{class:"default-trigger",icon:"ellipsis",ref:this.setDefaultMenuButtonEl,scale:c,text:b}));return k.getSlotted(a,l.tooltip)?f.h("calcite-tooltip-manager",null,d):d}renderMenuItems(){const {actionElements:a,activeMenuItemIndex:b,open:c,menuId:d,menuButtonEl:g,label:e,placement:B,overlayPositioning:C}=this,p=a[b];return f.h("calcite-popover",{disablePointer:!0,label:e,
offsetDistance:0,open:c,overlayPositioning:C,placement:B,referenceElement:g},f.h("div",{"aria-activedescendant":(null===p||void 0===p?void 0:p.id)||null,"aria-labelledby":null===g||void 0===g?void 0:g.id,class:"menu",id:d,onClick:this.handleCalciteActionClick,onKeyDown:this.menuActionsContainerKeyDown,onKeyUp:this.menuActionsContainerKeyUp,ref:D=>this.menuEl=D,role:"menu",tabIndex:-1},f.h("slot",null)))}render(){return f.h(f.Fragment,null,this.renderMenuButton(),this.renderMenuItems(),f.h("slot",
{name:l.tooltip}))}getAssignedElements(){return Array.from(this.el.querySelectorAll("slot")).map(a=>a.assignedElements({flatten:!0})).reduce((a,b)=>a.concat(b),[])}isValidKey(a,b){return!!b.find(c=>c===a)}get el(){return this}static get watchers(){return{expanded:["expandedHandler"],open:["openHandler"],activeMenuItemIndex:["activeMenuItemIndexHandler"]}}static get style(){return"@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:300ms}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:150ms ease-in-out}:host([hidden]){display:none}:host{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size-1)}.menu ::slotted(calcite-action){display:-ms-flexbox;display:flex;outline-offset:0;outline-color:transparent;-webkit-transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;margin:0.125rem}::slotted(calcite-action[active]){outline:2px solid var(--calcite-ui-brand);outline-offset:2px;outline-offset:0px}.default-trigger{-ms-flex-item-align:stretch;align-self:stretch;-ms-flex:0 1 auto;flex:0 1 auto;height:100%;position:relative}slot[name\x3dtrigger]::slotted(calcite-action),calcite-action::slotted([slot\x3dtrigger]){-ms-flex-item-align:stretch;align-self:stretch;-ms-flex:0 1 auto;flex:0 1 auto;height:100%;position:relative}.menu{-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:nowrap;flex-wrap:nowrap;outline:2px solid transparent;outline-offset:2px}"}};
h.CalciteActionMenu=f.proxyCustomElement(h.CalciteActionMenu,[1,"calcite-action-menu",{expanded:[516],flipPlacements:[16],label:[1],open:[1540],overlayPositioning:[1,"overlay-positioning"],placement:[513],scale:[513],activeMenuItemIndex:[32],setFocus:[64]},[[8,"click","closeCalciteActionMenuOnClick"]]]);r();h.SLOTS=l;h.defineCustomElement=m;h.defineCustomElement$1=r});