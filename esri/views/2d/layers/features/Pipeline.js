// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/HandleOwner":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Handles ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ../views/support/WatchUpdatingTracking".split(" "),function(r,t,C,D,x,w,q,p){const g=e=>{e=function(l){function k(){return l.apply(this,arguments)||this}t._inheritsLoose(k,l);k.prototype.destroy=function(){var n,d;this.destroyed||(null==(n=this._get("handles"))?void 0:n.destroy(),
null==(d=this._get("updatingHandles"))?void 0:d.destroy())};t._createClass(k,[{key:"handles",get:function(){return this._get("handles")||new x}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new p.WatchUpdatingTracking}}]);return k}(e);C.__decorate([w.property({readOnly:!0})],e.prototype,"handles",null);C.__decorate([w.property({readOnly:!0})],e.prototype,"updatingHandles",null);return e=C.__decorate([q.subclass("esri.core.HandleOwner")],e)};r.HandleOwner=function(e){function l(){return e.apply(this,
arguments)||this}t._inheritsLoose(l,e);return l}(g(D));r.HandleOwner=C.__decorate([q.subclass("esri.core.HandleOwner")],r.HandleOwner);r.HandleOwnerMixin=g;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/Handles":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Collection ./maybe ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(r,t,C,D,x,w,q){C=function(p){function g(l){l=p.call(this,l)||this;l._groups=
new Map;return l}r._inheritsLoose(g,p);var e=g.prototype;e.destroy=function(){this.removeAll()};e.add=function(l,k){if(!this._isHandle(l)&&!Array.isArray(l)&&!D.isCollection(l))return this;const n=this._getOrCreateGroup(k);Array.isArray(l)||D.isCollection(l)?l.forEach(d=>this._isHandle(d)&&n.push(d)):n.push(l);this.notifyChange("size");return this};e.forEach=function(l,k){if("function"===typeof l)this._groups.forEach(n=>n.forEach(l));else{const n=this._getGroup(l);n&&k&&n.forEach(k)}};e.has=function(l){return this._groups.has(this._ensureGroupKey(l))};
e.remove=function(l){if(Array.isArray(l)||D.isCollection(l))return l.forEach(this.remove,this),this;if(!this.has(l))return this;const k=this._getGroup(l);for(let n=0;n<k.length;n++)k[n].remove();this._deleteGroup(l);this.notifyChange("size");return this};e.removeAll=function(){this._groups.forEach(l=>{for(let k=0;k<l.length;k++)l[k].remove()});this._groups.clear();this.notifyChange("size");return this};e._isHandle=function(l){return l&&!!l.remove};e._getOrCreateGroup=function(l){if(this.has(l))return this._getGroup(l);
const k=[];this._groups.set(this._ensureGroupKey(l),k);return k};e._getGroup=function(l){return x.assumeNonNull(this._groups.get(this._ensureGroupKey(l)))};e._deleteGroup=function(l){return this._groups.delete(this._ensureGroupKey(l))};e._ensureGroupKey=function(l){return l||"_default_"};r._createClass(g,[{key:"size",get:function(){let l=0;this._groups.forEach(k=>{l+=k.length});return l}}]);return g}(C);t.__decorate([w.property({readOnly:!0})],C.prototype,"size",null);return C=t.__decorate([q.subclass("esri.core.Handles")],
C)})},"esri/core/Collection":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./scheduling ./accessorSupport/decorators/property ./accessorSupport/ensureType ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking ./accessorSupport/tracking/SimpleObservable".split(" "),function(r,t,C,D,x,w,q,p,g,e,l,k,n,d){function b(H){return H?H instanceof G?H.toArray():H.length?Array.prototype.slice.apply(H):
[]:[]}function a(H){if(H&&H.length)return H[0]}function c(H,K,L,J){K&&K.forEach((B,y,I)=>{H.push(B);c(H,L.call(J,B,y,I),L,J)})}var f;let m=function(){function H(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var K=H.prototype;K.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};K.reset=function(L){this.defaultPrevented=!1;this.item=L};return H}();const h=new q(m,void 0,H=>{H.item=null;H.target=null;H.defaultPrevented=!1;H.cancellable=!1}),
v=()=>{},u=new Set,F=new Set,z=new Set,A=new Map;let E=0,G=f=function(H,K){function L(B){B=H.call(this,B)||this;B._chgListeners=[];B._notifications=null;B._timer=null;B._observable=new d.SimpleObservable;B.length=0;B._items=[];Object.defineProperty(r._assertThisInitialized(B),"uid",{value:E++});return B}r._inheritsLoose(L,H);L.isCollection=function(B){return null!=B&&B instanceof f};var J=L.prototype;J.normalizeCtorArgs=function(B){return B?Array.isArray(B)||B instanceof f?{items:B}:B:{}};J.destroy=
function(){this.removeAll()};J[K]=function*(){yield*this.items};J.hasEventListener=function(B){return"change"===B?0<this._chgListeners.length:this._emitter.hasEventListener(B)};J.on=function(B,y){if("change"===B){const I=this._chgListeners,S={removed:!1,callback:y};I.push(S);this._notifications&&this._notifications.push({listeners:I.slice(),items:this._items.slice(),changes:[]});return{remove(){this.remove=v;S.removed=!0;I.splice(I.indexOf(S),1)}}}return this._emitter.on(B,y)};J.once=function(B,y){const I=
this.on(B,y);return{remove(){I.remove()}}};J.add=function(B,y){n.trackAccess(this._observable);if(this._emitBeforeChanges(1))return this;y=this.getNextIndex(null!=y?y:null);this._splice(y,0,[B]);this._emitAfterChanges(1);return this};J.addMany=function(B,y=this._items.length){n.trackAccess(this._observable);if(!B||!B.length||this._emitBeforeChanges(1))return this;y=this.getNextIndex(y);this._splice(y,0,b(B));this._emitAfterChanges(1);return this};J.removeAll=function(){n.trackAccess(this._observable);
if(!this.length||this._emitBeforeChanges(2))return[];const B=this._splice(0,this.length)||[];this._emitAfterChanges(2);return B};J.clone=function(){n.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(x.clone)})};J.concat=function(...B){n.trackAccess(this._observable);B=B.map(b);return this._createNewInstance({items:this._items.concat(...B)})};J.drain=function(B,y){n.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var I=w.assumeNonNull(this._splice(0,
this.length)),S=I.length;for(let O=0;O<S;O++)B.call(y,I[O],O,I);this._emitAfterChanges(2)}};J.every=function(B,y){n.trackAccess(this._observable);return this._items.every(B,y)};J.filter=function(B,y){n.trackAccess(this._observable);let I;I=2===arguments.length?this._items.filter(B,y):this._items.filter(B);return this._createNewInstance({items:I})};J.find=function(B,y){n.trackAccess(this._observable);return this._items.find(B,y)};J.findIndex=function(B,y){n.trackAccess(this._observable);return this._items.findIndex(B,
y)};J.flatten=function(B,y){n.trackAccess(this._observable);const I=[];c(I,this,B,y);return new f(I)};J.forEach=function(B,y){n.trackAccess(this._observable);return this._items.forEach(B,y)};J.getItemAt=function(B){n.trackAccess(this._observable);return this._items[B]};J.getNextIndex=function(B){n.trackAccess(this._observable);const y=this.length;B=null==B?y:B;0>B?B=0:B>y&&(B=y);return B};J.includes=function(B,y=0){n.trackAccess(this._observable);return this._items.includes(B,y)};J.indexOf=function(B,
y=0){n.trackAccess(this._observable);return this._items.indexOf(B,y)};J.join=function(B=","){n.trackAccess(this._observable);return this._items.join(B)};J.lastIndexOf=function(B,y=this.length-1){n.trackAccess(this._observable);return this._items.lastIndexOf(B,y)};J.map=function(B,y){n.trackAccess(this._observable);B=this._items.map(B,y);return new f({items:B})};J.reorder=function(B,y=this.length-1){n.trackAccess(this._observable);const I=this.indexOf(B);if(-1!==I){0>y?y=0:y>=this.length&&(y=this.length-
1);if(I!==y){if(this._emitBeforeChanges(4))return B;this._splice(I,1);this._splice(y,0,[B]);this._emitAfterChanges(4)}return B}};J.pop=function(){n.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var B=a(this._splice(this.length-1,1));this._emitAfterChanges(2);return B}};J.push=function(...B){n.trackAccess(this._observable);if(this._emitBeforeChanges(1))return this.length;this._splice(this.length,0,B);this._emitAfterChanges(1);return this.length};J.reduce=function(B,y){n.trackAccess(this._observable);
const I=this._items;return 2===arguments.length?I.reduce(B,y):I.reduce(B)};J.reduceRight=function(B,y){n.trackAccess(this._observable);const I=this._items;return 2===arguments.length?I.reduceRight(B,y):I.reduceRight(B)};J.remove=function(B){n.trackAccess(this._observable);return this.removeAt(this.indexOf(B))};J.removeAt=function(B){n.trackAccess(this._observable);if(!(0>B||B>=this.length||this._emitBeforeChanges(2)))return B=a(this._splice(B,1)),this._emitAfterChanges(2),B};J.removeMany=function(B){n.trackAccess(this._observable);
if(!B||!B.length||this._emitBeforeChanges(2))return[];B=B instanceof f?B.toArray():B;const y=this._items,I=[],S=B.length;for(let Q=0;Q<S;Q++){var O=y.indexOf(B[Q]);if(-1<O){{var Y=Q+1;var R=O+1;const W=Math.min(B.length-Y,y.length-R);let P=0;for(;P<W&&B[Y+P]===y[R+P];)P++;Y=P}Y=1+Y;(O=this._splice(O,Y))&&0<O.length&&I.push.apply(I,O);Q+=Y-1}}this._emitAfterChanges(2);return I};J.reverse=function(){n.trackAccess(this._observable);if(this._emitBeforeChanges(4))return this;const B=this._splice(0,this.length);
B&&(B.reverse(),this._splice(0,0,B));this._emitAfterChanges(4);return this};J.shift=function(){n.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var B=a(this._splice(0,1));this._emitAfterChanges(2);return B}};J.slice=function(B=0,y=this.length){n.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(B,y)})};J.some=function(B,y){n.trackAccess(this._observable);return this._items.some(B,y)};J.sort=function(B){n.trackAccess(this._observable);
if(!this.length||this._emitBeforeChanges(4))return this;const y=w.assumeNonNull(this._splice(0,this.length));arguments.length?y.sort(B):y.sort();this._splice(0,0,y);this._emitAfterChanges(4);return this};J.splice=function(B,y,...I){n.trackAccess(this._observable);const S=(y?2:0)|(I.length?1:0);if(this._emitBeforeChanges(S))return[];B=this._splice(B,y,I)||[];this._emitAfterChanges(S);return B};J.toArray=function(){n.trackAccess(this._observable);return this._items.slice()};J.toJSON=function(){n.trackAccess(this._observable);
return this.toArray()};J.toLocaleString=function(){n.trackAccess(this._observable);return this._items.toLocaleString()};J.toString=function(){n.trackAccess(this._observable);return this._items.toString()};J.unshift=function(...B){n.trackAccess(this._observable);if(!B.length||this._emitBeforeChanges(1))return this.length;this._splice(0,0,B);this._emitAfterChanges(1);return this.length};J._createNewInstance=function(B){return new this.constructor(B)};J._splice=function(B,y,I){const S=this._items;var O=
this.itemType;let Y=void 0;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=p.schedule(()=>this._dispatchChange()));if(y){Y=S.splice(B,y);if(this.hasEventListener("before-remove")){var R=h.acquire();R.target=this;R.cancellable=!0;for(let P=0,fa=Y.length;P<fa;P++)y=Y[P],R.reset(y),this.emit("before-remove",R),R.defaultPrevented&&(Y.splice(P,1),S.splice(B,
0,y),B+=1,--P,--fa);h.release(R)}this.length=this._items.length;if(this.hasEventListener("after-remove")){y=h.acquire();y.target=this;y.cancellable=!1;R=Y.length;for(let P=0;P<R;P++)y.reset(Y[P]),this.emit("after-remove",y);h.release(y)}}if(I&&I.length){if(O){y=[];for(var Q of I)I=O.ensureType(Q),null==I&&null!=Q||y.push(I);I=y}O=this.hasEventListener("before-add");Q=this.hasEventListener("after-add");y=B===this.length;if(O||Q){var W=h.acquire();W.target=this;W.cancellable=!0;R=h.acquire();R.target=
this;R.cancellable=!1;for(const P of I)O?(W.reset(P),this.emit("before-add",W),W.defaultPrevented||(y?S.push(P):S.splice(B++,0,P),this._set("length",S.length),Q&&(R.reset(P),this.emit("after-add",R)))):(y?S.push(P):S.splice(B++,0,P),this._set("length",S.length),R.reset(P),this.emit("after-add",R));h.release(R);h.release(W)}else{if(y)for(W of I)S.push(W);else S.splice(B,0,...I);this._set("length",S.length)}}(I&&I.length||Y&&Y.length)&&this._notifyChangeEvent(I,Y);return Y};J._emitBeforeChanges=function(B){let y=
!1;if(this.hasEventListener("before-changes")){const I=h.acquire();I.target=this;I.cancellable=!0;I.type=B;this.emit("before-changes",I);y=I.defaultPrevented;h.release(I)}return y};J._emitAfterChanges=function(B){if(this.hasEventListener("after-changes")){const y=h.acquire();y.target=this;y.cancellable=!1;y.type=B;this.emit("after-changes",y);h.release(y)}this._observable.notify()};J._notifyChangeEvent=function(B,y){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-
1].changes.push({added:B,removed:y})};J._dispatchChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var B=this._notifications;this._notifications=null;for(const y of B){B=y.changes;u.clear();F.clear();z.clear();for(const {added:Q,removed:W}of B){if(Q)if(0===z.size&&0===F.size)for(const P of Q)u.add(P);else for(const P of Q)F.has(P)?(z.add(P),F.delete(P)):z.has(P)||u.add(P);if(W)if(0===z.size&&0===u.size)for(const P of W)F.add(P);else for(const P of W)u.has(P)?
u.delete(P):(z.delete(P),F.add(P))}const I=C.acquire();u.forEach(Q=>{I.push(Q)});const S=C.acquire();F.forEach(Q=>{S.push(Q)});const O=this._items,Y=y.items,R=C.acquire();z.forEach(Q=>{Y.indexOf(Q)!==O.indexOf(Q)&&R.push(Q)});if(y.listeners&&(I.length||S.length||R.length)){B={target:this,added:I,removed:S,moved:R};const Q=y.listeners.length;for(let W=0;W<Q;W++){const P=y.listeners[W];P.removed||P.callback.call(this,B)}}C.release(I);C.release(S);C.release(R)}u.clear();F.clear();z.clear()}};r._createClass(L,
[{key:"items",get:function(){n.trackAccess(this._observable);return this._items},set:function(B){this._emitBeforeChanges(1)||(this._splice(0,this.length,b(B)),this._emitAfterChanges(1))}}]);return L}(D.EventedAccessor,Symbol.iterator);G.ofType=H=>{if(!H)return f;if(A.has(H))return A.get(H);let K=null;if("function"===typeof H)K=H.prototype.declaredClass;else if(H.base)K=H.base.prototype.declaredClass;else for(var L in H.typeMap){const J=H.typeMap[L].prototype.declaredClass;K=K?K+` | ${J}`:J}L=function(J){function B(){return J.apply(this,
arguments)||this}r._inheritsLoose(B,J);return B}(f);t.__decorate([l.shared({Type:H,ensureType:"function"===typeof H?e.ensureType(H):e.ensureOneOfType(H)})],L.prototype,"itemType",void 0);L=t.__decorate([k.subclass(`esri.core.Collection<${K}>`)],L);A.set(H,L);return L};t.__decorate([g.property()],G.prototype,"length",void 0);t.__decorate([g.property()],G.prototype,"items",null);return G=f=t.__decorate([k.subclass("esri.core.Collection")],G)})},"esri/core/Evented":function(){define(["../chunks/_rollupPluginBabelHelpers",
"../chunks/tslib.es6","./Accessor","./handleUtils","./accessorSupport/decorators/subclass"],function(r,t,C,D,x){let w=function(){function q(){this._emitter=new q.EventEmitter(this)}var p=q.prototype;p.emit=function(g,e){return this._emitter.emit(g,e)};p.on=function(g,e){return this._emitter.on(g,e)};p.once=function(g,e){return this._emitter.once(g,e)};p.hasEventListener=function(g){return this._emitter.hasEventListener(g)};return q}();(function(q){let p=function(){function e(k=null){this.target=k;
this._listenersMap=null}var l=e.prototype;l.clear=function(){this._listenersMap&&this._listenersMap.clear();this._listenersMap=null};l.emit=function(k,n){k=this._listenersMap&&this._listenersMap.get(k);if(!k)return!1;const d=this.target||this;[...k].forEach(b=>{b.call(d,n)});return 0<k.length};l.on=function(k,n){if(Array.isArray(k)){var d=k.map(b=>this.on(b,n));return D.handlesGroup(d)}if(-1<k.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");
this._listenersMap||(this._listenersMap=new Map);d=this._listenersMap.get(k)||[];d.push(n);this._listenersMap.set(k,d);return{remove:()=>{const b=this._listenersMap&&this._listenersMap.get(k)||[],a=b.indexOf(n);0<=a&&b.splice(a,1)}}};l.once=function(k,n){const d=this.on(k,b=>{d.remove();n.call(null,b)});return d};l.hasEventListener=function(k){k=this._listenersMap&&this._listenersMap.get(k);return null!=k&&0<k.length};return e}();q.EventEmitter=p;q.EventedMixin=e=>{e=function(l){function k(){var d=
l.apply(this,arguments)||this;d._emitter=new p;return d}r._inheritsLoose(k,l);var n=k.prototype;n.destroy=function(){this._emitter.clear()};n.emit=function(d,b){return this._emitter.emit(d,b)};n.on=function(d,b){return this._emitter.on(d,b)};n.once=function(d,b){return this._emitter.once(d,b)};n.hasEventListener=function(d){return this._emitter.hasEventListener(d)};return k}(e);return e=t.__decorate([x.subclass("esri.core.Evented")],e)};let g=function(e){function l(){var n=e.apply(this,arguments)||
this;n._emitter=new w.EventEmitter(r._assertThisInitialized(n));return n}r._inheritsLoose(l,e);var k=l.prototype;k.destroy=function(){this._emitter.clear()};k.emit=function(n,d){return this._emitter.emit(n,d)};k.on=function(n,d){return this._emitter.on(n,d)};k.once=function(n,d){return this._emitter.once(n,d)};k.hasEventListener=function(n){return this._emitter.hasEventListener(n)};return l}(C);g=t.__decorate([x.subclass("esri.core.Evented")],g);q.EventedAccessor=g})(w||(w={}));return w})},"esri/core/accessorSupport/decorators/shared":function(){define(["exports"],
function(r){r.shared=function(t){return(C,D)=>{C[D]=t}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/accessorSupport/tracking/SimpleObservable":function(){define(["exports","./ObservationHandle"],function(r,t){let C=function(){function D(){this._observers=[]}var x=D.prototype;x.observe=function(w){this._observers.includes(w)||this._observers.push(w);return new t.ObservationHandle(this._observers,w)};x.notify=function(){const w=this._observers.slice();for(let q=0;q<w.length;++q){const p=
w[q];p.onInvalidated();p.onCommitted()}};return D}();r.SimpleObservable=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/support/WatchUpdatingTracking":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Handles ../../core/maybe ../../core/reactiveUtils ../../core/scheduling ../../core/watchUtils ../../core/accessorSupport/get ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k){r.WatchUpdatingTracking=function(n){function d(){var a=n.apply(this,arguments)||this;a.updating=!1;a.handleId=0;a.handles=new x;a.scheduleHandleId=0;a.pendingPromises=new Set;return a}t._inheritsLoose(d,n);var b=d.prototype;b.destroy=function(){this.removeAll();this.handles.destroy()};b.add=function(a,c,f,m=0){const h=0!==(m&1),v=++this.handleId;h||this.installSyncUpdatingWatch(a,c,v);a=0!==(m&2)?g.init(a,c,f,h):a.watch(c,f,h);this.handles.add(a,v);return{remove:()=>
this.handles.remove(v)}};b.addOnCollectionPropertyChange=function(a,c,f,m=0){m=0!==(m&2);const h=++this.handleId;this.handles.add([g.on(a,c,"after-changes",this.createSyncUpdatingCallback()),g.on(a,c,"change",f,m?v=>{f({added:v.items,removed:[],moved:[],target:v})}:void 0)],h);return{remove:()=>{this.handles.remove(h)}}};b.addOnCollectionChange=function(a,c,f=0){f=0!==(f&2);const m=++this.handleId;this.handles.add([a.on("after-changes",this.createSyncUpdatingCallback()),a.on("change",c)],m);f&&c({added:a.items,
removed:[],moved:[],target:a});return{remove:()=>{this.handles.remove(m)}}};b.addPromise=function(a){if(w.isNone(a))return a;const c=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(a)&&(0!==this.pendingPromises.size||this.handles.has(-42)||this._set("updating",!1))}},c);this.pendingPromises.add(a);this._set("updating",!0);const f=()=>this.handles.remove(c);a.then(f,f);return a};b.removeAll=function(){this.pendingPromises.clear();this.handles.removeAll();this._set("updating",
!1)};b.installSyncUpdatingWatch=function(a,c,f){var m=this.createSyncUpdatingCallback();m=q.react(()=>e.valueOf(a,c),m,{sync:!0,equals:()=>!1});this.handles.add(m,f);return m};b.createSyncUpdatingCallback=function(){return()=>{this.handles.remove(-42);++this.scheduleHandleId;const a=this.scheduleHandleId;this._get("updating")||this._set("updating",!0);this.handles.add(p.schedule(()=>{a===this.scheduleHandleId&&(this._set("updating",0<this.pendingPromises.size),this.handles.remove(-42))}),-42)}};return d}(D);
C.__decorate([l.property({readOnly:!0})],r.WatchUpdatingTracking.prototype,"updating",void 0);r.WatchUpdatingTracking=C.__decorate([k.subclass("esri.views.support.WatchUpdatingTracking")],r.WatchUpdatingTracking);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/reactiveUtils":function(){define("exports ./events ./handleUtils ./maybe ./accessorSupport/watch ./accessorSupport/trackingUtils".split(" "),function(r,t,C,D,x,w){function q(e,l,k={},n){let d=null;const b=k.once?(a,c)=>{n(a)&&
(D.removeMaybe(d),l(a,c))}:(a,c)=>{n(a)&&l(a,c)};d=x.watchTracked(e,b,k.sync,k.equals);k.initial&&(e=e(),b(e,e));return d}function p(e){return!0}function g(e){return!!e}r.autorun=w.autorun;r.initial={initial:!0};r.react=function(e,l,k={}){return q(e,l,k,p)};r.reactListener=function(e,l,k,n={}){function d(){a&&c&&(c.remove(),null==n.onListenerRemove?void 0:n.onListenerRemove(a),c=a=null)}function b(h){n.once&&n.once&&D.removeMaybe(f);k(h)}let a=null,c=null,f=null;const m=x.watchTracked(e,(h,v)=>{d();
t.isEventTarget(h)&&(a=h,c=t.on(h,l,b),null==n.onListenerAdd?void 0:n.onListenerAdd(h))},n.sync);return f=C.makeHandle(()=>{m.remove();d()})};r.reactTruthy=function(e,l,k={}){return q(e,l,k,g)};r.sync={sync:!0};r.syncAndInitial={sync:!0,initial:!0};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/watchUtils":function(){define(["exports","./events","./lang","./promiseUtils"],function(r,t,C,D){function x(b,a,c,f){var m=Array.isArray(a)?a:-1<a.indexOf(",")?a.split(","):[a];a=b.watch(a,
c,f);for(const h of m)m=h.trim().replace(d,"$1"),f=b.get(m),c.call(b,f,f,m,b);return a}function w(b,a,c,f,m){m=b.watch(a,(v,u,F,z)=>{if(!c||c(v))null==f?void 0:f.call(b,v,u,F,z)},m);if(Array.isArray(a))for(var h of a){const v=b.get(h);c&&c(v)&&(null==f?void 0:f.call(b,v,v,a,b))}else h=b.get(a),c&&c(h)&&(null==f?void 0:f.call(b,h,h,a,b));return m}function q(b,a,c,f,m){function h(){z&&(z.remove(),z=null)}const v="function"===typeof f?f:null,u="object"===typeof f?f:null;"boolean"===typeof f&&(m=f);let F=
!1,z;const A=D.createDeferred();D.onAbort(u,()=>{h();A.reject(D.createAbortError())});f={then:A.promise.then.bind(A.promise),catch:A.promise.catch.bind(A.promise),remove:h};Object.freeze(f);z=w(b,a,c,(E,G,H,K)=>{F=!0;h();v&&v.call(b,E,G,H,K);A.resolve({value:E,oldValue:G,propertyName:H,target:K})},m);F&&h();return f}function p(b){return!!b}function g(b){return!b}function e(b){return!0===b}function l(b){return!1===b}function k(b){return void 0!==b}function n(b){return void 0===b}const d=/\?(\.|$)/g;
r.init=x;r.on=function(b,a,c,f,m,h,v){function u(A){const E=F[A];E&&(h&&h(E.target,A,b,c),E.handle.remove(),delete F[A])}const F={},z=x(b,a,(A,E,G)=>{u(G);t.isEventTarget(A)&&(F[G]={handle:t.on(A,c,f),target:A},m&&m(A,G,b,c))},v);return{remove(){z.remove();for(const A in F)u(A)}}};r.once=function(b,a,c,f){return q(b,a,null,c,f)};r.pausable=function(b,a,c,f){let m=!1;const h=b.watch(a,(v,u,F,z)=>{m||c.call(b,v,u,F,z)},f);return{remove(){h.remove()},pause(){m=!0},resume(){m=!1}}};r.watch=function(b,
a,c,f){return b.watch(a,c,f)};r.when=function(b,a,c,f){return w(b,a,p,c,f)};r.whenDefined=function(b,a,c,f){return w(b,a,k,c,f)};r.whenDefinedOnce=function(b,a,c,f){return q(b,a,k,c,f)};r.whenEqual=function(b,a,c,f,m){return w(b,a,h=>C.equals(c,h),f,m)};r.whenEqualOnce=function(b,a,c,f,m){return q(b,a,h=>C.equals(c,h),f,m)};r.whenFalse=function(b,a,c,f){return w(b,a,l,c,f)};r.whenFalseOnce=function(b,a,c,f){return q(b,a,l,c,f)};r.whenNot=function(b,a,c,f){return w(b,a,g,c,f)};r.whenNotOnce=function(b,
a,c,f){return q(b,a,g,c,f)};r.whenOnce=function(b,a,c,f){return q(b,a,p,c,f)};r.whenTrue=function(b,a,c,f){return w(b,a,e,c,f)};r.whenTrueOnce=function(b,a,c,f){return q(b,a,e,c,f)};r.whenUndefined=function(b,a,c,f){return w(b,a,n,c,f)};r.whenUndefinedOnce=function(b,a,c,f){return q(b,a,n,c,f)};r.whenValidOnce=q;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m){var h;C=new C.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});D=h=function(v){function u(z){z=v.call(this,z)||this;z.dpi=96;z.format=null;z.origin=null;z.minScale=0;z.maxScale=0;z.size=null;z.spatialReference=null;return z}r._inheritsLoose(u,v);u.create=function(z=
{}){const {resolutionFactor:A=1,scales:E,size:G=256,spatialReference:H=b.WebMercator,numLODs:K=24}=z;if(!c.isValid(H)){z=[];if(E)for(var L=0;L<E.length;L++){var J=E[L];z.push({level:L,scale:J,resolution:J})}else for(L=5E-4,J=K-1;0<=J;J--)z.unshift({level:J,scale:L,resolution:L}),L*=2;return new h({dpi:96,lods:z,origin:new d(0,0,H),size:[G,G],spatialReference:H})}L=c.getInfo(H);z=z.origin?new d({x:z.origin.x,y:z.origin.y,spatialReference:H}):L?new d({x:L.origin[0],y:L.origin[1],spatialReference:H}):
new d({x:0,y:0,spatialReference:H});L=1/(39.37*w.getMetersPerUnitForSR(H)*96);J=[];if(E)for(var B=0;B<E.length;B++){var y=E[B];J.push({level:B,scale:y,resolution:y*L})}else{var I=c.isGeographic(H)?512/G*5.916575275917094E8:256/G*5.91657527591555E8;B=Math.ceil(K/A);J.push({level:0,scale:I,resolution:I*L});for(y=1;y<B;y++)I/=2**A,J.push({level:y,scale:I,resolution:I*L})}return new h({dpi:96,lods:J,origin:z,size:[G,G],spatialReference:H})};var F=u.prototype;F.readOrigin=function(z,A){return d.fromJSON({spatialReference:A.spatialReference,
...z})};F.readSize=function(z,A){return[A.cols,A.rows]};F.writeSize=function(z,A){A.cols=z[0];A.rows=z[1]};F.zoomToScale=function(z){const A=this.scales;if(0>=z)return A[0];if(z>=A.length-1)return A[A.length-1];{const E=Math.floor(z);return A[E]/(A[E]/A[E+1])**(z-E)}};F.scaleToZoom=function(z){const A=this.scales,E=A.length-1;let G=0;for(;G<E;G++){const H=A[G],K=A[G+1];if(H<=z)break;if(K===z)return G+1;if(H>z&&K<z)return G+Math.log(H/z)/Math.log(H/K)}return G};F.snapScale=function(z,A=.95){z=this.scaleToZoom(z);
return z%Math.floor(z)>=A?this.zoomToScale(Math.ceil(z)):this.zoomToScale(Math.floor(z))};F.tileAt=function(z,A,E,G){var H=this.lodAt(z);if(!H)return null;let K;if("number"===typeof A)K=A,A=E;else{if(c.equals(A.spatialReference,this.spatialReference))K=A.x,A=A.y;else{G=f.project(A,this.spatialReference);if(x.isNone(G))return null;K=G.x;A=G.y}G=E}E=H.resolution*this.size[0];H=H.resolution*this.size[1];G||(G={id:null,level:0,row:0,col:0,extent:a.create()});G.level=z;G.row=Math.floor((this.origin.y-
A)/H+.001);G.col=Math.floor((K-this.origin.x)/E+.001);this.updateTileInfo(G);return G};F.updateTileInfo=function(z,A=0){var E=this.lodAt(z.level);E||1!==A||(A=this.lods[this.lods.length-1],A.level<z.level&&(E=A));if(E){var G=z.level-E.level;A=E.resolution*this.size[0]/2**G;E=E.resolution*this.size[1]/2**G;z.id=`${z.level}/${z.row}/${z.col}`;z.extent||(z.extent=a.create());z.extent[0]=this.origin.x+z.col*A;z.extent[1]=this.origin.y-(z.row+1)*E;z.extent[2]=z.extent[0]+A;z.extent[3]=z.extent[1]+E}};
F.upsampleTile=function(z){const A=this._upsampleLevels[z.level];if(!A||-1===A.parentLevel)return!1;z.level=A.parentLevel;z.row=Math.floor(z.row/A.factor+.001);z.col=Math.floor(z.col/A.factor+.001);this.updateTileInfo(z);return!0};F.getTileBounds=function(z,A){var {resolution:E}=this.lodAt(A.level);const G=E*this.size[0];E*=this.size[1];z[0]=this.origin.x+A.col*G;z[1]=this.origin.y-(A.row+1)*E;z[2]=z[0]+G;z[3]=z[1]+E;return z};F.lodAt=function(z){return this._levelToLOD&&this._levelToLOD[z]||null};
F.clone=function(){return h.fromJSON(this.write({}))};F._initializeUpsampleLevels=function(){const z=this.lods;this._upsampleLevels=[];let A=null;for(let E=0;E<z.length;E++){const G=z[E];this._upsampleLevels[G.level]={parentLevel:A?A.level:-1,factor:A?A.resolution/G.resolution:0};A=G}};r._createClass(u,[{key:"isWrappable",get:function(){const {spatialReference:z,origin:A}=this;if(z&&A){const E=c.getInfo(z);return z.isWrappable&&Math.abs(E.origin[0]-A.x)<=E.dx}return!1}},{key:"lods",set:function(z){let A=
0,E=0;const G=[];this._levelToLOD={};z&&(A=-Infinity,E=Infinity,z.forEach(H=>{G.push(H.scale);A=H.scale>A?H.scale:A;E=H.scale<E?H.scale:E;this._levelToLOD[H.level]=H}));this._set("scales",G);this._set("minScale",A);this._set("maxScale",E);this._set("lods",z);this._initializeUpsampleLevels()}}]);return u}(D.JSONSupport);t.__decorate([q.property({type:Number,json:{write:!0}})],D.prototype,"compressionQuality",void 0);t.__decorate([q.property({type:Number,json:{write:!0}})],D.prototype,"dpi",void 0);
t.__decorate([q.property({type:String,json:{read:C.read,write:C.write,origins:{"web-scene":{read:!1,write:!1}}}})],D.prototype,"format",void 0);t.__decorate([q.property({readOnly:!0})],D.prototype,"isWrappable",null);t.__decorate([q.property({type:d,json:{write:!0}})],D.prototype,"origin",void 0);t.__decorate([l.reader("origin")],D.prototype,"readOrigin",null);t.__decorate([q.property({type:[m],value:null,json:{write:!0}})],D.prototype,"lods",null);t.__decorate([q.property({readOnly:!0})],D.prototype,
"minScale",void 0);t.__decorate([q.property({readOnly:!0})],D.prototype,"maxScale",void 0);t.__decorate([q.property({readOnly:!0})],D.prototype,"scales",void 0);t.__decorate([q.property({cast:v=>Array.isArray(v)?v:"number"===typeof v?[v,v]:[256,256]})],D.prototype,"size",void 0);t.__decorate([l.reader("size",["rows","cols"])],D.prototype,"readSize",null);t.__decorate([n.writer("size",{cols:{type:e.Integer},rows:{type:e.Integer}})],D.prototype,"writeSize",null);t.__decorate([q.property({type:b,json:{write:!0}})],
D.prototype,"spatialReference",void 0);return D=h=t.__decorate([k.subclass("esri.layers.support.TileInfo")],D)})},"esri/core/unitUtils":function(){define("exports ./has ./jsonMap ./maybe ../geometry/projectionEllipsoid ../geometry/SpatialReference ../geometry/support/Ellipsoid ../geometry/support/spatialReferenceUtils ../geometry/support/WKIDUnitConversion".split(" "),function(r,t,C,D,x,w,q,p,g){function e(y){if(y=L[y])return y;throw Error("unknown measure");}function l(y){return K[y].baseUnit}function k(y,
I=null){I=I||e(y);return K[I].baseUnit===y}function n(y,I,S){if(I===S)return y;const O=e(I);if(O!==e(S))throw Error("incompatible units");y=k(I,O)?y:y*K[O].units[I].inBaseUnits;return k(S,O)?y:y/K[O].units[S].inBaseUnits}function d(y,I){return 3E3>n(y,I,"meters")?"meters":"kilometers"}function b(y,I){return 1E5>n(y,I,"meters")?"meters":"kilometers"}function a(y,I){return 1E3>n(y,I,"feet")?"feet":"miles"}function c(y,I){return 1E5>n(y,I,"feet")?"feet":"miles"}function f(y){return H.fromJSON(y.toLowerCase())||
null}function m(y,I=q.earth.metersPerDegree){return h(y,!0)||I}function h(y,I=!1){let S,O,Y=null;null!=y&&("object"===typeof y?(S=y.wkid,O=y.wkt):"number"===typeof y?S=y:"string"===typeof y&&(O=y));if(S){if(p.isWKIDFromMars(S))return q.mars.metersPerDegree;if(p.isWKIDFromMoon(S))return q.moon.metersPerDegree;Y=A.values[A[S]];!Y&&I&&G.has(S)&&(Y=F)}else O&&(/^PROJCS/i.test(O)?Y=v(z.exec(O),Y):/^GEOCCS/i.test(O)&&(Y=v(E.exec(O),Y)));return Y}function v(y,I){return y&&y[1]?parseFloat(y[1].split(",")[1]):
I}function u(y){var I=null;if(null!=y)if("object"===typeof y){var S=y.wkid;var O=y.wkt}else"number"===typeof y?S=y:"string"===typeof y&&(O=y);if(S)I=A.units[A[S]];else if(O&&(y=/^PROJCS/i.test(O)?z:/^GEOCCS/i.test(O)?E:null)&&(O=y.exec(O))&&O[1]&&(O=O[1],I=(I=/[\\"\\']{1}([^\\"\\']+)/.exec(O))&&I[1],!I||-1===A.units.indexOf(I)))for(O=parseFloat(O.split(",")[1]),I=null,y=A.values,S=0;S<y.length;++S)if(1E-7>Math.abs(O-y[S])){I=A.units[S];break}return D.isSome(I)?f(I):null}const F=q.earth.radius*Math.PI/
200,z=/UNIT\[([^\]]+)\]\]$/i,A=g,E=/UNIT\[([^\]]+)\]/i,G=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),H=C.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",
"50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});t={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};g={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*
.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:(y=>y*y)(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};const K={length:{baseUnit:"meters",units:t},area:{baseUnit:"square-meters",units:g},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},
"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},L=function(){const y={};for(const I in K)for(const S in K[I].units)y[S]=
I;return y}(),J={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},B={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",
esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"};t=C.strict()(J);g=C.strict()(B);C=C.strict()({...J,...B});r.areaUnitsJSONMap=t;r.baseUnitForMeasure=l;r.baseUnitForUnit=function(y){return l(e(y))};r.convertUnit=n;r.getDefaultUnitSystem=function(y){if(!y)return null;switch(u(y)){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric"}return null};r.getMetersPerUnit=h;r.getMetersPerUnitForSR=m;r.getMetersPerVerticalUnitForSR=function(y){if(y&&"object"===typeof y&&!p.isEarth(y))return 1;y=m(y);return 1E5<y?1:y};r.getUnitString=u;r.getVerticalUnitStringForSR=function(y){const I=m(y),S=y instanceof w?x.getReferenceEllipsoid(y).metersPerDegree:1E5;return I>=S?"meters":u(y)};r.inchesPerMeter=39.37;r.isBaseUnit=k;r.isMeasurementSystem=function(y){return"imperial"===
y||"metric"===y};r.lengthToDegrees=function(y,I,S){return n(y,I,"meters")/(S*Math.PI/180)};r.lengthUnitsJSONMap=g;r.measureForUnit=e;r.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");r.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");r.preferredImperialAreaUnit=function(y,I){return 1E6>n(y,I,"square-feet")?"square-feet":
"square-miles"};r.preferredImperialLengthUnit=a;r.preferredImperialVerticalLengthUnit=c;r.preferredLengthUnit=function(y,I,S){switch(S){case "metric":return d(y,I);case "imperial":return a(y,I);default:return S}};r.preferredMetricAreaUnit=function(y,I){return 3E6>n(y,I,"square-meters")?"square-meters":"square-kilometers"};r.preferredMetricLengthUnit=d;r.preferredMetricVerticalLengthUnit=b;r.preferredVerticalLengthUnit=function(y,I,S){switch(S){case "metric":return b(y,I);case "imperial":return c(y,
I);default:return S}};r.unitFromRESTJSON=f;r.unitToRESTJSON=function(y){return H.toJSON(y)||null};r.unitsJSONMap=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/projectionEllipsoid":function(){define(["exports","./SpatialReference","./support/Ellipsoid","./support/spatialReferenceUtils"],function(r,t,C,D){function x(e){return new t({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${e.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}
const w=x(C.earth),q=x(C.mars),p=x(C.moon),g=new t({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${C.earth.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});r.SphericalECEFSpatialReference=w;r.SphericalPCPFMars=
q;r.SphericalPCPFMoon=p;r.WGS84ECEFSpatialReference=g;r.createSphericalPCPF=x;r.getReferenceEllipsoid=function(e){return e&&(D.isMars(e)||e===q)?C.mars:e&&(D.isMoon(e)||e===p)?C.moon:C.earth};r.getReferenceEllipsoidFromWKID=function(e){return D.isWKIDFromMars(e)?C.mars:D.isWKIDFromMoon(e)?C.moon:C.earth};r.getSphericalPCPF=function(e){return e&&(D.isMars(e)||e===q)?q:e&&(D.isMoon(e)||e===p)?p:w};r.getSphericalPCPFForEllipsoid=function(e){return e&&e===C.mars?q:e&&e===C.moon?p:w};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/mathUtils","../../core/maybe","../Extent"],function(r,t,C,D,x){function w(d=n){return[d[0],d[1],d[2],d[3]]}function q(d,b){d!==b&&(d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3]);return d}function p(d){return D.isNone(d)||d[0]>=d[2]?0:d[2]-d[0]}function g(d){return d[1]>=d[3]?0:d[3]-d[1]}function e(d,b,a){return b>=d[0]&&a>=d[1]&&b<=d[2]&&a<=d[3]}function l(d){return null!=d&&4===
d.length}const k=[Infinity,Infinity,-Infinity,-Infinity],n=[0,0,0,0];r.NEGATIVE_INFINITY=k;r.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];r.UNIT=[0,0,1,1];r.ZERO=n;r.allFinite=function(d){for(let b=0;4>b;b++)if(!isFinite(d[b]))return!1;return!0};r.area=function(d){return p(d)*g(d)};r.center=function(d,b=[0,0]){b[0]=(d[0]+d[2])/2;b[1]=(d[1]+d[3])/2;return b};r.clone=function(d){return[d[0],d[1],d[2],d[3]]};r.contains=function(d,b){return b[0]>=d[0]&&b[2]<=d[2]&&b[1]>=d[1]&&b[3]<=d[3]};
r.containsPoint=function(d,b){return e(d,b[0],b[1])};r.containsPointObject=function(d,b){return e(d,b.x,b.y)};r.containsPointWithMargin=function(d,b,a){return b[0]>=d[0]-a&&b[1]>=d[1]-a&&b[0]<=d[2]+a&&b[1]<=d[3]+a};r.containsXY=e;r.copy=q;r.create=w;r.distance=function(d,b){const a=(d[1]+d[3])/2,c=Math.max(Math.abs(b[0]-(d[0]+d[2])/2)-p(d)/2,0);d=Math.max(Math.abs(b[1]-a)-g(d)/2,0);return Math.sqrt(c*c+d*d)};r.empty=function(d){return d?q(d,k):w(k)};r.equals=function(d,b){return l(d)&&l(b)?d[0]===
b[0]&&d[1]===b[1]&&d[2]===b[2]&&d[3]===b[3]:d===b};r.expand=function(d,b,a){if(D.isNone(b))q(a,d);else if("length"in b)if(l(b))a[0]=Math.min(d[0],b[0]),a[1]=Math.min(d[1],b[1]),a[2]=Math.max(d[2],b[2]),a[3]=Math.max(d[3],b[3]);else{if(2===b.length||3===b.length)a[0]=Math.min(d[0],b[0]),a[1]=Math.min(d[1],b[1]),a[2]=Math.max(d[2],b[0]),a[3]=Math.max(d[3],b[1])}else switch(b.type){case "extent":a[0]=Math.min(d[0],b.xmin);a[1]=Math.min(d[1],b.ymin);a[2]=Math.max(d[2],b.xmax);a[3]=Math.max(d[3],b.ymax);
break;case "point":a[0]=Math.min(d[0],b.x),a[1]=Math.min(d[1],b.y),a[2]=Math.max(d[2],b.x),a[3]=Math.max(d[3],b.y)}};r.expandPointInPlace=function(d,b){b[0]<d[0]&&(d[0]=b[0]);b[0]>d[2]&&(d[2]=b[0]);b[1]<d[1]&&(d[1]=b[1]);b[1]>d[3]&&(d[3]=b[1])};r.expandWithNestedArray=function(d,b,a=d){const c=b.length;let f=d[0],m=d[1],h=d[2];d=d[3];for(let v=0;v<c;v++){const u=b[v];f=Math.min(f,u[0]);m=Math.min(m,u[1]);h=Math.max(h,u[0]);d=Math.max(d,u[1])}a[0]=f;a[1]=m;a[2]=h;a[3]=d;return a};r.fromExtent=function(d,
b=w()){b[0]=d.xmin;b[1]=d.ymin;b[2]=d.xmax;b[3]=d.ymax;return b};r.fromValues=function(d,b,a,c,f=w()){f[0]=d;f[1]=b;f[2]=a;f[3]=c;return f};r.height=g;r.intersection=function(d,b,a){if(D.isNone(b))return q(a,d);const c=b[0],f=b[1],m=b[2];b=b[3];a[0]=C.clamp(d[0],c,m);a[1]=C.clamp(d[1],f,b);a[2]=C.clamp(d[2],c,m);a[3]=C.clamp(d[3],f,b);return a};r.intersects=function(d,b){return Math.max(b[0],d[0])<=Math.min(b[2],d[2])&&Math.max(b[1],d[1])<=Math.min(b[3],d[3])};r.intersectsSphere=function(d,b){const a=
b[3];var c=Math.abs(b[0]-.5*(d[0]+d[2]));const f=.5*(d[2]-d[0]);if(c>a+f)return!1;var m=.5*(d[3]-d[1]);d=Math.abs(b[1]-.5*(d[1]+d[3]));if(d>a+m)return!1;if(c<f||d<m)return!0;c-=f;m=d-m;return c*c+m*m<=a*a};r.is=l;r.isPoint=function(d){return(0===p(d)||!isFinite(d[0]))&&(0===g(d)||!isFinite(d[1]))};r.offset=function(d,b,a,c=d){c[0]=d[0]+b;c[1]=d[1]+a;c[2]=d[2]+b;c[3]=d[3]+a;return c};r.pad=function(d,b,a=d){a[0]=d[0]-b;a[1]=d[1]-b;a[2]=d[2]+b;a[3]=d[3]+b;return a};r.setMax=function(d,b,a=d){a[2]=b[0];
a[3]=b[1];a!==d&&(a[0]=d[0],a[1]=d[1]);return d};r.setMin=function(d,b,a=d){a[0]=b[0];a[1]=b[1];a!==d&&(a[2]=d[2],a[3]=d[3]);return a};r.size=function(d,b){b[0]=d[2]-d[0];b[1]=d[3]-d[1]};r.toExtent=function(d,b){return new x({xmin:d[0],ymin:d[1],xmax:d[2],ymax:d[3],spatialReference:b})};r.width=p;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p){var g;C=g=function(e){function l(k){k=e.call(this,k)||this;k.cols=null;k.level=0;k.levelValue=null;k.origin=null;k.resolution=0;k.rows=null;k.scale=0;return k}r._inheritsLoose(l,e);l.prototype.clone=function(){return new g({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return l}(C.JSONSupport);t.__decorate([D.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,
write:!1}}}})],C.prototype,"cols",void 0);t.__decorate([D.property({type:q.Integer,json:{write:!0}})],C.prototype,"level",void 0);t.__decorate([D.property({type:String,json:{write:!0}})],C.prototype,"levelValue",void 0);t.__decorate([D.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],C.prototype,"origin",void 0);t.__decorate([D.property({type:Number,json:{write:!0}})],C.prototype,"resolution",void 0);t.__decorate([D.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],C.prototype,"rows",void 0);t.__decorate([D.property({type:Number,json:{write:!0}})],C.prototype,"scale",void 0);return C=g=t.__decorate([p.subclass("esri.layers.support.LOD")],C)})},"esri/views/2d/layers/features/processors":function(){define(["require","exports"],function(r,t){t.loadProcessorModule=function(C){return"heatmap"===C?new Promise((D,x)=>r(["./processors/HeatmapProcessor"],w=>D(Object.freeze({__proto__:null,
default:w})),x)):new Promise((D,x)=>r(["./processors/SymbolProcessor"],w=>D(Object.freeze({__proto__:null,default:w})),x))};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/views/2d/layers/features/controllers/FeatureController2D":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../../../engine/webgl/DisplayId ../FeatureStore2D ../sources/createSource ../support/AttributeStore ../support/ClusterStore ../support/ComputedAttributeStorage ../support/FeatureSetReaderJSON ../support/UpdateToken ../../../../support/QueueProcessor".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h,v,u,F){function z(E){if(!w.isAbortError(E)&&"worker:port-closed"!==E.name)throw E;}function A(E){return"feature"===E.type&&"snapshot"===E.mode}C=function(E){function G(){var K=E.apply(this,arguments)||this;K._storage=new h.ComputedAttributeStorage;K._markedIdsBufId=K._storage.createBitset();K._lastCleanup=performance.now();K._cleanupNeeded=!1;K._invalidated=!1;K._tileToResolver=new Map;K._didEdit=!1;K.tileStore=null;K.config=null;K.processor=null;K.remoteClient=
null;K.service=null;return K}r._inheritsLoose(G,E);var H=G.prototype;H.initialize=function(){this._initAttributeStore();this._initStores();this._initQueryEngine();this._initSource();this._updateQueue=new F.QueueProcessor({concurrency:"geoevent"===this._source.type?1:4,process:(K,L)=>this._onTileMessage(K,{signal:L})});this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this)),this.watch("updating",K=>!K&&this.onIdle())]);this._checkUpdating=setInterval(()=>this.notifyChange("updating"),
300)};H.startup=function(){var K=r._asyncToGenerator(function*(){this._initAttributeStore()});return function(){return K.apply(this,arguments)}}();H._initSource=function(){this._source=c.createSource(this.service,this.spatialReference,this.tileStore.tileScheme,(K,L)=>{this._invalidated=!0;return this._patchTile(K,L)},()=>50>this._updateQueue.length,this.featureStore);this._proxyEvents()};H._proxyEvents=function(){if("geoevent"===this._source.type){const K=this._source.events;this.handles.add([K.on("connectionStatus",
L=>this.remoteClient.invoke("setProperty",{propertyName:"connectionStatus",value:L}).catch(z)),K.on("errorString",L=>this.remoteClient.invoke("setProperty",{propertyName:"errorString",value:L}).catch(z)),K.on("feature",L=>this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:L.attributes,centroid:L.centroid,geometry:L.geometry}}).catch(z)),K.on("updateRate",L=>this.remoteClient.invoke("emitEvent",{name:"update-rate",event:{...L}}).catch(z))])}};H._initAttributeStore=function(){this.attributeStore?
this.attributeStore.invalidateResources():this.attributeStore=new f({type:"remote",initialize:(K,L)=>w.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",K,{signal:L}).catch(z)),update:(K,L)=>w.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",K,{signal:L}).catch(z)),render:K=>w.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.requestRender",void 0,{signal:K}).catch(z))},this.config)};
H._initStores=function(){const K={geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields};this.featureStore=new a.FeatureStore2D(K,this._storage,"snapshot"===this.service.type?"snapshot":"on-demand");this.aggregateStore=new m.ClusterStore(K,this.spatialReference,this._storage);this.handles.add(this.aggregateStore.events.on("valueRangesChanged",L=>{this.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",
event:{valueRanges:L.valueRanges}}).catch(z)}))};H._initQueryEngine=function(){var K;const L=this;null==(K=this.queryEngine)?void 0:K.destroy();this.queryEngine=new n.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:this.featureStore,aggregateAdapter:{getFeatureObjectIds(J){return L.aggregateStore.getFeatureDisplayIdsForAggregate(J).map(B=>
L.getObjectId(B))}},timeInfo:this.service.timeInfo})};H.destroy=function(){this._updateQueue.destroy();this._source.destroy();this.queryEngine.destroy();this.attributeStore&&this.attributeStore.destroy();for(const K of this.tileStore.tiles)this._source.unsubscribe(K);clearInterval(this._checkUpdating)};H.isUpdating=function(){return this._source.updating||!!this._updateQueue.length};H.enableEvent=function(K){this._source.enableEvent(K.name,K.value)};H.pause=function(){this._updateQueue.pause();this._updateQueue.clear()};
H.update=function(){var K=r._asyncToGenerator(function*(L,J){this._set("config",J);this._schema=J.schema;this._initQueryEngine();yield Promise.all([this._source.update(L,J.schema.source),this.featureStore.updateSchema(L,J.schema.targets.feature),this.attributeStore.update(L,J),this.attributeStore.updateFilters(L,this)]);yield this.aggregateStore.updateSchema(L,J.schema.targets.aggregate);D("esri-2d-update-debug")&&L.describe()});return function(L,J){return K.apply(this,arguments)}}();H.applyUpdate=
function(){var K=r._asyncToGenerator(function*(L){L.mesh&&this.clearTiles();this._updateQueue.resume();yield this._source.applyUpdate(L);this.notifyChange("updating");yield q.whenFalseOnce(this,"updating",!0);this.hasAggregates&&(yield w.after(10),yield q.whenFalseOnce(this,"updating",!0))});return function(L){return K.apply(this,arguments)}}();H.onEdits=function(){var K=r._asyncToGenerator(function*({edits:L}){D("esri-2d-update-debug")&&console.debug("Applying Edit:",L);this._didEdit=!0;try{const J=
L.removed.map(y=>y.objectId&&-1!==y.objectId?y.objectId:this._lookupObjectIdByGlobalId(y.globalId)),B=L.addOrModified.map(({objectId:y})=>y);this.featureStore.invalidate();yield this._source.edit(B,J);this.clearTiles();this.notifyChange("updating");this.aggregateStore.clear();yield this._source.resend();yield q.whenFalseOnce(this,"updating",!0)}catch(J){}});return function(L){return K.apply(this,arguments)}}();H.refresh=function(){var K=r._asyncToGenerator(function*(L){if(!L)return L=u.UpdateToken.empty(),
L.storage.filters=!0,this.applyUpdate(L);this.featureStore.invalidate();this.clearTiles();this._source.refresh();this._cleanupNeeded=!0;this.notifyChange("updating");yield q.whenFalseOnce(this,"updating",!0)});return function(L){return K.apply(this,arguments)}}();H.clearTiles=function(){for(const K of this.tileStore.tiles)this.processor.onTileClear(K)};H.onTileUpdate=function(K){this.aggregateStore.onTileUpdate(K);for(const L of K.added)this._source.subscribe(L),this._level=L.level;for(const L of K.removed)this._source.unsubscribe(L),
this._cleanupNeeded=!0,this._tileToResolver.has(L.id)&&(this._tileToResolver.get(L.id).resolve(),this._tileToResolver.delete(L.id));this.notifyChange("updating")};H.onIdle=function(){this._invalidated&&((this.hasAggregates||"heatmap"===this.processor.type)&&this._repushCurrentLevelTiles(),this._invalidated=!1);this._markAndSweep()};H.querySummaryStatistics=function(){var K=r._asyncToGenerator(function*({query:L,params:J}){return this.queryEngine.executeQueryForSummaryStatistics(L,J)});return function(L){return K.apply(this,
arguments)}}();H.queryUniqueValues=function(){var K=r._asyncToGenerator(function*({query:L,params:J}){return this.queryEngine.executeQueryForUniqueValues(L,J)});return function(L){return K.apply(this,arguments)}}();H.queryClassBreaks=function(){var K=r._asyncToGenerator(function*({query:L,params:J}){return this.queryEngine.executeQueryForClassBreaks(L,J)});return function(L){return K.apply(this,arguments)}}();H.queryHistogram=function(){var K=r._asyncToGenerator(function*({query:L,params:J}){return this.queryEngine.executeQueryForHistogram(L,
J)});return function(L){return K.apply(this,arguments)}}();H.queryExtent=function(K){return this.queryEngine.executeQueryForExtent(K)};H.queryFeatures=function(K){return this.queryEngine.executeQuery(K)};H.queryVisibleFeatures=function(){var K=r._asyncToGenerator(function*(L){L=yield this.queryEngine.executeQuery(L);const J=L.objectIdFieldName;L.features=L.features.filter(B=>{B=this.getDisplayId(B.attributes[J]);return this.attributeStore.isVisible(B)});return L});return function(L){return K.apply(this,
arguments)}}();H.queryFeatureCount=function(K){return this.queryEngine.executeQueryForCount(K)};H.queryLatestObservations=function(K){return this.queryEngine.executeQueryForLatestObservations(K)};H.queryObjectIds=function(K){return this.queryEngine.executeQueryForIds(K)};H.queryStatistics=function(){var K=r._asyncToGenerator(function*(){return this.featureStore.storeStatistics});return function(){return K.apply(this,arguments)}}();H.getObjectId=function(K){return this.featureStore.lookupObjectId(K,
this._storage)};H.getDisplayId=function(K){if(this._schema.targets.aggregate){const L=this.aggregateStore.getDisplayId(K);return x.isNone(L)?(K=this.featureStore.lookupDisplayId(K),this.aggregateStore.getDisplayIdForReferenceId(K)):L}return this.featureStore.lookupDisplayId(K)};H.getFeatures=function(K){const L=[],J=[];for(const B of K)b.isAggregateId(B)?(K=this.getAggregate(B),x.isSome(K)&&(x.isSome(K.referenceId)?(K=this.getFeature(K.referenceId),x.isSome(K)&&L.push(K)):J.push(K))):(K=this.getFeature(B),
x.isSome(K)&&L.push(K));return{features:L,aggregates:J}};H.getFeature=function(K){K=this.featureStore.lookupFeatureByDisplayId(K,this._storage);if(x.isNone(K))return null;var L=K.readHydratedGeometry();L=k.convertToGeometry(L,K.geometryType,K.hasZ,K.hasM);return{attributes:K.readAttributes(),geometry:L}};H.getAggregate=function(K){return this.aggregateStore.getAggregate(K)};H.getAggregates=function(){return this.aggregateStore.getAggregates()};H.setHighlight=function(){var K=r._asyncToGenerator(function*(L){const J=
L.map(B=>this.getDisplayId(B));return this.attributeStore.setHighlight(L,J)});return function(L){return K.apply(this,arguments)}}();H._lookupObjectIdByGlobalId=function(K){const L=this.service.globalIdField;if(x.isNone(L))throw Error("Expected globalIdField to be defined");let J=null;this.featureStore.forEach(B=>{K===B.readAttribute(L)&&(J=B.getObjectId())});if(x.isNone(J))throw Error(`Expected to find a feature with globalId ${K}`);return J};H._repushCurrentLevelTiles=function(){const K=this.tileStore.tiles.filter(L=>
L.level===this._level);for(const L of K)this._patchTile({type:"append",id:L.key.id,addOrUpdate:v.FeatureSetReaderJSON.fromOptimizedFeatures([],this.service.geometryType),remove:[],end:!0,status:u.UpdateToken.empty()})};H._maybeForceCleanup=function(){5E3<performance.now()-this._lastCleanup&&this._markAndSweep()};H._patchTile=function(K,L){K=this._updateQueue.push(K,L).then(()=>{this.notifyChange("updating")}).catch(J=>{this.notifyChange("updating")});this.notifyChange("updating");return K};H._onTileMessage=
function(){var K=r._asyncToGenerator(function*(L,J){w.throwIfAborted(J);const B=this.tileStore.get(L.id);if(B){if(L.clear)return this.processor.onTileClear(B);var y=L.status;this._cleanupNeeded=!0;var I=[];for(const S of L.remove){const O=this.featureStore.lookupDisplayId(S);O&&I.push(O)}L.remove=I;try{if(x.isNone(L.addOrUpdate))this.processor.onTileMessage(B,{...L,addOrUpdate:null},this.hasAggregates,J).catch(w.throwIfNotAbortError);else{L.addOrUpdate.setArcadeSpatialReference(this.spatialReference);
this.featureStore.hasInstance(L.addOrUpdate.instance)&&y.targets.feature||(y.targets.feature=!0,this.featureStore.onTileData(B,L));y.storage.data&&y.storage.filters||(y.storage.data=!0,y.storage.filters=!0,this.attributeStore.onTileData(B,L),"geoevent"===this._source.type||this._didEdit?(yield this.attributeStore.sendUpdates(),w.throwIfAborted(J)):this.attributeStore.sendUpdates());if(this.hasAggregates&&!y.targets.aggregate){y.targets.aggregate=!0;const S=A(this._source)&&this._source.loading,O=
!A(this._source)||S||L.end;this.aggregateStore.onTileData(B,L,this._storage,this.attributeStore,O);if(!O)return;y.mesh||(this.attributeStore.onTileData(B,L),yield this.attributeStore.sendUpdates(),this.processor.onTileClear(B))}y.mesh||(y.mesh=!0,yield this.processor.onTileMessage(B,L,this.hasAggregates,J),w.throwIfAborted(J));this._maybeForceCleanup()}}catch(S){w.throwIfNotAbortError(S)}}});return function(L,J){return K.apply(this,arguments)}}();H._mark=function(K,L,J){const B=this._storage.getInstanceId(K);
K&&(L.add((4294901760&B)>>>16),J.set(K))};H._markAndSweep=function(){this._lastCleanup=performance.now();if(!("feature"===this._source.type&&"snapshot"===this._source.mode||"geoevent"!==this._source.type&&!this._cleanupNeeded)){this._cleanupNeeded=!1;var K=this._storage.getBitset(this._markedIdsBufId),L=new Set;K.clear();for(const B of this.tileStore.tiles)for(const y of this._source.readers(B.id)){const I=y.getCursor();for(;I.next();){var J=I.getDisplayId();J||(J=I.getObjectId(),J=this.featureStore.lookupDisplayId(J));
this._mark(J,L,K)}}"symbol"===this.processor.type&&this.processor.forEachBufferId(B=>{this._mark(B,L,K)});this._updateQueue.forEach(B=>{for(const y of B.remove)B=this.featureStore.lookupDisplayId(y),this._mark(B,L,K)});this.config.schema.targets.aggregate&&(this.aggregateStore.sweepFeatures(K,this.featureStore),this.aggregateStore.sweepClusters(this._storage,this.attributeStore,this._level));this.featureStore.sweepFeatures(K,this._storage,this.attributeStore);this.featureStore.sweepFeatureSets(L)}};
r._createClass(G,[{key:"fieldsIndex",get:function(){return new d(this.service.fields)}},{key:"hasAggregates",get:function(){return!!this.config.schema.targets.aggregate}},{key:"spatialReference",get:function(){return this.tileStore.tileScheme.spatialReference}},{key:"updating",get:function(){return this.isUpdating()}}]);return G}(C.HandleOwner);t.__decorate([p.property({constructOnly:!0})],C.prototype,"tileStore",void 0);t.__decorate([p.property()],C.prototype,"config",void 0);t.__decorate([p.property({readOnly:!0})],
C.prototype,"fieldsIndex",null);t.__decorate([p.property()],C.prototype,"processor",void 0);t.__decorate([p.property({constructOnly:!0})],C.prototype,"remoteClient",void 0);t.__decorate([p.property({constructOnly:!0})],C.prototype,"service",void 0);t.__decorate([p.property()],C.prototype,"spatialReference",null);t.__decorate([p.property()],C.prototype,"updating",null);return C=t.__decorate([l.subclass("esri.views.2d.layers.features.controllers.FeatureController2D")],C)})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),
function(r,t,C,D,x,w,q,p){function g(V,Z){return V?Z?4:3:Z?3:2}function e(V,Z,ca,ea){if(V){if(ca)return Z&&ea?M:ra;if(Z&&ea)return ua}else if(Z&&ea)return ra;return sa}function l({scale:V,translate:Z},ca){return Math.round((ca-Z[0])/V[0])}function k({scale:V,translate:Z},ca){return Math.round((Z[1]-ca)/V[1])}function n({scale:V,translate:Z},ca){return ca*V[0]+Z[0]}function d({scale:V,translate:Z},ca){return Z[1]-ca*V[1]}function b(V){V=V.coords;return{x:V[0],y:V[1]}}function a(V,Z){V.coords[0]=Z.x;
V.coords[1]=Z.y;return V}function c(V){V=V.coords;return{x:V[0],y:V[1],z:V[2]}}function f(V,Z){V.coords[0]=Z.x;V.coords[1]=Z.y;V.coords[2]=Z.z;return V}function m(V){V=V.coords;return{x:V[0],y:V[1],m:V[2]}}function h(V,Z){V.coords[0]=Z.x;V.coords[1]=Z.y;V.coords[2]=Z.m;return V}function v(V){V=V.coords;return{x:V[0],y:V[1],z:V[2],m:V[3]}}function u(V,Z){V.coords[0]=Z.x;V.coords[1]=Z.y;V.coords[2]=Z.z;V.coords[3]=Z.m;return V}function F(V,Z){return V&&Z?u:V?f:Z?h:a}function z(V,Z,ca,ea,ja){ca=F(ca,
ea);for(const la of Z){const {geometry:aa,attributes:da}=la;let ia;aa&&(ia=ca(new p,aa));V.push(new w.default(ia,da,null,da[ja]))}return V}function A(V,Z,ca,ea){for(const ja of Z){const {geometry:la,attributes:aa}=ja;let da;la&&(da=E(la,ca,ea));V.push({attributes:aa,geometry:da})}return V}function E(V,Z,ca){if(D.isNone(V))return null;const ea=g(Z,ca),ja=[];for(let la=0;la<V.coords.length;la+=ea){const aa=[];for(let da=0;da<ea;da++)aa.push(V.coords[la+da]);ja.push(aa)}return Z?ca?{points:ja,hasZ:Z,
hasM:ca}:{points:ja,hasZ:Z}:ca?{points:ja,hasM:ca}:{points:ja}}function G(V,Z,ca,ea,ja){ca=g(ca,ea);for(const la of Z){Z=la.geometry;ea=la.attributes;let aa;Z&&(aa=H(new p,Z,ca));V.push(new w.default(aa,ea,null,ea[ja]))}return V}function H(V,Z,ca=g(Z.hasZ,Z.hasM)){V.lengths[0]=Z.points.length;const ea=V.coords;let ja=0;for(const la of Z.points)for(Z=0;Z<ca;Z++)ea[ja++]=la[Z];return V}function K(V,Z,ca){if(!V)return null;const ea=g(Z,ca),{coords:ja,lengths:la}=V;V=[];let aa=0;for(const da of la){const ia=
[];for(let va=0;va<da;va++){const wa=[];for(let Aa=0;Aa<ea;Aa++)wa.push(ja[aa++]);ia.push(wa)}V.push(ia)}return Z?ca?{paths:V,hasZ:Z,hasM:ca}:{paths:V,hasZ:Z}:ca?{paths:V,hasM:ca}:{paths:V}}function L(V,Z,ca,ea,ja){ca=g(ca,ea);for(const la of Z){Z=la.geometry;ea=la.attributes;let aa;Z&&(aa=J(new p,Z,ca));V.push(new w.default(aa,ea,null,ea[ja]))}return V}function J(V,Z,ca=g(Z.hasZ,Z.hasM)){const {lengths:ea,coords:ja}=V;let la=0;for(const aa of Z.paths){for(const da of aa)for(Z=0;Z<ca;Z++)ja[la++]=
da[Z];ea.push(aa.length)}return V}function B(V,Z,ca){if(!V)return null;const ea=g(Z,ca),{coords:ja,lengths:la}=V;V=[];let aa=0;for(const da of la){const ia=[];for(let va=0;va<da;va++){const wa=[];for(let Aa=0;Aa<ea;Aa++)wa.push(ja[aa++]);ia.push(wa)}V.push(ia)}return Z?ca?{rings:V,hasZ:Z,hasM:ca}:{rings:V,hasZ:Z}:ca?{rings:V,hasM:ca}:{rings:V}}function y(V,Z,ca,ea,ja){for(const la of Z){Z=la.geometry;const aa=la.centroid,da=la.attributes;let ia;Z&&(ia=I(new p,Z,ca,ea));D.isSome(aa)?V.push(new w.default(ia,
da,a(new p,aa),da[ja])):V.push(new w.default(ia,da,null,da[ja]))}return V}function I(V,Z,ca=Z.hasZ,ea=Z.hasM){S(V,Z.rings,ca,ea);return V}function S(V,Z,ca,ea){ca=g(ca,ea);const {lengths:ja,coords:la}=V;ea=0;ja.length=la.length=0;for(const aa of Z){for(const da of aa)for(Z=0;Z<ca;Z++)la[ea++]=da[Z];ja.push(aa.length)}return V}function O(V,Z,ca,ea,ja,la){V.length=0;if(!ca){for(const aa of Z)V.push(new w.default(null,aa.attributes,null,aa.attributes[la]));return V}switch(ca){case "esriGeometryPoint":return z(V,
Z,ea,ja,la);case "esriGeometryMultipoint":return G(V,Z,ea,ja,la);case "esriGeometryPolyline":return L(V,Z,ea,ja,la);case "esriGeometryPolygon":return y(V,Z,ea,ja,la);default:oa.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ca}'`)),V.length=0}return V}function Y(V,Z,ca,ea){V=V&&("coords"in V?V:V.geometry);if(D.isNone(V))return null;switch(Z){case "esriGeometryPoint":return Z=b,ca&&ea?Z=v:ca?Z=c:ea&&(Z=m),Z(V);case "esriGeometryMultipoint":return E(V,ca,
ea);case "esriGeometryPolyline":return K(V,ca,ea);case "esriGeometryPolygon":return B(V,ca,ea);default:oa.error("convertToGeometry:unknown-geometry",new t(`Unable to parse unknown geometry type '${Z}'`))}}function R(V,Z,ca,ea,ja){V.length=0;if(D.isNone(ca)){for(const da of Z)V.push({attributes:da.attributes});return V}switch(ca){case "esriGeometryPoint":var la=b;ea&&ja?la=v:ea?la=c:ja&&(la=m);for(var aa of Z){const {geometry:da,attributes:ia}=aa;ea=D.isSome(da)?la(da):null;V.push({attributes:ia,geometry:ea})}break;
case "esriGeometryMultipoint":return A(V,Z,ea,ja);case "esriGeometryPolyline":for(const da of Z){const {geometry:ia,attributes:va}=da;let wa;D.isSome(ia)&&(wa=K(ia,ea,ja));V.push({attributes:va,geometry:wa})}break;case "esriGeometryPolygon":for(la of Z){const {geometry:da,attributes:ia,centroid:va}=la;let wa;D.isSome(da)&&(wa=B(da,ea,ja));va?(aa=b(va),V.push({attributes:ia,centroid:aa,geometry:wa})):V.push({attributes:ia,geometry:wa})}break;default:oa.error("convertToFeatureSet:unknown-geometry",
new t(`Unable to parse unknown geometry type '${ca}'`))}return V}function Q(V,Z,ca,ea,ja,la,aa=ca,da=ea){V.lengths.length&&(V.lengths.length=0);V.coords.length&&(V.coords.length=0);if(D.isNone(Z)||!Z.coords.length)return null;ja=pa[ja];const {coords:ia,lengths:va}=Z;Z=g(ca,ea);const wa=g(ca&&aa,ea&&da);ca=e(ca,ea,aa,da);if(!va.length)return ca(V.coords,ia,0,0,l(la,ia[0]),k(la,ia[1])),V.lengths.length&&(V.lengths.length=0),V.coords.length=Z,V;let Aa,Ba=0,Da,Ka=0;for(const Fa of va){if(Fa<ja)continue;
let Ga=0;Da=Ka;da=ea=l(la,ia[Ba]);Aa=aa=k(la,ia[Ba+1]);ca(V.coords,ia,Da,Ba,da,Aa);Ga++;Ba+=Z;Da+=wa;for(let Ia=1;Ia<Fa;Ia++,Ba+=Z)if(da=l(la,ia[Ba]),Aa=k(la,ia[Ba+1]),da!==ea||Aa!==aa)ca(V.coords,ia,Da,Ba,da-ea,Aa-aa),Da+=wa,Ga++,ea=da,aa=Aa;Ga>=ja&&(V.lengths.push(Ga),Ka=Da)}V.coords.length=Ka;return V.coords.length?V:null}function W(V,Z,ca,ea,ja,la,aa){let da=ea,ia=0;for(let wa=la+ca;wa<aa;wa+=ca){{var va=Z[wa];const Aa=Z[wa+1],Ba=Z[aa],Da=Z[aa+1];let Ka=Z[la],Fa=Z[la+1],Ga=Ba-Ka,Ia=Da-Fa;if(0!==
Ga||0!==Ia){const Ja=((va-Ka)*Ga+(Aa-Fa)*Ia)/(Ga*Ga+Ia*Ia);1<Ja?(Ka=Ba,Fa=Da):0<Ja&&(Ka+=Ga*Ja,Fa+=Ia*Ja)}Ga=va-Ka;Ia=Aa-Fa;va=Ga*Ga+Ia*Ia}va>da&&(ia=wa,da=va)}da>ea&&(ia-la>ca&&W(V,Z,ca,ea,ja,la,ia),ja(V,Z,V.length,ia,Z[ia],Z[ia+1]),aa-ia>ca&&W(V,Z,ca,ea,ja,ia,aa))}function P(V,Z,ca,ea,ja){const {coords:la,lengths:aa}=Z,da=ca?ea?M:ra:ea?ra:sa;ca=g(ca,ea);if(!la.length)return V!==Z&&(V.lengths.length=0,V.coords.length=0),V;if(!aa.length)return da(V.coords,la,0,0,n(ja,la[0]),d(ja,la[1])),V!==Z&&(V.lengths.length=
0,V.coords.length=ca),V;const [ia,va]=ja.scale;ea=0;for(let wa=0;wa<aa.length;wa++){const Aa=aa[wa];V.lengths[wa]=Aa;let Ba=n(ja,la[ea]),Da=d(ja,la[ea+1]);da(V.coords,la,ea,ea,Ba,Da);ea+=ca;for(let Ka=1;Ka<Aa;Ka++,ea+=ca)Ba+=la[ea]*ia,Da-=la[ea+1]*va,da(V.coords,la,ea,ea,Ba,Da)}V!==Z&&(V.lengths.length=aa.length,V.coords.length=la.length);return V}function fa(V,Z,ca,ea){let ja=0,la=V[ea*Z],aa=V[ea*(Z+1)];for(let da=1;da<ca;da++){const ia=la+V[ea*(Z+da)],va=aa+V[ea*(Z+da)+1],wa=(ia-la)*(va+aa);la=
ia;aa=va;ja+=wa}return.5*ja}const oa=C.getLogger("esri.tasks.support.optimizedFeatureSet"),pa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},sa=(V,Z,ca,ea,ja,la)=>{V[ca]=ja;V[ca+1]=la},ra=(V,Z,ca,ea,ja,la)=>{V[ca]=ja;V[ca+1]=la;V[ca+2]=Z[ea+2]},ua=(V,Z,ca,ea,ja,la)=>{V[ca]=ja;V[ca+1]=la;V[ca+2]=Z[ea+3]},M=(V,Z,ca,ea,ja,la)=>{V[ca]=ja;V[ca+1]=la;V[ca+2]=Z[ea+2];V[ca+3]=Z[ea+3]},T=[],ha=[];r.convertFromFeature=function(V,Z,ca,ea,ja){T[0]=V;[V]=O(ha,T,Z,ca,
ea,ja);T.length=ha.length=0;return V};r.convertFromFeatureSet=function(V,Z){const ca=new q,{hasM:ea,hasZ:ja,features:la,objectIdFieldName:aa,spatialReference:da,geometryType:ia,exceededTransferLimit:va,transform:wa,fields:Aa}=V;Aa&&(ca.fields=Aa);ca.geometryType=ia;ca.objectIdFieldName=aa||Z;ca.spatialReference=da;if(!ca.objectIdFieldName)return oa.error(new t("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),ca;la&&O(ca.features,la,ia,ja,ea,ca.objectIdFieldName);va&&
(ca.exceededTransferLimit=va);ea&&(ca.hasM=ea);ja&&(ca.hasZ=ja);wa&&(ca.transform=wa);return ca};r.convertFromFeatures=O;r.convertFromGeometry=function(V,Z,ca){if(D.isNone(V))return null;const ea=new p;"hasZ"in V&&null==Z&&(Z=V.hasZ);"hasM"in V&&null==ca&&(ca=V.hasM);if(x.isPoint(V))return F(null!=Z?Z:null!=V.z,null!=ca?ca:null!=V.m)(ea,V);if(x.isPolygon(V))return I(ea,V,Z,ca);if(x.isPolyline(V))return J(ea,V,g(Z,ca));if(x.isMultipoint(V))return H(ea,V,g(Z,ca));oa.error("convertFromGeometry:unknown-geometry",
new t(`Unable to parse unknown geometry type '${V}'`))};r.convertFromGraphics=function(V,Z,ca,ea,ja,la){const aa=V.length;switch(ca){case "esriGeometryPoint":z(V,Z,ea,ja,la);break;case "esriGeometryMultipoint":G(V,Z,ea,ja,la);break;case "esriGeometryPolyline":L(V,Z,ea,ja,la);break;case "esriGeometryPolygon":y(V,Z,ea,ja,la);break;default:oa.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ca}'`))}for(ea=0;ea<Z.length;ea++)V[ea+aa].geometryType=ca,V[ea+aa].insertAfter=
Z[ea].insertAfter,V[ea+aa].groupId=Z[ea].groupId;return V};r.convertFromMultipoint=H;r.convertFromMultipointFeatures=G;r.convertFromNestedArray=S;r.convertFromPoint=function(V,Z,ca=F(null!=Z.z,null!=Z.m)){return ca(V,Z)};r.convertFromPointFeatures=z;r.convertFromPolygon=I;r.convertFromPolyline=J;r.convertFromPolylineFeatures=L;r.convertToFeature=function(V,Z,ca,ea){ha[0]=V;R(T,ha,Z,ca,ea);V=T[0];T.length=ha.length=0;return V};r.convertToFeatureSet=function(V){const {objectIdFieldName:Z,spatialReference:ca,
transform:ea,fields:ja,hasM:la,hasZ:aa,features:da,geometryType:ia,exceededTransferLimit:va,uniqueIdField:wa,queryGeometry:Aa,queryGeometryType:Ba}=V;V=R([],da,ia,aa,la);const Da=Y(Aa,Ba,!1,!1);V={features:V,fields:ja,geometryType:ia,objectIdFieldName:Z,spatialReference:ca,uniqueIdField:wa,queryGeometry:Da};ea&&(V.transform=ea);va&&(V.exceededTransferLimit=va);la&&(V.hasM=la);aa&&(V.hasZ=aa);return V};r.convertToFeatures=R;r.convertToGeometry=Y;r.convertToMultipoint=E;r.convertToMultipointFeatures=
A;r.convertToPoint=function(V,Z,ca){return V?Z?ca?v(V):c(V):ca?m(V):b(V):null};r.convertToPolygon=B;r.convertToPolyline=K;r.deltaDecodeGeometry=function(V,Z){if(D.isNone(V))return null;const ca=V.clone(),ea=V.coords;V=V.lengths;let ja=0;for(let da=0;da<V.length;da++){const ia=V[da];var la=ea[Z*ja],aa=ea[Z*ja+1];for(let va=1;va<ia;va++)la+=ea[Z*(ja+va)],aa+=ea[Z*(ja+va)+1],ca.coords[Z*(ja+va)]=la,ca.coords[Z*(ja+va)+1]=aa;ja+=ia}return ca};r.deltaEncodeGeometry=function(V,Z){const ca=V.clone(),ea=
V.coords;V=V.lengths;let ja=0;for(let aa=0;aa<V.length;aa++){const da=V[aa];let ia=ea[Z*ja];var la=ea[Z*ja+1];for(let va=1;va<da;va++){const wa=ea[Z*(ja+va)],Aa=ea[Z*(ja+va)+1];la=Aa-la;ca.coords[Z*(ja+va)]=wa-ia;ca.coords[Z*(ja+va)+1]=la;ia=wa;la=Aa}ja+=da}return ca};r.generalizeOptimizedGeometry=function(V,Z,ca,ea,ja,la,aa=ca,da=ea){V.lengths.length&&(V.lengths.length=0);V.coords.length&&(V.coords.length=0);if(!Z||!Z.coords.length)return null;ja=pa[ja];const {coords:ia,lengths:va}=Z;Z=g(ca,ea);
const wa=g(ca&&aa,ea&&da);ca=e(ca,ea,aa,da);if(!va.length)return ca(V.coords,ia,0,0,ia[0],ia[1]),V.lengths.length&&(V.lengths.length=0),V.coords.length=Z,V;ea=0;la*=la;for(const Aa of va){if(Aa<ja){ea+=Aa*Z;continue}aa=V.coords.length/wa;da=ea;const Ba=ea+(Aa-1)*Z;ca(V.coords,ia,V.coords.length,da,ia[da],ia[da+1]);W(V.coords,ia,Z,la,ca,da,Ba);ca(V.coords,ia,V.coords.length,Ba,ia[Ba],ia[Ba+1]);da=V.coords.length/wa-aa;da>=ja?V.lengths.push(da):V.coords.length=aa*wa;ea+=Aa*Z}return V.coords.length?
V:null};r.getBoundsOptimizedGeometry=function(V,Z,ca,ea){if(D.isNone(Z)||!Z.coords||!Z.coords.length)return null;ca=g(ca,ea);let ja=ea=Number.POSITIVE_INFINITY,la=Number.NEGATIVE_INFINITY,aa=Number.NEGATIVE_INFINITY;if(Z&&Z.coords){Z=Z.coords;for(let da=0;da<Z.length;da+=ca){const ia=Z[da],va=Z[da+1];ea=Math.min(ea,ia);la=Math.max(la,ia);ja=Math.min(ja,va);aa=Math.max(aa,va)}}V[0]=ea;V[1]=ja;V[2]=la;V[3]=aa;return V};r.getQuantizedArea=function(V,Z){const {coords:ca,lengths:ea}=V;let ja=V=0;for(let la=
0;la<ea.length;la++)ja+=fa(ca,V,ea[la],Z),V+=la;return Math.abs(ja)};r.getQuantizedBoundsOptimizedGeometry=function(V,Z,ca,ea){ca=g(ca,ea);const {lengths:ja,coords:la}=Z;ea=Z=Number.POSITIVE_INFINITY;let aa=Number.NEGATIVE_INFINITY,da=Number.NEGATIVE_INFINITY,ia=0;for(const va of ja){let wa=la[ia],Aa=la[ia+1];Z=Math.min(wa,Z);ea=Math.min(Aa,ea);aa=Math.max(wa,aa);da=Math.max(Aa,da);ia+=ca;for(let Ba=1;Ba<va;Ba++,ia+=ca){const Da=la[ia],Ka=la[ia+1];wa+=Da;Aa+=Ka;0>Da&&(Z=Math.min(Z,wa));0<Da&&(aa=
Math.max(aa,wa));0>Ka?ea=Math.min(ea,Aa):0<Ka&&(da=Math.max(da,Aa))}}V[0]=Z;V[1]=ea;V[2]=aa;V[3]=da;return V};r.getSignedQuantizedRingArea=fa;r.quantizeOptimizedFeatureSet=function(V,Z){const {geometryType:ca,features:ea,hasM:ja,hasZ:la}=Z;if(!V)return Z;for(let aa=0;aa<ea.length;aa++){const da=ea[aa],ia=da.weakClone();ia.geometry=new p;Q(ia.geometry,da.geometry,ja,la,ca,V);da.centroid&&(ia.centroid=new p,Q(ia.centroid,da.centroid,ja,la,"esriGeometryPoint",V));ea[aa]=ia}Z.transform=V;return Z};r.quantizeOptimizedGeometry=
Q;r.quantizeX=l;r.quantizeY=k;r.removeCollinearVectices=function(V,Z,ca,ea,ja){if(!Z||!Z.coords||!Z.coords.length)return null;ca=pa[ca];const {coords:la,lengths:aa}=Z;Z=e(ea,ja,ea,ja);ea=g(ea,ja);let da=ja=0,ia=0,va=0;for(const Ba of aa){da=va;Z(V.coords,la,da,ja,la[ja],la[ja+1]);ja+=ea;var wa=la[ja];let Da=la[ja+1],Ka=wa,Fa=Da;var Aa=Da/wa;da+=ea;Z(V.coords,la,da,ja,Ka,Fa);ja+=ea;for(let Ga=2;Ga<Ba;Ga++){wa=la[ja];Da=la[ja+1];const Ia=Da/wa,Ja=Aa===Ia||!isFinite(Aa)&&!isFinite(Ia);Aa=Ja&&isFinite(Ia)?
0<=Aa&&0<=Ia||0>=Aa&&0>=Ia:0<=Fa&&0<=Da||0>=Fa&&0>=Da;Ja&&Aa?(Ka+=wa,Fa+=Da):(Ka=wa,Fa=Da,da+=ea);Z(V.coords,la,da,ja,Ka,Fa);ja+=ea;Aa=Ia}da+=ea;wa=(da-va)/ea;wa>=ca&&(V.lengths[ia]=wa,va=da,ia++)}V.coords.length>va&&(V.coords.length=va);V.lengths.length>ia&&(V.lengths.length=ia);return V.coords.length&&V.lengths.length?V:null};r.removeZMValues=function(V,Z,ca,ea,ja,la){const aa=g(ca,ea);ca=e(ca,ea,ja,la);ea=Z.coords;V.coords.length=0;V.lengths.length=0;V.lengths.push(...Z.lengths);for(Z=0;Z<ea.length;Z+=
aa)ca(V.coords,ea,V.coords.length,Z,ea[Z],ea[Z+1]);return V};r.unquantizeOptimizedFeatureSet=function(V){const {transform:Z,features:ca,hasM:ea,hasZ:ja}=V;if(!Z)return V;for(const la of ca)D.isSome(la.geometry)&&P(la.geometry,la.geometry,ea,ja,Z),la.centroid&&P(la.centroid,la.centroid,ea,ja,Z);V.transform=null;return V};r.unquantizeOptimizedGeometry=P;r.unquantizeX=n;r.unquantizeY=d;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(r,t,C){let D=function(){function w(q=null,p={},g,e){this.geometry=q;this.attributes=p;this.centroid=g;this.objectId=e;this.geohashY=this.geohashX=this.displayId=0}w.prototype.weakClone=function(){const q=new w(this.geometry,this.attributes,this.centroid,this.objectId);q.displayId=this.displayId;q.geohashX=this.geohashX;q.geohashY=this.geohashY;return q};return w}(),x=function(w){function q(){return w.apply(this,arguments)||this}
t._inheritsLoose(q,w);return q}(D);r.OptimizedFeatureWithGeometry=x;r.default=D;r.hasGeometry=function(w){return!(C.isNone(w.geometry)||!w.geometry.coords||!w.geometry.coords.length)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){return function(){function r(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=
[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}r.prototype.weakClone=function(){const t=new r;t.objectIdFieldName=this.objectIdFieldName;t.globalIdFieldName=this.globalIdFieldName;t.geohashFieldName=this.geohashFieldName;t.geometryProperties=this.geometryProperties;t.geometryType=this.geometryType;t.spatialReference=this.spatialReference;t.hasZ=this.hasZ;t.hasM=this.hasM;t.features=this.features;t.fields=this.fields;
t.transform=this.transform;t.exceededTransferLimit=this.exceededTransferLimit;t.uniqueIdField=this.uniqueIdField;t.queryGeometry=this.queryGeometry;t.queryGeometryType=this.queryGeometryType;return t};return r}()})},"esri/layers/graphics/OptimizedGeometry":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function t(D=[],x=[],w=!1){this.lengths=null!=D?D:[];this.coords=null!=x?x:[];this.hasIndeterminateRingOrder=w}var C=t.prototype;C.forEachVertex=function(D){let x=
0;this.lengths.length||D(this.coords[0],this.coords[1]);for(let w=0;w<this.lengths.length;w++){const q=this.lengths[w];for(let p=0;p<q;p++)D(this.coords[2*(p+x)],this.coords[2*(p+x)+1]);x+=q}};C.clone=function(D){return D?(D.set(this.coords),new t(this.lengths.slice(),D,this.hasIndeterminateRingOrder)):new t(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};r._createClass(t,[{key:"isPoint",get:function(){return 0===this.lengths.length}},{key:"maxLength",get:function(){return Math.max(...this.lengths)}},
{key:"size",get:function(){return this.lengths.reduce((D,x)=>D+x)}}]);return t}()})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../../support/arcadeOnDemand ../../../views/support/Scheduler".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h,v,u,F){function z(J){return J.every(B=>"exceedslimit"!==B.statisticType)}const A=new Set,E=new w.MemCacheStorage(2E6);let G=0,H=function(){function J(y){this.capabilities={query:a.queryCapabilities};this.geometryType=y.geometryType;this.hasM=y.hasM;this.hasZ=y.hasZ;this.objectIdField=y.objectIdField;this.spatialReference=y.spatialReference;this.definitionExpression=y.definitionExpression;this.featureStore=y.featureStore;this.aggregateAdapter=y.aggregateAdapter;
this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=y.timeInfo;y.cacheSpatialQueries&&(this._geometryQueryCache=new w.MemCache(G++ +"$$",E));this.fieldsIndex=new v(y.fields);y.scheduler&&y.priority&&(this._frameTask=y.scheduler.registerTask(y.priority))}var B=J.prototype;B.destroy=function(){this._frameTask=x.removeMaybe(this._frameTask);this.clearCache();x.destroyMaybe(this._geometryQueryCache);this._changeHandle=x.removeMaybe(this._changeHandle);x.destroyMaybe(this.fieldsIndex)};
B.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};B.executeQuery=function(){var y=t._asyncToGenerator(function*(I={},S){let O=D.clone(I),Y;try{O=yield this._schedule(()=>h.normalizeQuery(O,this.definitionExpression,this.spatialReference),S),O=yield this._reschedule(()=>this._checkQuerySupport(O),S),Y=yield this._reschedule(()=>this._executeGeometryQuery(O,S),S),Y=yield this._reschedule(()=>Y.executeAggregateIdsQuery(O),S),Y=yield this._reschedule(()=>
Y.executeObjectIdsQuery(O),S),Y=yield this._reschedule(()=>Y.executeTimeQuery(O),S),Y=yield this._reschedule(()=>Y.executeAttributesQuery(O),S)}catch(R){if(R!==h.QUERY_ENGINE_EMPTY_RESULT)throw R;Y=new c([],null,this)}return Y.createQueryResponse(O)});return function(){return y.apply(this,arguments)}}();B.executeQueryForCount=function(){var y=t._asyncToGenerator(function*(I={},S){let O=D.clone(I);O.returnGeometry=!1;O.returnCentroid=!1;O.outSR=null;try{O=yield this._schedule(()=>h.normalizeQuery(O,
this.definitionExpression,this.spatialReference),S);O=yield this._reschedule(()=>this._checkQuerySupport(O),S);let Y=yield this._reschedule(()=>this._executeGeometryQuery(O,S),S);Y=yield this._reschedule(()=>Y.executeAggregateIdsQuery(O),S);Y=yield this._reschedule(()=>Y.executeObjectIdsQuery(O),S);Y=yield this._reschedule(()=>Y.executeTimeQuery(O),S);Y=yield this._reschedule(()=>Y.executeAttributesQuery(O),S);return Y.createQueryResponseForCount(O)}catch(Y){if(Y!==h.QUERY_ENGINE_EMPTY_RESULT)throw Y;
return 0}});return function(){return y.apply(this,arguments)}}();B.executeQueryForExtent=function(){var y=t._asyncToGenerator(function*(I={},S){let O=D.clone(I),Y;I=O.outSR;try{O=yield this._schedule(()=>h.normalizeQuery(O,this.definitionExpression,this.spatialReference),S);O=yield this._reschedule(()=>this._checkQuerySupport(O),S);O.returnGeometry=!0;O.returnCentroid=!1;O.outSR=null;Y=yield this._reschedule(()=>this._executeGeometryQuery(O,S),S);Y=yield this._reschedule(()=>Y.executeAggregateIdsQuery(O),
S);Y=yield this._reschedule(()=>Y.executeObjectIdsQuery(O),S);Y=yield this._reschedule(()=>Y.executeTimeQuery(O),S);Y=yield this._reschedule(()=>Y.executeAttributesQuery(O),S);const R=Y.size;if(!R)return{count:R,extent:null};p.set(L,p.NEGATIVE_INFINITY);this.featureStore.forEachBounds(Y.items,P=>p.expandWithAABB(L,P),K);const Q={xmin:L[0],ymin:L[1],xmax:L[3],ymax:L[4],spatialReference:h.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(L[2])&&isFinite(L[5])&&(Q.zmin=L[2],Q.zmax=
L[5]);const W=b.project(Q,Y.spatialReference,I);W.spatialReference=h.cleanFromGeometryEngine(I||this.spatialReference);if(0===W.xmax-W.xmin){const P=q.getMetersPerUnitForSR(W.spatialReference);W.xmin-=P;W.xmax+=P}if(0===W.ymax-W.ymin){const P=q.getMetersPerUnitForSR(W.spatialReference);W.ymin-=P;W.ymax+=P}if(this.hasZ&&null!=W.zmin&&null!=W.zmax&&0===W.zmax-W.zmin){const P=q.getMetersPerUnitForSR(W.spatialReference);W.zmin-=P;W.zmax+=P}return{count:R,extent:W}}catch(R){if(R===h.QUERY_ENGINE_EMPTY_RESULT)return{count:0,
extent:null};throw R;}});return function(){return y.apply(this,arguments)}}();B.executeQueryForIds=function(){var y=t._asyncToGenerator(function*(I={},S){return this.executeQueryForIdSet(I,S).then(O=>Array.from(O))});return function(){return y.apply(this,arguments)}}();B.executeQueryForIdSet=function(){var y=t._asyncToGenerator(function*(I={},S){let O=D.clone(I),Y;O.returnGeometry=!1;O.returnCentroid=!1;O.outSR=null;try{O=yield this._schedule(()=>h.normalizeQuery(O,this.definitionExpression,this.spatialReference),
S);O=yield this._reschedule(()=>this._checkQuerySupport(O),S);Y=yield this._reschedule(()=>this._executeGeometryQuery(O,S),S);Y=yield this._reschedule(()=>Y.executeAggregateIdsQuery(O),S);Y=yield this._reschedule(()=>Y.executeObjectIdsQuery(O),S);Y=yield this._reschedule(()=>Y.executeTimeQuery(O),S);Y=yield this._reschedule(()=>Y.executeAttributesQuery(O),S);const R=Y.items,Q=new Set;yield this._reschedule(()=>{for(const W of R)Q.add(Y.featureAdapter.getObjectId(W))},S);return Q}catch(R){if(R===h.QUERY_ENGINE_EMPTY_RESULT)return new Set;
throw R;}});return function(){return y.apply(this,arguments)}}();B.executeQueryForSnapping=function(){var y=t._asyncToGenerator(function*(I,S){const {point:O,distance:Y,types:R}=I;if(0===R)return{candidates:[]};const Q=yield this._reschedule(()=>this._checkQuerySupport(I.query),S),W=!n.equals(O.spatialReference,this.spatialReference);W&&(yield b.checkProjectionSupport(O.spatialReference,this.spatialReference));var P="number"===typeof Y?Y:Y.x,fa="number"===typeof Y?Y:Y.y;P={xmin:O.x-P,xmax:O.x+P,ymin:O.y-
fa,ymax:O.y+fa,spatialReference:O.spatialReference};P=W?b.project(P,this.spatialReference):P;if(!P)return{candidates:[]};fa=(yield k.normalizeCentralMeridian(l.fromJSON(O),null,{signal:S}))[0];const oa=(yield k.normalizeCentralMeridian(l.fromJSON(P),null,{signal:S}))[0];if(x.isNone(fa)||x.isNone(oa))return{candidates:[]};let pa=new c(this._searchFeatures(this._getQueryBBoxes(oa.toJSON())),null,this);pa=yield this._reschedule(()=>pa.executeObjectIdsQuery(Q),S);pa=yield this._reschedule(()=>pa.executeTimeQuery(Q),
S);pa=yield this._reschedule(()=>pa.executeAttributesQuery(Q),S);S=fa.toJSON();S=W?b.project(S,this.spatialReference):S;return pa.createSnappingResponse({...I,point:S,distance:W?Math.max(P.xmax-P.xmin,P.ymax-P.ymin)/2:Y},O.spatialReference)});return function(I,S){return y.apply(this,arguments)}}();B.executeQueryForLatestObservations=function(){var y=t._asyncToGenerator(function*(I={},S){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new C("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",
{query:I,timeInfo:this.timeInfo});let O=D.clone(I),Y;try{O=yield this._schedule(()=>h.normalizeQuery(O,this.definitionExpression,this.spatialReference),S),O=yield this._reschedule(()=>this._checkQuerySupport(O),S),Y=yield this._reschedule(()=>this._executeGeometryQuery(O,S),S),Y=yield this._reschedule(()=>Y.executeAggregateIdsQuery(O),S),Y=yield this._reschedule(()=>Y.executeObjectIdsQuery(O),S),Y=yield this._reschedule(()=>Y.executeTimeQuery(O),S),Y=yield this._reschedule(()=>Y.executeAttributesQuery(O),
S),Y=yield this._reschedule(()=>Y.filterLatest(),S)}catch(R){if(R!==h.QUERY_ENGINE_EMPTY_RESULT)throw R;Y=new c([],null,this)}return Y.createQueryResponse(O)});return function(){return y.apply(this,arguments)}}();B.executeQueryForSummaryStatistics=function(){var y=t._asyncToGenerator(function*(I={},S,O){const {field:Y,normalizationField:R,valueExpression:Q}=S;return(yield this._getQueryEngineResultForStats(I,{field:Y,normalizationField:R,valueExpression:Q},O)).createSummaryStatisticsResponse(I,S)});
return function(){return y.apply(this,arguments)}}();B.executeQueryForUniqueValues=function(){var y=t._asyncToGenerator(function*(I={},S,O){const {field:Y,valueExpression:R}=S;return(yield this._getQueryEngineResultForStats(I,{field:Y,valueExpression:R},O)).createUniqueValuesResponse(I,S)});return function(){return y.apply(this,arguments)}}();B.executeQueryForClassBreaks=function(){var y=t._asyncToGenerator(function*(I={},S,O){const {field:Y,normalizationField:R,valueExpression:Q}=S;return(yield this._getQueryEngineResultForStats(I,
{field:Y,normalizationField:R,valueExpression:Q},O)).createClassBreaksResponse(I,S)});return function(){return y.apply(this,arguments)}}();B.executeQueryForHistogram=function(){var y=t._asyncToGenerator(function*(I={},S,O){const {field:Y,normalizationField:R,valueExpression:Q}=S;return(yield this._getQueryEngineResultForStats(I,{field:Y,normalizationField:R,valueExpression:Q},O)).createHistogramResponse(I,S)});return function(){return y.apply(this,arguments)}}();B._schedule=function(){var y=t._asyncToGenerator(function*(I,
S){return x.isSome(this._frameTask)?this._frameTask.schedule(I,S):I(F.noBudget)});return function(I,S){return y.apply(this,arguments)}}();B._reschedule=function(){var y=t._asyncToGenerator(function*(I,S){return x.isSome(this._frameTask)?this._frameTask.reschedule(I,S):I(F.noBudget)});return function(I,S){return y.apply(this,arguments)}}();B._getAll=function(){if(!this._allItems){const y=[];this.featureStore.forEach(I=>y.push(I));this._allItems=new c(y,null,this)}return this._allItems};B._executeGeometryQuery=
function(){var y=t._asyncToGenerator(function*(I,S){var O=this;const {geometry:Y,outSR:R,spatialRel:Q,returnGeometry:W,returnCentroid:P}=I,fa=W||P,oa=n.isValid(R)&&!n.equals(this.spatialReference,R),pa=this._geometryQueryCache?oa&&fa?JSON.stringify({geometry:Y,spatialRelationship:Q,outSpatialReference:R}):JSON.stringify({geometry:Y,spatialRelationship:Q}):null;if(pa){var sa=this._geometryQueryCache.get(pa);if(!x.isUndefined(sa))return sa}sa=function(){var T=t._asyncToGenerator(function*(ha){if(oa&&
fa)return ha=yield ha.project(R),pa&&O._geometryQueryCache.put(pa,ha,ha.size||1),ha;pa&&O._geometryQueryCache.put(pa,ha,ha.size||1);return ha});return function(ha){return T.apply(this,arguments)}}();if(!Y)return sa(this._getAll());const ra=this.featureAdapter;if("esriSpatialRelDisjoint"===Q){I=this._searchFeatures(this._getQueryBBoxes(Y));if(!I.length)return sa(this._getAll());let T,ha;const V=new Set;for(var ua of I)V.add(ra.getObjectId(ua));yield this._reschedule(()=>{let Z=0;T=Array(V.size);this.featureStore.forEach(ca=>
T[Z++]=ca);ha=V},S);I=yield this._reschedule(t._asyncToGenerator(function*(){const Z=yield f.getSpatialQueryOperator(Q,Y,O.geometryType,O.hasZ,O.hasM);return new c(yield O._runSpatialFilter(T,ca=>!ha.has(ra.getObjectId(ca))||Z(ra.getGeometry(ca)),S),Y,O)}),S);return sa(I)}ua=this._searchFeatures(this._getQueryBBoxes(Y));if(!ua.length)return sa=new c([],Y,this),pa&&this._geometryQueryCache.put(pa,sa,sa.size||1),sa;if(this._canExecuteSoloPass(Y,I))return sa(new c(ua,Y,this));const M=yield f.getSpatialQueryOperator(Q,
Y,this.geometryType,this.hasZ,this.hasM);I=yield this._runSpatialFilter(ua,T=>M(ra.getGeometry(T)),S);return sa(new c(I,Y,this))});return function(I,S){return y.apply(this,arguments)}}();B._runSpatialFilter=function(){var y=t._asyncToGenerator(function*(I,S,O){var Y=this;if(!S)return I;if(x.isNone(this._frameTask))return I.filter(P=>S(P));let R=0;const Q=[],W=function(){var P=t._asyncToGenerator(function*(fa){for(;R<I.length;){const oa=I[R++];S(oa)&&(Q.push(oa),fa.madeProgress());fa.done&&(yield Y._reschedule(pa=>
W(pa),O))}});return function(fa){return P.apply(this,arguments)}}();return this._reschedule(P=>W(P),O).then(()=>Q)});return function(I,S,O){return y.apply(this,arguments)}}();B._canExecuteSoloPass=function(y,I){const {geometryType:S}=this;({spatialRel:I}=I);return f.canQueryWithRBush(y)&&("esriSpatialRelEnvelopeIntersects"===I||"esriGeometryPoint"===S&&("esriSpatialRelIntersects"===I||"esriSpatialRelContains"===I||"esriSpatialRelWithin"===I))};B._getQueryBBoxes=function(y){if(f.canQueryWithRBush(y)){if(l.isExtent(y))return[g.fromValues(y.xmin,
y.ymin,y.xmax,y.ymax)];if(l.isPolygon(y))return y.rings.map(I=>g.fromValues(Math.min(I[0][0],I[2][0]),Math.min(I[0][1],I[2][1]),Math.max(I[0][0],I[2][0]),Math.max(I[0][1],I[2][1])))}return[e.getBoundsXY(g.create(),y)]};B._searchFeatures=function(y){for(const O of y)this.featureStore.forEachInBounds(O,Y=>{A.add(Y)});const I=Array(A.size);let S=0;A.forEach(O=>I[S++]=O);A.clear();return I};B._checkStatisticsSupport=function(){var y=t._asyncToGenerator(function*(I,S){if(0>I.distance||null!=I.geometryPrecision||
I.multipatchOption||I.pixelSize||I.relationParam||I.text||I.outStatistics||I.groupByFieldsForStatistics||I.having||I.orderByFields)throw new C("feature-store:unsupported-query","Unsupported query options",{query:I});return Promise.all([this._checkAttributesQuerySupport(I),this._checkStatisticsParamsSupport(S),f.checkSpatialQuerySupport(I,this.geometryType,this.spatialReference),b.checkProjectionSupport(this.spatialReference,I.outSR)]).then(()=>I)});return function(I,S){return y.apply(this,arguments)}}();
B._checkStatisticsParamsSupport=function(){var y=t._asyncToGenerator(function*(I){var S=[];I.valueExpression&&({arcadeUtils:S}=yield u.loadArcade(),S=S.extractFieldNames(I.valueExpression));I.field&&S.push(I.field);I.normalizationField&&S.push(I.normalizationField);if(!S.length)throw new C("feature-store:unsupported-query","params should have at least a field or valueExpression",{params:I});d.validateFields(this.fieldsIndex,S,"params contains missing fields")});return function(I){return y.apply(this,
arguments)}}();B._checkQuerySupport=function(){var y=t._asyncToGenerator(function*(I){if(0>I.distance||null!=I.geometryPrecision||I.multipatchOption||I.pixelSize||I.relationParam||I.text)throw new C("feature-store:unsupported-query","Unsupported query options",{query:I});return Promise.all([this._checkAttributesQuerySupport(I),this._checkStatisticsQuerySupport(I),f.checkSpatialQuerySupport(I,this.geometryType,this.spatialReference),b.checkProjectionSupport(this.spatialReference,I.outSR)]).then(()=>
I)});return function(I){return y.apply(this,arguments)}}();B._checkAttributesQuerySupport=function(y){const {outFields:I,orderByFields:S,returnDistinctValues:O,outStatistics:Y}=y,R=Y?Y.map(Q=>Q.outStatisticFieldName&&Q.outStatisticFieldName.toLowerCase()):[];if(S&&0<S.length){const Q=S.map(W=>{const P=W.toLowerCase();return-1<P.indexOf(" asc")?P.split(" asc")[0]:-1<P.indexOf(" desc")?P.split(" desc")[0]:W}).filter(W=>-1===R.indexOf(W));d.validateFields(this.fieldsIndex,Q,"orderByFields contains missing fields")}if(I&&
0<I.length)d.validateFields(this.fieldsIndex,I,"outFields contains missing fields");else if(O)throw new C("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:y});d.validateWhere(this.fieldsIndex,y.where)};B._checkStatisticsQuerySupport=function(){var y=t._asyncToGenerator(function*(I){const {outStatistics:S,groupByFieldsForStatistics:O,having:Y}=I;var R=O&&O.length,Q=S&&S.length;if(Y){if(!R||!Q)throw new C("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",
{query:I});d.validateHaving(this.fieldsIndex,Y,S)}if(Q&&z(S)){Q=S.map(W=>W.onStatisticField);d.validateFields(this.fieldsIndex,Q,"onStatisticFields contains missing fields");R&&d.validateFields(this.fieldsIndex,O,"groupByFieldsForStatistics contains missing fields");for(const W of S){const {onStatisticField:P,statisticType:fa}=W;if(("percentile_disc"===fa||"percentile_cont"===fa)&&"statisticParameters"in W){if({statisticParameters:R}=W,!R)throw new C("feature-store:unsupported-query","statisticParamters should be set for percentile type",
{definition:W,query:I});}else if("count"!==fa&&P&&d.hasInvalidFieldType(P,this.fieldsIndex))throw new C("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:W,query:I});}}});return function(I){return y.apply(this,arguments)}}();B._getQueryEngineResultForStats=function(){var y=t._asyncToGenerator(function*(I={},S,O){I=D.clone(I);let Y;try{I=yield this._schedule(()=>h.normalizeQuery(I,this.definitionExpression,this.spatialReference),O),I=yield this._reschedule(()=>
this._checkStatisticsSupport(I,S),O),Y=yield this._reschedule(()=>this._executeGeometryQuery(I,O),O),Y=yield this._reschedule(()=>Y.executeAggregateIdsQuery(I),O),Y=yield this._reschedule(()=>Y.executeObjectIdsQuery(I),O),Y=yield this._reschedule(()=>Y.executeTimeQuery(I),O),Y=yield this._reschedule(()=>Y.executeAttributesQuery(I),O)}catch(R){if(R!==h.QUERY_ENGINE_EMPTY_RESULT)throw R;Y=new c([],null,this)}return Y});return function(){return y.apply(this,arguments)}}();t._createClass(J,[{key:"featureAdapter",
get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){const y=this.featureStore.fullBounds;return y?{xmin:y[0],ymin:y[1],xmax:y[2],ymax:y[3],spatialReference:h.cleanFromGeometryEngine(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=m.getTimeExtent(this.timeInfo,this.featureStore):null}}]);return J}();const K=p.create(),L=p.create();r.Feature=function(J,B=null,y,I,S){this.attributes=
J;this.geometry=y;this.centroid=I;this.filterFlags=S;this.groupId=-1;this.displayId=B};r.default=H;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/MemCache":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./maybe","./PooledArray"],function(r,t,C,D){let x=function(){function q(g,e,l){this._namespace=g;this._storage=e;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";l&&(this._storage.registerRemoveFunc(this._namespace,l),
this._removeFunc=!0)}var p=q.prototype;p.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this);this._storage=null};p.resetHitRate=function(){this._hit=this._miss=0};p.put=function(g,e,l,k=0){this._storage.put(this._namespace+g,e,l,k)};p.get=function(g){g=this._storage.get(this._namespace+g);void 0===g?++this._miss:++this._hit;return g};p.pop=function(g){g=this._storage.pop(this._namespace+g);void 0===
g?++this._miss:++this._hit;return g};p.updateSize=function(g,e,l){this._storage.updateSize(this._namespace+g,e,l)};p.clear=function(){this._storage.clear(this._namespace)};p.clearAll=function(){this._storage.clearAll()};p.getStats=function(){return this._storage.getStats()};p.resetStats=function(){this._storage.resetStats()};t._createClass(q,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},
{key:"maxSize",get:function(){return this._storage.maxSize}}]);return q}(),w=function(){function q(g=10485760){this._maxSize=g;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new D;this._users=new D}var p=q.prototype;p.destroy=function(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null};p.register=function(g){this._users.push(g)};p.deregister=function(g){this._users.removeUnordered(g)};p.registerRemoveFunc=function(g,e){this._removeFuncs.push([g,e])};
p.deregisterRemoveFunc=function(g){this._removeFuncs.filterInPlace(e=>e[0]!==g)};p.put=function(g,e,l,k){const n=this._db.get(g);n&&(this._size-=n.size,this._db.delete(g),n.entry!==e&&this._notifyRemove(g,n.entry,0));l>this._maxSize?this._notifyRemove(g,e,0):void 0===e?console.warn("Refusing to cache undefined entry "):!l||0>l?console.warn("Refusing to cache entry with invalid size "+l):(k=1+Math.max(k,-3)- -3,this._db.set(g,{entry:e,size:l,lifetime:k,lives:k}),this._size+=l,this._checkSizeLimit())};
p.updateSize=function(g,e,l){const k=this._db.get(g);if(k&&k.entry===e){for(this._size-=k.size;l>this._maxSize;)if(l=this._notifyRemove(g,e,1),!(C.isSome(l)&&0<l)){this._db.delete(g);return}k.size=l;this._size+=l;this._checkSizeLimit()}};p.pop=function(g){const e=this._db.get(g);if(e)return this._size-=e.size,this._db.delete(g),++this._hit,e.entry;++this._miss};p.get=function(g){const e=this._db.get(g);if(void 0===e)++this._miss;else return this._db.delete(g),e.lives=e.lifetime,this._db.set(g,e),
++this._hit,e.entry};p.getStats=function(){const g={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},l=[];this._db.forEach((d,b)=>{const a=d.lifetime;l[a]=(l[a]||0)+d.size;this._users.forAll(c=>{c=c.namespace;b.startsWith(c)&&(e[c]=(e[c]||0)+d.size)})});const k={};this._users.forAll(d=>{const b=d.namespace;!isNaN(d.hitRate)&&0<d.hitRate?(e[b]=e[b]||0,k[b]=Math.round(100*d.hitRate)+
"%"):k[b]="0%"});var n=Object.keys(e);n.sort((d,b)=>e[b]-e[d]);n.forEach(d=>g[d]=Math.round(e[d]/2**20)+"MB / "+k[d]);for(n=l.length-1;0<=n;--n){const d=l[n];d&&(g["Priority "+(n+-3-1)]=Math.round(d/this.size*100)+"%")}return g};p.resetStats=function(){this._hit=this._miss=0;this._users.forAll(g=>g.resetHitRate())};p.clear=function(g){this._db.forEach((e,l)=>{l.startsWith(g)&&(this._size-=e.size,this._db.delete(l),this._notifyRemove(l,e.entry,0))})};p.clearAll=function(){this._db.forEach((g,e)=>this._notifyRemove(e,
g.entry,0));this._size=0;this._db.clear()};p._getHitRate=function(){return this._hit/(this._hit+this._miss)};p._notifyRemove=function(g,e,l){let k;this._removeFuncs.some(n=>g.startsWith(n[0])?(n=n[1](e,l),"number"===typeof n&&(k=n),!0):!1);return k};p._checkSizeLimit=function(){if(!(this._size<=this._maxSize))for(const [g,e]of this._db){this._db.delete(g);if(1>=e.lives){this._size-=e.size;const l=this._notifyRemove(g,e.entry,1);C.isSome(l)&&0<l&&(this._size+=l,e.lives=e.lifetime,e.size=l,this._db.set(g,
e))}else--e.lives,this._db.set(g,e);if(this._size<=.9*this.maxSize)break}};t._createClass(q,[{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(g){this._maxSize=Math.max(g,0);this._checkSizeLimit()}}]);return q}();r.MIN_PRIORITY=-3;r.MemCache=x;r.MemCacheStorage=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../../core/maybe","../Extent","./aaBoundingRect"],function(r,
t,C,D){function x(a=d){return[a[0],a[1],a[2],a[3],a[4],a[5]]}function w(a,c,f,m,h,v,u=x()){u[0]=a;u[1]=c;u[2]=f;u[3]=m;u[4]=h;u[5]=v;return u}function q(a){return a[0]>=a[3]?0:a[3]-a[0]}function p(a){return a[1]>=a[4]?0:a[4]-a[1]}function g(a){return a[2]>=a[5]?0:a[5]-a[2]}function e(a,c){return Math.max(c[0],a[0])<=Math.min(c[3],a[3])&&Math.max(c[1],a[1])<=Math.min(c[4],a[4])&&Math.max(c[2],a[2])<=Math.min(c[5],a[5])}function l(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];return a}
function k(a){return 6===a.length}const n=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],d=[0,0,0,0,0,0],b=x();r.NEGATIVE_INFINITY=n;r.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];r.ZERO=d;r.allFinite=function(a){for(let c=0;6>c;c++)if(!isFinite(a[c]))return!1;return!0};r.center=function(a,c=[0,0,0]){c[0]=a[0]+q(a)/2;c[1]=a[1]+p(a)/2;c[2]=a[2]+g(a)/2;return c};r.contains=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[2]>=a[2]&&c[3]<=a[3]&&c[4]<=a[4]&&c[5]<=
a[5]};r.containsPoint=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[2]>=a[2]&&c[0]<=a[3]&&c[1]<=a[4]&&c[2]<=a[5]};r.containsPointWithMargin=function(a,c,f){return c[0]>=a[0]-f&&c[1]>=a[1]-f&&c[2]>=a[2]-f&&c[0]<=a[3]+f&&c[1]<=a[4]+f&&c[2]<=a[5]+f};r.create=x;r.depth=p;r.diameter=function(a){const c=q(a),f=g(a);a=p(a);return Math.sqrt(c*c+f*f+a*a)};r.empty=function(a){return a?l(a,n):x(n)};r.equals=function(a,c,f){if(t.isNone(a)||t.isNone(c))return a===c;if(!k(a)||!k(c))return!1;if(f)for(let m=0;m<
a.length;m++){if(!f(a[m],c[m]))return!1}else for(f=0;f<a.length;f++)if(a[f]!==c[f])return!1;return!0};r.expandWithAABB=function(a,c){a[0]=Math.min(a[0],c[0]);a[1]=Math.min(a[1],c[1]);a[2]=Math.min(a[2],c[2]);a[3]=Math.max(a[3],c[3]);a[4]=Math.max(a[4],c[4]);a[5]=Math.max(a[5],c[5])};r.expandWithBuffer=function(a,c,f=0,m=c.length/3){let h=a[0],v=a[1],u=a[2],F=a[3],z=a[4],A=a[5];for(let E=0;E<m;E++)h=Math.min(h,c[f+3*E]),v=Math.min(v,c[f+3*E+1]),u=Math.min(u,c[f+3*E+2]),F=Math.max(F,c[f+3*E]),z=Math.max(z,
c[f+3*E+1]),A=Math.max(A,c[f+3*E+2]);a[0]=h;a[1]=v;a[2]=u;a[3]=F;a[4]=z;a[5]=A};r.expandWithNestedArray=function(a,c,f){const m=c.length;let h=a[0],v=a[1],u=a[2],F=a[3],z=a[4],A=a[5];if(f)for(f=0;f<m;f++){var E=c[f];h=Math.min(h,E[0]);v=Math.min(v,E[1]);u=Math.min(u,E[2]);F=Math.max(F,E[0]);z=Math.max(z,E[1]);A=Math.max(A,E[2])}else for(f=0;f<m;f++)E=c[f],h=Math.min(h,E[0]),v=Math.min(v,E[1]),F=Math.max(F,E[0]),z=Math.max(z,E[1]);a[0]=h;a[1]=v;a[2]=u;a[3]=F;a[4]=z;a[5]=A};r.expandWithOffset=function(a,
c,f,m){a[0]=Math.min(a[0],a[0]+c);a[3]=Math.max(a[3],a[3]+c);a[1]=Math.min(a[1],a[1]+f);a[4]=Math.max(a[4],a[4]+f);a[2]=Math.min(a[2],a[2]+m);a[5]=Math.max(a[5],a[5]+m)};r.expandWithRect=function(a,c){a[0]=Math.min(a[0],c[0]);a[1]=Math.min(a[1],c[1]);a[3]=Math.max(a[3],c[2]);a[4]=Math.max(a[4],c[3])};r.expandWithVec3=function(a,c){a[0]=Math.min(a[0],c[0]);a[1]=Math.min(a[1],c[1]);a[2]=Math.min(a[2],c[2]);a[3]=Math.max(a[3],c[0]);a[4]=Math.max(a[4],c[1]);a[5]=Math.max(a[5],c[2])};r.fromExtent=function(a,
c=x()){c[0]=a.xmin;c[1]=a.ymin;c[2]=a.zmin;c[3]=a.xmax;c[4]=a.ymax;c[5]=a.zmax;return c};r.fromMinMax=function(a,c,f=x()){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=c[0];f[4]=c[1];f[5]=c[2];return f};r.fromRect=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=c[2];a[4]=c[3];a[5]=Number.POSITIVE_INFINITY;return a};r.fromValues=w;r.getMax=function(a,c){c[0]=a[3];c[1]=a[4];c[2]=a[5];return c};r.getMin=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];return c};r.height=g;r.intersects=e;r.intersectsClippingArea=
function(a,c){return t.isNone(c)?!0:e(a,c)};r.is=k;r.isPoint=function(a){return 0===q(a)&&0===p(a)&&0===g(a)};r.maximumDimension=function(a){return Math.max(q(a),g(a),p(a))};r.offset=function(a,c,f,m,h=a){h[0]=a[0]+c;h[1]=a[1]+f;h[2]=a[2]+m;h[3]=a[3]+c;h[4]=a[4]+f;h[5]=a[5]+m;return h};r.scale=function(a,c,f=a){const m=a[0]+q(a)/2,h=a[1]+p(a)/2,v=a[2]+g(a)/2;f[0]=m+(a[0]-m)*c;f[1]=h+(a[1]-h)*c;f[2]=v+(a[2]-v)*c;f[3]=m+(a[3]-m)*c;f[4]=h+(a[4]-h)*c;f[5]=v+(a[5]-v)*c;return f};r.set=l;r.setMax=function(a,
c,f=a){f[3]=c[0];f[4]=c[1];f[5]=c[2];f!==a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2]);return a};r.setMin=function(a,c,f=a){f[0]=c[0];f[1]=c[1];f[2]=c[2];f!==a&&(f[3]=a[3],f[4]=a[4],f[5]=a[5]);return f};r.size=function(a,c=[0,0,0]){c[0]=q(a);c[1]=p(a);c[2]=g(a);return c};r.toExtent=function(a,c){return isFinite(a[2])||isFinite(a[5])?new C({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:c}):new C({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:c})};r.toRect=function(a,
c){c||(c=D.create());c[0]=a[0];c[1]=a[1];c[2]=a[3];c[3]=a[4];return c};r.width=q;r.wrap=function(a,c,f,m,h,v){return w(a,c,f,m,h,v,b)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../config ../../core/Error ../../core/Logger ../../core/maybe ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../tasks/geometry/cut ../../tasks/geometry/simplify".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n){function d(u){const F=[];let z=0,A=0;for(let E=0;E<u.length;E++){const G=u[E];let H=null;for(let K=0;K<G.length;K++)H=G[K],F.push(H),0===K?A=z=H[0]:(z=Math.min(z,H[0]),A=Math.max(A,H[0]));H&&F.push([(z+A)/2,0])}return F}function b(u,F){if(!(u instanceof p||u instanceof q))throw v.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new D("straightLineDensify: the input geometry is neither polyline nor polygon");var z=g.getGeometryParts(u);
const A=[];for(const G of z){z=[];A.push(z);z.push([G[0][0],G[0][1]]);for(let H=0;H<G.length-1;H++){const K=G[H][0],L=G[H][1],J=G[H+1][0],B=G[H+1][1];var E=Math.sqrt((J-K)*(J-K)+(B-L)*(B-L));const y=(B-L)/E,I=(J-K)/E,S=E/F;if(1<S){for(let O=1;O<=S-1;O++){const Y=O*F;z.push([I*Y+K,y*Y+L])}E=(E+Math.floor(S-1)*F)/2;z.push([I*E+K,y*E+L])}z.push([J,B])}}return"polygon"===u.type?new q({rings:A,spatialReference:u.spatialReference}):new p({paths:A,spatialReference:u.spatialReference})}function a(u,F,z){F&&
(u=b(u,1E6),u=l.webMercatorToGeographic(u,!0));z&&(u=g.updatePolyGeometry(u,z));return u}function c(u,F,z){if(Array.isArray(u)){var A=u[0];A>F?(z=g.offsetMagnitude(A,F),u[0]=A+-2*z*F):A<z&&(F=g.offsetMagnitude(A,z),u[0]=A+-2*F*z)}else A=u.x,A>F?(z=g.offsetMagnitude(A,F),u=u.clone().offset(-2*z*F,0)):A<z&&(F=g.offsetMagnitude(A,z),u=u.clone().offset(-2*F*z,0));return u}function f(u,F){let z=-1;for(let A=0;A<F.cutIndexes.length;A++){const E=F.cutIndexes[A],G=F.geometries[A],H=g.getGeometryParts(G);
for(let K=0;K<H.length;K++){const L=H[K];L.some(J=>{if(180>J[0])return!0;J=0;for(var B=0;B<L.length;B++){var y=L[B][0];J=y>J?y:J}J=Number(J.toFixed(9));J=-360*g.offsetMagnitude(J,180);for(B=0;B<L.length;B++)y=G.getPoint(K,B),G.setPoint(K,B,y.clone().offset(J,0));return!0})}if(E===z)if("polygon"===u[0].type)for(const K of g.getGeometryParts(G))u[E]=u[E].addRing(K);else{if("polyline"===u[0].type)for(const K of g.getGeometryParts(G))u[E]=u[E].addPath(K)}else z=E,u[E]=G}return u}function m(u,F,z){return h.apply(this,
arguments)}function h(){h=t._asyncToGenerator(function*(u,F,z){var A;if(!Array.isArray(u))return m([u],F);F=null!=(A=null==F?void 0:F.url)?A:C.geometryServiceUrl;let E,G,H;let K=0;var L=[];A=[];for(var J of u)if(w.isNone(J))A.push(J);else{if(!B){var B=J.spatialReference;var y=e.getInfo(B);var I=(E=B.isWebMercator)?102100:4326;G=g.cutParams[I].maxX;H=g.cutParams[I].minX;var S=g.cutParams[I].plus180Line;I=g.cutParams[I].minus180Line}if(y)if("mesh"===J.type)A.push(J);else if("point"===J.type)A.push(c(J.clone(),
G,H));else if("multipoint"===J.type){var O=J.clone();O.points=O.points.map(Y=>c(Y,G,H));A.push(O)}else if("extent"===J.type)O=J.clone()._normalize(!1,!1,y),A.push(O.rings?new q(O):O);else if(J.extent){O=J.extent;const Y=2*g.offsetMagnitude(O.xmin,H)*G;let R=0===Y?J.clone():g.updatePolyGeometry(J.clone(),Y);O.offset(Y,0);O.intersects(S)&&O.xmax!==G?(K=O.xmax>K?O.xmax:K,R=a(R,E),L.push(R),A.push("cut")):O.intersects(I)&&O.xmin!==H?(K=2*O.xmax*G>K?2*O.xmax*G:K,R=a(R,E,360),L.push(R),A.push("cut")):A.push(R)}else A.push(J.clone());
else A.push(J)}B=g.offsetMagnitude(K,G);y=-90;S=B;for(J=new p;0<B;)I=-180+360*B,J.addPath([[I,y],[I,-1*y]]),y*=-1,B--;if(0<L.length&&0<S){B=yield k.cut(F,L,J,z);B=f(L,B);y=[];L=[];for(S=0;S<A.length;S++)J=A[S],"cut"!==J?L.push(J):(J=B.shift(),I=u[S],w.isSome(I)&&"polygon"===I.type&&I.rings&&1<I.rings.length&&J.rings.length>=I.rings.length?(y.push(J),L.push("simplify")):L.push(E?l.geographicToWebMercator(J):J));if(!y.length)return L;A=yield n.simplify(F,y,z);u=[];for(z=0;z<L.length;z++)F=L[z],"simplify"!==
F?u.push(F):u.push(E?l.geographicToWebMercator(A.shift()):A.shift());return u}u=[];for(z=0;z<A.length;z++)F=A[z],"cut"!==F?u.push(F):(F=L.shift(),u.push(!0===E?l.geographicToWebMercator(F):F));return Promise.resolve(u)});return h.apply(this,arguments)}const v=x.getLogger("esri.geometry.support.normalizeUtils");r.getDenormalizedExtent=function(u){if(!u)return null;const F=u.extent;if(!F)return null;var z=u.spatialReference&&e.getInfo(u.spatialReference);if(!z)return F;const [A,E]=z.valid;({width:z}=
F);let {xmin:G,xmax:H}=F;[G,H]=[H,G];if("extent"===u.type||0===z||z<=E||z>2*E||G<A||H>E)return F;let K;switch(u.type){case "polygon":if(1<u.rings.length)K=d(u.rings);else return F;break;case "polyline":if(1<u.paths.length)K=d(u.paths);else return F;break;case "multipoint":K=u.points}u=F.clone();for(let L=0;L<K.length;L++){let J=K[L][0];0>J?(J+=E,H=Math.max(J,H)):(J-=E,G=Math.min(J,G))}u.xmin=G;u.xmax=H;return u.width<z?(u.xmin-=E,u.xmax-=E,u):F};r.normalizeCentralMeridian=m;r.normalizeMapX=function(u,
F){if(F=e.getInfo(F)){const [z,A]=F.valid;F=A-z;if(u<z)for(;u<z;)u+=F;if(u>A)for(;u>A;)u-=F}return u};r.straightLineDensify=b;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(r,t,C,D){function x(q){return D.isPolygon(q)?q.rings:q.paths}const w={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new t({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],
[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:C.WebMercator}),minus180Line:new t({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:C.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new t({paths:[[[180,-180],[180,180]]],spatialReference:C.WGS84}),minus180Line:new t({paths:[[[-180,-180],[-180,180]]],spatialReference:C.WGS84})}};r.cutParams=w;r.getGeometryParts=x;r.getSpatialReferenceMinMaxX=function(q){q=(null==
q?0:q.isWebMercator)?102100:4326;return[w[q].minX,w[q].maxX]};r.offsetMagnitude=function(q,p){return Math.ceil((q-p)/(2*p))};r.updatePolyGeometry=function(q,p){const g=x(q);for(const e of g)for(const l of e)l[0]+=p;return q};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/tasks/geometry/cut":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(r,t,C,D,x,w){function q(){q=t._asyncToGenerator(function*(p,
g,e,l){p="string"===typeof p?x.urlToObject(p):p;const k=g[0].spatialReference;g={...l,query:{...p.query,f:"json",sr:JSON.stringify(k),target:JSON.stringify({geometryType:w.getJsonType(g[0]),geometries:g}),cutter:JSON.stringify(e)}};g=yield D(p.path+"/cut",g);const {cutIndexes:n,geometries:d=[]}=g.data;return{cutIndexes:n,geometries:d.map(b=>{b=w.fromJSON(b);b.spatialReference=k;return b})}});return q.apply(this,arguments)}r.cut=function(p,g,e,l){return q.apply(this,arguments)};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/tasks/geometry/simplify":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../request","../../core/urlUtils","../../geometry/support/jsonUtils"],function(r,t,C,D,x){function w(){w=t._asyncToGenerator(function*(g,e,l){const k="string"===typeof g?D.urlToObject(g):g;g=e[0].spatialReference;const n=x.getJsonType(e[0]);e={...l,query:{...k.query,f:"json",sr:g.wkid?g.wkid:JSON.stringify(g),geometries:JSON.stringify(q(e))}};e=yield C(k.path+"/simplify",
e);return p(e.data,n,g)});return w.apply(this,arguments)}function q(g){return{geometryType:x.getJsonType(g[0]),geometries:g.map(e=>e.toJSON())}}function p(g,e,l){const k=x.getGeometryType(e);return g.map(n=>{n=k.fromJSON(n);n.spatialReference=l;return n})}r.simplify=function(g,e,l){return w.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],
function(r,t,C){function D(g,e){return g?q.get(g,e):null}function x(g,e,l,k=!0){const n=[];for(const d of e)if("*"!==d&&!g.has(d))if(k){e=w(d);try{const b=D(e,g);if(!b)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:e});if(!b.isStandardized)throw new t("feature-store:unsupported-query","expression is not standard",{clause:b});x(g,b.fieldNames,"expression contains missing fields")}catch(b){if((e=b&&b.details)&&(e.clause||e.where))throw b;e&&e.missingFields?n.push(...e.missingFields):
n.push(d)}}else n.push(d);if(n.length)throw new t("feature-store:unsupported-query",l,{missingFields:n});}function w(g){return g.split(" as ")[0]}const q=new C.WhereClauseCache(50,500),p=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));r.getAliasFromFieldName=function(g){return g.split(" as ")[1]};r.getExpressionFromFieldName=w;r.getWhereClause=D;r.hasInvalidFieldType=function(g,e){return(g=
e.get(g))?!p.has(g.type):!1};r.validateFields=x;r.validateHaving=function(g,e,l){if(!e)return!0;const k=q.get(e,g);if(!k)throw new t("feature-store:unsupported-query","invalid SQL expression",{having:e});if(!k.isAggregate)throw new t("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:e});x(g,k.fieldNames,"having contains missing fields");if(!k.getExpressions().every(n=>{const {aggregateType:d,field:b}=n,a=g.has(b)&&g.get(b).name;return l.some(c=>{const {onStatisticField:f,
statisticType:m}=c;return(g.has(f)&&g.get(f).name)===a&&m.toLowerCase().trim()===d})}))throw new t("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:e});return!0};r.validateWhere=function(g,e){if(!e)return!0;const l=q.get(e,g);if(!l)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:e});if(!l.isStandardized)throw new t("feature-store:unsupported-query","where clause is not standard",{where:e});x(g,l.fieldNames,"where clause contains missing fields");
return!0};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../ItemCache","./WhereClause"],function(r,t,C){let D=function(){function x(w,q){this._cache=new t(w);this._invalidCache=new t(q)}x.prototype.get=function(w,q){const p=`${q.uid}:${w}`,g=this._cache.get(p);if(g)return g;if(void 0!==this._invalidCache.get(p))return null;try{const e=C.WhereClause.create(w,q);this._cache.put(p,e);return e}catch{return this._invalidCache.put(p,null),
null}};return x}();r.WhereClauseCache=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(r){return function(){function t(D,x){this._storage=new r.MemCacheStorage;this._storage.maxSize=D;x&&this._storage.registerRemoveFunc("",x)}var C=t.prototype;C.put=function(D,x){this._storage.put(D,x,1,1)};C.pop=function(D){return this._storage.pop(D)};C.get=function(D){return this._storage.get(D)};C.clear=function(){this._storage.clearAll()};C.destroy=
function(){this._storage.destroy()};return t}()})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(r,t,C,D,x,w){function q(L,J){L+="";return L.length>=J?L:Array(J-L.length+1).join("0")+L}function p(L,J,B="0",y="0",I="0",S="0",O="",Y="0",R="0"){return"+"===O||"-"===O?(L=`${q(parseInt(L,10),4)}-${q(parseInt(J,10),2)}-${q(parseInt(B,10),2)}`,J="",10>parseFloat(S)&&(J=
"0"),y=`${q(parseInt(y,10),2)}:${q(parseInt(I,10),2)}:${J+parseFloat(S).toString()}`,O=`${O}${q(parseInt(Y,10),2)}:${q(parseInt(R,10),2)}`,new Date(L+"T"+y+O)):new Date(parseInt(L,10),parseInt(J,10)-1,parseInt(B,10),parseInt(y,10),parseInt(I,10),parseFloat(S))}function g(L){let J=u.exec(L);if(null!==J){const [,B,y,I,S,O,Y]=J;return p(B,y,I,S,O,Y)}J=F.exec(L);if(null!==J){const [,B,y,I,S,O,Y,R,Q,W]=J;return p(B,y,I,S,O,Y,R,Q,W)}J=z.exec(L);if(null!==J){const [,B,y,I,S,O,Y,R,Q]=J;return p(B,y,I,S,O,
"0",Y,R,Q)}J=A.exec(L);if(null!==J){const [,B,y,I,S,O]=J;return p(B,y,I,S,O)}J=v.exec(L);if(null!==J){const [,B,y,I]=J;return p(B,y,I)}throw Error("SQL Invalid Timestamp");}function e(L){L=v.exec(L);if(null===L)throw Error("SQL Invalid Date");const [,J,B,y]=L;return new Date(parseInt(J,10),parseInt(B,10)-1,parseInt(y,10))}function l(L){return Array.isArray(L)?L:[L]}function k(L){return null!==L?!0!==L:null}function n(L,J){return null!=L&&null!=J?!0===L&&!0===J:!1===L||!1===J?!1:null}function d(L,
J){return null!=L&&null!=J?!0===L||!0===J:!0===L||!0===J?!0:null}function b(L,J){if(null==L)return null;let B=!1;for(const y of J)if(null==y)B=null;else if(L===y){B=!0;break}return B}function a(L,J,B){if(null==L)return null;let y="",I=0;for(let S=0;S<J.length;S++){const O=J.charAt(S);switch(I){case 0:O===B?I=1:y=0<="-[]/{}()*+?.\\^$|".indexOf(O)?y+("\\"+O):"%"===O?y+".*":"_"===O?y+".":y+O;break;case 1:y=0<="-[]/{}()*+?.\\^$|".indexOf(O)?y+("\\"+O):y+O,I=0}}return(new RegExp("^"+y+"$")).test(L)}function c(L){return L instanceof
Date?L.valueOf():L}function f(L,J,B){if(null==J||null==B)return null;J=c(J);B=c(B);switch(L){case "\x3c\x3e":return J!==B;case "\x3d":return J===B;case "\x3e":return J>B;case "\x3c":return J<B;case "\x3e\x3d":return J>=B;case "\x3c\x3d":return J<=B}}function m(L,J,B){if(J instanceof x.SqlInterval)if(B instanceof Date)switch(L){case "+":return new Date(J.valueInMilliseconds()+B.getTime());case "-":return J.valueInMilliseconds()-B.getTime();case "*":return J.valueInMilliseconds()*B.getTime();case "/":return J.valueInMilliseconds()/
B.getTime()}else if(B instanceof x.SqlInterval)switch(L){case "+":return x.SqlInterval.createFromMilliseconds(J.valueInMilliseconds()+B.valueInMilliseconds());case "-":return x.SqlInterval.createFromMilliseconds(J.valueInMilliseconds()-B.valueInMilliseconds());case "*":return J.valueInMilliseconds()*B.valueInMilliseconds();case "/":return J.valueInMilliseconds()/B.valueInMilliseconds()}else J=J.valueInMilliseconds();else if(B instanceof x.SqlInterval)if(J instanceof Date)switch(L){case "+":return new Date(B.valueInMilliseconds()+
J.getTime());case "-":return new Date(J.getTime()-B.valueInMilliseconds());case "*":return J.getTime()*B.valueInMilliseconds();case "/":return J.getTime()/B.valueInMilliseconds()}else B=B.valueInMilliseconds();else if(J instanceof Date&&"number"===typeof B)switch(B*=864E5,J=J.getTime(),L){case "+":return new Date(J+B);case "-":return new Date(J-B);case "*":return new Date(J*B);case "/":return new Date(J/B)}else if(B instanceof Date&&"number"===typeof J)switch(J*=864E5,B=B.getTime(),L){case "+":return new Date(J+
B);case "-":return new Date(J-B);case "*":return new Date(J*B);case "/":return new Date(J/B)}switch(L){case "+":return J+B;case "-":return J-B;case "*":return J*B;case "/":return J/B}}function h(L,J,B,y){L=y.getAttribute(L,J);return null!=L&&1===B[J]?new Date(L):L}const v=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,u=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,z=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,
A=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,E=new Set(["current_timestamp","current_date","current_time"]);let G=function(){function L(){}L.makeBool=function(J){return!0===J};L.featureValue=function(J,B,y,I){return h(J,B,y,I)};L.equalsNull=function(J){return null===J};L.applyLike=function(J,B,y){return a(J,B,y)};L.ensureArray=function(J){return l(J)};L.applyIn=function(J,B){return b(J,B)};L.currentDate=function(){const J=new Date;J.setHours(0,0,0,0);return J};L.makeSqlInterval=function(J,
B,y){return x.SqlInterval.createFromValueAndQualifer(J,B,y)};L.convertInterval=function(J){return J instanceof x.SqlInterval?J.valueInMilliseconds():J};L.currentTimestamp=function(){return new Date};L.compare=function(J,B,y){return f(J,B,y)};L.calculate=function(J,B,y){return m(J,B,y)};L.makeComparable=function(J){return c(J)};L.evaluateFunction=function(J,B){return x.evaluateFunction(J,B)};L.lookup=function(J,B){J=B[J];return void 0===J?null:J};L.between=function(J,B){return null==J||null==B[0]||
null==B[1]?null:J>=B[0]&&J<=B[1]};L.notbetween=function(J,B){return null==J||null==B[0]||null==B[1]?null:J<B[0]||J>B[1]};L.ternaryNot=function(J){return k(J)};L.ternaryAnd=function(J,B){return n(J,B)};L.ternaryOr=function(J,B){return d(J,B)};return L}(),H=function(){function L(B,y){this.fieldsIndex=y;this.datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=w.WhereGrammar.parse(B);const {isStandardized:I,isAggregate:S,referencedFieldNames:O}=this.extractExpressionInfo(y);
this.referencedFieldNames=O;this.isStandardized=I;this.isAggregate=S}L.create=function(B,y){return new L(B,y)};var J=L.prototype;J.testSet=function(B,y=K){const I={};for(const S of this.fieldNames)I[S]=B.map(O=>y.getAttribute(O,S));return!!this.evaluateNode(this.parseTree,{attributes:I},K)};J.calculateValue=function(B,y=K){B=this.evaluateNode(this.parseTree,B,y);return B instanceof x.SqlInterval?B.valueInMilliseconds()/864E5:B};J.calculateValueCompiled=function(B,y=K){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(B,
this.parameters,y,this.datefields);if(C("esri-csp-restrictions"))return this.calculateValue(B,y);this.compileMe();return this.parseTree._compiledVersion(B,this.parameters,y,this.datefields)};J.testFeature=function(B,y=K){return!!this.evaluateNode(this.parseTree,B,y)};J.testFeatureCompiled=function(B,y=K){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(B,this.parameters,y,this.datefields);if(C("esri-csp-restrictions"))return this.testFeature(B,y);this.compileMe();return!!this.parseTree._compiledVersion(B,
this.parameters,y,this.datefields)};J.getFunctions=function(){const B=new Set;this.visitAll(this.parseTree,y=>{"function"===y.type&&B.add(y.name.toLowerCase())});return Array.from(B)};J.getExpressions=function(){const B=new Map;this.visitAll(this.parseTree,y=>{if("function"===y.type){const I=y.name.toLowerCase();y=y.args.value[0];if("column_ref"===y.type){y=y.column;const S=`${I}-${y}`;B.has(S)||B.set(S,{aggregateType:I,field:y})}}});return[...B.values()]};J.getVariables=function(){const B=new Set;
this.visitAll(this.parseTree,y=>{"param"===y.type&&B.add(y.value.toLowerCase())});return Array.from(B)};J.compileMe=function(){const B="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",B)).bind(G)};J.extractExpressionInfo=function(B){const y=[],I=new Set;let S=!0,O=!0;this.visitAll(this.parseTree,Y=>{switch(Y.type){case "column_ref":{const R=B.get(Y.column);let Q,W;R?Q=
W=R.name:(W=Y.column,Q=W.toLowerCase());!R||"date"!==R.type&&"esriFieldTypeDate"!==R.type||(this.datefields[R.name]=1);I.has(Q)||(I.add(Q),y.push(W));Y.column=W;break}case "function":{const {name:R,args:Q}=Y;Y=Q.value.length;S&&(S=x.isStandardized(R,Y));O&&(O=D.isAggregate(R,Y))}}});return{referencedFieldNames:Array.from(y),isStandardized:S,isAggregate:O}};J.visitAll=function(B,y){if(null!=B)switch(y(B),B.type){case "when_clause":this.visitAll(B.operand,y);this.visitAll(B.value,y);break;case "case_expression":for(const I of B.clauses)this.visitAll(I,
y);"simple"===B.format&&this.visitAll(B.operand,y);null!==B.else&&this.visitAll(B.else,y);break;case "expr_list":for(const I of B.value)this.visitAll(I,y);break;case "unary_expr":this.visitAll(B.expr,y);break;case "binary_expr":this.visitAll(B.left,y);this.visitAll(B.right,y);break;case "function":this.visitAll(B.args,y)}};J.evaluateNodeToJavaScript=function(B){switch(B.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(B.value)+", "+JSON.stringify(B.qualifier)+","+
JSON.stringify(B.op)+")";case "case_expression":var y="";if("simple"===B.format){var I="this.makeComparable("+this.evaluateNodeToJavaScript(B.operand)+")";y="( ";for(let S=0;S<B.clauses.length;S++)y+=" ("+I+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(B.clauses[S].operand)+")) ? ("+this.evaluateNodeToJavaScript(B.clauses[S].value)+") : "}else for(y="( ",I=0;I<B.clauses.length;I++)y+=" this.makeBool("+this.evaluateNodeToJavaScript(B.clauses[I].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(B.clauses[I].value)+") : ";y=null!==B.else?y+this.evaluateNodeToJavaScript(B.else):y+"null";return y+=" )";case "param":return"this.lookup("+JSON.stringify(B.value.toLowerCase())+",lookups)";case "expr_list":y="[";for(I of B.value)"["!==y&&(y+=","),y+=this.evaluateNodeToJavaScript(I);return y+="]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(B.expr)+")";case "binary_expr":switch(B.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(B.left)+
","+this.evaluateNodeToJavaScript(B.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+" )";case "IS":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(B.left)+")";case "ISNOT":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(B.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(B.left)+
",this.ensureArray("+this.evaluateNodeToJavaScript(B.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(B.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(B.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+")";case "LIKE":return"this.applyLike("+
this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+","+JSON.stringify(B.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+","+JSON.stringify(B.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(B.operator)+","+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+
")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(B.operator)+","+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+")"}throw Error("Not Supported Operator "+B.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(B.value);case "date":return"(new Date("+e(B.value).getTime().toString()+"))";case "timestamp":return"(new Date("+g(B.value).getTime().toString()+"))";case "current_time":return"date"===B.mode?"this.currentDate()":
"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(B.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(B.name)+","+this.evaluateNodeToJavaScript(B.args)+")"}throw Error("Unsupported sql syntax "+B.type);};J.evaluateNode=function(B,y,I){switch(B.type){case "interval":return y=this.evaluateNode(B.value,y,I),x.SqlInterval.createFromValueAndQualifer(y,B.qualifier,B.op);case "case_expression":if("simple"===B.format){var S=
c(this.evaluateNode(B.operand,y,I));for(var O=0;O<B.clauses.length;O++)if(S===c(this.evaluateNode(B.clauses[O].operand,y,I)))return this.evaluateNode(B.clauses[O].value,y,I)}else for(S=0;S<B.clauses.length;S++)if(!0===this.evaluateNode(B.clauses[S].operand,y,I))return this.evaluateNode(B.clauses[S].value,y,I);return null!==B.else?this.evaluateNode(B.else,y,I):null;case "param":return this.parameters[B.value.toLowerCase()];case "expr_list":S=[];for(O of B.value)S.push(this.evaluateNode(O,y,I));return S;
case "unary_expr":return k(this.evaluateNode(B.expr,y,I));case "binary_expr":switch(B.operator){case "AND":return n(this.evaluateNode(B.left,y,I),this.evaluateNode(B.right,y,I));case "OR":return d(this.evaluateNode(B.left,y,I),this.evaluateNode(B.right,y,I));case "IS":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(B.left,y,I);case "ISNOT":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(B.left,y,I);case "IN":return S=
l(this.evaluateNode(B.right,y,I)),b(this.evaluateNode(B.left,y,I),S);case "NOT IN":return S=l(this.evaluateNode(B.right,y,I)),k(b(this.evaluateNode(B.left,y,I),S));case "BETWEEN":return S=this.evaluateNode(B.left,y,I),B=this.evaluateNode(B.right,y,I),null==S||null==B[0]||null==B[1]?null:S>=c(B[0])&&S<=c(B[1]);case "NOTBETWEEN":return S=this.evaluateNode(B.left,y,I),B=this.evaluateNode(B.right,y,I),null==S||null==B[0]||null==B[1]?null:S<c(B[0])||S>c(B[1]);case "LIKE":return a(this.evaluateNode(B.left,
y,I),this.evaluateNode(B.right,y,I),B.escape);case "NOT LIKE":return k(a(this.evaluateNode(B.left,y,I),this.evaluateNode(B.right,y,I),B.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return f(B.operator,this.evaluateNode(B.left,y,I),this.evaluateNode(B.right,y,I));case "-":case "+":case "*":case "/":return m(B.operator,this.evaluateNode(B.left,y,I),this.evaluateNode(B.right,y,I))}case "null":case "bool":case "string":case "number":return B.value;case "date":return e(B.value);
case "timestamp":return g(B.value);case "current_time":return y=new Date,"date"===B.mode&&y.setHours(0,0,0,0),y;case "column_ref":return h(y,B.column,this.datefields,I);case "function":return y=this.evaluateNode(B.args,y,I),this.isAggregate?D.aggregateFunction(B.name,y):x.evaluateFunction(B.name,y)}throw Error("Unsupported sql syntax "+B.type);};t._createClass(L,[{key:"fieldNames",get:function(){return this.referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=this._hasDateFunctions)return this._hasDateFunctions;
this._hasDateFunctions=!1;this.visitAll(this.parseTree,B=>{"current_time"===B.type?this._hasDateFunctions=!0:"function"===B.type&&(this._hasDateFunctions=this._hasDateFunctions||E.has(B.name.toLowerCase()))});return this._hasDateFunctions}}]);return L}();const K={getAttribute(L,J){return(L&&"object"===typeof L.attributes?L.attributes:L)[J]}};r.WhereClause=H;r.defaultAttributeAdapter=K;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],
function(r){function t(x){let w=0;for(let q=0;q<x.length;q++)w+=x[q];return w/x.length}function C(x){const w=t(x),q=x.length;let p=0;for(const g of x)p+=(g-w)**2;return 1<q?p/(q-1):0}const D={min:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.min.apply(Math,x[0])},max:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.max.apply(Math,x[0])},avg:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:t(x[0])},sum:{minParams:1,maxParams:1,evaluate:x=>{if(null==x[0])x=null;else{{x=x[0];
let w=0;for(let q=0;q<x.length;q++)w+=x[q];x=w}}return x}},stddev:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.sqrt(C(x[0]))},count:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:x[0].length},var:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:C(x[0])}};r.aggregateFunction=function(x,w){const q=D[x.toLowerCase()];if(null==q)throw Error("Function Not Recognised");if(w.length<q.minParams||w.length>q.maxParams)throw Error(`Invalid Parameter count for call to ${x.toUpperCase()}`);
return q.evaluate(w)};r.isAggregate=function(x,w){x=D[x.toLowerCase()];return null!=x&&w>=x.minParams&&w<=x.maxParams};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../string"],function(r,t){let C=function(){function x(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}x.fixDefaults=function(w){if(null!==w.precision||null!==w.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");
};x.createFromMilliseconds=function(w){const q=new x;q.second=w/1E3;return q};x.createFromValueAndQualifer=function(w,q,p){let g=null;const e=new x;e.op="-"===p?"-":"+";if("interval-period"===q.type){x.fixDefaults(q);if("year"===q.period||"month"===q.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(w))e[q.period]=parseFloat(w);else throw Error("Illegal Interval");}else{x.fixDefaults(q.start);x.fixDefaults(q.end);if("year"===q.start.period||"month"===q.start.period)throw Error("Year-Month Intervals not supported");
if("year"===q.end.period||"month"===q.end.period)throw Error("Year-Month Intervals not supported");switch(q.start.period){case "day":switch(q.end.period){case "hour":g=/^[0-9]{1,} [0-9]{1,}$/;if(g.test(w))e[q.start.period]=parseFloat(w.split(" ")[0]),e[q.end.period]=parseFloat(w.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(g.test(w))e[q.start.period]=parseFloat(w.split(" ")[0]),w=w.split(" ")[1].split(":"),e.hour=parseFloat(w[0]),
e.minute=parseFloat(w[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(w))e[q.start.period]=parseFloat(w.split(" ")[0]),w=w.split(" ")[1].split(":"),e.hour=parseFloat(w[0]),e.minute=parseFloat(w[1]),e.second=parseFloat(w[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(q.end.period){case "minute":g=/^[0-9]{1,}:[0-9]{1,}$/;if(g.test(w))e.hour=parseFloat(w.split(":")[0]),
e.minute=parseFloat(w.split(":")[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(w))w=w.split(":"),e.hour=parseFloat(w[0]),e.minute=parseFloat(w[1]),e.second=parseFloat(w[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(q.end.period){case "second":g=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(w))w=w.split(":"),e.minute=parseFloat(w[0]),e.second=parseFloat(w[1]);
else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return e};x.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return x}();const D={extract:{minParams:2,maxParams:2,evaluate:([x,w])=>{if(null==w)return null;if(w instanceof Date)switch(x.toUpperCase()){case "SECOND":return w.getSeconds();case "MINUTE":return w.getMinutes();
case "HOUR":return w.getHours();case "DAY":return w.getDate();case "MONTH":return w.getMonth()+1;case "YEAR":return w.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:x=>{if(2===x.length){const [w,q]=x;return null==w||null==q?null:w.toString().substring(q-1)}if(3===x.length){const [w,q,p]=x;return null==w||null==q||null==p?null:0>=p?"":w.toString().substring(q-1,q+p-1)}}},position:{minParams:2,maxParams:2,evaluate:([x,w])=>null==x||
null==w?null:w.indexOf(x)+1},trim:{minParams:2,maxParams:3,evaluate:x=>{var w=3===x.length,q=w?x[1]:" ";w=w?x[2]:x[1];if(null==q||null==w)return null;q=`(${t.escapeRegExpString(q)})`;switch(x[0]){case "BOTH":return w.replace(new RegExp(`^${q}*|${q}*$`,"g"),"");case "LEADING":return w.replace(new RegExp(`^${q}*`,"g"),"");case "TRAILING":return w.replace(new RegExp(`${q}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.abs(x[0])},
ceiling:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.ceil(x[0])},floor:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.floor(x[0])},log:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.log(x[0])},log10:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.log(x[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.sin(x[0])},cos:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.cos(x[0])},tan:{minParams:1,maxParams:1,evaluate:x=>
null==x[0]?null:Math.tan(x[0])},asin:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.asin(x[0])},acos:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.acos(x[0])},atan:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.atan(x[0])},sign:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:0<x[0]?1:0>x[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:x=>null==x[0]||null==x[1]?null:x[0]**x[1]},mod:{minParams:2,maxParams:2,evaluate:x=>null==x[0]||null==x[1]?null:x[0]%x[1]},round:{minParams:1,
maxParams:2,evaluate:x=>{const w=x[0];x=2===x.length?10**x[1]:1;return null==w?null:Math.round(w*x)/x}},truncate:{minParams:1,maxParams:2,evaluate:x=>null==x[0]?null:1===x.length?parseInt(x[0].toFixed(0),10):parseFloat(x[0].toFixed(x[1]))},char_length:{minParams:1,maxParams:1,evaluate:x=>"string"===typeof x[0]||x[0]instanceof String?x[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:x=>{let w="";for(let q=0;q<x.length;q++){if(null==x[q])return null;w+=x[q].toString()}return w}},lower:{minParams:1,
maxParams:1,evaluate:x=>null==x[0]?null:x[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:x[0].toString().toUpperCase()}};r.SqlInterval=C;r.evaluateFunction=function(x,w){const q=D[x.toLowerCase()];if(null==q)throw Error("Function Not Recognised");if(w.length<q.minParams||w.length>q.maxParams)throw Error(`Invalid Parameter count for call to ${x.toUpperCase()}`);return q.evaluate(w)};r.isStandardized=function(x,w){x=D[x.toLowerCase()];return null!=x&&w>=x.minParams&&
w<=x.maxParams};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(r,t){var C={exports:{}};(function(x){(function(w,q){x.exports&&(x.exports=q())})(t.commonjsGlobal,function(){function w(p,g,e,l){p=Error.call(this,p);Object.setPrototypeOf&&Object.setPrototypeOf(p,w.prototype);p.expected=g;p.found=e;p.location=l;p.name="SyntaxError";return p}function q(p,g,e){e=e||" ";if(p.length>g)return p;g-=p.length;
e+=e.repeat(g);return p+e.slice(0,g)}(function(p,g){function e(){this.constructor=p}e.prototype=g.prototype;p.prototype=new e})(w,Error);w.prototype.format=function(p){var g="Error: "+this.message;if(this.location){var e=null,l;for(l=0;l<p.length;l++)if(p[l].source===this.location.source){e=p[l].text.split(/\r\n|\n|\r/g);break}p=this.location.start;l=this.location.source+":"+p.line+":"+p.column;if(e){var k=this.location.end,n=q("",p.line.toString().length);e=e[p.line-1];k=p.line===k.line?k.column:
e.length+1;g+="\n --\x3e "+l+"\n"+n+" |\n"+p.line+" | "+e+"\n"+n+" | "+q("",p.column-1)+q("",k-p.column,"^")}else g+="\n at "+l}return g};w.buildMessage=function(p,g){function e(b){return b.charCodeAt(0).toString(16).toUpperCase()}function l(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+e(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+e(a)})}function k(b){return b.replace(/\\/g,
"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+e(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+e(a)})}function n(b){return d[b.type](b)}var d={literal:function(b){return'"'+l(b.text)+'"'},class:function(b){var a=b.parts.map(function(c){return Array.isArray(c)?k(c[0])+"-"+k(c[1]):k(c)});return"["+(b.inverted?"^":"")+a+"]"},any:function(){return"any character"},
end:function(){return"end of input"},other:function(b){return b.description}};return"Expected "+function(b){b=b.map(n);var a,c;b.sort();if(0<b.length){for(c=a=1;a<b.length;a++)b[a-1]!==b[a]&&(b[c]=b[a],c++);b.length=c}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(p)+" but "+(g?'"'+l(g)+'"':"end of input")+" found."};return{SyntaxError:w,parse:function(p,g){function e(X,ba){return{type:"literal",text:X,ignoreCase:ba}}
function l(X,ba,ka){return{type:"class",parts:X,inverted:ba,ignoreCase:ka}}function k(X){var ba=Zb[X],ka;if(!ba){for(ka=X-1;!Zb[ka];)ka--;ba=Zb[ka];for(ba={line:ba.line,column:ba.column};ka<X;)10===p.charCodeAt(ka)?(ba.line++,ba.column=1):ba.column++,ka++;Zb[X]=ba}return ba}function n(X,ba){var ka=k(X),ya=k(ba);return{source:ab,start:{offset:X,line:ka.line,column:ka.column},end:{offset:ba,line:ya.line,column:ya.column}}}function d(X){U<ob||(U>ob&&(ob=U,tc=[]),tc.push(X))}function b(){var X=U;xa();
var ba=c();ba!==N?(xa(),X=ba):(U=X,X=N);return X}function a(){var X=U;var ba=c();if(ba!==N){X=[];var ka=U;var ya=xa();var Ha=Ia();if(Ha!==N){var Oa=xa();var Pa=c();Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)}else U=ka,ka=N;for(;ka!==N;)X.push(ka),ka=U,ya=xa(),Ha=Ia(),Ha!==N?(Oa=xa(),Pa=c(),Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)):(U=ka,ka=N);ka={type:"expr_list"};ba=[ba];for(ya=0;ya<X.length;ya++)ba.push(X[ya][3]);ka.value=ba;X=ka}else U=X,X=N;return X}function c(){var X=U;var ba=f();if(ba!==N){X=[];var ka=
U;var ya=xa();var Ha=ca();if(Ha!==N){var Oa=xa();var Pa=f();Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)}else U=ka,ka=N;for(;ka!==N;)X.push(ka),ka=U,ya=xa(),Ha=ca(),Ha!==N?(Oa=xa(),Pa=f(),Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)):(U=ka,ka=N);X=Ra(ba,X)}else U=X,X=N;return X}function f(){var X=U;var ba=m();if(ba!==N){X=[];var ka=U;var ya=xa();var Ha=Z();if(Ha!==N){var Oa=xa();var Pa=m();Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)}else U=ka,ka=N;for(;ka!==N;)X.push(ka),ka=U,ya=xa(),Ha=Z(),Ha!==N?(Oa=xa(),Pa=m(),
Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)):(U=ka,ka=N);X=Ra(ba,X)}else U=X,X=N;return X}function m(){var X=U;var ba=V();if(ba===N){ba=U;if(33===p.charCodeAt(U)){var ka=sb;U++}else ka=N,0===za&&d(ld);if(ka!==N){var ya=U;za++;if(61===p.charCodeAt(U)){var Ha=jb;U++}else Ha=N,0===za&&d(Jc);za--;Ha===N?ya=void 0:(U=ya,ya=N);ya!==N?ba=ka=[ka,ya]:(U=ba,ba=N)}else U=ba,ba=N}ba!==N?(ka=xa(),ya=m(),ya!==N?X={type:"unary_expr",operator:"NOT",expr:ya}:(U=X,X=N)):(U=X,X=N);if(X===N){ba=U;X=F();if(X!==N){xa();ba=
[];ka=U;ya=xa();Ha=h();if(Ha!==N){var Oa=xa();var Pa=F();Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)}else U=ka,ka=N;if(ka!==N)for(;ka!==N;)ba.push(ka),ka=U,ya=xa(),Ha=h(),Ha!==N?(Oa=xa(),Pa=F(),Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)):(U=ka,ka=N);else ba=N;ba!==N&&(ba={type:"arithmetic",tail:ba});ba===N&&(ba=U,ka=u(),ka!==N?(xa(),ya=Ja(),ya!==N?(xa(),ya=a(),ya!==N?(xa(),Ha=Ma(),Ha!==N?ba={op:ka,right:ya}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ka=u(),ka!==N?(xa(),ya=Ja(),ya!==N?
(xa(),ya=Ma(),ya!==N?ba={op:ka,right:{type:"expr_list",value:[]}}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ka=u(),ka!==N?(xa(),ya=B(),ya!==N?ba={op:ka,right:ya}:(U=ba,ba=N)):(U=ba,ba=N))),ba===N&&(ba=U,Ha=V(),Ha!==N?(xa(),ka=ea(),ka!==N?(xa(),ya=F(),ya!==N?(xa(),Oa=Z(),Oa!==N?(xa(),Ha=F(),Ha!==N?ba={op:"NOT"+ka,right:{type:"expr_list",value:[ya,Ha]}}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,Ha=ea(),Ha!==N?(xa(),ka=F(),ka!==N?(xa(),ya=Z(),ya!==N?(xa(),
Oa=F(),Oa!==N?ba={op:Ha,right:{type:"expr_list",value:[ka,Oa]}}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)),ba===N&&(ba=U,ka=T(),ka!==N?(xa(),ya=V(),ya!==N?(xa(),ya=F(),ya!==N?ba={op:ka+"NOT",right:ya}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ka=T(),ka!==N?(xa(),ya=F(),ya!==N?ba={op:ka,right:ya}:(U=ba,ba=N)):(U=ba,ba=N)),ba===N&&(ba=U,ka=v(),ka!==N?(xa(),ya=R(),ya!==N?(xa(),Ha=U,p.substr(U,6).toLowerCase()===Va?(Oa=p.substr(U,6),U+=6):(Oa=N,0===za&&d(md)),Oa!==N?(Oa=U,za++,Pa=L(),
za--,Pa===N?Oa=void 0:(U=Oa,Oa=N),Oa!==N?Ha="ESCAPE":(U=Ha,Ha=N)):(U=Ha,Ha=N),Ha!==N?(xa(),Ha=Q(),Ha!==N?ba={op:ka,right:ya,escape:Ha.value}:(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N)):(U=ba,ba=N),ba===N&&(ba=U,ka=v(),ka!==N?(xa(),ya=R(),ya!==N?ba={op:ka,right:ya,escape:""}:(U=ba,ba=N)):(U=ba,ba=N))))));ba===N&&(ba=null);""==ba||void 0==ba||null==ba?ba=X:(ka=null,ba=ka="arithmetic"==ba.type?Ra(X,ba.tail):Sa(ba.op,X,ba.right,ba.escape))}else U=ba,ba=N;X=ba}return X}function h(){if(p.substr(U,2)===Ab){var X=
Ab;U+=2}else X=N,0===za&&d(nd);X===N&&(62===p.charCodeAt(U)?(X=$b,U++):(X=N,0===za&&d(od)),X===N&&(p.substr(U,2)===Cb?(X=Cb,U+=2):(X=N,0===za&&d(pd)),X===N&&(p.substr(U,2)===ac?(X=ac,U+=2):(X=N,0===za&&d(qd)),X===N&&(60===p.charCodeAt(U)?(X=kb,U++):(X=N,0===za&&d(rd)),X===N&&(61===p.charCodeAt(U)?(X=jb,U++):(X=N,0===za&&d(Jc)),X===N&&(p.substr(U,2)===tb?(X=tb,U+=2):(X=N,0===za&&d(sd))))))));return X}function v(){var X=X=U;var ba=V();if(ba!==N){var ka=xa();var ya=ha();ya!==N?X=ba=[ba,ka,ya]:(U=X,X=
N)}else U=X,X=N;X!==N&&(X=X[0]+" "+X[2]);X===N&&(X=ha());return X}function u(){var X=X=U;var ba=V();if(ba!==N){var ka=xa();var ya=M();ya!==N?X=ba=[ba,ka,ya]:(U=X,X=N)}else U=X,X=N;X!==N&&(X=X[0]+" "+X[2]);X===N&&(X=M());return X}function F(){var X=U;var ba=A();if(ba!==N){X=[];var ka=U;var ya=xa();var Ha=z();if(Ha!==N){var Oa=xa();var Pa=A();Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)}else U=ka,ka=N;for(;ka!==N;)X.push(ka),ka=U,ya=xa(),Ha=z(),Ha!==N?(Oa=xa(),Pa=A(),Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)):
(U=ka,ka=N);X=Ra(ba,X)}else U=X,X=N;return X}function z(){if(43===p.charCodeAt(U)){var X=Ta;U++}else X=N,0===za&&d(uc);X===N&&(45===p.charCodeAt(U)?(X=eb,U++):(X=N,0===za&&d(vc)));return X}function A(){var X=U;var ba=G();if(ba!==N){X=[];var ka=U;var ya=xa();var Ha=E();if(Ha!==N){var Oa=xa();var Pa=G();Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)}else U=ka,ka=N;for(;ka!==N;)X.push(ka),ka=U,ya=xa(),Ha=E(),Ha!==N?(Oa=xa(),Pa=G(),Pa!==N?ka=ya=[ya,Ha,Oa,Pa]:(U=ka,ka=N)):(U=ka,ka=N);X=Ra(ba,X)}else U=X,X=N;return X}
function E(){if(42===p.charCodeAt(U)){var X=pb;U++}else X=N,0===za&&d(td);X===N&&(47===p.charCodeAt(U)?(X=Qa,U++):(X=N,0===za&&d(ud)));return X}function G(){var X=Q();if(X===N){var ba=U;var ka=U;var ya=oa();if(ya!==N){var Ha=pa();if(Ha!==N){var Oa=sa();Oa!==N?ka=parseFloat(ya+Ha+Oa):(U=ka,ka=N)}else U=ka,ka=N}else U=ka,ka=N;ka===N&&(ka=U,ya=oa(),ya!==N?(Ha=pa(),Ha!==N?ka=parseFloat(ya+Ha):(U=ka,ka=N)):(U=ka,ka=N),ka===N&&(ka=U,ya=oa(),ya!==N?(Ha=sa(),Ha!==N?ka=parseFloat(ya+Ha):(U=ka,ka=N)):(U=ka,
ka=N),ka===N&&(ka=U,ya=oa(),ya!==N&&(ya=parseFloat(ya)),ka=ya)));var Pa=ka;if(Pa!==N){var bc=U;za++;var vd=K();za--;vd===N?bc=void 0:(U=bc,bc=N);bc!==N?ba={type:"number",value:Pa}:(U=ba,ba=N)}else U=ba,ba=N;X=ba;if(X===N){var Pb=U;var Db=U;if(p.substr(U,4).toLowerCase()===Ea){var cc=p.substr(U,4);U+=4}else cc=N,0===za&&d(wd);if(cc!==N){var Qb=U;za++;var xd=L();za--;xd===N?Qb=void 0:(U=Qb,Qb=N);Qb!==N?Db=cc=[cc,Qb]:(U=Db,Db=N)}else U=Db,Db=N;var Bb=Db;Bb!==N&&(Bb={type:"bool",value:!0});Pb=Bb;if(Pb===
N){Pb=U;var Eb=U;if(p.substr(U,5).toLowerCase()===La){var dc=p.substr(U,5);U+=5}else dc=N,0===za&&d(yd);if(dc!==N){var Rb=U;za++;var zd=L();za--;zd===N?Rb=void 0:(U=Rb,Rb=N);Rb!==N?Eb=dc=[dc,Rb]:(U=Eb,Eb=N)}else U=Eb,Eb=N;Bb=Eb;Bb!==N&&(Bb={type:"bool",value:!1});Pb=Bb}X=Pb;if(X===N){var Fb=U;if(p.substr(U,4).toLowerCase()===Ca){var ec=p.substr(U,4);U+=4}else ec=N,0===za&&d(Ad);if(ec!==N){var Sb=U;za++;var Bd=L();za--;Bd===N?Sb=void 0:(U=Sb,Sb=N);Sb!==N?Fb=ec=[ec,Sb]:(U=Fb,Fb=N)}else U=Fb,Fb=N;var wc=
Fb;wc!==N&&(wc={type:"null",value:null});X=wc;if(X===N){var Gb=U;var Hb=U;if(p.substr(U,4).toLowerCase()===Cd){var Kc=p.substr(U,4);U+=4}else Kc=N,0===za&&d(Dd);if(Kc!==N){var fc=U;za++;var Ed=L();za--;Ed===N?fc=void 0:(U=fc,fc=N);fc!==N?Hb="DATE":(U=Hb,Hb=N)}else U=Hb,Hb=N;if(Hb!==N){xa();var Lc=R();Lc!==N?Gb={type:"date",value:Lc.value}:(U=Gb,Gb=N)}else U=Gb,Gb=N;X=Gb;if(X===N){var Ib=U;var Jb=U;if(p.substr(U,9).toLowerCase()===Fd){var Mc=p.substr(U,9);U+=9}else Mc=N,0===za&&d(Gd);if(Mc!==N){var gc=
U;za++;var Hd=L();za--;Hd===N?gc=void 0:(U=gc,gc=N);gc!==N?Jb="TIMESTAMP":(U=Jb,Jb=N)}else U=Jb,Jb=N;if(Jb!==N){xa();var Nc=R();Nc!==N?Ib={type:"timestamp",value:Nc.value}:(U=Ib,Ib=N)}else U=Ib,Ib=N;X=Ib;if(X===N){var bb=U;var xc=aa();if(xc!==N){xa();if(45===p.charCodeAt(U)){var ub=eb;U++}else ub=N,0===za&&d(vc);ub===N&&(43===p.charCodeAt(U)?(ub=Ta,U++):(ub=N,0===za&&d(uc)));if(ub!==N){xa();var Tb=R();if(Tb!==N){xa();var Oc=I();Oc!==N?bb={type:"interval",value:Tb,qualifier:Oc,op:ub}:(U=bb,bb=N)}else U=
bb,bb=N}else U=bb,bb=N}else U=bb,bb=N;bb===N&&(bb=U,xc=aa(),xc!==N?(xa(),ub=R(),ub!==N?(xa(),Tb=I(),Tb!==N?bb={type:"interval",value:ub,qualifier:Tb,op:""}:(U=bb,bb=N)):(U=bb,bb=N)):(U=bb,bb=N));X=bb}}}}}}var Xa=X;if(Xa===N){var gb=U;var Kb=U;if(p.substr(U,7).toLowerCase()===Id){var Pc=p.substr(U,7);U+=7}else Pc=N,0===za&&d(Jd);if(Pc!==N){var hc=U;za++;var Kd=L();za--;Kd===N?hc=void 0:(U=hc,hc=N);hc!==N?Kb="EXTRACT":(U=Kb,Kb=N)}else U=Kb,Kb=N;if(Kb!==N){xa();var Ld=Ja();if(Ld!==N){xa();var mb=da();
mb===N&&(mb=ia(),mb===N&&(mb=va(),mb===N&&(mb=wa(),mb===N&&(mb=Aa(),mb===N&&(mb=Ba())))));var Qc=mb;if(Qc!==N){xa();var Md=ja();if(Md!==N){xa();var Rc=c();if(Rc!==N){xa();var Nd=Ma();Nd!==N?gb={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:Qc},Rc]}}:(U=gb,gb=N)}else U=gb,gb=N}else U=gb,gb=N}else U=gb,gb=N}else U=gb,gb=N}else U=gb,gb=N;Xa=gb;if(Xa===N){var hb=U;var Lb=U;if(p.substr(U,9).toLowerCase()===Od){var Sc=p.substr(U,9);U+=9}else Sc=N,0===za&&d(Pd);if(Sc!==
N){var ic=U;za++;var Qd=L();za--;Qd===N?ic=void 0:(U=ic,ic=N);ic!==N?Lb="SUBSTRING":(U=Lb,Lb=N)}else U=Lb,Lb=N;if(Lb!==N){xa();var Rd=Ja();if(Rd!==N){xa();var yc=c();if(yc!==N){xa();var Sd=ja();if(Sd!==N){xa();var zc=c();if(zc!==N){xa();var vb=U;var Mb=U;if(p.substr(U,3).toLowerCase()===Td){var Tc=p.substr(U,3);U+=3}else Tc=N,0===za&&d(Ud);if(Tc!==N){var jc=U;za++;var Vd=L();za--;Vd===N?jc=void 0:(U=jc,jc=N);jc!==N?Mb="FOR":(U=Mb,Mb=N)}else U=Mb,Mb=N;var Ub=Mb;if(Ub!==N){var Wd=xa();var Uc=c();if(Uc!==
N){var Xd=xa();vb=Ub=[Ub,Wd,Uc,Xd]}else U=vb,vb=N}else U=vb,vb=N;vb===N&&(vb=null);Ub=Ma();Ub!==N?hb={type:"function",name:"substring",args:{type:"expr_list",value:vb?[yc,zc,vb[2]]:[yc,zc]}}:(U=hb,hb=N)}else U=hb,hb=N}else U=hb,hb=N}else U=hb,hb=N}else U=hb,hb=N}else U=hb,hb=N;Xa=hb;if(Xa===N){var Za=U;var Ac=la();if(Ac!==N){xa();var Bc=Ja();if(Bc!==N){xa();var wb=y();wb===N&&(wb=null);xa();var Vb=c();if(Vb!==N){xa();var Cc=ja();if(Cc!==N){xa();var Vc=c();if(Vc!==N){xa();var Yd=Ma();Yd!==N?Za={type:"function",
name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==wb?"BOTH":wb},Vb,Vc]}}:(U=Za,Za=N)}else U=Za,Za=N}else U=Za,Za=N}else U=Za,Za=N}else U=Za,Za=N}else U=Za,Za=N;Za===N&&(Za=U,Ac=la(),Ac!==N?(xa(),Bc=Ja(),Bc!==N?(xa(),wb=y(),wb===N&&(wb=null),xa(),Vb=c(),Vb!==N?(xa(),Cc=Ma(),Cc!==N?Za={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==wb?"BOTH":wb},Vb]}}:(U=Za,Za=N)):(U=Za,Za=N)):(U=Za,Za=N)):(U=Za,Za=N));Xa=Za;if(Xa===N){var ib=U;var Nb=U;if(p.substr(U,
8).toLowerCase()===Zd){var Wc=p.substr(U,8);U+=8}else Wc=N,0===za&&d($d);if(Wc!==N){var kc=U;za++;var ae=L();za--;ae===N?kc=void 0:(U=kc,kc=N);kc!==N?Nb="POSITION":(U=Nb,Nb=N)}else U=Nb,Nb=N;if(Nb!==N){xa();var be=Ja();if(be!==N){xa();var Xc=c();if(Xc!==N){xa();var ce=M();if(ce!==N){xa();var Yc=c();if(Yc!==N){xa();var de=Ma();de!==N?ib={type:"function",name:"position",args:{type:"expr_list",value:[Xc,Yc]}}:(U=ib,ib=N)}else U=ib,ib=N}else U=ib,ib=N}else U=ib,ib=N}else U=ib,ib=N}else U=ib,ib=N;Xa=ib;
if(Xa===N){var yb=U;var lc;var nb=U;nb=lc=H();if(nb===N)if(nb=U,96===p.charCodeAt(U)?(lc=Zc,U++):(lc=N,0===za&&d($c)),lc!==N){var mc=[];if(ad.test(p.charAt(U))){var xb=p.charAt(U);U++}else xb=N,0===za&&d(bd);if(xb!==N)for(;xb!==N;)mc.push(xb),ad.test(p.charAt(U))?(xb=p.charAt(U),U++):(xb=N,0===za&&d(bd));else mc=N;mc!==N?(96===p.charCodeAt(U)?(xb=Zc,U++):(xb=N,0===za&&d($c)),xb!==N?nb=mc.join(""):(U=nb,nb=N)):(U=nb,nb=N)}else U=nb,nb=N;var cd=nb;if(cd!==N){xa();var ee=Ja();if(ee!==N){xa();var nc=
a();nc===N&&(nc=null);xa();var fe=Ma();fe!==N?yb={type:"function",name:cd,args:nc?nc:{type:"expr_list",value:[]}}:(U=yb,yb=N)}else U=yb,yb=N}else U=yb,yb=N;Xa=yb;if(Xa===N){var qb;var cb=U;var Dc=Da();if(Dc!==N){xa();var Wb=c();if(Wb!==N){xa();var Xb=[];for(qb=P();qb!==N;)Xb.push(qb),qb=P();qb=xa();var oc=Ka();oc!==N?cb={type:"case_expression",format:"simple",operand:Wb,clauses:Xb,else:null}:(U=cb,cb=N)}else U=cb,cb=N}else U=cb,cb=N;if(cb===N)if(cb=U,Dc=Da(),Dc!==N)if(xa(),Wb=c(),Wb!==N){xa();Xb=
[];for(qb=P();qb!==N;)Xb.push(qb),qb=P();qb=xa();oc=fa();if(oc!==N){xa();var ge=Ka();ge!==N?cb={type:"case_expression",format:"simple",operand:Wb,clauses:Xb,else:oc.value}:(U=cb,cb=N)}else U=cb,cb=N}else U=cb,cb=N;else U=cb,cb=N;var Ec=cb;if(Ec===N){var rb;var fb=U;var Fc=Da();if(Fc!==N){xa();var Yb=[];for(rb=W();rb!==N;)Yb.push(rb),rb=W();rb=xa();var pc=Ka();pc!==N?fb={type:"case_expression",format:"searched",clauses:Yb,else:null}:(U=fb,fb=N)}else U=fb,fb=N;if(fb===N)if(fb=U,Fc=Da(),Fc!==N){xa();
Yb=[];for(rb=W();rb!==N;)Yb.push(rb),rb=W();rb=xa();pc=fa();if(pc!==N){xa();var he=Ka();he!==N?fb={type:"case_expression",format:"searched",clauses:Yb,else:pc.value}:(U=fb,fb=N)}else U=fb,fb=N}else U=fb,fb=N;Ec=fb}Xa=Ec;if(Xa===N){var qc;var rc=U;var dd=K();if(dd!==N){var ed=[];for(qc=J();qc!==N;)ed.push(qc),qc=J();rc=dd+ed.join("")}else U=rc,rc=N;var sc=rc;if(sc!==N){var Gc=sc;sc=/^CURRENT_DATE$/i.test(Gc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Gc)?{type:"current_time",mode:"timestamp"}:
{type:"column_ref",table:"",column:Gc}}Xa=sc;if(Xa===N&&(Xa=B(),Xa===N)){Xa=U;var ie=Ja();if(ie!==N){xa();var Hc=c();if(Hc!==N){xa();var je=Ma();je!==N?(Hc.paren=!0,Xa=Hc):(U=Xa,Xa=N)}else U=Xa,Xa=N}else U=Xa,Xa=N}}}}}}}}return Xa}function H(){var X;var ba=U;var ka=K();if(ka!==N){ba=[];for(X=L();X!==N;)ba.push(X),X=L();ba=ka+ba.join("")}else U=ba,ba=N;return ba}function K(){if(ke.test(p.charAt(U))){var X=p.charAt(U);U++}else X=N,0===za&&d(le);return X}function L(){if(me.test(p.charAt(U))){var X=p.charAt(U);
U++}else X=N,0===za&&d(ne);return X}function J(){if(oe.test(p.charAt(U))){var X=p.charAt(U);U++}else X=N,0===za&&d(pe);return X}function B(){var X=U;if(64===p.charCodeAt(U)){var ba=Ob;U++}else ba=N,0===za&&d(qe);if(ba!==N){var ka=H();ka!==N?X=ba=[ba,ka]:(U=X,X=N)}else U=X,X=N;X!==N&&(X={type:"param",value:X[1]});return X}function y(){var X=U;if(p.substr(U,7).toLowerCase()===re){var ba=p.substr(U,7);U+=7}else ba=N,0===za&&d(se);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==
N?X="LEADING":(U=X,X=N)}else U=X,X=N;X===N&&(X=U,p.substr(U,8).toLowerCase()===te?(ba=p.substr(U,8),U+=8):(ba=N,0===za&&d(ue)),ba!==N?(ba=U,za++,ka=L(),za--,ka===N?ba=void 0:(U=ba,ba=N),ba!==N?X="TRAILING":(U=X,X=N)):(U=X,X=N),X===N&&(X=U,p.substr(U,4).toLowerCase()===ve?(ba=p.substr(U,4),U+=4):(ba=N,0===za&&d(we)),ba!==N?(ba=U,za++,ka=L(),za--,ka===N?ba=void 0:(U=ba,ba=N),ba!==N?X="BOTH":(U=X,X=N)):(U=X,X=N)));return X}function I(){var X=U;var ba=U;var ka=S();if(ka!==N){xa();var ya=Ja();if(ya!==
N)if(xa(),ya=Y(),ya!==N){xa();var Ha=Ma();Ha!==N?ba={type:"interval-period",period:ka.value,precision:ya,secondary:null}:(U=ba,ba=N)}else U=ba,ba=N;else U=ba,ba=N}else U=ba,ba=N;ba===N&&(ba=U,ka=S(),ka!==N&&(ka=fd(ka)),ba=ka);if(ba!==N)if(xa(),ka=U,p.substr(U,2).toLowerCase()===xe?(ya=p.substr(U,2),U+=2):(ya=N,0===za&&d(ye)),ya!==N?(ya=U,za++,Ha=L(),za--,Ha===N?ya=void 0:(U=ya,ya=N),ya!==N?ka="TO":(U=ka,ka=N)):(U=ka,ka=N),ka!==N){xa();ka=U;ya=S();ya!==N&&(ya={type:"interval-period",period:ya.value,
precision:null,secondary:null});ka=ya;if(ka===N){ka=U;ya=Ba();if(ya!==N)if(xa(),ya=Ja(),ya!==N)if(xa(),ya=Y(),ya!==N)if(xa(),Ha=Ia(),Ha!==N)if(xa(),Ha=O(),Ha!==N){xa();var Oa=Ma();Oa!==N?ka=gd(ya,Ha):(U=ka,ka=N)}else U=ka,ka=N;else U=ka,ka=N;else U=ka,ka=N;else U=ka,ka=N;else U=ka,ka=N;ka===N&&(ka=U,ya=Ba(),ya!==N?(xa(),ya=Ja(),ya!==N?(xa(),ya=Y(),ya!==N?(xa(),Ha=Ma(),Ha!==N?ka={type:"interval-period",period:"second",precision:ya,secondary:null}:(U=ka,ka=N)):(U=ka,ka=N)):(U=ka,ka=N)):(U=ka,ka=N),
ka===N&&(ka=U,ya=Ba(),ya!==N&&(ya={type:"interval-period",period:"second",precision:null,secondary:null}),ka=ya))}ka!==N?X={type:"interval-qualifier",start:ba,end:ka}:(U=X,X=N)}else U=X,X=N;else U=X,X=N;X===N&&(X=U,ka=S(),ka!==N?(xa(),ba=Ja(),ba!==N?(xa(),ba=O(),ba!==N?(xa(),ya=Ma(),ya!==N?X={type:"interval-period",period:ka.value,precision:ba,secondary:null}:(U=X,X=N)):(U=X,X=N)):(U=X,X=N)):(U=X,X=N),X===N&&(X=U,ka=S(),ka!==N&&(ka=fd(ka)),X=ka,X===N&&(X=U,ka=Ba(),ka!==N?(xa(),ba=Ja(),ba!==N?(xa(),
ba=Y(),ba!==N?(xa(),ya=Ia(),ya!==N?(xa(),ka=O(),ka!==N?(xa(),ya=Ma(),ya!==N?X=gd(ba,ka):(U=X,X=N)):(U=X,X=N)):(U=X,X=N)):(U=X,X=N)):(U=X,X=N)):(U=X,X=N),X===N&&(X=U,ka=Ba(),ka!==N?(xa(),ba=Ja(),ba!==N?(xa(),ba=O(),ba!==N?(xa(),ya=Ma(),ya!==N?X={type:"interval-period",period:"second",precision:ba,secondary:null}:(U=X,X=N)):(U=X,X=N)):(U=X,X=N)):(U=X,X=N),X===N&&(X=U,ka=Ba(),ka!==N&&(ka={type:"interval-period",period:"second",precision:null,secondary:null}),X=ka)))));return X}function S(){var X=U;X=
va();X!==N&&(X={type:"string",value:"day"});X===N&&(X=U,X=wa(),X!==N&&(X={type:"string",value:"hour"}),X===N&&(X=U,X=Aa(),X!==N&&(X={type:"string",value:"minute"}),X===N&&(X=U,X=ia(),X!==N&&(X={type:"string",value:"month"}),X===N&&(X=U,X=da(),X!==N&&(X={type:"string",value:"year"})))));return X}function O(){var X=ra();X!==N&&(X=parseFloat(X));return X}function Y(){var X=ra();X!==N&&(X=parseFloat(X));return X}function R(){var X=Q();X===N&&(X=B());return X}function Q(){var X=U;if(39===p.charCodeAt(U)){var ba=
na;U++}else ba=N,0===za&&d(hd);ba===N&&(p.substr(U,2)===qa?(ba=qa,U+=2):(ba=N,0===za&&d(ze)));if(ba!==N){ba=[];var ka=U;p.substr(U,2)===ma?(ka=ma,U+=2):(ka=N,0===za&&d(id));ka!==N&&(ka="'");ka===N&&(jd.test(p.charAt(U))?(ka=p.charAt(U),U++):(ka=N,0===za&&d(kd)));for(;ka!==N;)ba.push(ka),ka=U,p.substr(U,2)===ma?(ka=ma,U+=2):(ka=N,0===za&&d(id)),ka!==N&&(ka="'"),ka===N&&(jd.test(p.charAt(U))?(ka=p.charAt(U),U++):(ka=N,0===za&&d(kd)));39===p.charCodeAt(U)?(ka=na,U++):(ka=N,0===za&&d(hd));ka!==N?X={type:"string",
value:ba.join("")}:(U=X,X=N)}else U=X,X=N;return X}function W(){var X=U;if(Fa()!==N){xa();var ba=c();if(ba!==N){xa();var ka=Ga();ka!==N?(xa(),ka=c(),ka!==N?X={type:"when_clause",operand:ba,value:ka}:(U=X,X=N)):(U=X,X=N)}else U=X,X=N}else U=X,X=N;return X}function P(){var X=U;if(Fa()!==N){xa();var ba=c();if(ba!==N){xa();var ka=Ga();ka!==N?(xa(),ka=c(),ka!==N?X={type:"when_clause",operand:ba,value:ka}:(U=X,X=N)):(U=X,X=N)}else U=X,X=N}else U=X,X=N;return X}function fa(){var X=U;var ba=U;if(p.substr(U,
4).toLowerCase()===Ae){var ka=p.substr(U,4);U+=4}else ka=N,0===za&&d(Be);if(ka!==N){ka=U;za++;var ya=L();za--;ya===N?ka=void 0:(U=ka,ka=N);ka!==N?ba="ELSE":(U=ba,ba=N)}else U=ba,ba=N;ba!==N?(xa(),ba=c(),ba!==N?X={type:"else_clause",value:ba}:(U=X,X=N)):(U=X,X=N);return X}function oa(){var X=ra();if(X===N){X=U;if(45===p.charCodeAt(U)){var ba=eb;U++}else ba=N,0===za&&d(vc);ba===N&&(43===p.charCodeAt(U)?(ba=Ta,U++):(ba=N,0===za&&d(uc)));if(ba!==N){var ka=ra();ka!==N?X=ba[0]+ka:(U=X,X=N)}else U=X,X=N}return X}
function pa(){var X=U;if(46===p.charCodeAt(U)){var ba=ta;U++}else ba=N,0===za&&d(Ce);ba!==N?(X=ra(),X===N&&(X=null),X="."+(null!=X?X:"")):(U=X,X=N);return X}function sa(){var X;var ba=X=U;if(De.test(p.charAt(U))){var ka=p.charAt(U);U++}else ka=N,0===za&&d(Ee);ka!==N?(Fe.test(p.charAt(U))?(ba=p.charAt(U),U++):(ba=N,0===za&&d(Ge)),ba===N&&(ba=null),ba="e"+(null===ba?"":ba)):(U=ba,ba=N);ba!==N?(ka=ra(),ka!==N?X=ba+ka:(U=X,X=N)):(U=X,X=N);return X}function ra(){var X=[];var ba=ua();if(ba!==N)for(;ba!==
N;)X.push(ba),ba=ua();else X=N;X!==N&&(X=X.join(""));return X}function ua(){if(He.test(p.charAt(U))){var X=p.charAt(U);U++}else X=N,0===za&&d(Ie);return X}function M(){var X=U;if(p.substr(U,2).toLowerCase()===Na){var ba=p.substr(U,2);U+=2}else ba=N,0===za&&d(Je);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="IN":(U=X,X=N)}else U=X,X=N;return X}function T(){var X=U;if(p.substr(U,2).toLowerCase()===Ya){var ba=p.substr(U,2);U+=2}else ba=N,0===za&&d(Ke);if(ba!==N){ba=U;za++;
var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="IS":(U=X,X=N)}else U=X,X=N;return X}function ha(){var X=U;if(p.substr(U,4).toLowerCase()===Wa){var ba=p.substr(U,4);U+=4}else ba=N,0===za&&d(Le);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="LIKE":(U=X,X=N)}else U=X,X=N;return X}function V(){var X=U;if(p.substr(U,3).toLowerCase()===db){var ba=p.substr(U,3);U+=3}else ba=N,0===za&&d(Me);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="NOT":
(U=X,X=N)}else U=X,X=N;return X}function Z(){var X=U;if(p.substr(U,3).toLowerCase()===lb){var ba=p.substr(U,3);U+=3}else ba=N,0===za&&d(Ne);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="AND":(U=X,X=N)}else U=X,X=N;return X}function ca(){var X=U;if(p.substr(U,2).toLowerCase()===Oe){var ba=p.substr(U,2);U+=2}else ba=N,0===za&&d(Pe);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="OR":(U=X,X=N)}else U=X,X=N;return X}function ea(){var X=U;if(p.substr(U,
7).toLowerCase()===Qe){var ba=p.substr(U,7);U+=7}else ba=N,0===za&&d(Re);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="BETWEEN":(U=X,X=N)}else U=X,X=N;return X}function ja(){var X=U;if(p.substr(U,4).toLowerCase()===Se){var ba=p.substr(U,4);U+=4}else ba=N,0===za&&d(Te);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="FROM":(U=X,X=N)}else U=X,X=N;return X}function la(){var X=U;if(p.substr(U,4).toLowerCase()===Ue){var ba=p.substr(U,4);U+=4}else ba=
N,0===za&&d(Ve);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="TRIM":(U=X,X=N)}else U=X,X=N;return X}function aa(){var X=U;if(p.substr(U,8).toLowerCase()===We){var ba=p.substr(U,8);U+=8}else ba=N,0===za&&d(Xe);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="INTERVAL":(U=X,X=N)}else U=X,X=N;return X}function da(){var X=U;if(p.substr(U,4).toLowerCase()===Ye){var ba=p.substr(U,4);U+=4}else ba=N,0===za&&d(Ze);if(ba!==N){ba=U;za++;var ka=L();za--;
ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="YEAR":(U=X,X=N)}else U=X,X=N;return X}function ia(){var X=U;if(p.substr(U,5).toLowerCase()===$e){var ba=p.substr(U,5);U+=5}else ba=N,0===za&&d(af);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="MONTH":(U=X,X=N)}else U=X,X=N;return X}function va(){var X=U;if(p.substr(U,3).toLowerCase()===bf){var ba=p.substr(U,3);U+=3}else ba=N,0===za&&d(cf);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="DAY":(U=X,X=N)}else U=
X,X=N;return X}function wa(){var X=U;if(p.substr(U,4).toLowerCase()===df){var ba=p.substr(U,4);U+=4}else ba=N,0===za&&d(ef);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="HOUR":(U=X,X=N)}else U=X,X=N;return X}function Aa(){var X=U;if(p.substr(U,6).toLowerCase()===ff){var ba=p.substr(U,6);U+=6}else ba=N,0===za&&d(gf);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="MINUTE":(U=X,X=N)}else U=X,X=N;return X}function Ba(){var X=U;if(p.substr(U,6).toLowerCase()===
hf){var ba=p.substr(U,6);U+=6}else ba=N,0===za&&d(jf);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="SECOND":(U=X,X=N)}else U=X,X=N;return X}function Da(){var X=U;if(p.substr(U,4).toLowerCase()===kf){var ba=p.substr(U,4);U+=4}else ba=N,0===za&&d(lf);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="CASE":(U=X,X=N)}else U=X,X=N;return X}function Ka(){var X=U;if(p.substr(U,3).toLowerCase()===mf){var ba=p.substr(U,3);U+=3}else ba=N,0===za&&d(nf);
if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="END":(U=X,X=N)}else U=X,X=N;return X}function Fa(){var X=U;if(p.substr(U,4).toLowerCase()===of){var ba=p.substr(U,4);U+=4}else ba=N,0===za&&d(pf);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=ba,ba=N);ba!==N?X="WHEN":(U=X,X=N)}else U=X,X=N;return X}function Ga(){var X=U;if(p.substr(U,4).toLowerCase()===qf){var ba=p.substr(U,4);U+=4}else ba=N,0===za&&d(rf);if(ba!==N){ba=U;za++;var ka=L();za--;ka===N?ba=void 0:(U=
ba,ba=N);ba!==N?X="THEN":(U=X,X=N)}else U=X,X=N;return X}function Ia(){if(44===p.charCodeAt(U)){var X=sf;U++}else X=N,0===za&&d(tf);return X}function Ja(){if(40===p.charCodeAt(U)){var X=uf;U++}else X=N,0===za&&d(vf);return X}function Ma(){if(41===p.charCodeAt(U)){var X=wf;U++}else X=N,0===za&&d(xf);return X}function xa(){var X;var ba=[];for(X=$a();X!==N;)ba.push(X),X=$a();return ba}function $a(){if(yf.test(p.charAt(U))){var X=p.charAt(U);U++}else X=N,0===za&&d(zf);return X}function Sa(X,ba,ka,ya){X=
{type:"binary_expr",operator:X,left:ba,right:ka};void 0!==ya&&(X.escape=ya);return X}function Ra(X,ba){for(var ka=0;ka<ba.length;ka++)X=Sa(ba[ka][1],X,ba[ka][3]);return X}g=void 0!==g?g:{};var N={},ab=g.grammarSource,Ua={start:b},zb=b,sb="!",jb="\x3d",Ab="\x3e\x3d",$b="\x3e",Cb="\x3c\x3d",ac="\x3c\x3e",kb="\x3c",tb="!\x3d",Ta="+",eb="-",pb="*",Qa="/",Ob="@",na="'",qa="N'",ma="''",ta=".",Ca="null",Ea="true",La="false",Na="in",Ya="is",Wa="like",Va="escape",db="not",lb="and",Oe="or",Qe="between",Se=
"from",Td="for",Od="substring",Id="extract",Ue="trim",Zd="position",Fd="timestamp",Cd="date",re="leading",te="trailing",ve="both",xe="to",We="interval",Ye="year",$e="month",bf="day",df="hour",ff="minute",hf="second",kf="case",mf="end",of="when",qf="then",Ae="else",sf=",",uf="(",wf=")",Zc="`",ke=/^[A-Za-z_\x80-\uFFFF]/,me=/^[A-Za-z0-9_]/,oe=/^[A-Za-z0-9_.\x80-\uFFFF]/,jd=/^[^']/,He=/^[0-9]/,De=/^[eE]/,Fe=/^[+\-]/,yf=/^[ \t\n\r]/,ad=/^[^`]/,ld=e("!",!1),Jc=e("\x3d",!1),nd=e("\x3e\x3d",!1),od=e("\x3e",
!1),pd=e("\x3c\x3d",!1),qd=e("\x3c\x3e",!1),rd=e("\x3c",!1),sd=e("!\x3d",!1),uc=e("+",!1),vc=e("-",!1),td=e("*",!1),ud=e("/",!1),le=l([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),ne=l([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),pe=l([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),qe=e("@",!1),hd=e("'",!1),ze=e("N'",!1),id=e("''",!1),kd=l(["'"],!0,!1),Ce=e(".",!1),Ie=l([["0","9"]],!1,!1),Ee=l(["e","E"],!1,!1),Ge=l(["+","-"],!1,!1),Ad=e("NULL",!0),wd=e("TRUE",!0),yd=e("FALSE",
!0),Je=e("IN",!0),Ke=e("IS",!0),Le=e("LIKE",!0),md=e("ESCAPE",!0),Me=e("NOT",!0),Ne=e("AND",!0),Pe=e("OR",!0),Re=e("BETWEEN",!0),Te=e("FROM",!0),Ud=e("FOR",!0),Pd=e("SUBSTRING",!0),Jd=e("EXTRACT",!0),Ve=e("TRIM",!0),$d=e("POSITION",!0),Gd=e("TIMESTAMP",!0),Dd=e("DATE",!0),se=e("LEADING",!0),ue=e("TRAILING",!0),we=e("BOTH",!0),ye=e("TO",!0),Xe=e("INTERVAL",!0),Ze=e("YEAR",!0),af=e("MONTH",!0),cf=e("DAY",!0),ef=e("HOUR",!0),gf=e("MINUTE",!0),jf=e("SECOND",!0),lf=e("CASE",!0),nf=e("END",!0),pf=e("WHEN",
!0),rf=e("THEN",!0),Be=e("ELSE",!0),tf=e(",",!1),vf=e("(",!1),xf=e(")",!1),zf=l([" ","\t","\n","\r"],!1,!1),$c=e("`",!1),bd=l(["`"],!0,!1),fd=function(X){return{type:"interval-period",period:X.value,precision:null,secondary:null}},gd=function(X,ba){return{type:"interval-period",period:"second",precision:X,secondary:ba}},U=0,Zb=[{line:1,column:1}],ob=0,tc=[],za=0;if("startRule"in g){if(!(g.startRule in Ua))throw Error("Can't start parsing from rule \""+g.startRule+'".');zb=Ua[g.startRule]}var Ic=zb();
if(Ic!==N&&U===p.length)return Ic;Ic!==N&&U<p.length&&d({type:"end"});throw function(X,ba,ka){return new w(w.buildMessage(X,ba),X,ba,ka)}(tc,ob<p.length?p.charAt(ob):null,ob<p.length?n(ob,ob+1):n(ob,ob));}}})})(C);let D=function(){function x(){}x.parse=function(w){return C.exports.parse(w)};return x}();r.WhereGrammar=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(r){r.commonjsGlobal="undefined"!==typeof globalThis?globalThis:
"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};r.commonjsRequire=function(t){throw Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');};r.getDefaultExportFromCjs=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(r,t,C,D,x,w,q){function p(a,c){if(!c)return null;if("x"in c){var f={x:0,y:0};[f.x,f.y]=a(c.x,c.y,k);null!=c.z&&(f.z=c.z);null!=c.m&&(f.m=c.m);return f}if("xmin"in c)return f={xmin:0,ymin:0,xmax:0,ymax:0},[f.xmin,f.ymin]=a(c.xmin,c.ymin,k),[f.xmax,f.ymax]=a(c.xmax,c.ymax,k),c.hasZ&&(f.zmin=c.zmin,f.zmax=c.zmax,f.hasZ=!0),c.hasM&&(f.mmin=c.mmin,f.mmax=c.mmax,f.hasM=!0),f;if("rings"in c)return{rings:g(c.rings,a),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:g(c.paths,a),hasM:c.hasM,hasZ:c.hasZ};
if("points"in c)return{points:e(c.points,a),hasM:c.hasM,hasZ:c.hasZ}}function g(a,c){const f=[];for(const m of a)f.push(e(m,c));return f}function e(a,c){const f=[];for(const m of a)a=c(m[0],m[1],[0,0]),f.push(a),2<m.length&&a.push(m[2]),3<m.length&&a.push(m[3]);return f}function l(){l=t._asyncToGenerator(function*(a,c){c&&(a=Array.isArray(a)?a.map(f=>C.isSome(f.geometry)&&f.geometry.spatialReference):[a],yield D.initializeProjection(a.map(f=>({source:f,dest:c}))))});return l.apply(this,arguments)}
const k=[0,0],n=p.bind(null,q.lngLatToXY),d=p.bind(null,q.xyToLngLat),b=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var c=a.prototype;c.push=function(){var f=t._asyncToGenerator(function*(m,h,v){if(!(m&&m.length&&h&&v)||w.equals(h,v))return m;const u={geometries:m,inSpatialReference:h,outSpatialReference:v,resolve:null};this._jobs.push(u);return new Promise(F=>{u.resolve=F;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(m,
h,v){return f.apply(this,arguments)}}();c._process=function(){this._timer=null;const f=this._jobs.shift();if(f){var {geometries:m,inSpatialReference:h,outSpatialReference:v,resolve:u}=f;q.canProject(h,v)?w.isWebMercator(v)?u(m.map(n)):u(m.map(d)):u(D.projectMany(x.jsonAdapter,m,h,v,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());r.checkProjectionSupport=function(a,c){return l.apply(this,arguments)};r.project=function(a,c,f){if(!a)return a;f||(f=c,c=a.spatialReference);
return w.isValid(c)&&w.isValid(f)&&!w.equals(c,f)?q.canProject(c,f)?w.isWebMercator(f)?n(a):d(a):D.projectMany(x.jsonAdapter,[a],c,f,null)[0]:a};r.projectMany=function(a,c,f){return b.push(a,c,f)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./projectionEllipsoid ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils ./support/zscale".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h,v,u,F,z){function A(){return!!Sa&&d.isLoaded()}function E(na){w.isNone(N)&&(N=Promise.all([d.load(),(new Promise((qa,ma)=>r(["../chunks/geometryEngineBase"],qa,ma))).then(qa=>qa.geometryEngineBase),new Promise((qa,ma)=>r(["./geometryAdapters/hydrated"],qa,ma))]));return N.then(([,qa,{hydratedAdapter:ma}])=>{q.throwIfAborted(na);Ra=ma;Sa=qa.default;Sa._enableProjection(d.pe)})}function G(na,qa,ma=null){return Array.isArray(na)?0===na.length?[]:H(Ra,
na,na[0].spatialReference,qa,ma):H(Ra,[na],na.spatialReference,qa,ma)[0]}function H(na,qa,ma,ta,Ca=null){if(w.isNone(ma)||w.isNone(ta))return qa;if(L(ma,ta,Ca))return qa.map(Ea=>w.unwrap(B(Ea,ma,ta)));if(w.isNone(Ca)){const Ea=u.cacheKey(ma,ta);void 0!==ab[Ea]?Ca=ab[Ea]:(Ca=K(ma,ta,null),w.isNone(Ca)&&(Ca=new u),ab[Ea]=Ca)}if(w.isNone(Sa))throw new Ua;return Sa._project(na,qa,ma,ta,Ca)}function K(na,qa,ma=null){if(w.isNone(Sa))throw new Ua;if(w.isNone(na)||w.isNone(qa))return null;na=Sa._getTransformation(Ra,
na,qa,ma,null==ma?void 0:ma.spatialReference);return null!==na?u.fromGE(na):null}function L(na,qa,ma){return ma?!1:F.equals(na,qa)?!0:F.isValid(na)&&F.isValid(qa)&&!!Ma(na,qa,Cb)}function J(){J=C._asyncToGenerator(function*(na,qa,ma,ta){if(!A())if(Array.isArray(na))for(const {source:Ca,dest:Ea,geographicTransformation:La}of na){if(!L(Ca,Ea,La))return E(ta)}else if(!L(na,qa,ma))return E(ta)});return J.apply(this,arguments)}function B(na,qa,ma){return na?"x"in na?y(na,qa,new b,ma,0):"xmin"in na?Y(na,
qa,new k,ma,0):"rings"in na?O(na,qa,new a,ma,0):"paths"in na?S(na,qa,new c,ma,0):"points"in na?I(na,qa,new n,ma,0):null:null}function y(na,qa,ma,ta,Ca){Qa[0]=na.x;Qa[1]=na.y;const Ea=na.z;Qa[2]=void 0!==Ea?Ea:Ca;if(!P(Qa,qa,0,Qa,ta,0,1))return null;ma.x=Qa[0];ma.y=Qa[1];ma.spatialReference=ta;void 0===Ea?(ma.z=void 0,ma.hasZ=!1):(ma.z=Qa[2],ma.hasZ=!0);void 0===na.m?(ma.m=void 0,ma.hasM=!1):(ma.m=na.m,ma.hasM=!0);return ma}function I(na,qa,ma,ta,Ca){const {points:Ea,hasZ:La,hasM:Na}=na;na=[];const Ya=
Ea.length,Wa=[];for(var Va of Ea)Wa.push(Va[0],Va[1],La?Va[2]:Ca);if(!P(Wa,qa,0,Wa,ta,0,Ya))return null;for(qa=0;qa<Ya;++qa){Ca=3*qa;Va=Wa[Ca];const db=Wa[Ca+1];La&&Na?na.push([Va,db,Wa[Ca+2],Ea[qa][3]]):La?na.push([Va,db,Wa[Ca+2]]):Na?na.push([Va,db,Ea[qa][2]]):na.push([Va,db])}ma.points=na;ma.spatialReference=ta;ma.hasZ=La;ma.hasM=Na;return ma}function S(na,qa,ma,ta,Ca){const {paths:Ea,hasZ:La,hasM:Na}=na;na=[];if(!fa(Ea,La,Na,qa,na,ta,Ca))return null;ma.paths=na;ma.spatialReference=ta;ma.hasZ=
La;ma.hasM=Na;return ma}function O(na,qa,ma,ta,Ca){const {rings:Ea,hasZ:La,hasM:Na}=na;na=[];if(!fa(Ea,La,Na,qa,na,ta,Ca))return null;ma.rings=na;ma.spatialReference=ta;ma.hasZ=La;ma.hasM=Na;return ma}function Y(na,qa,ma,ta,Ca){const {xmin:Ea,ymin:La,xmax:Na,ymax:Ya,hasZ:Wa,hasM:Va}=na;if(!R(Ea,La,Wa?na.zmin:Ca,qa,Qa,ta))return null;ma.xmin=Qa[0];ma.ymin=Qa[1];Wa&&(ma.zmin=Qa[2]);if(!R(Na,Ya,Wa?na.zmax:Ca,qa,Qa,ta))return null;ma.xmax=Qa[0];ma.ymax=Qa[1];Wa&&(ma.zmax=Qa[2]);Va&&(ma.mmin=na.mmin,ma.mmax=
na.mmax);ma.spatialReference=ta;return ma}function R(na,qa,ma,ta,Ca,Ea){Ta[0]=na;Ta[1]=qa;Ta[2]=ma;return P(Ta,ta,0,Ca,Ea,0,1)}function Q(na,qa,ma,ta){if(w.isNone(qa)||w.isNone(ta)||2>na.length)return!1;2===na.length&&(Ta[0]=na[0],Ta[1]=na[1],Ta[2]=0,na=Ta);return P(na,qa,0,ma,ta,0,1)}function W(na,qa,ma){if(w.isNone(qa))return!1;qa=ra(qa,Ab);qa=jb[qa][6];if(w.isNone(qa))return!1;qa(na,0,Ta,0);ma!==Ta&&(ma[0]=Ta[0],ma[1]=Ta[1],2<ma.length&&(ma[2]=Ta[2]));return!0}function P(na,qa,ma,ta,Ca,Ea,La=1){qa=
Ma(qa,Ca,Cb);if(w.isNone(qa))return!1;if(qa===ua){if(na===ta&&ma===Ea)return!0;La=ma+3*La;for(let Na=ma,Ya=Ea;Na<La;Na++,Ya++)ta[Ya]=na[Na];return!0}La=ma+3*La;for(let Na=ma,Ya=Ea;Na<La;Na+=3,Ya+=3)qa(na,Na,ta,Ya);return!0}function fa(na,qa,ma,ta,Ca,Ea,La=0){const Na=[];for(const Ya of na)for(const Wa of Ya)Na.push(Wa[0],Wa[1],qa?Wa[2]:La);if(!P(Na,ta,0,Na,Ea,0,Na.length/3))return!1;ta=0;Ca.length=0;for(const Ya of na){na=[];for(const Wa of Ya)qa&&ma?na.push([Na[ta++],Na[ta++],Na[ta++],Wa[3]]):qa?
na.push([Na[ta++],Na[ta++],Na[ta++]]):(ma?na.push([Na[ta++],Na[ta++],Wa[2]]):na.push([Na[ta++],Na[ta++]]),ta++);Ca.push(na)}return!0}function oa(na,qa,ma,ta){na=Math.abs(kb*na)+Math.asin(ma/(ta+qa));return na>=Math.PI/2?Number.MAX_VALUE:ma/Math.cos(na)}function pa(na,qa,ma){const ta=Math.sin(na);na=Math.cos(na);const Ca=Math.sin(qa);qa=Math.cos(qa);ma[0]=-ta;ma[4]=-Ca*na;ma[8]=qa*na;ma[12]=0;ma[1]=na;ma[5]=-Ca*ta;ma[9]=qa*ta;ma[13]=0;ma[2]=0;ma[6]=qa;ma[10]=Ca;ma[14]=0;ma[3]=0;ma[7]=0;ma[11]=0;ma[15]=
1;return ma}function sa(na,qa,ma){pa(na,qa,ma);g.transpose(ma,ma);return ma}function ra(na,qa){if(qa.spatialReference===na)return qa.spatialReferenceId;qa.spatialReference=na;"metersPerUnit"in qa&&(qa.metersPerUnit=p.getMetersPerUnitForSR(na,1));return na.wkt===f.SphericalECEFSpatialReference.wkt?qa.spatialReferenceId=1:F.isWGS84(na)?qa.spatialReferenceId=2:F.isWebMercator(na)?qa.spatialReferenceId=3:F.isPlateCarree(na)?qa.spatialReferenceId=12:na.wkt===f.WGS84ECEFSpatialReference.wkt?qa.spatialReferenceId=
4:4490===na.wkid?qa.spatialReferenceId=5:na.wkt===f.SphericalPCPFMars.wkt?qa.spatialReferenceId=7:na.wkt===f.SphericalPCPFMoon.wkt?qa.spatialReferenceId=9:F.isMars(na)?qa.spatialReferenceId=8:F.isMoon(na)?qa.spatialReferenceId=10:qa.spatialReferenceId=0}function ua(na,qa,ma,ta){na!==ma&&(ma[ta++]=na[qa++],ma[ta++]=na[qa++],ma[ta]=na[qa])}function M(na,qa,ma,ta){ma[ta++]=tb*(na[qa++]/h.earth.radius);ma[ta++]=tb*(Math.PI/2-2*Math.atan(Math.exp(-na[qa++]/h.earth.radius)));ma[ta]=na[qa]}function T(na,
qa,ma,ta){M(na,qa,ma,ta);ia(ma,ta,ma,ta)}function ha(na,qa,ma,ta){M(na,qa,ma,ta);Fa(ma,ta,ma,ta)}function V(na,qa,ma,ta,Ca){var Ea=.4999999*Math.PI;Ea=x.clamp(kb*na[qa+1],-Ea,Ea);Ea=Math.sin(Ea);ma[ta++]=kb*na[qa]*Ca.radius;ma[ta++]=Ca.halfSemiMajorAxis*Math.log((1+Ea)/(1-Ea));ma[ta]=na[qa+2]}function Z(na,qa,ma,ta){V(na,qa,ma,ta,h.earth)}function ca(na,qa,ma,ta){ma[ta]=na[qa]*zb;ma[ta+1]=na[qa+1]*zb;ma[ta+2]=na[qa+2]}function ea(na,qa,ma,ta){ma[ta]=na[qa]*sb;ma[ta+1]=na[qa+1]*sb;ma[ta+2]=na[qa+2]}
function ja(na,qa,ma,ta){M(na,qa,ma,ta);ca(ma,ta,ma,ta)}function la(na,qa,ma,ta,Ca){Ca+=na[qa+2];const Ea=kb*na[qa+1];na=kb*na[qa];qa=Math.cos(Ea);ma[ta++]=Math.cos(na)*qa*Ca;ma[ta++]=Math.sin(na)*qa*Ca;ma[ta]=Math.sin(Ea)*Ca}function aa(na,qa,ma,ta){la(na,qa,ma,ta,h.moon.radius)}function da(na,qa,ma,ta){la(na,qa,ma,ta,h.mars.radius)}function ia(na,qa,ma,ta){la(na,qa,ma,ta,h.earth.radius)}function va(na,qa,ma,ta,Ca){var Ea=na[qa];const La=na[qa+1];qa=na[qa+2];na=Math.sqrt(Ea*Ea+La*La+qa*qa);qa=x.asinClamped(qa/
(0===na?1:na));Ea=Math.atan2(La,Ea);ma[ta++]=tb*Ea;ma[ta++]=tb*qa;ma[ta]=na-Ca}function wa(na,qa,ma,ta){va(na,qa,ma,ta,h.moon.radius)}function Aa(na,qa,ma,ta){va(na,qa,ma,ta,h.mars.radius)}function Ba(na,qa,ma,ta){va(na,qa,ma,ta,h.earth.radius)}function Da(na,qa,ma,ta){Ba(na,qa,ma,ta);Z(ma,ta,ma,ta)}function Ka(na,qa,ma,ta){Ba(na,qa,ma,ta);Fa(ma,ta,ma,ta)}function Fa(na,qa,ma,ta){{var Ca=h.earth;const La=kb*na[qa];var Ea=kb*na[qa+1];na=na[qa+2];qa=Math.sin(Ea);Ea=Math.cos(Ea);const Na=Ca.radius/Math.sqrt(1-
Ca.eccentricitySquared*qa*qa);ma[ta++]=(Na+na)*Ea*Math.cos(La);ma[ta++]=(Na+na)*Ea*Math.sin(La);ma[ta++]=(Na*(1-Ca.eccentricitySquared)+na)*qa}}function Ga(na,qa,ma,ta){var Ca=v.earthEllipsoidConstants,Ea=na[qa],La=na[qa+1];na=na[qa+2];let Na;qa=Math.abs(na);var Ya=Ea*Ea+La*La;var Wa=Math.sqrt(Ya);var Va=Ya+na*na;var db=Math.sqrt(Va);Ea=Math.atan2(La,Ea);var lb=na*na/Va;Va=Ya/Va;La=Ca.a2/db;Ya=Ca.a3-Ca.a4/db;.3<Va?(lb=qa/db*(1+Va*(Ca.a1+La+lb*Ya)/db),db=Math.asin(lb),La=lb*lb,Va=Math.sqrt(1-La)):
(Va=Wa/db*(1-lb*(Ca.a5-La-Va*Ya)/db),db=Math.acos(Va),La=1-Va*Va,lb=Math.sqrt(La));Na=1-h.earth.eccentricitySquared*La;La=h.earth.radius/Math.sqrt(Na);Ca=Ca.a6*La;La=Wa-La*Va;Ya=qa-Ca*lb;qa=Va*La+lb*Ya;Wa=Va*Ya-lb*La;Ca=Wa/(Ca/Na+qa);db+=Ca;0>na&&(db=-db);ma[ta++]=tb*Ea;ma[ta++]=tb*db;ma[ta]=qa+Wa*Ca/2}function Ia(na,qa,ma,ta){Ga(na,qa,ma,ta);ia(ma,ta,ma,ta)}function Ja(na,qa,ma,ta){Ga(na,qa,ma,ta);Z(ma,ta,ma,ta)}function Ma(na,qa,ma=$a()){return w.isNone(na)||w.isNone(qa)?null:xa(na,qa,ma).projector}
function xa(na,qa,ma){if(w.isNone(na)||w.isNone(qa)||ma.source.spatialReference===na&&ma.dest.spatialReference===qa)return ma;const ta=ra(na,ma.source),Ca=ra(qa,ma.dest);0===ta&&0===Ca?F.equals(na,qa)?ma.projector=ua:ma.projector=null:ma.projector=jb[ta][Ca];return ma}function $a(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:ua}}let Sa=null,Ra=null,N=null,ab={},Ua=function(na){function qa(){return na.call(this,
"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}C._inheritsLoose(qa,na);return qa}(D);const zb=h.earth.radius*Math.PI/180,sb=180/(h.earth.radius*Math.PI),jb={[2]:{[5]:null,[8]:null,[10]:null,[11]:ua,[6]:ua,[1]:ia,[7]:null,[9]:null,[0]:null,[3]:Z,[12]:ca,[2]:ua,[4]:Fa},[5]:{[5]:ua,[8]:null,[10]:null,[11]:ua,[6]:ua,[1]:ia,[7]:null,[9]:null,[0]:null,[3]:null,[12]:ca,[2]:null,[4]:Fa},[8]:{[5]:null,[8]:ua,[10]:null,[11]:ua,[6]:null,[1]:null,[7]:da,[9]:null,[0]:null,
[3]:null,[12]:null,[2]:null,[4]:null},[10]:{[5]:null,[8]:null,[10]:ua,[11]:ua,[6]:null,[1]:null,[7]:null,[9]:aa,[0]:null,[3]:null,[12]:null,[2]:null,[4]:null},[3]:{[5]:null,[8]:null,[10]:null,[11]:M,[6]:M,[1]:T,[7]:null,[9]:null,[0]:null,[3]:ua,[12]:ja,[2]:M,[4]:ha},[4]:{[5]:Ga,[8]:null,[10]:null,[11]:Ga,[6]:Ga,[1]:Ia,[7]:null,[9]:null,[0]:null,[3]:Ja,[12]:function(na,qa,ma,ta){Ga(na,qa,ma,ta);ca(ma,ta,ma,ta)},[2]:Ga,[4]:ua},[1]:{[5]:Ba,[8]:null,[10]:null,[11]:Ba,[6]:Ba,[1]:ua,[7]:null,[9]:null,[0]:null,
[3]:Da,[12]:function(na,qa,ma,ta){Ba(na,qa,ma,ta);ca(ma,ta,ma,ta)},[2]:Ba,[4]:Ka},[7]:{[5]:null,[8]:Aa,[10]:null,[11]:Aa,[6]:null,[1]:null,[7]:ua,[9]:null,[0]:null,[3]:null,[12]:null,[2]:null,[4]:null},[9]:{[5]:null,[8]:null,[10]:wa,[11]:wa,[6]:null,[1]:null,[7]:null,[9]:ua,[0]:null,[3]:null,[12]:null,[2]:null,[4]:null},[0]:{[5]:null,[8]:null,[10]:null,[11]:null,[6]:null,[1]:null,[7]:null,[9]:null,[0]:ua,[3]:null,[12]:null,[2]:null,[4]:null},[11]:{[5]:ua,[8]:ua,[10]:ua,[11]:ua,[6]:ua,[1]:ia,[7]:da,
[9]:aa,[0]:null,[3]:Z,[12]:ca,[2]:ua,[4]:Fa},[6]:{[5]:null,[8]:null,[10]:null,[11]:ua,[6]:ua,[1]:ia,[7]:null,[9]:null,[0]:null,[3]:null,[12]:ca,[2]:ua,[4]:Fa},[12]:{[5]:ea,[8]:null,[10]:null,[11]:ea,[6]:ea,[1]:function(na,qa,ma,ta){ea(na,qa,ma,ta);ia(ma,ta,ma,ta)},[7]:null,[9]:null,[0]:null,[3]:function(na,qa,ma,ta){ea(na,qa,ma,ta);Z(ma,ta,ma,ta)},[12]:ua,[2]:ea,[4]:function(na,qa,ma,ta){ea(na,qa,ma,ta);Fa(ma,ta,ma,ta)}}},Ab={spatialReference:null,spatialReferenceId:0},$b={spatialReference:null,spatialReferenceId:0},
Cb=$a(),ac=$a(),kb=x.deg2rad(1),tb=x.rad2deg(1),Ta=l.create(),eb=l.create(),pb=l.create(),Qa=l.create(),Ob=l.create();t.canProjectToWGS84ComparableLonLat=function(na){if(w.isNone(na))return!1;na=ra(na,Ab);return!!jb[na][6]};t.canProjectWithoutEngine=L;t.computeENUToSphericalPCPFLocalRotation=pa;t.computeSphericalPCPFToENULocalRotation=sa;t.computeTranslationToOriginAndRotation=function(na,qa,ma,ta){if(w.isNone(na)||w.isNone(ta))return!1;var Ca=ra(na,Ab),Ea=ra(ta,$b);if(Ca===Ea&&1!==Ea&&7!==Ea&&9!==
Ea&&(0!==Ca||F.equals(na,ta)))return g.identity(ma),g.translate(ma,ma,qa),!0;if(1===Ea||7===Ea||9===Ea){Ca=jb[Ca][11];Ea=jb[11][Ea];if(w.isNone(Ca)||w.isNone(Ea))return!1;Ca(qa,0,eb,0);Ea(eb,0,pb,0);pa(kb*eb[0],kb*eb[1],ma);ma[12]=pb[0];ma[13]=pb[1];ma[14]=pb[2];return!0}if(!(3!==Ea&&12!==Ea||2!==Ca&&1!==Ca&&3!==Ca)){na=jb[Ca][11];Ea=jb[11][Ea];if(w.isNone(na)||w.isNone(Ea))return!1;na(qa,0,eb,0);Ea(eb,0,pb,0);1===Ca?sa(kb*eb[0],kb*eb[1],ma):g.identity(ma);ma[12]=pb[0];ma[13]=pb[1];ma[14]=pb[2];return!0}return!1};
t.getProjectorName=function(na,qa){switch(Ma(na,qa,Cb)){case ua:return"copy3";case ia:return"wgs84ToSphericalECEF";case Z:return"wgs84ToWebMercator";case ca:return"wgs84ToPlateCarree";case Fa:return"wgs84ToWGS84ECEF";case M:return"webMercatorToWGS84";case T:return"webMercatorToSphericalECEF";case ha:return"webMercatorToWGS84ECEF";case ja:return"webMercatorToPlateCarree";case Ga:return"wgs84ECEFToWGS84";case Ia:return"wgs84ECEFToSphericalECEF";case Ja:return"wgs84ECEFToWebMercator";case Ba:return"sphericalECEFToWGS84";
case Da:return"sphericalECEFToWebMercator";case Aa:return"sphericalMarsPCPFToMars2000";case wa:return"sphericalMoonPCPFToMoon2000";case Ka:return"sphericalECEFToWGS84ECEF";case da:return"mars2000ToSphericalPCPF";case aa:return"moon2000ToSphericalPCPF";default:return null}};t.getTransformation=K;t.getTransformations=function(na,qa,ma=null){if(w.isNone(Sa))throw new Ua;na=Sa._getTransformationBySuitability(Ra,na,qa,ma,null==ma?void 0:ma.spatialReference);if(null!==na){qa=[];for(const ta of na)qa.push(u.fromGE(ta));
return qa}return[]};t.initializeProjection=function(na,qa,ma,ta){return J.apply(this,arguments)};t.isLoaded=A;t.load=E;t.localLinearScaleFactors=function(na,qa,ma,ta){if(w.isNone(qa)||w.isNone(ta))return!1;const Ca=ra(qa,Ab);var Ea=ra(ta,$b);if(Ca===Ea&&0!==Ca||F.equals(qa,ta))return ma[0]=1,ma[1]=1,ma[2]=1,!0;if(1===Ca){qa=e.length(na);na=qa/Math.sqrt(na[0]*na[0]+na[1]*na[1]);qa/=h.earth.radius;if(3===Ea)return ma[0]=na*qa,ma[1]=na*qa,ma[2]=1,!0;if(2===Ea||5===Ea)return Ea=180/(h.earth.radius*Math.PI),
ma[0]=Ea*na*qa,ma[1]=Ea*qa,ma[2]=1,!0}else if(12===Ca&&(2===Ea||5===Ea))return ma[0]=sb,ma[1]=sb,ma[2]=1,!0;return!1};t.lonLatToSphericalPCPF=function(na,qa,ma,ta,Ca=0){ta+=Ca;Ca=Math.cos(ma);na[0]=Math.cos(qa)*Ca*ta;na[1]=Math.sin(qa)*Ca*ta;na[2]=Math.sin(ma)*ta};t.lonLatToWebMercatorComparable=V;t.project=G;t.projectBoundingRect=function(na,qa,ma,ta){if(null==na)return!1;if(F.equals(qa,ta))return m.copy(ma,na),!0;Ta[0]=na[0];Ta[1]=na[1];Ta[2]=0;if(!P(Ta,qa,0,Ta,ta,0,1))return!1;ma[0]=Ta[0];ma[1]=
Ta[1];Ta[0]=na[2];Ta[1]=na[3];Ta[2]=0;if(!P(Ta,qa,0,Ta,ta,0,1))return!1;ma[2]=Ta[0];ma[3]=Ta[1];return!0};t.projectBoundingSphere=function(na,qa,ma,ta){if(w.isNone(qa)||w.isNone(ta))return!1;qa=xa(qa,ta,ac);if(qa.projector===ua)return ma[0]=na[0],ma[1]=na[1],ma[2]=na[2],ma[3]=na[3],!0;if(w.isNone(qa.projector))return!1;const {source:Ca,dest:Ea}=qa;if(3===Ea.spatialReferenceId){qa=jb[Ca.spatialReferenceId][2];if(w.isNone(qa))return!1;qa(na,0,eb,0);Z(eb,0,ma,0);ma[3]=oa(eb[1],na[2],na[3],h.earth.radius);
return!0}if(2!==Ca.spatialReferenceId&&5!==Ca.spatialReferenceId||12!==Ea.spatialReferenceId)qa.projector(na,0,ma,0),ma[3]=na[3]*Ca.metersPerUnit/Ea.metersPerUnit;else{ta=jb[1][12];let La=na[3];w.isSome(jb[Ca.spatialReferenceId][1])&&w.isSome(ta)&&(La=oa(na[1],na[2],na[3],h.earth.radius));qa.projector(na,0,ma,0);ma[3]=La}return!0};t.projectBuffer=P;t.projectDirection=function(na,qa,ma,ta,Ca){e.copy(Qa,na);e.add(Ob,na,qa);Q(Qa,ma,Qa,Ca);Q(Ob,ma,Ob,Ca);e.subtract(ta,Ob,Qa);e.normalize(ta,ta)};t.projectExtent=
function(na,qa,ma=qa.spatialReference,ta=0){return w.isSome(ma)&&w.isSome(Y(na,na.spatialReference,qa,ma,ta))};t.projectMany=H;t.projectMultipoint=function(na,qa,ma=qa.spatialReference,ta=0){return w.isNone(ma)?!1:w.isSome(I(na,na.spatialReference,qa,ma,ta))};t.projectPoint=function(na,qa,ma=qa.spatialReference,ta=0){return w.isNone(ma)?!1:w.isSome(y(na,na.spatialReference,qa,ma,ta))};t.projectPointToVector=function(na,qa,ma,ta=0){Qa[0]=na.x;Qa[1]=na.y;const Ca=na.z;Qa[2]=void 0!==Ca?Ca:ta;return P(Qa,
na.spatialReference,0,qa,ma,0,1)};t.projectPointToWGS84ComparableLonLat=function(na,qa){Qa[0]=na.x;Qa[1]=na.y;const ma=na.z;Qa[2]=void 0!==ma?ma:0;return W(Qa,na.spatialReference,qa)};t.projectPolygon=function(na,qa,ma=qa.spatialReference,ta=0){return w.isSome(ma)&&w.isSome(O(na,na.spatialReference,qa,ma,ta))};t.projectPolyline=function(na,qa,ma=qa.spatialReference,ta=0){return w.isSome(ma)&&w.isSome(S(na,na.spatialReference,qa,ma,ta))};t.projectVectorToDehydratedPoint=function(na,qa,ma){return P(na,
qa,0,Qa,ma.spatialReference,0,1)?(ma.x=Qa[0],ma.y=Qa[1],ma.z=Qa[2],ma):null};t.projectVectorToPoint=function(na,qa,ma){if(w.isNone(qa)||w.isNone(ma))return null;const ta=new b({spatialReference:ma});return P(na,qa,0,Qa,ma,0,1)?(ta.x=Qa[0],ta.y=Qa[1],ta.z=Qa[2],ta):null};t.projectVectorToVector=Q;t.projectVectorToWGS84ComparableLonLat=function(na,qa,ma){return W(na,qa,ma)};t.projectWithoutEngine=B;t.projectXYZToVector=R;t.sphericalPCPFtoLonLatElevation=va;t.tryProjectWithZConversion=function(na,qa){try{const ma=
G(na,qa);if(null==ma)return null;"xmin"in na&&"xmin"in ma&&(ma.zmin=na.zmin,ma.zmax=na.zmax);const ta=z.getGeometryZScaler(ma.type,na.spatialReference,qa);w.isSome(ta)&&ta(ma);return ma}catch(ma){if(!(ma instanceof Ua))throw ma;return null}};t.unload=function(){N=Ra=Sa=null;ab={}};Object.defineProperty(t,"__esModule",{value:!0})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(r,t,C){function D(M,T){M[0]=T[0];M[1]=T[1];M[2]=T[2];M[3]=T[3];M[4]=T[4];M[5]=T[5];M[6]=
T[6];M[7]=T[7];M[8]=T[8];M[9]=T[9];M[10]=T[10];M[11]=T[11];M[12]=T[12];M[13]=T[13];M[14]=T[14];M[15]=T[15];return M}function x(M,T,ha,V,Z,ca,ea,ja,la,aa,da,ia,va,wa,Aa,Ba,Da){M[0]=T;M[1]=ha;M[2]=V;M[3]=Z;M[4]=ca;M[5]=ea;M[6]=ja;M[7]=la;M[8]=aa;M[9]=da;M[10]=ia;M[11]=va;M[12]=wa;M[13]=Aa;M[14]=Ba;M[15]=Da;return M}function w(M){M[0]=1;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=1;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=1;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function q(M,T){if(M===T){const ha=T[1],V=T[2],
Z=T[3],ca=T[6],ea=T[7],ja=T[11];M[1]=T[4];M[2]=T[8];M[3]=T[12];M[4]=ha;M[6]=T[9];M[7]=T[13];M[8]=V;M[9]=ca;M[11]=T[14];M[12]=Z;M[13]=ea;M[14]=ja}else M[0]=T[0],M[1]=T[4],M[2]=T[8],M[3]=T[12],M[4]=T[1],M[5]=T[5],M[6]=T[9],M[7]=T[13],M[8]=T[2],M[9]=T[6],M[10]=T[10],M[11]=T[14],M[12]=T[3],M[13]=T[7],M[14]=T[11],M[15]=T[15];return M}function p(M,T){const ha=T[0],V=T[1],Z=T[2],ca=T[3],ea=T[4],ja=T[5],la=T[6],aa=T[7],da=T[8],ia=T[9],va=T[10],wa=T[11],Aa=T[12],Ba=T[13],Da=T[14];T=T[15];const Ka=ha*ja-V*
ea,Fa=ha*la-Z*ea,Ga=ha*aa-ca*ea,Ia=V*la-Z*ja,Ja=V*aa-ca*ja,Ma=Z*aa-ca*la,xa=da*Ba-ia*Aa,$a=da*Da-va*Aa,Sa=da*T-wa*Aa,Ra=ia*Da-va*Ba,N=ia*T-wa*Ba,ab=va*T-wa*Da;let Ua=Ka*ab-Fa*N+Ga*Ra+Ia*Sa-Ja*$a+Ma*xa;if(!Ua)return null;Ua=1/Ua;M[0]=(ja*ab-la*N+aa*Ra)*Ua;M[1]=(Z*N-V*ab-ca*Ra)*Ua;M[2]=(Ba*Ma-Da*Ja+T*Ia)*Ua;M[3]=(va*Ja-ia*Ma-wa*Ia)*Ua;M[4]=(la*Sa-ea*ab-aa*$a)*Ua;M[5]=(ha*ab-Z*Sa+ca*$a)*Ua;M[6]=(Da*Ga-Aa*Ma-T*Fa)*Ua;M[7]=(da*Ma-va*Ga+wa*Fa)*Ua;M[8]=(ea*N-ja*Sa+aa*xa)*Ua;M[9]=(V*Sa-ha*N-ca*xa)*Ua;M[10]=
(Aa*Ja-Ba*Ga+T*Ka)*Ua;M[11]=(ia*Ga-da*Ja-wa*Ka)*Ua;M[12]=(ja*$a-ea*Ra-la*xa)*Ua;M[13]=(ha*Ra-V*$a+Z*xa)*Ua;M[14]=(Ba*Fa-Aa*Ia-Da*Ka)*Ua;M[15]=(da*Ia-ia*Fa+va*Ka)*Ua;return M}function g(M,T){const ha=T[0],V=T[1],Z=T[2],ca=T[3],ea=T[4],ja=T[5],la=T[6],aa=T[7],da=T[8],ia=T[9],va=T[10],wa=T[11],Aa=T[12],Ba=T[13],Da=T[14];T=T[15];M[0]=ja*(va*T-wa*Da)-ia*(la*T-aa*Da)+Ba*(la*wa-aa*va);M[1]=-(V*(va*T-wa*Da)-ia*(Z*T-ca*Da)+Ba*(Z*wa-ca*va));M[2]=V*(la*T-aa*Da)-ja*(Z*T-ca*Da)+Ba*(Z*aa-ca*la);M[3]=-(V*(la*wa-
aa*va)-ja*(Z*wa-ca*va)+ia*(Z*aa-ca*la));M[4]=-(ea*(va*T-wa*Da)-da*(la*T-aa*Da)+Aa*(la*wa-aa*va));M[5]=ha*(va*T-wa*Da)-da*(Z*T-ca*Da)+Aa*(Z*wa-ca*va);M[6]=-(ha*(la*T-aa*Da)-ea*(Z*T-ca*Da)+Aa*(Z*aa-ca*la));M[7]=ha*(la*wa-aa*va)-ea*(Z*wa-ca*va)+da*(Z*aa-ca*la);M[8]=ea*(ia*T-wa*Ba)-da*(ja*T-aa*Ba)+Aa*(ja*wa-aa*ia);M[9]=-(ha*(ia*T-wa*Ba)-da*(V*T-ca*Ba)+Aa*(V*wa-ca*ia));M[10]=ha*(ja*T-aa*Ba)-ea*(V*T-ca*Ba)+Aa*(V*aa-ca*ja);M[11]=-(ha*(ja*wa-aa*ia)-ea*(V*wa-ca*ia)+da*(V*aa-ca*ja));M[12]=-(ea*(ia*Da-va*Ba)-
da*(ja*Da-la*Ba)+Aa*(ja*va-la*ia));M[13]=ha*(ia*Da-va*Ba)-da*(V*Da-Z*Ba)+Aa*(V*va-Z*ia);M[14]=-(ha*(ja*Da-la*Ba)-ea*(V*Da-Z*Ba)+Aa*(V*la-Z*ja));M[15]=ha*(ja*va-la*ia)-ea*(V*va-Z*ia)+da*(V*la-Z*ja);return M}function e(M){const T=M[0],ha=M[1],V=M[2],Z=M[3],ca=M[4],ea=M[5],ja=M[6],la=M[7],aa=M[8],da=M[9],ia=M[10],va=M[11],wa=M[12],Aa=M[13],Ba=M[14];M=M[15];return(T*ea-ha*ca)*(ia*M-va*Ba)-(T*ja-V*ca)*(da*M-va*Aa)+(T*la-Z*ca)*(da*Ba-ia*Aa)+(ha*ja-V*ea)*(aa*M-va*wa)-(ha*la-Z*ea)*(aa*Ba-ia*wa)+(V*la-Z*ja)*
(aa*Aa-da*wa)}function l(M,T,ha){const V=T[0],Z=T[1],ca=T[2],ea=T[3],ja=T[4],la=T[5],aa=T[6],da=T[7],ia=T[8],va=T[9],wa=T[10],Aa=T[11],Ba=T[12],Da=T[13],Ka=T[14];T=T[15];let Fa=ha[0],Ga=ha[1],Ia=ha[2],Ja=ha[3];M[0]=Fa*V+Ga*ja+Ia*ia+Ja*Ba;M[1]=Fa*Z+Ga*la+Ia*va+Ja*Da;M[2]=Fa*ca+Ga*aa+Ia*wa+Ja*Ka;M[3]=Fa*ea+Ga*da+Ia*Aa+Ja*T;Fa=ha[4];Ga=ha[5];Ia=ha[6];Ja=ha[7];M[4]=Fa*V+Ga*ja+Ia*ia+Ja*Ba;M[5]=Fa*Z+Ga*la+Ia*va+Ja*Da;M[6]=Fa*ca+Ga*aa+Ia*wa+Ja*Ka;M[7]=Fa*ea+Ga*da+Ia*Aa+Ja*T;Fa=ha[8];Ga=ha[9];Ia=ha[10];Ja=
ha[11];M[8]=Fa*V+Ga*ja+Ia*ia+Ja*Ba;M[9]=Fa*Z+Ga*la+Ia*va+Ja*Da;M[10]=Fa*ca+Ga*aa+Ia*wa+Ja*Ka;M[11]=Fa*ea+Ga*da+Ia*Aa+Ja*T;Fa=ha[12];Ga=ha[13];Ia=ha[14];Ja=ha[15];M[12]=Fa*V+Ga*ja+Ia*ia+Ja*Ba;M[13]=Fa*Z+Ga*la+Ia*va+Ja*Da;M[14]=Fa*ca+Ga*aa+Ia*wa+Ja*Ka;M[15]=Fa*ea+Ga*da+Ia*Aa+Ja*T;return M}function k(M,T,ha){const V=ha[0],Z=ha[1];ha=ha[2];let ca=void 0,ea=void 0,ja=void 0,la=void 0,aa=void 0,da=void 0,ia=void 0,va=void 0,wa=void 0,Aa=void 0,Ba=void 0,Da=void 0;T===M?(M[12]=T[0]*V+T[4]*Z+T[8]*ha+T[12],
M[13]=T[1]*V+T[5]*Z+T[9]*ha+T[13],M[14]=T[2]*V+T[6]*Z+T[10]*ha+T[14],M[15]=T[3]*V+T[7]*Z+T[11]*ha+T[15]):(ca=T[0],ea=T[1],ja=T[2],la=T[3],aa=T[4],da=T[5],ia=T[6],va=T[7],wa=T[8],Aa=T[9],Ba=T[10],Da=T[11],M[0]=ca,M[1]=ea,M[2]=ja,M[3]=la,M[4]=aa,M[5]=da,M[6]=ia,M[7]=va,M[8]=wa,M[9]=Aa,M[10]=Ba,M[11]=Da,M[12]=ca*V+aa*Z+wa*ha+T[12],M[13]=ea*V+da*Z+Aa*ha+T[13],M[14]=ja*V+ia*Z+Ba*ha+T[14],M[15]=la*V+va*Z+Da*ha+T[15]);return M}function n(M,T,ha){const V=ha[0],Z=ha[1];ha=ha[2];M[0]=T[0]*V;M[1]=T[1]*V;M[2]=
T[2]*V;M[3]=T[3]*V;M[4]=T[4]*Z;M[5]=T[5]*Z;M[6]=T[6]*Z;M[7]=T[7]*Z;M[8]=T[8]*ha;M[9]=T[9]*ha;M[10]=T[10]*ha;M[11]=T[11]*ha;M[12]=T[12];M[13]=T[13];M[14]=T[14];M[15]=T[15];return M}function d(M,T,ha,V){let Z=V[0],ca=V[1];V=V[2];let ea=Math.sqrt(Z*Z+ca*ca+V*V);var ja=void 0,la=void 0;let aa=void 0,da=void 0,ia=void 0,va=void 0,wa=void 0,Aa=void 0,Ba=void 0,Da=void 0,Ka=void 0,Fa=void 0,Ga=void 0,Ia=void 0,Ja=void 0,Ma=void 0,xa=void 0,$a=void 0,Sa=void 0,Ra=void 0,N=void 0,ab=void 0;la=ja=void 0;if(ea<
C.EPSILON)return null;ea=1/ea;Z*=ea;ca*=ea;V*=ea;ja=Math.sin(ha);la=Math.cos(ha);aa=1-la;da=T[0];ia=T[1];va=T[2];wa=T[3];Aa=T[4];Ba=T[5];Da=T[6];Ka=T[7];Fa=T[8];Ga=T[9];Ia=T[10];Ja=T[11];Ma=Z*Z*aa+la;xa=ca*Z*aa+V*ja;$a=V*Z*aa-ca*ja;Sa=Z*ca*aa-V*ja;Ra=ca*ca*aa+la;N=V*ca*aa+Z*ja;ab=Z*V*aa+ca*ja;ja=ca*V*aa-Z*ja;la=V*V*aa+la;M[0]=da*Ma+Aa*xa+Fa*$a;M[1]=ia*Ma+Ba*xa+Ga*$a;M[2]=va*Ma+Da*xa+Ia*$a;M[3]=wa*Ma+Ka*xa+Ja*$a;M[4]=da*Sa+Aa*Ra+Fa*N;M[5]=ia*Sa+Ba*Ra+Ga*N;M[6]=va*Sa+Da*Ra+Ia*N;M[7]=wa*Sa+Ka*Ra+Ja*
N;M[8]=da*ab+Aa*ja+Fa*la;M[9]=ia*ab+Ba*ja+Ga*la;M[10]=va*ab+Da*ja+Ia*la;M[11]=wa*ab+Ka*ja+Ja*la;T!==M&&(M[12]=T[12],M[13]=T[13],M[14]=T[14],M[15]=T[15]);return M}function b(M,T,ha){const V=Math.sin(ha);ha=Math.cos(ha);const Z=T[4],ca=T[5],ea=T[6],ja=T[7],la=T[8],aa=T[9],da=T[10],ia=T[11];T!==M&&(M[0]=T[0],M[1]=T[1],M[2]=T[2],M[3]=T[3],M[12]=T[12],M[13]=T[13],M[14]=T[14],M[15]=T[15]);M[4]=Z*ha+la*V;M[5]=ca*ha+aa*V;M[6]=ea*ha+da*V;M[7]=ja*ha+ia*V;M[8]=la*ha-Z*V;M[9]=aa*ha-ca*V;M[10]=da*ha-ea*V;M[11]=
ia*ha-ja*V;return M}function a(M,T,ha){const V=Math.sin(ha);ha=Math.cos(ha);const Z=T[0],ca=T[1],ea=T[2],ja=T[3],la=T[8],aa=T[9],da=T[10],ia=T[11];T!==M&&(M[4]=T[4],M[5]=T[5],M[6]=T[6],M[7]=T[7],M[12]=T[12],M[13]=T[13],M[14]=T[14],M[15]=T[15]);M[0]=Z*ha-la*V;M[1]=ca*ha-aa*V;M[2]=ea*ha-da*V;M[3]=ja*ha-ia*V;M[8]=Z*V+la*ha;M[9]=ca*V+aa*ha;M[10]=ea*V+da*ha;M[11]=ja*V+ia*ha;return M}function c(M,T,ha){const V=Math.sin(ha);ha=Math.cos(ha);const Z=T[0],ca=T[1],ea=T[2],ja=T[3],la=T[4],aa=T[5],da=T[6],ia=
T[7];T!==M&&(M[8]=T[8],M[9]=T[9],M[10]=T[10],M[11]=T[11],M[12]=T[12],M[13]=T[13],M[14]=T[14],M[15]=T[15]);M[0]=Z*ha+la*V;M[1]=ca*ha+aa*V;M[2]=ea*ha+da*V;M[3]=ja*ha+ia*V;M[4]=la*ha-Z*V;M[5]=aa*ha-ca*V;M[6]=da*ha-ea*V;M[7]=ia*ha-ja*V;return M}function f(M,T){M[0]=1;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=1;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=1;M[11]=0;M[12]=T[0];M[13]=T[1];M[14]=T[2];M[15]=1;return M}function m(M,T){M[0]=T[0];M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=T[1];M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=T[2];M[11]=
0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function h(M,T,ha){let V=ha[0],Z=ha[1];ha=ha[2];let ca=Math.sqrt(V*V+Z*Z+ha*ha),ea=void 0,ja=void 0,la=void 0;if(ca<C.EPSILON)return null;ca=1/ca;V*=ca;Z*=ca;ha*=ca;ea=Math.sin(T);ja=Math.cos(T);la=1-ja;M[0]=V*V*la+ja;M[1]=Z*V*la+ha*ea;M[2]=ha*V*la-Z*ea;M[3]=0;M[4]=V*Z*la-ha*ea;M[5]=Z*Z*la+ja;M[6]=ha*Z*la+V*ea;M[7]=0;M[8]=V*ha*la+Z*ea;M[9]=Z*ha*la-V*ea;M[10]=ha*ha*la+ja;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function v(M,T){const ha=Math.sin(T);
T=Math.cos(T);M[0]=1;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=T;M[6]=ha;M[7]=0;M[8]=0;M[9]=-ha;M[10]=T;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function u(M,T){const ha=Math.sin(T);T=Math.cos(T);M[0]=T;M[1]=0;M[2]=-ha;M[3]=0;M[4]=0;M[5]=1;M[6]=0;M[7]=0;M[8]=ha;M[9]=0;M[10]=T;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function F(M,T){const ha=Math.sin(T);T=Math.cos(T);M[0]=T;M[1]=ha;M[2]=0;M[3]=0;M[4]=-ha;M[5]=T;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=1;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}
function z(M,T,ha){var V=T[0],Z=T[1],ca=T[2],ea=T[3],ja=V+V,la=Z+Z;const aa=ca+ca;T=V*ja;const da=V*la;V*=aa;const ia=Z*la;Z*=aa;ca*=aa;ja*=ea;la*=ea;ea*=aa;M[0]=1-(ia+ca);M[1]=da+ea;M[2]=V-la;M[3]=0;M[4]=da-ea;M[5]=1-(T+ca);M[6]=Z+ja;M[7]=0;M[8]=V+la;M[9]=Z-ja;M[10]=1-(T+ia);M[11]=0;M[12]=ha[0];M[13]=ha[1];M[14]=ha[2];M[15]=1;return M}function A(M,T){const ha=ua,V=-T[0],Z=-T[1],ca=-T[2],ea=T[3],ja=T[4],la=T[5],aa=T[6],da=T[7],ia=V*V+Z*Z+ca*ca+ea*ea;0<ia?(ha[0]=2*(ja*ea+da*V+la*ca-aa*Z)/ia,ha[1]=
2*(la*ea+da*Z+aa*V-ja*ca)/ia,ha[2]=2*(aa*ea+da*ca+ja*Z-la*V)/ia):(ha[0]=2*(ja*ea+da*V+la*ca-aa*Z),ha[1]=2*(la*ea+da*Z+aa*V-ja*ca),ha[2]=2*(aa*ea+da*ca+ja*Z-la*V));z(M,T,ha);return M}function E(M,T){M[0]=T[12];M[1]=T[13];M[2]=T[14];return M}function G(M,T){const ha=T[0],V=T[1],Z=T[2],ca=T[4],ea=T[5],ja=T[6],la=T[8],aa=T[9];T=T[10];M[0]=Math.sqrt(ha*ha+V*V+Z*Z);M[1]=Math.sqrt(ca*ca+ea*ea+ja*ja);M[2]=Math.sqrt(la*la+aa*aa+T*T);return M}function H(M,T){const ha=T[0]+T[5]+T[10];let V=0;0<ha?(V=2*Math.sqrt(ha+
1),M[3]=.25*V,M[0]=(T[6]-T[9])/V,M[1]=(T[8]-T[2])/V,M[2]=(T[1]-T[4])/V):T[0]>T[5]&&T[0]>T[10]?(V=2*Math.sqrt(1+T[0]-T[5]-T[10]),M[3]=(T[6]-T[9])/V,M[0]=.25*V,M[1]=(T[1]+T[4])/V,M[2]=(T[8]+T[2])/V):T[5]>T[10]?(V=2*Math.sqrt(1+T[5]-T[0]-T[10]),M[3]=(T[8]-T[2])/V,M[0]=(T[1]+T[4])/V,M[1]=.25*V,M[2]=(T[6]+T[9])/V):(V=2*Math.sqrt(1+T[10]-T[0]-T[5]),M[3]=(T[1]-T[4])/V,M[0]=(T[8]+T[2])/V,M[1]=(T[6]+T[9])/V,M[2]=.25*V);return M}function K(M,T,ha,V){var Z=T[0],ca=T[1],ea=T[2],ja=T[3],la=Z+Z,aa=ca+ca,da=ea+
ea;T=Z*la;const ia=Z*aa;Z*=da;const va=ca*aa;ca*=da;ea*=da;la*=ja;aa*=ja;ja*=da;da=V[0];const wa=V[1];V=V[2];M[0]=(1-(va+ea))*da;M[1]=(ia+ja)*da;M[2]=(Z-aa)*da;M[3]=0;M[4]=(ia-ja)*wa;M[5]=(1-(T+ea))*wa;M[6]=(ca+la)*wa;M[7]=0;M[8]=(Z+aa)*V;M[9]=(ca-la)*V;M[10]=(1-(T+va))*V;M[11]=0;M[12]=ha[0];M[13]=ha[1];M[14]=ha[2];M[15]=1;return M}function L(M,T,ha,V,Z){var ca=T[0],ea=T[1],ja=T[2],la=T[3],aa=ca+ca,da=ea+ea,ia=ja+ja;T=ca*aa;var va=ca*da,wa=ca*ia;ca=ea*da;ea*=ia;var Aa=ja*ia;ja=la*aa;da*=la;const Ba=
la*ia;var Da=V[0],Ka=V[1];ia=V[2];V=Z[0];la=Z[1];Z=Z[2];aa=(1-(ca+Aa))*Da;const Fa=(va+Ba)*Da;Da*=wa-da;va=(va-Ba)*Ka;Aa=(1-(T+Aa))*Ka;Ka*=ea+ja;wa=(wa+da)*ia;ea=(ea-ja)*ia;T=(1-(T+ca))*ia;M[0]=aa;M[1]=Fa;M[2]=Da;M[3]=0;M[4]=va;M[5]=Aa;M[6]=Ka;M[7]=0;M[8]=wa;M[9]=ea;M[10]=T;M[11]=0;M[12]=ha[0]+V-(aa*V+va*la+wa*Z);M[13]=ha[1]+la-(Fa*V+Aa*la+ea*Z);M[14]=ha[2]+Z-(Da*V+Ka*la+T*Z);M[15]=1;return M}function J(M,T){var ha=T[0],V=T[1],Z=T[2];T=T[3];var ca=ha+ha,ea=V+V;const ja=Z+Z;ha*=ca;const la=V*ca;V*=
ea;const aa=Z*ca,da=Z*ea;Z*=ja;ca*=T;ea*=T;T*=ja;M[0]=1-V-Z;M[1]=la+T;M[2]=aa-ea;M[3]=0;M[4]=la-T;M[5]=1-ha-Z;M[6]=da+ca;M[7]=0;M[8]=aa+ea;M[9]=da-ca;M[10]=1-ha-V;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function B(M,T,ha,V,Z,ca,ea){const ja=1/(ha-T),la=1/(Z-V),aa=1/(ca-ea);M[0]=2*ca*ja;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=2*ca*la;M[6]=0;M[7]=0;M[8]=(ha+T)*ja;M[9]=(Z+V)*la;M[10]=(ea+ca)*aa;M[11]=-1;M[12]=0;M[13]=0;M[14]=ea*ca*2*aa;M[15]=0;return M}function y(M,T,ha,V,Z){T=1/Math.tan(T/2);let ca=
void 0;M[0]=T/ha;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=T;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[11]=-1;M[12]=0;M[13]=0;M[15]=0;null!=Z&&Infinity!==Z?(ca=1/(V-Z),M[10]=(Z+V)*ca,M[14]=2*Z*V*ca):(M[10]=-1,M[14]=-2*V);return M}function I(M,T,ha,V){const Z=Math.tan(T.upDegrees*Math.PI/180),ca=Math.tan(T.downDegrees*Math.PI/180),ea=Math.tan(T.leftDegrees*Math.PI/180);T=Math.tan(T.rightDegrees*Math.PI/180);const ja=2/(ea+T),la=2/(Z+ca);M[0]=ja;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=la;M[6]=0;M[7]=0;M[8]=-((ea-T)*ja*.5);M[9]=
(Z-ca)*la*.5;M[10]=V/(ha-V);M[11]=-1;M[12]=0;M[13]=0;M[14]=V*ha/(ha-V);M[15]=0;return M}function S(M,T,ha,V,Z,ca,ea){const ja=1/(T-ha),la=1/(V-Z),aa=1/(ca-ea);M[0]=-2*ja;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=-2*la;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=2*aa;M[11]=0;M[12]=(T+ha)*ja;M[13]=(Z+V)*la;M[14]=(ea+ca)*aa;M[15]=1;return M}function O(M,T,ha,V){let Z=void 0,ca=void 0;var ea=void 0,ja=void 0;let la=void 0,aa=void 0;var da=void 0,ia=void 0;let va=void 0,wa=void 0;const Aa=T[0],Ba=T[1];T=T[2];ea=V[0];ja=
V[1];V=V[2];da=ha[0];ia=ha[1];ha=ha[2];if(Math.abs(Aa-da)<C.EPSILON&&Math.abs(Ba-ia)<C.EPSILON&&Math.abs(T-ha)<C.EPSILON)return w(M);da=Aa-da;ia=Ba-ia;va=T-ha;wa=1/Math.sqrt(da*da+ia*ia+va*va);da*=wa;ia*=wa;va*=wa;Z=ja*va-V*ia;ca=V*da-ea*va;ea=ea*ia-ja*da;(wa=Math.sqrt(Z*Z+ca*ca+ea*ea))?(wa=1/wa,Z*=wa,ca*=wa,ea*=wa):ea=ca=Z=0;ja=ia*ea-va*ca;la=va*Z-da*ea;aa=da*ca-ia*Z;(wa=Math.sqrt(ja*ja+la*la+aa*aa))?(wa=1/wa,ja*=wa,la*=wa,aa*=wa):aa=la=ja=0;M[0]=Z;M[1]=ja;M[2]=da;M[3]=0;M[4]=ca;M[5]=la;M[6]=ia;
M[7]=0;M[8]=ea;M[9]=aa;M[10]=va;M[11]=0;M[12]=-(Z*Aa+ca*Ba+ea*T);M[13]=-(ja*Aa+la*Ba+aa*T);M[14]=-(da*Aa+ia*Ba+va*T);M[15]=1;return M}function Y(M,T,ha,V){const Z=T[0],ca=T[1];T=T[2];var ea=V[0];const ja=V[1];var la=V[2];V=Z-ha[0];let aa=ca-ha[1];ha=T-ha[2];let da=V*V+aa*aa+ha*ha;0<da&&(da=1/Math.sqrt(da),V*=da,aa*=da,ha*=da);let ia=ja*ha-la*aa;la=la*V-ea*ha;ea=ea*aa-ja*V;da=ia*ia+la*la+ea*ea;0<da&&(da=1/Math.sqrt(da),ia*=da,la*=da,ea*=da);M[0]=ia;M[1]=la;M[2]=ea;M[3]=0;M[4]=aa*ea-ha*la;M[5]=ha*ia-
V*ea;M[6]=V*la-aa*ia;M[7]=0;M[8]=V;M[9]=aa;M[10]=ha;M[11]=0;M[12]=Z;M[13]=ca;M[14]=T;M[15]=1;return M}function R(M){return"mat4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+", "+M[4]+", "+M[5]+", "+M[6]+", "+M[7]+", "+M[8]+", "+M[9]+", "+M[10]+", "+M[11]+", "+M[12]+", "+M[13]+", "+M[14]+", "+M[15]+")"}function Q(M){return Math.sqrt(M[0]**2+M[1]**2+M[2]**2+M[3]**2+M[4]**2+M[5]**2+M[6]**2+M[7]**2+M[8]**2+M[9]**2+M[10]**2+M[11]**2+M[12]**2+M[13]**2+M[14]**2+M[15]**2)}function W(M,T,ha){M[0]=T[0]+ha[0];M[1]=
T[1]+ha[1];M[2]=T[2]+ha[2];M[3]=T[3]+ha[3];M[4]=T[4]+ha[4];M[5]=T[5]+ha[5];M[6]=T[6]+ha[6];M[7]=T[7]+ha[7];M[8]=T[8]+ha[8];M[9]=T[9]+ha[9];M[10]=T[10]+ha[10];M[11]=T[11]+ha[11];M[12]=T[12]+ha[12];M[13]=T[13]+ha[13];M[14]=T[14]+ha[14];M[15]=T[15]+ha[15];return M}function P(M,T,ha){M[0]=T[0]-ha[0];M[1]=T[1]-ha[1];M[2]=T[2]-ha[2];M[3]=T[3]-ha[3];M[4]=T[4]-ha[4];M[5]=T[5]-ha[5];M[6]=T[6]-ha[6];M[7]=T[7]-ha[7];M[8]=T[8]-ha[8];M[9]=T[9]-ha[9];M[10]=T[10]-ha[10];M[11]=T[11]-ha[11];M[12]=T[12]-ha[12];M[13]=
T[13]-ha[13];M[14]=T[14]-ha[14];M[15]=T[15]-ha[15];return M}function fa(M,T,ha){M[0]=T[0]*ha;M[1]=T[1]*ha;M[2]=T[2]*ha;M[3]=T[3]*ha;M[4]=T[4]*ha;M[5]=T[5]*ha;M[6]=T[6]*ha;M[7]=T[7]*ha;M[8]=T[8]*ha;M[9]=T[9]*ha;M[10]=T[10]*ha;M[11]=T[11]*ha;M[12]=T[12]*ha;M[13]=T[13]*ha;M[14]=T[14]*ha;M[15]=T[15]*ha;return M}function oa(M,T,ha,V){M[0]=T[0]+ha[0]*V;M[1]=T[1]+ha[1]*V;M[2]=T[2]+ha[2]*V;M[3]=T[3]+ha[3]*V;M[4]=T[4]+ha[4]*V;M[5]=T[5]+ha[5]*V;M[6]=T[6]+ha[6]*V;M[7]=T[7]+ha[7]*V;M[8]=T[8]+ha[8]*V;M[9]=T[9]+
ha[9]*V;M[10]=T[10]+ha[10]*V;M[11]=T[11]+ha[11]*V;M[12]=T[12]+ha[12]*V;M[13]=T[13]+ha[13]*V;M[14]=T[14]+ha[14]*V;M[15]=T[15]+ha[15]*V;return M}function pa(M,T){return M[0]===T[0]&&M[1]===T[1]&&M[2]===T[2]&&M[3]===T[3]&&M[4]===T[4]&&M[5]===T[5]&&M[6]===T[6]&&M[7]===T[7]&&M[8]===T[8]&&M[9]===T[9]&&M[10]===T[10]&&M[11]===T[11]&&M[12]===T[12]&&M[13]===T[13]&&M[14]===T[14]&&M[15]===T[15]}function sa(M,T){if(M===T)return!0;const ha=M[0],V=M[1],Z=M[2],ca=M[3],ea=M[4],ja=M[5],la=M[6],aa=M[7],da=M[8],ia=M[9],
va=M[10],wa=M[11],Aa=M[12],Ba=M[13],Da=M[14];M=M[15];const Ka=T[0],Fa=T[1],Ga=T[2],Ia=T[3],Ja=T[4],Ma=T[5],xa=T[6],$a=T[7],Sa=T[8],Ra=T[9],N=T[10],ab=T[11],Ua=T[12],zb=T[13],sb=T[14];T=T[15];return Math.abs(ha-Ka)<=C.EPSILON*Math.max(1,Math.abs(ha),Math.abs(Ka))&&Math.abs(V-Fa)<=C.EPSILON*Math.max(1,Math.abs(V),Math.abs(Fa))&&Math.abs(Z-Ga)<=C.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Ga))&&Math.abs(ca-Ia)<=C.EPSILON*Math.max(1,Math.abs(ca),Math.abs(Ia))&&Math.abs(ea-Ja)<=C.EPSILON*Math.max(1,Math.abs(ea),
Math.abs(Ja))&&Math.abs(ja-Ma)<=C.EPSILON*Math.max(1,Math.abs(ja),Math.abs(Ma))&&Math.abs(la-xa)<=C.EPSILON*Math.max(1,Math.abs(la),Math.abs(xa))&&Math.abs(aa-$a)<=C.EPSILON*Math.max(1,Math.abs(aa),Math.abs($a))&&Math.abs(da-Sa)<=C.EPSILON*Math.max(1,Math.abs(da),Math.abs(Sa))&&Math.abs(ia-Ra)<=C.EPSILON*Math.max(1,Math.abs(ia),Math.abs(Ra))&&Math.abs(va-N)<=C.EPSILON*Math.max(1,Math.abs(va),Math.abs(N))&&Math.abs(wa-ab)<=C.EPSILON*Math.max(1,Math.abs(wa),Math.abs(ab))&&Math.abs(Aa-Ua)<=C.EPSILON*
Math.max(1,Math.abs(Aa),Math.abs(Ua))&&Math.abs(Ba-zb)<=C.EPSILON*Math.max(1,Math.abs(Ba),Math.abs(zb))&&Math.abs(Da-sb)<=C.EPSILON*Math.max(1,Math.abs(Da),Math.abs(sb))&&Math.abs(M-T)<=C.EPSILON*Math.max(1,Math.abs(M),Math.abs(T))}function ra(M){const T=C.EPSILON,ha=M[0],V=M[1],Z=M[2],ca=M[4],ea=M[5],ja=M[6],la=M[8],aa=M[9];M=M[10];return Math.abs(1-(ha*ha+ca*ca+la*la))<=T&&Math.abs(1-(V*V+ea*ea+aa*aa))<=T&&Math.abs(1-(Z*Z+ja*ja+M*M))<=T}const ua=t.create();t=Object.freeze({__proto__:null,copy:D,
set:x,identity:w,transpose:q,invert:p,adjoint:g,determinant:e,multiply:l,translate:k,scale:n,rotate:d,rotateX:b,rotateY:a,rotateZ:c,fromTranslation:f,fromScaling:m,fromRotation:h,fromXRotation:v,fromYRotation:u,fromZRotation:F,fromRotationTranslation:z,fromQuat2:A,getTranslation:E,getScaling:G,getRotation:H,fromRotationTranslationScale:K,fromRotationTranslationScaleOrigin:L,fromQuat:J,frustum:B,perspective:y,perspectiveFromFieldOfView:I,ortho:S,lookAt:O,targetTo:Y,str:R,frob:Q,add:W,subtract:P,multiplyScalar:fa,
multiplyScalarAndAdd:oa,exactEquals:pa,equals:sa,isOrthoNormal:ra,mul:l,sub:P});r.add=W;r.adjoint=g;r.copy=D;r.determinant=e;r.equals=sa;r.exactEquals=pa;r.frob=Q;r.fromQuat=J;r.fromQuat2=A;r.fromRotation=h;r.fromRotationTranslation=z;r.fromRotationTranslationScale=K;r.fromRotationTranslationScaleOrigin=L;r.fromScaling=m;r.fromTranslation=f;r.fromXRotation=v;r.fromYRotation=u;r.fromZRotation=F;r.frustum=B;r.getRotation=H;r.getScaling=G;r.getTranslation=E;r.identity=w;r.invert=p;r.isOrthoNormal=ra;
r.lookAt=O;r.mat4=t;r.mul=l;r.multiply=l;r.multiplyScalar=fa;r.multiplyScalarAndAdd=oa;r.ortho=S;r.perspective=y;r.perspectiveFromFieldOfView=I;r.rotate=d;r.rotateX=b;r.rotateY=a;r.rotateZ=c;r.scale=n;r.set=x;r.str=R;r.sub=P;r.subtract=P;r.targetTo=Y;r.translate=k;r.transpose=q})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../assets","../core/has"],function(r,t,C,D,x){function w(){return!!t._pe}function q(){return!!x("esri-wasm")}function p(){return d?d:
d=(new Promise((a,c)=>r(["./pe-wasm"],a,c))).then(a=>a.peWasm).then(({default:a})=>a({locateFile:c=>D.getAssetUrl(`esri/geometry/support/${c}`)})).then(a=>{g(a)})}function g(a){function c(h,v,u){h[v]=u(h[v])}t._pe=a;t.PeDefs.init();t.PeGTlistExtended.init();t.PeNotationMgrs.init();t.PeNotationUtm.init();t.PePCSInfo.init();t.PeGCSExtent=function(h){function v(){return h.apply(this,arguments)||this}C._inheritsLoose(v,h);v.prototype.destroy=function(){t._pe.destroy(this)};return v}(t._pe.PeGCSExtent);
a=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];for(var f of a)c(f.prototype,"getName",h=>function(){return h.call(this,Array(t.PeDefs.PE_NAME_MAX))});for(const h of[t._pe.PeGeogtran,t._pe.PeProjcs])c(h.prototype,"getParameters",v=>function(){const u=Array(t.PeDefs.PE_PARM_MAX);let F=v.call(this);for(let z=0;z<u.length;z++){const A=t._pe.getValue(F,"*");u[z]=A?t._pe.wrapPointer(A,t._pe.PeParameter):null;
F+=Int32Array.BYTES_PER_ELEMENT}return u});c(t._pe.PeHorizon.prototype,"getCoord",h=>function(){const v=this.getSize();if(!v)return null;const u=[],F=h.call(this);n(u,v,F);return u});c(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",h=>{const v=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){let u=null;var F=h.call(this);if(!t._pe.compare(F,t._pe.NULL)){u=[F];const z=this.getSteps();if(1<z){F=t._pe.getPointer(F);for(let A=1;A<z;A++)u.push(t._pe.wrapPointer(F+v*A,t._pe.PeGTlistExtendedGTs))}}return u}});
const m=t._pe._pe_getPeHorizonSize();f=h=>function(){let v=this._cache;v||(this._cache=v=new Map);if(v.has(h))return v.get(h);let u=null;var F=h.call(this);if(!t._pe.compare(F,t._pe.NULL)){u=[F];const z=F.getNump();if(1<z){F=t._pe.getPointer(F);for(let A=1;A<z;A++)u.push(t._pe.wrapPointer(F+m*A,t._pe.PeHorizon))}}v.set(h,u);return u};c(t._pe.PeProjcs.prototype,"horizonGcsGenerate",f);c(t._pe.PeProjcs.prototype,"horizonPcsGenerate",f);t._pe.PeObject.prototype.toString=function(h=t.PeDefs.PE_STR_OPTS_NONE){t._pe.ensureCache.prepare();
const v=t._pe.getPointer(this),u=t._pe.ensureInt8(Array(t.PeDefs.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(v,h,u))}}function e(a){if(a){var c=t._pe.getClass(a);c&&(c=t._pe.getCache(c))&&(a=t._pe.getPointer(a))&&delete c[a]}}function l(a,c){const f=[];c=Array(c);for(let m=0;m<a;m++)f.push(t._pe.ensureInt8(c));return f}function k(a){let c;Array.isArray(a[0])?(c=[],a.forEach(f=>{c.push(f[0],f[1])})):c=a;return c}function n(a,c,f,m=!1){if(m)for(m=0;m<2*c;m++)a[m]=t._pe.getValue(f+
m*Float64Array.BYTES_PER_ELEMENT,"double");else{m=0===a.length;for(let h=0;h<c;h++)m&&(a[h]=Array(2)),a[h][0]=t._pe.getValue(f,"double"),a[h][1]=t._pe.getValue(f+Float64Array.BYTES_PER_ELEMENT,"double"),f+=2*Float64Array.BYTES_PER_ELEMENT}}let d;t._pe=null;t.PeCSTransformations=void 0;(function(a){function c(h,v,u){t._pe.ensureCache.prepare();var F=k(u);const z=u===F;F=t._pe.ensureFloat64(F);(h=t._pe._pe_geog_to_proj(t._pe.getPointer(h),v,F))&&n(u,v,F,z);return h}function f(h,v,u){return m(h,v,u,
0)}function m(h,v,u,F){t._pe.ensureCache.prepare();var z=k(u);const A=u===z;z=t._pe.ensureFloat64(z);(h=t._pe._pe_proj_to_geog_center(t._pe.getPointer(h),v,z,F))&&n(u,v,z,A);return h}a.geogToProj=c;a.projGeog=function(h,v,u,F){switch(F){case t.PeDefs.PE_TRANSFORM_P_TO_G:return f(h,v,u);case t.PeDefs.PE_TRANSFORM_G_TO_P:return c(h,v,u)}return 0};a.projToGeog=f;a.projToGeogCenter=m})(t.PeCSTransformations||(t.PeCSTransformations={}));t.PeDefs=void 0;(function(a){a.init=function(){a.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX;
a.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX;a.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX;a.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX;a.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX;a.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX;a.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX;a.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX;a.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX;a.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE;a.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS;a.PE_TYPE_PROJCS=
t._pe.PeDefs.prototype.PE_TYPE_PROJCS;a.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;a.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS;a.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT;a.PE_TYPE_LINUNIT=t._pe.PeDefs.prototype.PE_TYPE_LINUNIT;a.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE;a.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE;a.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP;a.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON;a.PE_PARM_X0=
t._pe.PeDefs.prototype.PE_PARM_X0;a.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND;a.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;a.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;a.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;a.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;a.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT;a.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY;a.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE;
a.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(t.PeDefs||(t.PeDefs={}));t.PeFactory=void 0;(function(a){function c(v,u){let F=null,z=f[v];z||(z={},f[v]=z);z.hasOwnProperty(String(u))?F=z[u]:(v=t._pe.PeFactory.prototype.factoryByType(v,u),t._pe.compare(v,t._pe.NULL)||(F=v,z[u]=F));return F=h(F)}const f={},m={},h=v=>{if(v){const u=v.getType();switch(u){case t.PeDefs.PE_TYPE_GEOGCS:v=t._pe.castObject(v,t._pe.PeGeogcs);break;case t.PeDefs.PE_TYPE_PROJCS:v=t._pe.castObject(v,t._pe.PeProjcs);
break;case t.PeDefs.PE_TYPE_GEOGTRAN:v=t._pe.castObject(v,t._pe.PeGeogtran);break;default:u&t.PeDefs.PE_TYPE_UNIT&&(v=t._pe.castObject(v,t._pe.PeUnit))}}return v};a.initialize=function(){t._pe.PeFactory.prototype.initialize(null)};a.coordsys=function(v){return c(t.PeDefs.PE_TYPE_COORDSYS,v)};a.factoryByType=c;a.fromString=function(v,u){let F=null,z=m[v];z||(z={},m[v]=z);z.hasOwnProperty(u)?F=z[u]:(v=t._pe.PeFactory.prototype.fromString(v,u),t._pe.compare(v,t._pe.NULL)||(F=v,z[u]=F));return F=h(F)};
a.geogcs=function(v){return c(t.PeDefs.PE_TYPE_GEOGCS,v)};a.geogtran=function(v){return c(t.PeDefs.PE_TYPE_GEOGTRAN,v)};a.getCode=function(v){return t._pe.PeFactory.prototype.getCode(v)};a.projcs=function(v){return c(t.PeDefs.PE_TYPE_PROJCS,v)};a.unit=function(v){return c(t.PeDefs.PE_TYPE_UNIT,v)}})(t.PeFactory||(t.PeFactory={}));t.PeGCSExtent=null;t.PeGTlistExtended=void 0;(function(a){let c;a.init=function(){a.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=t._pe._pe_getPeGTlistExtendedEntrySize()};
a.getGTlist=function(f,m,h,v,u,F){let z=null;const A=new t._pe.PeInteger(F);try{const E=t._pe.PeGTlistExtended.prototype.getGTlist(f,m,h,v,u,A);if(F=A.val)if(z=[E],1<F){const G=t._pe.getPointer(E);for(f=1;f<F;f++)z.push(t._pe.wrapPointer(G+c*f,t._pe.PeGTlistExtendedEntry))}}finally{t._pe.destroy(A)}return z}})(t.PeGTlistExtended||(t.PeGTlistExtended={}));t.PeGTlistExtendedEntry=void 0;(function(a){a.destroy=function(c){if(c&&c.length){for(const f of c)e(f),f.getEntries().forEach(m=>{e(m);m=m.getGeogtran();
e(m);m.getParameters().forEach(e);[m.getGeogcs1(),m.getGeogcs2()].forEach(h=>{e(h);const v=h.getDatum();e(v);e(v.getSpheroid());e(h.getPrimem());e(h.getUnit())})});t._pe.PeGTlistExtendedEntry.prototype.Delete(c[0])}}})(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={}));t.PeGTTransformations=void 0;(function(a){a.geogToGeog=function(c,f,m,h,v){t._pe.ensureCache.prepare();var u=k(m);const F=m===u;u=t._pe.ensureFloat64(u);let z=0;h&&(z=t._pe.ensureFloat64(h));(c=t._pe._pe_geog_to_geog(t._pe.getPointer(c),
f,u,z,v))&&n(m,f,u,F);return c}})(t.PeGTTransformations||(t.PeGTTransformations={}));t.PeNotationDms=void 0;(function(a){const c=(m,h,v,u,F,z)=>{t._pe.ensureCache.prepare();switch(m){case "dd":var A=t._pe._pe_geog_to_dd;var E=t.PeDefs.PE_DD_MAX;break;case "ddm":A=t._pe._pe_geog_to_ddm;E=t.PeDefs.PE_DDM_MAX;break;case "dms":A=t._pe._pe_geog_to_dms,E=t.PeDefs.PE_DMS_MAX}m=0;h&&(m=t._pe.getPointer(h));h=k(u);h=t._pe.ensureFloat64(h);E=l(v,E);u=t._pe.ensureInt32(E);if(F=A(m,v,h,F,u))for(A=0;A<v;A++)z[A]=
t._pe.UTF8ToString(E[A]);return F},f=(m,h,v,u,F)=>{t._pe.ensureCache.prepare();switch(m){case "dd":var z=t._pe._pe_dd_to_geog;break;case "ddm":z=t._pe._pe_ddm_to_geog;break;case "dms":z=t._pe._pe_dms_to_geog}m=0;h&&(m=t._pe.getPointer(h));h=u.map(A=>t._pe.ensureString(A));u=t._pe.ensureInt32(h);h=t._pe.ensureFloat64(Array(2*v));(z=z(m,v,u,h))&&n(F,v,h);return z};a.geog_to_dms=function(m,h,v,u,F){return c("dms",m,h,v,u,F)};a.dms_to_geog=function(m,h,v,u){return f("dms",m,h,v,u)};a.geog_to_ddm=function(m,
h,v,u,F){return c("ddm",m,h,v,u,F)};a.ddm_to_geog=function(m,h,v,u){return f("ddm",m,h,v,u)};a.geog_to_dd=function(m,h,v,u,F){return c("dd",m,h,v,u,F)};a.dd_to_geog=function(m,h,v,u){return f("dd",m,h,v,u)}})(t.PeNotationDms||(t.PeNotationDms={}));t.PeNotationMgrs=void 0;(function(a){a.init=function(){a.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;a.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;a.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;
a.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;a.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};a.geog_to_mgrs_extended=function(c,f,m,h,v,u,F){t._pe.ensureCache.prepare();let z=0;c&&(z=t._pe.getPointer(c));c=k(m);m=t._pe.ensureFloat64(c);c=l(f,t.PeDefs.PE_MGRS_MAX);const A=t._pe.ensureInt32(c);if(h=t._pe._pe_geog_to_mgrs_extended(z,f,m,h,v,u,A))for(v=0;v<f;v++)F[v]=t._pe.UTF8ToString(c[v]);return h};a.mgrs_to_geog_extended=function(c,f,m,h,
v){t._pe.ensureCache.prepare();let u=0;c&&(u=t._pe.getPointer(c));c=m.map(F=>t._pe.ensureString(F));m=t._pe.ensureInt32(c);c=t._pe.ensureFloat64(Array(2*f));(h=t._pe._pe_mgrs_to_geog_extended(u,f,m,h,c))&&n(v,f,c);return h}})(t.PeNotationMgrs||(t.PeNotationMgrs={}));t.PeNotationUsng=void 0;(function(a){a.geog_to_usng=function(c,f,m,h,v,u,F){t._pe.ensureCache.prepare();let z=0;c&&(z=t._pe.getPointer(c));c=k(m);m=t._pe.ensureFloat64(c);c=l(f,t.PeDefs.PE_MGRS_MAX);const A=t._pe.ensureInt32(c);if(h=t._pe._pe_geog_to_usng(z,
f,m,h,v,u,A))for(v=0;v<f;v++)F[v]=t._pe.UTF8ToString(c[v]);return h};a.usng_to_geog=function(c,f,m,h){t._pe.ensureCache.prepare();var v=0;c&&(v=t._pe.getPointer(c));c=m.map(u=>t._pe.ensureString(u));m=t._pe.ensureInt32(c);c=t._pe.ensureFloat64(Array(2*f));(v=t._pe._pe_usng_to_geog(v,f,m,c))&&n(h,f,c);return v}})(t.PeNotationUsng||(t.PeNotationUsng={}));t.PeNotationUtm=void 0;(function(a){a.init=function(){a.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;a.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;
a.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};a.geog_to_utm=function(c,f,m,h,v){t._pe.ensureCache.prepare();var u=0;c&&(u=t._pe.getPointer(c));c=k(m);m=t._pe.ensureFloat64(c);c=l(f,t.PeDefs.PE_UTM_MAX);const F=t._pe.ensureInt32(c);if(h=t._pe._pe_geog_to_utm(u,f,m,h,F))for(u=0;u<f;u++)v[u]=t._pe.UTF8ToString(c[u]);return h};a.utm_to_geog=function(c,f,m,h,v){t._pe.ensureCache.prepare();let u=0;c&&(u=t._pe.getPointer(c));c=m.map(F=>t._pe.ensureString(F));m=t._pe.ensureInt32(c);c=t._pe.ensureFloat64(Array(2*
f));(h=t._pe._pe_utm_to_geog(u,f,m,h,c))&&n(v,f,c);return h}})(t.PeNotationUtm||(t.PeNotationUtm={}));t.PePCSInfo=void 0;(function(a){const c=new Map;a.init=function(){a.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;a.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;a.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;a.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT};a.generate=function(f,m=a.PE_PCSINFO_OPTION_DOMAIN){let h,
v;c.has(f)&&(v=c.get(f),v[m]&&(h=v[m]));h||(h=t._pe.PePCSInfo.prototype.generate(f,m),v||(v=[],c.set(f,v)),v[m]=h);return h}})(t.PePCSInfo||(t.PePCSInfo={}));t.PeVersion=void 0;(function(a){a.version_string=function(){return t._pe.PeVersion.prototype.version_string()}})(t.PeVersion||(t.PeVersion={}));const b=Object.freeze({__proto__:null,get _pe(){return t._pe},isLoaded:w,isSupported:q,load:p,get PeCSTransformations(){return t.PeCSTransformations},get PeDefs(){return t.PeDefs},get PeFactory(){return t.PeFactory},
get PeGCSExtent(){return t.PeGCSExtent},get PeGTlistExtended(){return t.PeGTlistExtended},get PeGTlistExtendedEntry(){return t.PeGTlistExtendedEntry},get PeGTTransformations(){return t.PeGTTransformations},get PeNotationDms(){return t.PeNotationDms},get PeNotationMgrs(){return t.PeNotationMgrs},get PeNotationUsng(){return t.PeNotationUsng},get PeNotationUtm(){return t.PeNotationUtm},get PePCSInfo(){return t.PePCSInfo},get PeVersion(){return t.PeVersion},_init:g});t._init=g;t.isLoaded=w;t.isSupported=
q;t.load=p;t.pe=b})},"esri/geometry/support/geodesicConstants":function(){define(["exports","./Ellipsoid"],function(r,t){const C=Math.PI/180;var D=t.earth.radius;const x=t.earth.eccentricitySquared;D={a1:D*x,a2:D*x*D*x,a3:D*x*x/2,a4:D*x*D*x*2.5,a5:D*x+D*x*x/2,a6:1-x};t={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:t.earth.radius,f:t.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:t.moon.radius,f:t.moon.flattening},104904:{a:3393400,
f:.005207166853303471},104905:{a:t.mars.radius,f:t.mars.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},
104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,
f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:t.mars.radius,
f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};r.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;r.earthEllipsoidConstants=D;r.spheroids=t;r.toRadians=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geometry/support/GeographicTransformation":function(){define(["./GeographicTransformationStep"],function(r){return function(){function t(D){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(D&&D.steps)for(const x of D.steps)x instanceof r?this.steps.push(x):
this.steps.push(new r({wkid:x.wkid,wkt:x.wkt,isInverse:x.isInverse}))}t.cacheKey=function(D,x){return[void 0!==D.wkid&&null!==D.wkid?D.wkid.toString():"-1",void 0!==D.wkt&&null!==D.wkt?D.wkt.toString():"",void 0!==x.wkid&&null!==x.wkid?x.wkid.toString():"-1",void 0!==x.wkt&&null!==x.wkt?x.wkt.toString():""].join()};t.fromGE=function(D){const x=new t;let w="";for(const q of D.steps)D=r.fromGE(q),x.steps.push(D),w+=D.uid.toString()+",";x._cached_projection={};x._gtlistentry=null;x._chain=w;return x};
var C=t.prototype;C.getInverse=function(){const D=new t;D.steps=[];for(let x=this.steps.length-1;0<=x;x--)D.steps.push(this.steps[x].getInverse());return D};C.getGTListEntry=function(){let D="";for(const x of this.steps)D+=x.uid.toString()+",";D!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=D);return this._gtlistentry};C.assignCachedGe=function(D,x,w){this._cached_projection[t.cacheKey(D,x)]=w};C.getCachedGeTransformation=function(D,x){let w="";for(const q of this.steps)w+=
q.uid.toString()+",";w!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=w);D=this._cached_projection[t.cacheKey(D,x)];return void 0===D?null:D};return t}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){let t=0;return function(){function C(D=null){this.uid=t++;D?(this._wkt=void 0!==D.wkt?D.wkt:null,this._wkid=void 0!==D.wkid?D.wkid:-1,this._isInverse=void 0!==D.isInverse?!0===D.isInverse:
!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}C.fromGE=function(D){const x=new C;x._wkt=D.wkt;x._wkid=D.wkid;x._isInverse=D.isInverse;return x};C.prototype.getInverse=function(){const D=new C;D._wkt=this.wkt;D._wkid=this._wkid;D._isInverse=!this.isInverse;return D};r._createClass(C,[{key:"wkt",get:function(){return this._wkt},set:function(D){this._wkt=D;this.uid=t++}},{key:"wkid",get:function(){return this._wkid},set:function(D){this._wkid=D;this.uid=t++}},{key:"isInverse",get:function(){return this._isInverse},
set:function(D){this._isInverse=D;this.uid=t++}}]);return C}()})},"esri/geometry/support/zscale":function(){define(["exports","../../core/maybe","../../core/unitUtils","./spatialReferenceUtils"],function(r,t,C,D){r.getGeometryZScaler=function(x,w,q){if(t.isNone(w)||t.isNone(q)||q.vcsWkid||D.equals(w,q))return null;w=C.getMetersPerVerticalUnitForSR(w);q=C.getMetersPerVerticalUnitForSR(q);const p=w/q;if(1===p)return null;switch(x){case "point":case "esriGeometryPoint":return g=>{g&&null!=g.z&&(g.z*=
p)};case "polyline":case "esriGeometryPolyline":return g=>{if(g)for(const e of g.paths)for(const l of e)2<l.length&&(l[2]*=p)};case "polygon":case "esriGeometryPolygon":return g=>{if(g)for(const e of g.rings)for(const l of e)2<l.length&&(l[2]*=p)};case "multipoint":case "esriGeometryMultipoint":return g=>{if(g)for(const e of g.points)2<e.length&&(e[2]*=p)};case "extent":case "esriGeometryExtent":return g=>{g&&null!=g.zmin&&null!=g.zmax&&(g.zmin*=p,g.zmax*=p)};default:return null}};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(r){let t=function(q,p,g){this.x=q;this.y=p;this.spatialReference=g;this.m=this.z=void 0},C=function(q,p,g,e){this.rings=q;this.spatialReference=p;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);e&&(this.hasM=e)},D=function(q,p,g,e){this.paths=q;this.spatialReference=p;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);e&&(this.hasM=e)},x=function(q,p,g,e){this.points=q;this.spatialReference=p;this.hasM=this.hasZ=
void 0;g&&(this.hasZ=g);e&&(this.hasM=e)},w=function(q,p,g,e,l){this.xmin=q;this.ymin=p;this.xmax=g;this.ymax=e;this.spatialReference=l;this.mmax=this.mmin=this.zmax=this.zmin=void 0};r.jsonAdapter={convertToGEGeometry:function(q,p){return null==p?null:q.convertJSONToGeometry(p)},exportPoint:function(q,p,g){g=new t(q.getPointX(p),q.getPointY(p),g);const e=q.hasZ(p),l=q.hasM(p);e&&(g.z=q.getPointZ(p));l&&(g.m=q.getPointM(p));return g},exportPolygon:function(q,p,g){return new C(q.exportPaths(p),g,q.hasZ(p),
q.hasM(p))},exportPolyline:function(q,p,g){return new D(q.exportPaths(p),g,q.hasZ(p),q.hasM(p))},exportMultipoint:function(q,p,g){return new x(q.exportPoints(p),g,q.hasZ(p),q.hasM(p))},exportExtent:function(q,p,g){var e=q.hasZ(p);const l=q.hasM(p);g=new w(q.getXMin(p),q.getYMin(p),q.getXMax(p),q.getYMax(p),g);e&&(e=q.getZExtent(p),g.zmin=e.vmin,g.zmax=e.vmax);l&&(q=q.getMExtent(p),g.mmin=q.vmin,g.mmax=q.vmax);return g}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],
function(r){r.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,
supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n){function d(a,c,f,m,h,v){h-=f;v-=m;a=Math.min(1,Math.max(0,((a-f)*h+(c-m)*v)/(h*h+v*v)));return{x:f+h*a,y:m+v*a}}function b(a,c){return a?c?4:3:c?3:2}return function(){function a(f,m,h){this.items=f;this.queryGeometry=m;this.definitionExpression=h.definitionExpression;this.geometryType=h.geometryType;this.hasM=h.hasM;this.hasZ=h.hasZ;this.objectIdField=h.objectIdField;this.spatialReference=h.spatialReference;this.fieldsIndex=h.fieldsIndex;this.timeInfo=h.timeInfo;
this.featureAdapter=h.featureAdapter;this.aggregateAdapter=h.aggregateAdapter}var c=a.prototype;c.createQueryResponseForCount=function(f){const m=new w(f,this.featureAdapter,this.fieldsIndex);if(!f.outStatistics)return m.countDistinctValues(this.items);const {groupByFieldsForStatistics:h,having:v}=f;if(null==h||!h.length)return 1;const u=new Map,F=new Map,z=new Set;f=f.outStatistics;for(const E of f){({statisticType:f}=E);f="exceedslimit"!==f?E.onStatisticField:void 0;if(!F.has(f)){var A=[];for(const G of h){const H=
this._getAttributeValues(m,G,u);A.push(H)}F.set(f,this._calculateUniqueValues(A,m.returnDistinctValues))}f=F.get(f);for(const G in f){const {data:H,items:K}=f[G];A=H.join(",");v&&!m.validateItems(K,v)||z.add(A)}}return z.size};c.createQueryResponse=function(f){let m;m=f.outStatistics?f.outStatistics.some(h=>"exceedslimit"===h.statisticType)?this._createExceedsLimitQueryResponse(f):this._createStatisticsQueryResponse(f):this._createFeatureQueryResponse(f);f.returnQueryGeometry&&(D.isValid(f.outSR)&&
!D.equals(this.queryGeometry.spatialReference,f.outSR)?m.queryGeometry=e.cleanFromGeometryEngine({spatialReference:f.outSR,...p.project(this.queryGeometry,this.queryGeometry.spatialReference,f.outSR)}):m.queryGeometry=e.cleanFromGeometryEngine({spatialReference:f.outSR,...this.queryGeometry}));return m};c.createSnappingResponse=function(f,m){const h=this.featureAdapter,v=b(this.hasZ,this.hasM),{x:u,y:F}=f.point,z="number"===typeof f.distance?f.distance:f.distance.x,A="number"===typeof f.distance?
f.distance:f.distance.y,E={candidates:[]},G="esriGeometryPolygon"===this.geometryType;m=this.getPointCreator(f.point,this.spatialReference,m);for(const S of this.items){var H=h.getGeometry(S);if(t.isNone(H))continue;const {coords:O,lengths:Y}=H;if(f.types&1){H=0;for(var K=0;K<Y.length;K++){var L=Y[K];for(var J=0;J<L;J++,H+=v){var B=O[H],y=O[H+1];if(J!==L-1){const R=O[H+v],Q=O[H+v+1],{x:W,y:P}=d(u,F,B,y,R,Q);var I=(u-W)/z;const fa=(F-P)/A;I=I*I+fa*fa;1>=I&&E.candidates.push({type:"edge",objectId:h.getObjectId(S),
distance:Math.sqrt(I),target:m(W,P),start:m(B,y),end:m(R,Q)})}}}}if(f.types&2)for(H=G?O.length-v:O.length,K=0;K<H;K+=v)L=O[K],J=O[K+1],B=(u-L)/z,y=(F-J)/A,B=B*B+y*y,1>=B&&E.candidates.push({type:"vertex",objectId:h.getObjectId(S),distance:Math.sqrt(B),target:m(L,J)})}E.candidates.sort((S,O)=>S.distance-O.distance);return E};c.getPointCreator=function(f,m,h){const v=t.isSome(h)&&!D.equals(m,h)?u=>p.project(u,m,h):u=>u;return null!=f.z&&null!=f.m?(u,F)=>v({x:u,y:F,z:f.z,m:f.m}):null!=f.z?(u,F)=>v({x:u,
y:F,z:f.z}):null!=f.m?(u,F)=>v({x:u,y:F,m:f.m}):(u,F)=>v({x:u,y:F})};c.executeAttributesQuery=function(f){var m=q.getWhereClause(f.where,this.fieldsIndex);if(!m)return Promise.resolve(this);if(m.isStandardized){let h=0;const v=[];for(const u of this.items)m.testFeature(u,this.featureAdapter)&&(v[h++]=u);m=new a(v,this.queryGeometry,this);m.definitionExpression=f.where;return Promise.resolve(m)}return Promise.reject(new TypeError("Where clause is not standardized"))};c.executeAggregateIdsQuery=function(f){if(!f.aggregateIds||
!f.aggregateIds.length||t.isNone(this.aggregateAdapter))return Promise.resolve(this);const m=new Set;for(const v of f.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(v).forEach(u=>m.add(u));const h=this.featureAdapter.getObjectId;return Promise.resolve(new a(this.items.filter(v=>m.has(h(v))),this.queryGeometry,this))};c.executeObjectIdsQuery=function(f){if(!f.objectIds||!f.objectIds.length)return Promise.resolve(this);const m=new Set(f.objectIds),h=this.featureAdapter.getObjectId;return Promise.resolve(new a(this.items.filter(v=>
m.has(h(v))),this.queryGeometry,this))};c.executeTimeQuery=function(f){f=g.getTimeOperator(this.timeInfo,f.timeExtent,this.featureAdapter);if(!t.isSome(f))return Promise.resolve(this);f=this.items.filter(f);return Promise.resolve(new a(f,this.queryGeometry,this))};c.filterLatest=function(){const {trackIdField:f,startTimeField:m,endTimeField:h}=this.timeInfo;var v=h||m;const u=new Map,F=this.featureAdapter.getAttribute;for(const z of this.items){const A=F(z,f),E=F(z,v),G=u.get(A);(!G||E>F(G,v))&&u.set(A,
z)}v=Array.from(u.values());return Promise.resolve(new a(v,this.queryGeometry,this))};c.project=function(){var f=r._asyncToGenerator(function*(m){if(!m||D.equals(this.spatialReference,m))return this;const h=this.featureAdapter,v=(yield p.projectMany(this.items.map(u=>e.getGeometry(this.geometryType,this.hasZ,this.hasM,h.getGeometry(u))),this.spatialReference,m)).map((u,F)=>h.cloneWithGeometry(this.items[F],x.convertFromGeometry(u,this.hasZ,this.hasM)));return new a(v,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:m,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})});return function(m){return f.apply(this,arguments)}}();c.createSummaryStatisticsResponse=function(){var f=r._asyncToGenerator(function*(m,h){const {field:v,valueExpression:u,normalizationField:F,normalizationType:z,normalizationTotal:A,minValue:E,maxValue:G,scale:H}=h;h=this.fieldsIndex.isDateField(v);
m=yield this._getDataValues(m,{field:v,valueExpression:u,normalizationField:F,normalizationType:z,normalizationTotal:A,scale:H});const K=k.isNullCountSupported({normalizationType:z,normalizationField:F,minValue:E,maxValue:G}),L=this.fieldsIndex.get(v),J={value:.5,fieldType:null==L?void 0:L.type};m=l.isStringField(L)?k.calculateStringStatistics({values:m,supportsNullCount:K,percentileParams:J}):k.calculateStatistics({values:m,minValue:E,maxValue:G,useSampleStdDev:!z,supportsNullCount:K,percentileParams:J});
return k.processSummaryStatisticsResult(m,h)});return function(m,h){return f.apply(this,arguments)}}();c.createUniqueValuesResponse=function(){var f=r._asyncToGenerator(function*(m,h){const {field:v,valueExpression:u,domain:F,returnAllCodedValues:z,scale:A}=h;m=yield this._getDataValues(m,{field:v,valueExpression:u,scale:A});m=k.calculateUniqueValuesCount(m);return k.createUVResult(m,F,z)});return function(m,h){return f.apply(this,arguments)}}();c.createClassBreaksResponse=function(){var f=r._asyncToGenerator(function*(m,
h){const {field:v,valueExpression:u,normalizationField:F,normalizationType:z,normalizationTotal:A,classificationMethod:E,standardDeviationInterval:G,minValue:H,maxValue:K,numClasses:L,scale:J}=h;m=yield this._getDataValues(m,{field:v,valueExpression:u,normalizationField:F,normalizationType:z,normalizationTotal:A,scale:J});m=k.calculateClassBreaks(m,{field:v,normalizationField:F,normalizationType:z,normalizationTotal:A,classificationMethod:E,standardDeviationInterval:G,minValue:H,maxValue:K,numClasses:L});
return k.resolveCBResult(m,E)});return function(m,h){return f.apply(this,arguments)}}();c.createHistogramResponse=function(){var f=r._asyncToGenerator(function*(m,h){const {field:v,valueExpression:u,normalizationField:F,normalizationType:z,normalizationTotal:A,classificationMethod:E,standardDeviationInterval:G,minValue:H,maxValue:K,numBins:L,scale:J}=h;m=yield this._getDataValues(m,{field:v,valueExpression:u,normalizationField:F,normalizationType:z,normalizationTotal:A,scale:J});return k.calculateHistogram(m,
{field:v,normalizationField:F,normalizationType:z,normalizationTotal:A,classificationMethod:E,standardDeviationInterval:G,minValue:H,maxValue:K,numBins:L})});return function(m,h){return f.apply(this,arguments)}}();c._sortFeatures=function(f,m,h){if(1<f.length&&m&&m.length)for(const v of m.reverse()){m=v.split(" ");const u=m[0],F=this.fieldsIndex.get(u);m=m[1]&&"desc"===m[1].toLowerCase();const z=k.getAttributeComparator(null==F?void 0:F.type,m);f.sort((A,E)=>{A=h(A,u,F);E=h(E,u,F);return z(A,E)})}};
c._createFeatureQueryResponse=function(f){const m=this.items,{geometryType:h,hasM:v,hasZ:u,objectIdField:F,spatialReference:z}=this,{outFields:A,outSR:E,quantizationParameters:G,resultRecordCount:H,resultOffset:K,returnZ:L,returnM:J}=f,B=null!=H?m.length>(K||0)+H:!1,y=A&&(A.includes("*")?[...this.fieldsIndex.fields]:A.map(I=>this.fieldsIndex.get(I)));return{exceededTransferLimit:B,features:this._createFeatures(f,m),fields:y,geometryType:h,hasM:v&&J,hasZ:u&&L,objectIdFieldName:F,spatialReference:e.cleanFromGeometryEngine(E?
E:z),transform:G&&C.toQuantizationTransform(G)||null}};c._createFeatures=function(f,m){const h=new w(f,this.featureAdapter,this.fieldsIndex),{hasM:v,hasZ:u}=this,{orderByFields:F,quantizationParameters:z,returnGeometry:A,returnCentroid:E,maxAllowableOffset:G,resultOffset:H,resultRecordCount:K,returnZ:L=!1,returnM:J=!1}=f,B=u&&L,y=v&&J;f=[];var I=0;m=[...m];this._sortFeatures(m,F,(Y,R,Q)=>h.getFieldValue(Y,R,Q));if(A||E){var S=C.toQuantizationTransform(z);if(A&&!E)for(var O of m)f[I++]={attributes:h.getAttributes(O),
geometry:e.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(O),G,S,B,y)};else if(!A&&E)for(const Y of m)f[I++]={attributes:h.getAttributes(Y),centroid:e.transformCentroid(this,this.featureAdapter.getCentroid(Y,this),S)};else for(const Y of m)f[I++]={attributes:h.getAttributes(Y),centroid:e.transformCentroid(this,this.featureAdapter.getCentroid(Y,this),S),geometry:e.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(Y),G,S,B,y)}}else for(S of m)(O=
h.getAttributes(S))&&(f[I++]={attributes:O});I=H||0;null!=K&&(f=f.slice(I,Math.min(f.length,I+K)));return f};c._createExceedsLimitQueryResponse=function(f){var m=!1;let h=Number.POSITIVE_INFINITY,v=Number.POSITIVE_INFINITY;m=Number.POSITIVE_INFINITY;for(const u of f.outStatistics)if("exceedslimit"===u.statisticType){h=null!=u.maxPointCount?u.maxPointCount:Number.POSITIVE_INFINITY;v=null!=u.maxRecordCount?u.maxRecordCount:Number.POSITIVE_INFINITY;m=null!=u.maxVertexCount?u.maxVertexCount:Number.POSITIVE_INFINITY;
break}if("esriGeometryPoint"===this.geometryType)m=this.items.length>h;else if(this.items.length>v)m=!0;else{f=this.hasZ?this.hasM?4:3:this.hasM?3:2;const u=this.featureAdapter;m=this.items.reduce((F,z)=>{z=u.getGeometry(z);return F+(t.isSome(z)&&z.coords.length||0)},0)/f>m}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(m)}}]}};c._createStatisticsQueryResponse=
function(f){var m={attributes:{}};const h=[],v=new Map,u=new Map,F=new Map,z=new Map,A=new w(f,this.featureAdapter,this.fieldsIndex);var E=f.outStatistics;const {groupByFieldsForStatistics:G,having:H,orderByFields:K}=f;f=G&&G.length;const L=!!f,J=L&&G[0],B=L&&!this.fieldsIndex.get(J);for(const Y of E){const {outStatisticFieldName:R,statisticType:Q}=Y;E=Y;var y="exceedslimit"!==Q?Y.onStatisticField:void 0;const W="percentile_disc"===Q||"percentile_cont"===Q,P=L&&1===f&&(y===J||B)&&"count"===Q;if(L){if(!F.has(y)){var I=
[];for(const fa of G){var S=this._getAttributeValues(A,fa,v);I.push(S)}F.set(y,this._calculateUniqueValues(I,A.returnDistinctValues))}I=F.get(y);for(const fa in I){const {count:oa,data:pa,items:sa,itemPositions:ra}=I[fa];S=pa.join(",");if(!H||A.validateItems(sa,H)){const ua=z.get(S)||{attributes:{}};var O=null;if(P)O=oa;else{const M=this._getAttributeValues(A,y,v);O=ra.map(T=>M[T]);O=W&&"statisticParameters"in E?this._getPercentileValue(E,O):this._getStatisticValue(E,O,null,A.returnDistinctValues)}ua.attributes[R]=
O;G.forEach((M,T)=>ua.attributes[this.fieldsIndex.get(M)?M:`EXPR_${T+1}`]=pa[T]);z.set(S,ua)}}}else y=this._getAttributeValues(A,y,v),m.attributes[R]=W&&"statisticParameters"in E?this._getPercentileValue(E,y):this._getStatisticValue(E,y,u,A.returnDistinctValues);h.push({name:R,alias:R,type:"esriFieldTypeDouble"})}m=L?Array.from(z.values()):[m];this._sortFeatures(m,K,(Y,R)=>Y.attributes[R]);return{fields:h,features:m}};c._getStatisticValue=function(f,m,h,v){const {onStatisticField:u,statisticType:F}=
f;f=null;f=null!=h&&h.has(u)?h.get(u):l.isStringField(this.fieldsIndex.get(u))?k.calculateStringStatistics({values:m,returnDistinct:v}):k.calculateStatistics({values:m,minValue:null,maxValue:null,useSampleStdDev:!0});h&&h.set(u,f);return f["var"===F?"variance":F]};c._getPercentileValue=function(f,m){const {onStatisticField:h,statisticParameters:v,statisticType:u}=f,{value:F,orderBy:z}=v;f=this.fieldsIndex.get(h);return k.calculatePercentile(m,{value:F,orderBy:z,fieldType:null==f?void 0:f.type,isDiscrete:"percentile_disc"===
u})};c._getAttributeValues=function(f,m,h){if(h.has(m))return h.get(m);const v=this.fieldsIndex.get(m),u=this.items.map(F=>f.getFieldValue(F,m,v));h.set(m,u);return u};c._getAttributeNormalizedValues=function(f,m){return this.items.map(h=>f.getNormalizedValue(h,{field:m.field,fieldInfo:this.fieldsIndex.get(m.field),normalizationField:m.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(m.normalizationField),normalizationType:m.normalizationType,normalizationTotal:m.normalizationTotal}))};
c._getAttributeExpressionValues=function(){var f=r._asyncToGenerator(function*(m,h,v){const {arcadeUtils:u}=yield n.loadArcade(),F=u.createFunction(h),z=v&&u.getViewInfo(v);return this.items.map(A=>m.getExpressionValue(A,{compiledFunc:F,viewInfo:z},u))});return function(m,h,v){return f.apply(this,arguments)}}();c._calculateUniqueValues=function(f,m){const h={},v=this.items,u=v.length;for(let F=0;F<u;F++){const z=v[F],A=[];for(const G of f)A.push(G[F]);const E=A.join(",");m?null==h[E]&&(h[E]={count:1,
data:A,items:[z],itemPositions:[F]}):null==h[E]?h[E]={count:1,data:A,items:[z],itemPositions:[F]}:(h[E].count++,h[E].items.push(z),h[E].itemPositions.push(F))}return h};c._getDataValues=function(){var f=r._asyncToGenerator(function*(m,h){const v=new w(m,this.featureAdapter,this.fieldsIndex),{valueExpression:u,field:F,normalizationField:z,normalizationType:A,normalizationTotal:E,scale:G}=h;m=u?{viewingMode:"map",scale:G,spatialReference:m.outSR||this.spatialReference}:null;return u?this._getAttributeExpressionValues(v,
u,m):this._getAttributeNormalizedValues(v,{field:F,normalizationField:z,normalizationType:A,normalizationTotal:E})});return function(m,h){return f.apply(this,arguments)}}();r._createClass(a,[{key:"size",get:function(){return this.items.length}}]);return a}()})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(r,t,C){function D({scale:G,translate:H},K){return Math.round((K-H[0])/G[0])}function x({scale:G,translate:H},K){return Math.round((H[1]-
K)/G[1])}function w(G,H,K){const L=[];let J,B,y,I;for(let S=0;S<K.length;S++){const O=K[S];if(0<S){if(y=D(G,O[0]),I=x(G,O[1]),y!==J||I!==B)L.push(H(O,y-J,I-B)),J=y,B=I}else J=D(G,O[0]),B=x(G,O[1]),L.push(H(O,J,B))}return 0<L.length?L:null}function q(G,H,K,L){return w(G,K?L?E:A:L?A:z,H)}function p(G,H,K,L){const J=[];K=K?L?E:A:L?A:z;for(L=0;L<H.length;L++){const B=w(G,K,H[L]);B&&3<=B.length&&J.push(B)}return J.length?J:null}function g(G,H,K,L){const J=[];K=K?L?E:A:L?A:z;for(L=0;L<H.length;L++){const B=
w(G,K,H[L]);B&&2<=B.length&&J.push(B)}return J.length?J:null}function e({scale:G,translate:H},K){return K*G[0]+H[0]}function l({scale:G,translate:H},K){return H[1]-K*G[1]}function k(G,H,K){const L=Array(K.length);if(!K.length)return L;const [J,B]=G.scale;let y=e(G,K[0][0]);G=l(G,K[0][1]);L[0]=H(K[0],y,G);for(let I=1;I<K.length;I++){const S=K[I];y+=S[0]*J;G-=S[1]*B;L[I]=H(S,y,G)}return L}function n(G,H,K){const L=Array(K.length);for(let J=0;J<K.length;J++)L[J]=k(G,H,K[J]);return L}function d(G,H,K,
L){return k(G,K?L?E:A:L?A:z,H)}function b(G,H,K,L){return n(G,K?L?E:A:L?A:z,H)}function a(G,H,K,L){return n(G,K?L?E:A:L?A:z,H)}function c(G,H,K){let [L,J]=K[0],B=Math.min(L,H[0]),y=Math.min(J,H[1]),I=Math.max(L,H[2]);H=Math.max(J,H[3]);for(let S=1;S<K.length;S++){const [O,Y]=K[S];L+=O;J+=Y;0>O&&(B=Math.min(B,L));0<O&&(I=Math.max(I,L));0>Y?y=Math.min(y,J):0<Y&&(H=Math.max(H,J))}G[0]=B;G[1]=y;G[2]=I;G[3]=H;return G}function f(G,H){if(!H.length)return null;G[0]=G[1]=Number.POSITIVE_INFINITY;G[2]=G[3]=
Number.NEGATIVE_INFINITY;for(let K=0;K<H.length;K++)c(G,G,H[K]);return G}function m(G,H,K,L,J){H.xmin=D(G,K.xmin);H.ymin=x(G,K.ymin);H.xmax=D(G,K.xmax);H.ymax=x(G,K.ymax);H!==K&&(L&&(H.zmin=K.zmin,H.zmax=K.zmax),J&&(H.mmin=K.mmin,H.mmax=K.mmax));return H}function h(G,H,K,L,J){H.points=q(G,K.points,L,J);return H}function v(G,H,K,L,J){H.x=D(G,K.x);H.y=x(G,K.y);H!==K&&(L&&(H.z=K.z),J&&(H.m=K.m));return H}function u(G,H,K,L,J){G=p(G,K.rings,L,J);if(!G)return null;H.rings=G;return H}function F(G,H,K,L,
J){G=g(G,K.paths,L,J);if(!G)return null;H.paths=G;return H}const z=(G,H,K)=>[H,K],A=(G,H,K)=>[H,K,G[2]],E=(G,H,K)=>[H,K,G[2],G[3]];r.equals=function(G,H){if(G===H||null==G&&null==H)return!0;if(null==G||null==H)return!1;let K,L,J,B;G&&"upperLeft"===G.originPosition?(K=G.translate[0],L=G.translate[1],G=G.scale[0]):(K=t.isSome(G.extent)?G.extent.xmin:0,L=t.isSome(G.extent)?G.extent.ymax:0,G=G.tolerance);H&&"upperLeft"===H.originPosition?(J=H.translate[0],B=H.translate[1],H=H.scale[0]):(J=t.isSome(H.extent)?
H.extent.xmin:0,B=t.isSome(H.extent)?H.extent.ymax:0,H=H.tolerance);return K===J&&L===B&&G===H};r.getQuantizedBoundsCoordsArray=c;r.getQuantizedBoundsCoordsArrayArray=f;r.getQuantizedBoundsPaths=function(G){return f([0,0,0,0],G)};r.getQuantizedBoundsPoints=function(G){const H=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return c(H,H,G)};r.getQuantizedBoundsRings=function(G){return f([0,0,0,0],G)};r.quantizeBounds=function(G,H,K){H[0]=D(G,K[0]);
H[3]=x(G,K[1]);H[2]=D(G,K[2]);H[1]=x(G,K[3]);return H};r.quantizeExtent=m;r.quantizeGeometry=function(G,H){return G&&H?C.isPoint(H)?v(G,{},H,!1,!1):C.isPolyline(H)?F(G,{},H,!1,!1):C.isPolygon(H)?u(G,{},H,!1,!1):C.isMultipoint(H)?h(G,{},H,!1,!1):C.isExtent(H)?m(G,{},H,!1,!1):null:null};r.quantizeMultipoint=h;r.quantizePaths=g;r.quantizePoint=v;r.quantizePoints=q;r.quantizePolygon=u;r.quantizePolyline=F;r.quantizeRings=p;r.quantizeX=D;r.quantizeY=x;r.toQuantizationTransform=function(G){return G?{originPosition:"upper-left"===
G.originPosition?"upperLeft":"lower-left"===G.originPosition?"lowerLeft":G.originPosition,scale:G.tolerance?[G.tolerance,G.tolerance]:[1,1],translate:t.isSome(G.extent)?[G.extent.xmin,G.extent.ymax]:[0,0]}:null};r.unquantizeBounds=function(G,H,K){return K?(H[0]=e(G,K[0]),H[1]=l(G,K[3]),H[2]=e(G,K[2]),H[3]=l(G,K[1]),H):[e(G,H[0]),l(G,H[3]),e(G,H[2]),l(G,H[1])]};r.unquantizeCoordsArray=k;r.unquantizeCoordsArrayArray=n;r.unquantizeExtent=function(G,H,K,L,J){H.xmin=e(G,K.xmin);H.ymin=l(G,K.ymin);H.xmax=
e(G,K.xmax);H.ymax=l(G,K.ymax);H!==K&&(L&&(H.zmin=K.zmin,H.zmax=K.zmax),J&&(H.mmin=K.mmin,H.mmax=K.mmax));return H};r.unquantizeMultipoint=function(G,H,K,L,J){t.isSome(K)&&(H.points=d(G,K.points,L,J));return H};r.unquantizePaths=b;r.unquantizePoint=function(G,H,K,L,J){if(t.isNone(K))return H;H.x=e(G,K.x);H.y=l(G,K.y);H!==K&&(L&&(H.z=K.z),J&&(H.m=K.m));return H};r.unquantizePoints=d;r.unquantizePolygon=function(G,H,K,L,J){t.isSome(K)&&(H.rings=a(G,K.rings,L,J));return H};r.unquantizePolyline=function(G,
H,K,L,J){t.isSome(K)&&(H.paths=b(G,K.paths,L,J));return H};r.unquantizeRings=a;r.unquantizeX=e;r.unquantizeY=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe","./attributeSupport","../../../statistics/utils"],function(r,t,C){return function(){function D(w,q,p){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=w.returnDistinctValues;this.fieldsIndex=p;this.featureAdapter=
q;if((q=w.outFields)&&-1===q.indexOf("*")){this.outFields=q;w=0;for(const e of q){var g=t.getExpressionFromFieldName(e);g=(q=this.fieldsIndex.get(g))?null:t.getWhereClause(g,p);q=q?q.name:t.getAliasFromFieldName(e)||`FIELD_EXP_${w++}`;this._fieldDataCache.set(e,{alias:q,clause:g})}}}var x=D.prototype;x.countDistinctValues=function(w){if(!this.returnDistinctValues)return w.length;w.forEach(q=>this.getAttributes(q));return this._returnDistinctMap.size};x.getAttributes=function(w){w=this._processAttributesForOutFields(w);
return this._processAttributesForDistinctValues(w)};x.getFieldValue=function(w,q,p){const g=p?p.name:q;let e=null;this._fieldDataCache.has(g)?e=this._fieldDataCache.get(g).clause:p||(e=t.getWhereClause(q,this.fieldsIndex),this._fieldDataCache.set(g,{alias:g,clause:e}));return p?this.featureAdapter.getAttribute(w,g):e.calculateValue(w,this.featureAdapter)};x.getNormalizedValue=function(w,q){const p=q.normalizationType,g=q.normalizationTotal;let e=this.getFieldValue(w,q.field,q.fieldInfo);p&&Number.isFinite(e)&&
(w=this.getFieldValue(w,q.normalizationField,q.normalizationFieldInfo),e=C.getNormalizedValue(e,p,w,g));return e};x.getExpressionValue=function(w,q,p){w={attributes:this.featureAdapter.getAttributes(w)};w=p.createExecContext(w,q.viewInfo);return p.executeFunction(q.compiledFunc,w)};x.validateItem=function(w,q){this._fieldDataCache.has(q)||this._fieldDataCache.set(q,{alias:q,clause:t.getWhereClause(q,this.fieldsIndex)});return this._fieldDataCache.get(q).clause.testFeature(w,this.featureAdapter)};
x.validateItems=function(w,q){this._fieldDataCache.has(q)||this._fieldDataCache.set(q,{alias:q,clause:t.getWhereClause(q,this.fieldsIndex)});return this._fieldDataCache.get(q).clause.testSet(w,this.featureAdapter)};x._processAttributesForOutFields=function(w){const q=this.outFields;if(!q||!q.length)return this.featureAdapter.getAttributes(w);const p={};for(const g of q){const {alias:e,clause:l}=this._fieldDataCache.get(g);p[e]=l?l.calculateValue(w,this.featureAdapter):this.featureAdapter.getAttribute(w,
e)}return p};x._processAttributesForDistinctValues=function(w){if(r.isNone(w)||!this.returnDistinctValues)return w;var q=this.outFields,p=[];if(q)for(const e of q){var {alias:g}=this._fieldDataCache.get(e);p.push(w[g])}else for(g in w)p.push(w[g]);q=`${(q||["*"]).join(",")}=${p.join(",")}`;p=this._returnDistinctMap.get(q)||0;this._returnDistinctMap.set(q,++p);return 1<p?null:w};return D}()})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],
function(r,t,C){function D(h){const v=null!=h.minValue||null!=h.maxValue,u=!!h.sqlExpression&&h.supportsSQLExpression;return!(null!=h.normalizationField||null!=h.normalizationType)&&!v&&!u}function x(h){const {values:v,useSampleStdDev:u,supportsNullCount:F}=h;var z=Number.POSITIVE_INFINITY;let A=Number.NEGATIVE_INFINITY,E=null,G=null;var H=null;let K=null,L=0;const J=null==h.minValue?-Infinity:h.minValue,B=null==h.maxValue?Infinity:h.maxValue;for(const y of v)Number.isFinite(y)?y>=J&&y<=B&&(E+=y,
z=Math.min(z,y),A=Math.max(A,y),L++):"string"===typeof y&&L++;if(L&&null!=E){G=E/L;H=0;for(const y of v)Number.isFinite(y)&&y>=J&&y<=B&&(H+=(y-G)**2);K=u?1<L?H/(L-1):0:0<L?H/L:0;H=Math.sqrt(K)}else A=z=null;z={avg:G,count:L,max:A,min:z,stddev:H,sum:E,variance:K};F&&(z.nullcount=v.length-L);h.percentileParams&&(z.median=w(v,h.percentileParams));return z}function w(h,v){const {fieldType:u,value:F,orderBy:z,isDiscrete:A}=v,E=q(u,"desc"===z);h=[...h].filter(L=>null!=L).sort((L,J)=>E(L,J));if(0===h.length)return null;
if(0>=F)return h[0];if(1<=F)return h[h.length-1];var G=(h.length-1)*F,H=Math.floor(G);v=H+1;G%=1;H=h[H];const K=h[v];return v>=h.length||A||"string"===typeof H||"string"===typeof K?H:H*(1-G)+K*G}function q(h,v){const u=v?1:-1,F=g(v),z=p(v);if(!h||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...f].includes(h))return(A,E)=>"number"===typeof A&&"number"===typeof E?F(A,E):"string"===typeof A&&"string"===typeof E?z(A,E):u;if("esriFieldTypeDate"===h)return(A,E)=>
{A=(new Date(A)).getTime();E=(new Date(E)).getTime();return isNaN(A)||isNaN(E)?u:F(A,E)};if(f.has(h))return(A,E)=>F(A,E);if("esriFieldTypeString"===h)return(A,E)=>z(A,E);if("esriFieldTypeGUID"===h||"esriFieldTypeGlobalID"===h){const A=p(v);return(E,G)=>A(e(E),e(G))}return v?(A,E)=>1:(A,E)=>-1}function p(h){return h?(v,u)=>{v=v.toUpperCase();u=u.toUpperCase();return v>u?-1:v<u?1:0}:(v,u)=>{v=v.toUpperCase();u=u.toUpperCase();return v<u?-1:v>u?1:0}}function g(h){return h?(v,u)=>u-v:(v,u)=>v-u}function e(h){return h.substr(24,
12)+h.substr(19,4)+h.substr(16,2)+h.substr(14,2)+h.substr(11,2)+h.substr(9,2)+h.substr(6,2)+h.substr(4,2)+h.substr(2,2)+h.substr(0,2)}function l(h,v){const u=n({field:v.field,normalizationType:v.normalizationType,normalizationField:v.normalizationField,classificationMethod:v.classificationMethod,standardDeviationInterval:v.standardDeviationInterval,breakCount:v.numClasses||5});h=k(h,v.minValue,v.maxValue);return C.createGenerateRendererClassBreaks({definition:u,values:h,normalizationTotal:v.normalizationTotal})}
function k(h,v,u){v=null==v?-Infinity:v;u=null==u?Infinity:u;return h.filter(F=>Number.isFinite(F)&&F>=v&&F<=u)}function n(h){const v=h.field,u=h.classificationMethod||"equal-interval",F=h.normalizationType,z=h.normalizationField,A=new t;A.classificationField=v;A.breakCount=h.breakCount;A.classificationMethod=u;A.standardDeviationInterval="standard-deviation"===u?h.standardDeviationInterval||1:void 0;A.normalizationType=F;A.normalizationField="field"===F?z:void 0;return A}function d(h,v){const {field:u,
classificationMethod:F,standardDeviationInterval:z,normalizationType:A,normalizationField:E,normalizationTotal:G,minValue:H,maxValue:K}=v,L=v.numBins||10;let J=v=null,B=null;F&&"equal-interval"!==F||A?({classBreaks:h}=l(h,{field:u,normalizationType:A,normalizationField:E,normalizationTotal:G,classificationMethod:F,standardDeviationInterval:z,minValue:H,maxValue:K,numClasses:L}),v=h[0].minValue,J=h[h.length-1].maxValue,B=h.map(y=>[y.minValue,y.maxValue])):(null!=H&&null!=K?(v=H,J=K):(h=x({values:h,
minValue:H,maxValue:K,useSampleStdDev:!A,supportsNullCount:D({normalizationType:A,normalizationField:E,minValue:H,maxValue:K})}),v=h.min,J=h.max),B=a(v,J,L));return{min:v,max:J,intervals:B}}function b(h,v){let u=-1;for(let F=h.length-1;0<=F;F--)if(v>=h[F][0]){u=F;break}return u}function a(h,v,u){const F=(v-h)/u,z=[];let A;for(let E=1;E<=u;E++)A=h+F,A=Number(A.toFixed(16)),z.push([h,E===u?v:A]),h=A;return z}const c=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,f=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger",
"esriFieldTypeSingle","esriFieldTypeDouble"]),m="min max avg stddev count sum variance nullcount median".split(" ");r.calculateClassBreaks=l;r.calculateHistogram=function(h,v){const {min:u,max:F,intervals:z}=d(h,v),A=z.map((E,G)=>({minValue:z[G][0],maxValue:z[G][1],count:0}));for(const E of h)null!=E&&E>=u&&E<=F&&(h=b(z,E),-1<h&&A[h].count++);return{bins:A,minValue:u,maxValue:F,normalizationTotal:v.normalizationTotal}};r.calculatePercentile=w;r.calculateStatistics=x;r.calculateStringStatistics=function(h){const v=
h.returnDistinct?[...new Set(h.values)]:h.values,u=v.filter(z=>null!=z).length,F={count:u};h.supportsNullCount&&(F.nullcount=v.length-u);h.percentileParams&&(F.median=w(v,h.percentileParams));return F};r.calculateUniqueValuesCount=function(h){const v={};for(let u of h){if(null==u||"string"===typeof u&&""===u.trim())u=null;null==v[u]?v[u]={count:1,data:u}:v[u].count++}return{count:v}};r.createClassBreaksDefinition=n;r.createUVResult=function(h,v,u){const F=h.count;h=[];u&&v&&"coded-value"===v.type&&
v.codedValues.forEach(z=>{z=z.code;F.hasOwnProperty(z)||(F[z]={data:z,count:0})});for(const z in F)v=F[z],h.push({value:v.data,count:v.count,label:v.label});return{uniqueValueInfos:h}};r.getAttributeComparator=q;r.getEqualIntervalBins=a;r.getNormalizedValue=function(h,v,u,F){let z=null;switch(v){case "log":0!==h&&(z=Math.log(h)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(F)&&0!==F&&(z=h/F*100);break;case "field":Number.isFinite(u)&&0!==u&&(z=h/u);break;case "natural-log":0<h&&(z=Math.log(h));
break;case "square-root":0<h&&(z=h**.5)}return z};r.isNullCountSupported=D;r.processSummaryStatisticsResult=function(h,v){let u;for(u in h)-1<m.indexOf(u)&&(Number.isFinite(h[u])||(h[u]=null));if(!v)return h;["avg","stddev","variance"].forEach(F=>{null!=h[F]&&(h[F]=Math.ceil(h[F]))});return h};r.resolveCBResult=function(h,v){let u=h.classBreaks;const F=u[0].minValue,z=u[u.length-1].maxValue,A="standard-deviation"===v;u=u.map(E=>{const G=E.label;E={minValue:E.minValue,maxValue:E.maxValue,label:G};
if(A&&G){const H=G.match(c).map(K=>+K.trim());2===H.length?(E.minStdDev=H[0],E.maxStdDev=H[1],0>H[0]&&0<H[1]&&(E.hasAvg=!0)):1===H.length&&(G.includes("\x3c")?(E.minStdDev=null,E.maxStdDev=H[0]):G.includes("\x3e")&&(E.minStdDev=H[0],E.maxStdDev=null))}return E});return{minValue:F,maxValue:z,classBreakInfos:u,normalizationTotal:h.normalizationTotal}};r.statisticTypes=m;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),
function(r,t,C,D,x,w,q,p,g){x=new C.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});C=new C.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});g=function(e){function l(){var k=e.apply(this,arguments)||this;k.breakCount=null;k.classificationField=
null;k.classificationMethod=null;k.normalizationField=null;k.normalizationType=null;k.type="class-breaks-definition";return k}r._inheritsLoose(l,e);r._createClass(l,[{key:"standardDeviationInterval",set:function(k){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",k)}},{key:"definedInterval",set:function(k){"defined-interval"===this.classificationMethod&&this._set("definedInterval",k)}}]);return l}(g);t.__decorate([D.property({json:{write:!0}})],g.prototype,"breakCount",
void 0);t.__decorate([D.property({json:{write:!0}})],g.prototype,"classificationField",void 0);t.__decorate([D.property({type:String,json:{read:x.read,write:x.write}})],g.prototype,"classificationMethod",void 0);t.__decorate([D.property({json:{write:!0}})],g.prototype,"normalizationField",void 0);t.__decorate([D.property({json:{read:C.read,write:C.write}})],g.prototype,"normalizationType",void 0);t.__decorate([D.property({value:null,json:{write:!0}})],g.prototype,"standardDeviationInterval",null);
t.__decorate([D.property({value:null,json:{write:!0}})],g.prototype,"definedInterval",null);t.__decorate([D.property()],g.prototype,"type",void 0);return g=t.__decorate([p.subclass("esri.rest.support.ClassBreaksDefinition")],g)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){C=new C.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});D=function(k){function n(){var d=k.apply(this,arguments)||this;d.baseSymbol=null;d.colorRamp=null;d.type=null;return d}r._inheritsLoose(n,k);return n}(D.JSONSupport);t.__decorate([x.property({type:l,json:{write:!0}})],D.prototype,"baseSymbol",void 0);t.__decorate([x.property({types:e.types,json:{read:{reader:e.fromJSON},write:!0}})],D.prototype,"colorRamp",void 0);t.__decorate([x.property({json:{read:C.read,
write:C.write}})],D.prototype,"type",void 0);return D=t.__decorate([g.subclass("esri.rest.support.ClassificationDefinition")],D)})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(r,t,C,D){C={key:"type",base:C,typeMap:{algorithmic:t,multipart:D}};r.fromJSON=function(x){return x&&x.type?"algorithmic"===x.type?t.fromJSON(x):"multipart"===x.type?D.fromJSON(x):null:null};r.types=C;Object.defineProperty(r,"__esModule",
{value:!0})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),function(r,t,C,D,x,w,q,p,g){var e;g=e=function(l){function k(n){n=l.call(this,n)||this;n.algorithm=null;n.fromColor=null;n.toColor=
null;n.type="algorithmic";return n}r._inheritsLoose(k,l);k.prototype.clone=function(){return new e({fromColor:D.clone(this.fromColor),toColor:D.clone(this.toColor),algorithm:this.algorithm})};return k}(g);t.__decorate([q.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],g.prototype,"algorithm",void 0);t.__decorate([x.property({type:C,json:{type:[w.Integer],write:!0}})],g.prototype,"fromColor",void 0);t.__decorate([x.property({type:C,json:{type:[w.Integer],
write:!0}})],g.prototype,"toColor",void 0);t.__decorate([x.property({type:["algorithmic"]})],g.prototype,"type",void 0);return g=e=t.__decorate([p.subclass("esri.rest.support.AlgorithmicColorRamp")],g)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(r,t,C){r.enumeration=function(D,x={}){var w;D=D instanceof t.JSONMap?D:new t.JSONMap(D,x);D={type:(null!=(w=null==x?void 0:x.ignoreUnknown)?w:1)?D.apiValues:String,readOnly:null==
x?void 0:x.readOnly,json:{type:D.jsonValues,read:null!=x&&x.readOnly?!1:{reader:D.read},write:{writer:D.write}}};void 0!==(null==x?void 0:x.default)&&(D.json.default=x.default);void 0!==(null==x?void 0:x.name)&&(D.json.name=x.name);return C.property(D)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/ColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p){C=function(g){function e(l){l=g.call(this,l)||this;l.type=null;return l}r._inheritsLoose(e,g);return e}(C.JSONSupport);t.__decorate([D.property({readOnly:!0,json:{read:!1,write:!0}})],C.prototype,"type",void 0);return C=t.__decorate([p.subclass("esri.rest.support.ColorRamp")],C)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),
function(r,t,C,D,x,w,q,p){var g;x=g=function(e){function l(k){k=e.call(this,k)||this;k.colorRamps=null;k.type="multipart";return k}r._inheritsLoose(l,e);l.prototype.clone=function(){return new g({colorRamps:C.clone(this.colorRamps)})};return l}(p);t.__decorate([D.property({type:[q],json:{write:!0}})],x.prototype,"colorRamps",void 0);t.__decorate([D.property({type:["multipart"]})],x.prototype,"type",void 0);return x=g=t.__decorate([w.subclass("esri.rest.support.MultipartColorRamp")],x)})},"esri/symbols/Symbol":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){D=new D.JSONMap({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let k=0;x=function(n){function d(a){a=n.call(this,a)||this;a.id=`sym${k++}`;a.type=null;return a}r._inheritsLoose(d,
n);var b=d.prototype;b.readColor=function(a){return a&&null!=a[0]?[a[0],a[1],a[2],a[3]/255]:a};b.collectRequiredFields=function(){var a=r._asyncToGenerator(function*(c,f){});return function(c,f){return a.apply(this,arguments)}}();b.hash=function(){return JSON.stringify(this.toJSON())};b.clone=function(){};r._createClass(d,[{key:"color",set:function(a){this._set("color",a)}}]);return d}(x.JSONSupport);t.__decorate([w.property({type:D.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:D.write}}})],
x.prototype,"type",void 0);t.__decorate([w.property({type:C,value:new C([0,0,0,1]),json:{write:{allowNull:!0}}})],x.prototype,"color",null);t.__decorate([e.reader("color")],x.prototype,"readColor",null);return x=t.__decorate([l.subclass("esri.symbols.Symbol")],x)})},"esri/rest/support/generateRendererUtils":function(){define(["exports"],function(r){function t(l){const {classificationMethod:k,breakCount:n,normalizationType:d,definedInterval:b}=l.definition,a=[];var c=l.values;if(0===c.length)return[];
c=c.sort((F,z)=>F-z);var f=c[0],m=c[c.length-1];if("equal-interval"===k)if(c.length>=n){c=(m-f)/n;l=f;for(var h=1;h<n;h++){var v=Number((f+h*c).toFixed(6));a.push({minValue:l,maxValue:v,label:C(l,v,d)});l=v}a.push({minValue:l,maxValue:m,label:C(l,m,d)})}else c.forEach(F=>{a.push({minValue:F,maxValue:F,label:C(F,F,d)})});else if("natural-breaks"===k){c=D(c);l=x(c.uniqueValues,l.valueFrequency||c.valueFrequency,n);for(h=1;h<n;h++)c.uniqueValues.length>h&&(v=Number(c.uniqueValues[l[h]].toFixed(6)),a.push({minValue:f,
maxValue:v,label:C(f,v,d)}),f=v);a.push({minValue:f,maxValue:m,label:C(f,m,d)})}else if("quantile"===k)if(c.length>=n&&f!==m){l=Math.ceil(c.length/n);h=0;for(v=1;v<n;v++){var u=l+h-1;u>c.length&&(u=c.length-1);0>u&&(u=0);a.push({minValue:f,maxValue:c[u],label:C(f,c[u],d)});f=c[u];h+=l;l=Math.ceil((c.length-h)/(n-v))}a.push({minValue:f,maxValue:m,label:C(f,m,d)})}else for(m=-1,f=0;f<c.length;f++)l=c[f],l!==m&&(m=l,a.push({minValue:m,maxValue:l,label:C(m,l,d)}),m=l);else if("standard-deviation"===k)if(l=
p(c),h=g(c,l),0===h)a.push({minValue:c[0],maxValue:c[0],label:C(c[0],c[0],d)});else{c=q(f,m,n,l,h)*h;h=0;for(v=n;1<=v;v--)u=Number((l-(v-.5)*c).toFixed(6)),a.push({minValue:f,maxValue:u,label:C(f,u,d)}),f=u,h++;v=Number((l+.5*c).toFixed(6));a.push({minValue:f,maxValue:v,label:C(f,v,d)});f=v;h++;for(u=1;u<=n;u++)v=h===2*n?m:Number((l+(u+.5)*c).toFixed(6)),a.push({minValue:f,maxValue:v,label:C(f,v,d)}),f=v,h++}else if("defined-interval"===k){if(!b)return a;m=c[0];c=c[c.length-1];f=Math.ceil((c-m)/b);
l=m;for(h=1;h<f;h++)v=Number((m+h*b).toFixed(6)),a.push({minValue:l,maxValue:v,label:C(l,v,d)}),l=v;a.push({minValue:l,maxValue:c,label:C(l,c,d)})}return a}function C(l,k,n){let d=null;return d=l===k?n&&"percent-of-total"===n?l+"%":l.toString():n&&"percent-of-total"===n?l+"% - "+k+"%":l+" - "+k}function D(l){const k=[],n=[];let d=Number.MIN_VALUE,b=1,a=-1;for(let c=0;c<l.length;c++){const f=l[c];f===d?(b++,n[a]=b):null!==f&&(k.push(f),d=f,b=1,n.push(b),a++)}return{uniqueValues:k,valueFrequency:n}}
function x(l,k,n){var d=l.length;const b=[];n>d&&(n=d);for(var a=0;a<n;a++)b.push(Math.round(a*d/n-1));b.push(d-1);a=w(b,l,k,n);{d=a.mean;a=a.sdcm;var c=n,f=0,m=0;let v=0,u=0,F=!0;for(let z=0;2>z&&F;z++){0===z&&(F=!1);for(var h=0;h<c-1;h++)for(;b[h+1]+1!==b[h+2];)if(b[h+1]+=1,f=e(h,b,l,k),v=f.sbMean,f=f.sbSdcm,m=e(h+1,b,l,k),u=m.sbMean,m=m.sbSdcm,f+m<a[h]+a[h+1])a[h]=f,a[h+1]=m,d[h]=v,d[h+1]=u,F=!0;else{--b[h+1];break}for(h=c-1;0<h;h--)for(;b[h]!==b[h-1]+1;)if(--b[h],f=e(h-1,b,l,k),v=f.sbMean,f=f.sbSdcm,
m=e(h,b,l,k),u=m.sbMean,m=m.sbSdcm,f+m<a[h-1]+a[h])a[h-1]=f,a[h]=m,d[h-1]=v,d[h]=u,F=!0;else{b[h]+=1;break}}d=F}d&&(a=w(b,l,k,n));return b}function w(l,k,n,d){let b=[];var a=[],c=[];let f=0;const m=[],h=[];for(var v=0;v<d;v++){var u=e(v,l,k,n);m.push(u.sbMean);h.push(u.sbSdcm);f+=h[v]}u=f;for(v=!0;v||f<u;){v=!1;b=[];for(a=0;a<d;a++)b.push(l[a]);for(c=0;c<d;c++)for(u=l[c]+1;u<=l[c+1];u++)if(a=k[u],0<c&&u!==l[c+1]&&Math.abs(a-m[c])>Math.abs(a-m[c-1]))l[c]=u;else if(c<d-1&&l[c]!==u-1&&Math.abs(a-m[c])>
Math.abs(a-m[c+1])){l[c+1]=u-1;break}u=f;f=0;a=[];c=[];for(let F=0;F<d;F++){a.push(m[F]);c.push(h[F]);const z=e(F,l,k,n);m[F]=z.sbMean;h[F]=z.sbSdcm;f+=h[F]}}if(f>u){for(k=0;k<d;k++)l[k]=b[k],m[k]=a[k],h[k]=c[k];f=u}return{mean:m,sdcm:h}}function q(l,k,n,d,b){l=Math.max(d-l,k-d)/b/n;return 1<=l?1:.5<=l?.5:.25}function p(l){let k=0;for(let n=0;n<l.length;n++)k+=l[n];return k/=l.length}function g(l,k){let n=0;for(let d=0;d<l.length;d++){const b=l[d];n+=(b-k)*(b-k)}n/=l.length;return Math.sqrt(n)}function e(l,
k,n,d){var b=0,a=0;for(var c=k[l]+1;c<=k[l+1];c++){const f=d[c];b+=n[c]*f;a+=f}0>=a&&console.log("Exception in Natural Breaks calculation");b/=a;a=0;for(c=k[l]+1;c<=k[l+1];c++)a+=d[c]*(n[c]-b)**2;return{sbMean:b,sbSdcm:a}}r.createGenerateRendererClassBreaks=function(l){const {normalizationTotal:k}=l;return{classBreaks:t(l),normalizationTotal:k}};r.createGenerateRendererUniqueValues=function(l){l=D(l);const k=[],n=l.uniqueValues.length;for(let d=0;d<n;d++){const b=l.uniqueValues[d];k.push({value:b,
count:l.valueFrequency[d],label:b.toString()})}return{uniqueValues:k}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(r){function t(x,w,q,p,g){if(null!=p&&null!=g)return e=>{const l=x.getAttribute(e,w);e=x.getAttribute(e,q);return(null==l||l<=g)&&(null==e||e>=p)};if(null!=p)return e=>{e=x.getAttribute(e,q);return null==e||e>=p};if(null!=g)return e=>{e=x.getAttribute(e,w);return null==e||e<=g}}function C(x,w,q,p){if(null!=
q&&null!=p&&q===p)return g=>x.getAttribute(g,w)===q;if(null!=q&&null!=p)return g=>{g=x.getAttribute(g,w);return g>=q&&g<=p};if(null!=q)return g=>x.getAttribute(g,w)>=q;if(null!=p)return g=>x.getAttribute(g,w)<=p}function D(){return()=>!1}r.getTimeExtent=function(x,w){if(!x)return null;const q=w.featureAdapter,{startTimeField:p,endTimeField:g}=x;let e=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(p&&g)w.forEach(k=>{const n=q.getAttribute(k,p);k=q.getAttribute(k,g);null==n||isNaN(n)||(e=Math.min(e,
n));null==k||isNaN(k)||(l=Math.max(l,k))});else{const k=p||g;w.forEach(n=>{n=q.getAttribute(n,k);null==n||isNaN(n)||(e=Math.min(e,n),l=Math.max(l,n))})}return{start:e,end:l}};r.getTimeOperator=function(x,w,q){if(!w||!x)return null;const {startTimeField:p,endTimeField:g}=x;if(!p&&!g)return null;const {start:e,end:l}=w;return null===e&&null===l?null:void 0===e&&void 0===l?D():p&&g?t(q,p,g,e,l):C(q,p||g,e,l)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d){function b(J,B,y,I=J.hasZ,S=J.hasM){if(x.isNone(B))return null;const O=J.hasZ&&I,Y=J.hasM&&S;return y?(J=k.quantizeOptimizedGeometry(H,B,J.hasZ,J.hasM,"esriGeometryPoint",y,I,S),k.convertToPoint(J,O,Y)):k.convertToPoint(B,O,Y)}function a(){a=C._asyncToGenerator(function*(J,B,y){const {outFields:I,orderByFields:S,groupByFieldsForStatistics:O,outStatistics:Y}=J;if(I)for(var R=0;R<I.length;R++)I[R]=I[R].trim();if(S)for(R=0;R<S.length;R++)S[R]=S[R].trim();if(O)for(R=
0;R<O.length;R++)O[R]=O[R].trim();if(Y)for(R=0;R<Y.length;R++)Y[R].onStatisticField&&(Y[R].onStatisticField=Y[R].onStatisticField.trim());J.geometry&&!J.outSR&&(J.outSR=J.geometry.spatialReference);return f(J,B,y)});return a.apply(this,arguments)}function c(){c=C._asyncToGenerator(function*(J,B,y){return f(J,B,y)});return c.apply(this,arguments)}function f(J,B,y){return m.apply(this,arguments)}function m(){m=C._asyncToGenerator(function*(J,B,y){if(!J)return null;var {where:I}=J;J.where=I=I&&I.trim();
if(!I||/^1 *= *1$/.test(I)||B&&B===I)J.where=null;if(!J.geometry)return J;B=yield h(J);J.distance=0;J.units=null;"esriSpatialRelEnvelopeIntersects"===J.spatialRel&&({spatialReference:I}=J.geometry,B=q.getGeometryExtent(B),B.spatialReference=I);J.geometry=B;yield d.checkProjectionSupport(B.spatialReference,y);B=(yield g.normalizeCentralMeridian(p.fromJSON(B)))[0];if(x.isNone(B))throw A;B=B.toJSON();B=yield d.project(B,B.spatialReference,y);if(!B)throw A;B.spatialReference=y;J.geometry=B;return J});
return m.apply(this,arguments)}function h(J){return v.apply(this,arguments)}function v(){v=C._asyncToGenerator(function*(J){const {geometry:B,distance:y,units:I}=J;if(null==y||"vertexAttributes"in B)return B;var S=B.spatialReference;J=I?z.fromJSON(I):w.getUnitString(S);S=S&&(e.isGeographic(S)||e.isWebMercator(S))?B:yield d.checkProjectionSupport(S,e.WGS84).then(()=>d.project(B,e.WGS84));return(yield u())(S.spatialReference,S,y,J)});return v.apply(this,arguments)}function u(){return F.apply(this,arguments)}
function F(){F=C._asyncToGenerator(function*(){return(yield new Promise((J,B)=>r(["../../../geometry/geometryEngineJSON"],J,B))).geodesicBuffer});return F.apply(this,arguments)}const z=new D.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),A=Object.freeze({}),E=new n,G=new n,H=new n,K={esriGeometryPoint:k.convertToPoint,esriGeometryPolyline:k.convertToPolyline,
esriGeometryPolygon:k.convertToPolygon,esriGeometryMultipoint:k.convertToMultipoint},L=(J,B)=>"_geVersion"!==J?B:void 0;t.QUERY_ENGINE_EMPTY_RESULT=A;t.cleanFromGeometryEngine=function(J){return J&&"_geVersion"in J?JSON.parse(JSON.stringify(J,L)):J};t.getCentroid=function(J,B,y){if("esriGeometryPolygon"!==J.geometryType||!B||!B.centroid&&!B.geometry)return null;B.centroid||(B.centroid=l.getCentroidOptimizedGeometry(new n,B.geometry,J.hasZ,J.hasM));return b(J,B.centroid,y)};t.getGeometry=function(J,
B,y,I,S,O,Y=B,R=y){const Q=B&&Y,W=y&&R;I=x.isSome(I)?"coords"in I?I:I.geometry:null;if(x.isNone(I))return null;if(S)return B=k.generalizeOptimizedGeometry(G,I,B,y,J,S,Y,R),O&&(B=k.quantizeOptimizedGeometry(H,B,Q,W,J,O)),K[J](B,Q,W);if(O)return O=k.quantizeOptimizedGeometry(H,I,B,y,J,O,Y,R),K[J](O,Q,W);k.removeZMValues(E,I,B,y,Y,R);return K[J](E,Q,W)};t.normalizeFilter=function(J,B,y){return c.apply(this,arguments)};t.normalizeQuery=function(J,B,y){return a.apply(this,arguments)};t.normalizeQueryLike=
f;t.transformCentroid=b;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(r,t){function C(x,w,q,p,g,e,l=1){e=g?e?4:3:e?3:2;let k=q,n=q+e,d=0,b=0,a=q=0,c=0;for(let f=0,m=p-1;f<m;f++,k+=e,n+=e){p=w[k];const h=w[k+1],v=w[k+2],u=w[n],F=w[n+1],z=w[n+2];let A=p*F-u*h;a+=A;d+=(p+u)*A;b+=(h+F)*A;g&&(A=p*z-u*v,q+=(v+z)*A,c+=A);p<x[0]&&(x[0]=p);p>x[1]&&(x[1]=p);h<x[2]&&(x[2]=h);h>x[3]&&(x[3]=h);g&&(v<x[4]&&(x[4]=v),
v>x[5]&&(x[5]=v))}0<a*l&&(a*=-1);0<c*l&&(c*=-1);if(!a)return null;x=[d,b,.5*a];g&&(x[3]=q,x[4]=.5*c);return x}function D(x,w,q,p,g){g=p?g?4:3:g?3:2;let e=w,l=w+g,k=0,n=0,d=0,b=0;for(let m=0,h=q-1;m<h;m++,e+=g,l+=g){var a=x[e];const v=x[e+1],u=x[e+2],F=x[l],z=x[l+1],A=x[l+2];if(p){{var c=F-a;var f=z-v;const E=A-u;c=Math.sqrt(c*c+f*f+E*E)}}else c=F-a,f=z-v,c=Math.sqrt(c*c+f*f);c&&(k+=c,p?(a=[a+.5*(F-a),v+.5*(z-v),u+.5*(A-u)],n+=c*a[0],d+=c*a[1],b+=c*a[2]):(a=[a+.5*(F-a),v+.5*(z-v)],n+=c*a[0],d+=c*a[1]))}return 0<
k?p?[n/k,d/k,b/k]:[n/k,d/k]:0<q?p?[x[w],x[w+1],x[w+2]]:[x[w],x[w+1]]:null}r.getCentroidOptimizedGeometry=function(x,w,q,p,g){if(t.isNone(w)||!w.lengths.length)return null;const e="upperLeft"===(null==g?void 0:g.originPosition)?-1:1;x.lengths.length&&(x.lengths.length=0);x.coords.length&&(x.coords.length=0);g=x.coords;const l=[],k=q?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:n,coords:d}=w,b=q?p?4:3:p?3:2;let a=0;for(var c of n){const f=C(k,d,a,c,q,p,e);f&&l.push(f);a+=c*b}l.sort((f,m)=>{let h=e*f[2]-e*m[2];0===h&&q&&(h=f[4]-m[4]);return h});l.length&&(c=6*l[0][2],g[0]=l[0][0]/c,g[1]=l[0][1]/c,q&&(c=6*l[0][4],g[2]=0!==c?l[0][3]/c:0),g[0]<k[0]||g[0]>k[1]||g[1]<k[2]||g[1]>k[3]||q&&(g[2]<k[4]||g[2]>k[5]))&&(g.length=0);if(!g.length)if(w=w.lengths[0]?D(d,0,n[0],q,p):null)g[0]=w[0],g[1]=w[1],
q&&2<w.length&&(g[2]=w[2]);else return null;return x};r.lineCentroid=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/fieldUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/Error ../../core/maybe ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),function(r,t,C,D,x,w,q,p){function g(aa,da,ia){if(aa)for(const va of aa)(aa=(aa=w.getDeepValue(va,da))&&"function"!==typeof aa&&ia.get(aa))&&w.setDeepValue(va,aa.name,
da)}function e(aa,da){if(!aa||!da)return[];T.clear();l(T,aa,da);return Array.from(T).sort()}function l(aa,da,ia){var va;if(ia)if(null!=da&&null!=(va=da.fields)&&va.length)if(ia.includes("*"))for(const {name:wa}of da.fields)aa.add(wa);else for(const wa of ia)k(aa,da,wa);else if(ia.includes("*"))aa.clear(),aa.add("*");else for(const wa of ia)aa.add(wa)}function k(aa,da,ia){"string"===typeof ia&&(da?(da=da.get(ia))&&aa.add(da.name):aa.add(ia))}function n(aa,da,ia){return d.apply(this,arguments)}function d(){d=
C._asyncToGenerator(function*(aa,da,ia){var va;if(ia){var {arcadeUtils:wa}=yield p.loadArcade();ia=wa.extractFieldNames(ia,null==da?void 0:null==(va=da.fields)?void 0:va.map(Aa=>Aa.name));for(const Aa of ia)k(aa,da,Aa)}});return d.apply(this,arguments)}function b(aa,da,ia){return a.apply(this,arguments)}function a(){a=C._asyncToGenerator(function*(aa,da,ia){if(ia&&"1\x3d1"!==ia){ia=(yield new Promise((va,wa)=>r(["../../core/sql/WhereClause"],va,wa))).WhereClause.create(ia,da);if(!ia.isStandardized)throw new D("fieldUtils:collectFilterFields",
"Where clause is not standardized");l(aa,da,ia.fieldNames)}});return a.apply(this,arguments)}function c(aa,da){for(const ia of aa)if(ia&&ia.valueType&&ia.valueType===da)return ia.name;return null}function f(){f=C._asyncToGenerator(function*(aa){if(!aa)return[];const da=new Set;yield m(da,aa);return Array.from(da).sort()});return f.apply(this,arguments)}function m(aa,da){return h.apply(this,arguments)}function h(){h=C._asyncToGenerator(function*(aa,da){if(da){var ia=w.getDeepValue("elevationInfo.featureExpressionInfo",
da);if(ia)return ia.collectRequiredFields(aa,da.fieldsIndex)}});return h.apply(this,arguments)}function v(aa,da,ia){return u.apply(this,arguments)}function u(){u=C._asyncToGenerator(function*(aa,da,ia){ia.outStatistic.onStatisticValueExpression?n(aa,da,ia.outStatistic.onStatisticValueExpression):aa.add(ia.outStatistic.onStatisticField)});return u.apply(this,arguments)}function F(){F=C._asyncToGenerator(function*(aa,da,ia){var va,wa;if(da&&ia&&"cluster"===ia.type){var Aa=[];null!=(va=ia.popupTemplate)&&
va.expressionInfos&&Aa.push(...ia.popupTemplate.expressionInfos.map(Ba=>n(aa,da.fieldsIndex,Ba.expression)));if(Array.isArray(null==(wa=ia.popupTemplate)?void 0:wa.content)){va=ia.popupTemplate.content;for(const Ba of va)"expression"===Ba.type&&Ba.expressionInfo&&Aa.push(n(aa,da.fieldsIndex,Ba.expressionInfo.expression))}ia.fields&&Aa.push(...ia.fields.map(Ba=>v(aa,da.fieldsIndex,Ba)));yield Promise.all(Aa)}});return F.apply(this,arguments)}function z(){z=C._asyncToGenerator(function*(aa,da,ia){da&&
(da.timeInfo&&x.isSome(ia)&&ia.timeExtent&&l(aa,da.fieldsIndex,[da.timeInfo.startField,da.timeInfo.endField]),da.floorInfo&&l(aa,da.fieldsIndex,[da.floorInfo.floorField]),x.isSome(ia)&&x.isSome(ia.where)&&(yield b(aa,da.fieldsIndex,ia.where)))});return z.apply(this,arguments)}function A(){A=C._asyncToGenerator(function*(aa,da,ia){da&&ia&&(yield Promise.all(ia.map(va=>E(aa,da,va))))});return A.apply(this,arguments)}function E(aa,da,ia){return G.apply(this,arguments)}function G(){G=C._asyncToGenerator(function*(aa,
da,ia){da&&ia&&(ia.valueExpression?yield n(aa,da.fieldsIndex,ia.valueExpression):ia.field&&k(aa,da.fieldsIndex,ia.field))});return G.apply(this,arguments)}function H(){H=C._asyncToGenerator(function*(aa){if(!aa)return[];const da="timeInfo"in aa&&aa.timeInfo;return da?e(aa.fieldsIndex,[aa.trackIdField,da.startField,da.endField]):[]});return H.apply(this,arguments)}function K(){K=C._asyncToGenerator(function*(aa){if(!aa)return[];const da=new Set;yield L(da,aa);return Array.from(da).sort()});return K.apply(this,
arguments)}function L(aa,da){return J.apply(this,arguments)}function J(){J=C._asyncToGenerator(function*(aa,da){const {labelingInfo:ia,fieldsIndex:va}=da;ia&&ia.length&&(yield Promise.all(ia.map(wa=>B(aa,va,wa))))});return J.apply(this,arguments)}function B(aa,da,ia){return y.apply(this,arguments)}function y(){y=C._asyncToGenerator(function*(aa,da,ia){if(ia){var va=ia.getLabelExpression();ia=ia.where;"arcade"===va.type?yield n(aa,da,va.expression):(va=va.expression.match(/{[^}]*}/g))&&va.forEach(wa=>
{k(aa,da,wa.slice(1,-1))});yield b(aa,da,ia)}});return y.apply(this,arguments)}function I(aa){return"number"===typeof aa&&!isNaN(aa)&&isFinite(aa)}function S(aa){return null===aa||I(aa)}function O(aa){return null===aa||ha(aa)}function Y(aa){return null!=aa&&"string"===typeof aa}function R(aa){return null===aa||Y(aa)}function Q(){return!0}function W(aa,da){let ia;switch(aa.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":ia=
aa.nullable?O:ha;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":ia=aa.nullable?S:I;break;case "string":case "esriFieldTypeString":ia=aa.nullable?R:Y;break;default:ia=Q}return 1===arguments.length?ia:ia(da)}function P(aa){return null!=aa&&Z.has(aa.type)}function fa(aa,da){return aa.nullable&&null===da?null:P(aa)&&!oa(aa.type,Number(da))?t.NumericRangeValidationError.OUT_OF_RANGE:W(aa,da)?aa.domain?q.validateDomainValue(aa.domain,da):null:t.TypeValidationError.INVALID_TYPE}
function oa(aa,da){return(aa="string"===typeof aa?pa(aa):aa)?aa.isInteger?ha(da)&&da>=aa.min&&da<=aa.max:da>=aa.min&&da<=aa.max:!1}function pa(aa){switch(aa){case "esriFieldTypeSmallInteger":case "small-integer":return ca;case "esriFieldTypeInteger":case "integer":return ea;case "esriFieldTypeSingle":case "single":return ja;case "esriFieldTypeDouble":case "double":return la}}function sa(aa,da,ia){if(!da||!da.attributes||!aa){if(x.isSome(ia))for(var va of aa)ia.add(va);return!0}da=da.attributes;va=
!1;for(const wa of aa)if(!(wa in da))if(va=!0,x.isSome(ia))ia.add(wa);else break;return va}function ra(){ra=C._asyncToGenerator(function*(aa,da){const ia=new Set;for(const va of da)yield n(ia,aa.fieldsIndex,va);return Array.from(ia).sort()});return ra.apply(this,arguments)}const ua="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),M=["field","normalizationField"],
T=new Set,ha=(()=>"isInteger"in Number?Number.isInteger:aa=>"number"===typeof aa&&isFinite(aa)&&Math.floor(aa)===aa)(),V=["integer","small-integer","single","double"],Z=new Set([...V,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);t.NumericRangeValidationError=void 0;(t.NumericRangeValidationError||(t.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";t.TypeValidationError=void 0;(t.TypeValidationError||(t.TypeValidationError=
{})).INVALID_TYPE="type-validation-error::invalid-type";const ca={min:-32768,max:32767,isInteger:!0},ea={min:-2147483648,max:2147483647,isInteger:!0},ja={min:-3.4E38,max:1.2E38,isInteger:!1},la={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};t.collectArcadeFieldNames=n;t.collectElevationFields=m;t.collectFeatureReductionFields=function(aa,da,ia){return F.apply(this,arguments)};t.collectField=k;t.collectFields=l;t.collectFilterFields=function(aa,da,ia){return z.apply(this,arguments)};t.collectLabelingFields=
L;t.collectOrderByInfos=function(aa,da,ia){return A.apply(this,arguments)};t.doubleRange=la;t.featureHasFields=function(aa,da){return!sa(aa,da,null)};t.fixFields=e;t.fixRendererFields=function(aa,da){if(null!=aa&&null!=da)for(const ia of Array.isArray(aa)?aa:[aa])if(g(ua,ia,da),"visualVariables"in ia&&ia.visualVariables)for(const va of ia.visualVariables)g(M,va,da)};t.fixTimeInfoFields=function(aa,da){if(null!=aa&&null!=da&&da.fields.length)if("startField"in aa){var ia=da.get(aa.startField);da=da.get(aa.endField);
aa.startField=ia&&ia.name||null;aa.endField=da&&da.name||null}else ia=da.get(aa.startTimeField),da=da.get(aa.endTimeField),aa.startTimeField=ia&&ia.name||null,aa.endTimeField=da&&da.name||null};t.getDisplayFieldName=function({displayField:aa,fields:da}){if(aa)return aa;if(!da||!da.length)return null;if(!(aa=c(da,"name-or-title")||c(da,"unique-identifier")||c(da,"type-or-category")))a:{for(const ia of da)if(ia&&ia.name&&(da=ia.name.toLowerCase(),-1<da.indexOf("name")||-1<da.indexOf("title"))){aa=ia.name;
break a}aa=null}return aa};t.getElevationFields=function(aa){return f.apply(this,arguments)};t.getExpressionFields=function(aa,da){return ra.apply(this,arguments)};t.getFeatureEditFields=function(aa){if(!aa)return[];const da="editFieldsInfo"in aa&&aa.editFieldsInfo;return da?e(aa.fieldsIndex,[da&&da.creatorField,da&&da.creationDateField,da&&da.editorField,da&&da.editDateField]):[]};t.getFeatureGeometryFields=function(aa){if(!aa)return[];const da=aa.geometryFieldsInfo;return da?e(aa.fieldsIndex,[da.shapeAreaField,
da.shapeLengthField]):[]};t.getFieldDefaultValue=function(aa){const da=aa.defaultValue;if(void 0!==da&&W(aa,da))return da;if(aa.nullable)return null};t.getFieldRange=function(aa){const da=q.getDomainRange(aa.domain);if(da)return da;if(P(aa))return pa(aa.type)};t.getLabelingFields=function(aa){return K.apply(this,arguments)};t.getNumericTypeForValue=function(aa){if(!I(aa))return null;if(ha(aa)){if(aa>=ca.min&&aa<=ca.max)return"esriFieldTypeSmallInteger";if(aa>=ea.min&&aa<=ea.max)return"esriFieldTypeInteger"}return aa>=
ja.min&&aa<=ja.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};t.getTimeFields=function(aa){return H.apply(this,arguments)};t.integerRange=ea;t.isDateField=function(aa){return null!=aa&&("date"===aa.type||"esriFieldTypeDate"===aa.type)};t.isNumberInRange=oa;t.isNumericField=P;t.isStringField=function(aa){return null!=aa&&("string"===aa.type||"esriFieldTypeString"===aa.type)};t.isValidFieldValue=function(aa,da){return null===fa(aa,da)};t.isValueMatchingFieldType=W;t.numericTypes=V;t.packFields=function(aa,
da,ia=1){if(!da||!aa)return[];if(da.includes("*"))return["*"];da=e(aa,da);return da.length/aa.fields.length>=ia?["*"]:da};t.populateMissingFields=sa;t.rendererFields=ua;t.sanitizeNullFieldValue=function(aa){return null==aa||"number"===typeof aa&&isNaN(aa)?null:aa};t.singleRange=ja;t.smallIntegerRange=ca;t.unpackFieldNames=function(aa,da){return x.isNone(da)||x.isNone(aa)?[]:da.includes("*")?aa.fields.map(ia=>ia.name):da};t.validateFieldValue=fa;t.validationErrorToString=function(aa,da,ia){switch(aa){case q.DomainValidationError.INVALID_CODED_VALUE:return`Value ${ia} is not in the coded domain - field: ${da.name}, domain: ${JSON.stringify(da.domain)}`;
case q.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${ia} is out of the range of valid values - field: ${da.name}, domain: ${JSON.stringify(da.domain)}`;case t.TypeValidationError.INVALID_TYPE:return`Value ${ia} is not a valid value for the field type - field: ${da.name}, type: ${da.type}, nullable: ${da.nullable}`;case t.NumericRangeValidationError.OUT_OF_RANGE:{const {min:va,max:wa}=pa(da.type);return`Value ${ia} is out of range for the number type - field: ${da.name}, type: ${da.type}, value range is ${va} to ${wa}`}}};
t.visualVariableFields=M;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/support/domainUtils":function(){define(["exports"],function(r){function t(C,D){switch(C.type){case "range":{const x="range"in C?C.range[1]:C.maxValue;if(+D<("range"in C?C.range[0]:C.minValue)||+D>x)return r.DomainValidationError.VALUE_OUT_OF_RANGE;break}case "coded-value":case "codedValue":if(null==C.codedValues||C.codedValues.every(x=>null==x||x.code!==D))return r.DomainValidationError.INVALID_CODED_VALUE}return null}
r.DomainValidationError=void 0;(function(C){C.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";C.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(r.DomainValidationError||(r.DomainValidationError={}));r.getDomainRange=function(C){if(C&&"range"===C.type)return{min:"range"in C?C.range[0]:C.minValue,max:"range"in C?C.range[1]:C.maxValue}};r.isValidDomainValue=function(C,D){return null===t(C,D)};r.validateDomainValue=t;Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/maybe ../geometry/SpatialReference".split(" "),function(r,t,C,D,x,w){function q(){p||(p=C._asyncToGenerator(function*(){const e=yield new Promise((l,k)=>r(["./arcadeUtils"],l,k));return{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})());return p}let p;D=(e,l,k)=>g.create(e,l,k,null,["$feature","$view"]);let g=function(){function e(k,n,d,b,a,c,f,
m){this.script=k;this.evaluate=a;this.fields=Array.isArray(f)?f:f.fields;this._syntaxTree=b;this._arcade=n;this._arcadeDictionary=d;this._arcadeFeature=c;this._spatialReference=m;this._referencesGeometry=n.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}e.create=function(){var k=C._asyncToGenerator(function*(n,d,b,a,c,f){const {arcade:m,Feature:h,Dictionary:v}=yield q(),u=w.fromJSON(d);d=m.parseScript(n,f);c=c.reduce((G,H)=>({...G,
[H]:null}),{});let F=null;x.isSome(a)&&(F=new v(a),F.immutable=!0,c.$config=null);a=m.scriptUsesGeometryEngine(d)&&m.enableGeometrySupport();f=m.scriptUsesFeatureSet(d)&&m.enableFeatureSetSupport();const z=m.scriptIsAsync(d)&&m.enableAsyncSupport();c={vars:c,spatialReference:u,useAsync:!!z};const A=new v;A.immutable=!1;A.setField("scale",0);const E=m.compileScript(d,c);yield Promise.all([a,f,z]);return new e(n,m,v,d,G=>{"$view"in G&&G.$view&&(A.setField("scale",G.$view.scale),G.$view=A);F&&(G.$config=
F);return E({vars:G,spatialReference:u})},new h,b,u)});return function(n,d,b,a,c,f){return k.apply(this,arguments)}}();var l=e.prototype;l.repurposeFeature=function(k){k.geometry&&!k.geometry.spatialReference&&(k.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(k.geometry,k.attributes,{fields:this.fields});return this._arcadeFeature};l.repurposeAdapter=function(k){this._arcadeFeature.repurposeFromAdapter(k,{fields:this.fields});return this._arcadeFeature};
l.createDictionary=function(){return new this._arcadeDictionary};l.referencesMember=function(k){return this._arcade.referencesMember(this._syntaxTree,k)};l.referencesFunction=function(k){return this._arcade.referencesFunction(this._syntaxTree,k)};l.referencesGeometry=function(){return this._referencesGeometry};l.referencesScale=function(){return this._referencesScale};l.extractFieldLiterals=function(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)};return e}();t.ArcadeExpression=
g;t.createDictionaryExpression=(e,l,k,n)=>g.create(e,l,k,n,["$feature","$view"]);t.createLabelExpression=(e,l,k)=>g.create(e,l,k,null,["$feature"]);t.createRendererExpression=D;t.createVVExpression=D;t.default=g;t.loadArcade=q;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n){function d(){return new Promise((f,m)=>r(["../../../geometry/geometryEngineJSON"],f,m))}function b(){b=C._asyncToGenerator(function*(f,m,h){const {spatialRel:v,geometry:u}=f;if(u){if(!0!==c.spatialRelationship[v])throw new D("feature-store:unsupported-query","Unsupported query spatial relationship",{query:f});if(p.isValid(u.spatialReference)&&p.isValid(h)){if(!0!==c.queryGeometry[q.getJsonType(u)])throw new D("feature-store:unsupported-query","Unsupported query geometry type",
{query:f});if(!0!==c.layerGeometry[m])throw new D("feature-store:unsupported-query","Unsupported layer geometry type",{query:f});if(f.outSR)return k.checkProjectionSupport(f.geometry&&f.geometry.spatialReference,f.outSR)}}});return b.apply(this,arguments)}const a={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",
esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},c={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},
layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.canQueryWithRBush=function(f){if(q.isExtent(f))return!0;if(q.isPolygon(f)){for(const m of f.rings)if(5!==m.length||m[0][0]!==m[1][0]||m[0][0]!==m[4][0]||m[2][0]!==m[3][0]||m[0][1]!==m[3][1]||m[0][1]!==m[4][1]||m[1][1]!==m[2][1])return!1;return!0}return!1};t.checkSpatialQuerySupport=function(f,m,h){return b.apply(this,arguments)};t.getSpatialQueryOperator=function(f,
m,h,v,u){if(q.isPolygon(m)&&"esriGeometryPoint"===h&&("esriSpatialRelIntersects"===f||"esriSpatialRelContains"===f)){const F=e.convertFromPolygon(new l,m,!1,!1);return Promise.resolve(z=>g.polygonContainsPoint(F,!1,!1,z))}if(q.isPolygon(m)&&"esriGeometryMultipoint"===h){const F=e.convertFromPolygon(new l,m,!1,!1);if("esriSpatialRelContains"===f)return Promise.resolve(z=>g.polygonContainsMultipoint(F,!1,!1,z,v,u))}if(q.isExtent(m)&&"esriGeometryPoint"===h&&("esriSpatialRelIntersects"===f||"esriSpatialRelContains"===
f))return Promise.resolve(F=>x.extentContainsPoint(m,n.getGeometry(h,v,u,F)));if(q.isExtent(m)&&"esriGeometryMultipoint"===h&&"esriSpatialRelContains"===f)return Promise.resolve(F=>x.extentContainsMultipoint(m,n.getGeometry(h,v,u,F)));if(q.isExtent(m)&&"esriSpatialRelIntersects"===f){const F=w.getExtentIntersector(h);return Promise.resolve(z=>F(m,n.getGeometry(h,v,u,z)))}return d().then(F=>{const z=F[a[f]].bind(null,m.spatialReference,m);return A=>z(n.getGeometry(h,v,u,A))})};Object.defineProperty(t,
"__esModule",{value:!0})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(r,t){r.extentIntersectsExtent=t.extentIntersectsExtent;r.extentIntersectsMultipoint=t.extentIntersectsMultipoint;r.extentIntersectsPoint=t.extentIntersectsPoint;r.extentIntersectsPolygon=t.extentIntersectsPolygon;r.extentIntersectsPolyline=t.extentIntersectsPolyline;r.getFeatureExtentIntersector=t.getFeatureExtentIntersector;r.isSelfIntersecting=t.isSelfIntersecting;r.segmentIntersects=
t.segmentIntersects;r.getExtentIntersector=function(C){return"mesh"===C?t.extentIntersectsExtent:t.getFeatureExtentIntersector(C)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/contains":function(){define(["exports"],function(r){function t(C,D,x,w,q){if(!C)return!1;D=D?x?4:3:x?3:2;const {coords:p,lengths:g}=C;x=!1;C=0;for(const l of g){var e=C;for(let k=C,n=C+l*D;k<n;k+=D){e=k+D;e===n&&(e=C);const d=p[k],b=p[k+1],a=p[e];e=p[e+1];(b<q&&e>=q||e<q&&b>=q)&&d+(q-b)/(e-b)*(a-
d)<w&&(x=!x)}C+=l*D}return x}r.polygonContainsCoords=t;r.polygonContainsMultipoint=function(C,D,x,w,q,p){q=q?p?4:3:p?3:2;const {coords:g,lengths:e}=w;if(!e)return!1;for(let l=0,k=0;l<e.length;l++,k+=q)if(!t(C,D,x,g[k],g[k+1]))return!1;return!0};r.polygonContainsPoint=function(C,D,x,w){return t(C,D,x,w.coords[0],w.coords[1])};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/FieldsIndex":function(){define(["../../chunks/_rollupPluginBabelHelpers","./fieldUtils"],function(r,t){function C(x){return"oid"===
x.type||"esriFieldTypeOID"===x.type}function D(x){return"global-id"===x.type||"esriFieldTypeGlobalID"===x.type}return function(){function x(q){this.fields=q;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this.dateFields=[];this.numericFields=[];this._requiredFields=null;if(q){var p=[];for(const g of q)if(q=g&&g.name){const e=q.toLowerCase().trim();this._fieldsMap.set(q,g);this._fieldsMap.set(e,g);p.push(e);"date"===g.type||"esriFieldTypeDate"===g.type?(this.dateFields.push(g),
this._dateFieldsSet.add(g)):t.isNumericField(g)&&(this._numericFieldsSet.add(g),this.numericFields.push(g));C(g)||D(g)||(g.editable=null==g.editable?!0:!!g.editable,g.nullable=null==g.nullable?!0:!!g.nullable)}p.sort();this.uid=p.join(",")}}var w=x.prototype;w.destroy=function(){this._fieldsMap.clear()};w.has=function(q){return null!=this.get(q)};w.get=function(q){return null!=q?this._fieldsMap.get(q)||this._fieldsMap.get(q.toLowerCase().trim()):void 0};w.isDateField=function(q){return this._dateFieldsSet.has(this.get(q))};
w.isNumericField=function(q){return this._numericFieldsSet.has(this.get(q))};w.normalizeFieldName=function(q){if(q=this.get(q))return q.name};r._createClass(x,[{key:"requiredFields",get:function(){if(!this._requiredFields){this._requiredFields=[];for(const q of this.fields)C(q)||D(q)||q.nullable||void 0!==t.getFieldDefaultValue(q)||this._requiredFields.push(q)}return this._requiredFields}}]);return x}()})},"esri/views/support/Scheduler":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/time ../../core/watchUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/PromiseQueue ./debugFlags".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h){function v(y){return F.has(y)?F.get(y):"number"===typeof y?y:1}const u=w.getLogger("esri.views.support.Scheduler");r.TaskPriority=void 0;(function(y){y.RESOURCE_CONTROLLER="schedule";y.SLIDE="slide";y.STREAM_DATA_LOADER="stream loader";y.ELEVATION_QUERY="elevation query";y.TERRAIN_SURFACE="terrain";y.SURFACE_GEOMETRY_UPDATES="surface geometry updates";y.GRAPHICS_CORE="Graphics3D";y.I3S_CONTROLLER="I3S";y.POINT_CLOUD_LAYER="point cloud";y.FEATURE_TILE_FETCHER=
"feature fetcher";y.OVERLAY="overlay";y.STAGE="stage";y.GRAPHICS_DECONFLICTOR="graphics deconflictor";y.FILTER_VISIBILITY="Graphics3D filter visibility";y.SCALE_VISIBILITY="Graphics3D scale visibility";y.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";y.POINT_OF_INTEREST_FREQUENT="POI frequent";y.POINT_OF_INTEREST_INFREQUENT="POI infrequent";y.LABELER="labeler";y.FEATURE_QUERY_ENGINE="feature query";y.FEATURE_TILE_TREE="feature tile tree";y.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";y.ELEVATION_ALIGNMENT=
"elevation alignment";y.TEXT_TEXTURE_ATLAS="text texture atlas";y.TEXTURE_UNLOAD="texture unload";y.LINE_OF_SIGHT_TOOL="line of sight tool";y.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";y.ELEVATION_PROFILE="elevation profile";y.SNAPPING="snapping";y.SHADOW_ACCUMULATOR="shadow accumulator";y.CLOUDS_GENERATOR="cloud generator";y[y.TEST_PRIO=1]="TEST_PRIO"})(r.TaskPriority||(r.TaskPriority={}));const F=new Map([[r.TaskPriority.RESOURCE_CONTROLLER,0],[r.TaskPriority.SLIDE,0],[r.TaskPriority.STREAM_DATA_LOADER,
0],[r.TaskPriority.ELEVATION_QUERY,0],[r.TaskPriority.TERRAIN_SURFACE,1],[r.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[r.TaskPriority.GRAPHICS_CORE,2],[r.TaskPriority.I3S_CONTROLLER,2],[r.TaskPriority.POINT_CLOUD_LAYER,2],[r.TaskPriority.FEATURE_TILE_FETCHER,2],[r.TaskPriority.OVERLAY,4],[r.TaskPriority.STAGE,4],[r.TaskPriority.GRAPHICS_DECONFLICTOR,4],[r.TaskPriority.FILTER_VISIBILITY,4],[r.TaskPriority.SCALE_VISIBILITY,4],[r.TaskPriority.FRUSTUM_VISIBILITY,4],[r.TaskPriority.POINT_OF_INTEREST_FREQUENT,
6],[r.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[r.TaskPriority.LABELER,8],[r.TaskPriority.FEATURE_QUERY_ENGINE,8],[r.TaskPriority.FEATURE_TILE_TREE,16],[r.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[r.TaskPriority.ELEVATION_ALIGNMENT,12],[r.TaskPriority.TEXT_TEXTURE_ATLAS,12],[r.TaskPriority.CLOUDS_GENERATOR,12],[r.TaskPriority.TEXTURE_UNLOAD,12],[r.TaskPriority.LINE_OF_SIGHT_TOOL,16],[r.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[r.TaskPriority.SNAPPING,0],[r.TaskPriority.SHADOW_ACCUMULATOR,
30]]),z=k.Milliseconds(6.5),A=k.Milliseconds(1),E=k.Milliseconds(30),G=k.Milliseconds(1E3/30),H=k.Milliseconds(100);var K;(function(y){let I=function(Y){function R(W){var P=Y.call(this,W)||this;P.updating=!0;P._microTaskQueued=!1;P.performanceInfo={total:new p("total"),tasks:new Map};P._frameTaskTimes=new Map;P._budget=null;P._state=1;P._tasks=new g;P._runQueue=new g;P._load=0;P._idleStateCallbacks=new g;P._idleUpdatesStartFired=!1;P._maxReschedule=B;P._forceTask=!1;P._debug=!1;P._debugHandle=n.init(h,
"SCHEDULER_LOG_SLOW_TASKS",pa=>P._debug=pa);P._budget=new O(W.nowFunc);for(const pa of Object.keys(r.TaskPriority))P.performanceInfo.tasks.set(r.TaskPriority[pa],new p(r.TaskPriority[pa]));let fa;const oa=t._assertThisInitialized(P);P._test={get state(){return q.unwrapOr(fa,oa._state)},set state(pa){fa=pa},FRAME_SAFETY_BUDGET:z,INTERACTING_BUDGET:G,IDLE_BUDGET:H,get budget(){return oa._budget.budget},usedBudget:0,setBudget:pa=>oa._budget=pa,updateTask:pa=>P._updateTask(pa),getState:pa=>P._getState(pa),
getRuntime:pa=>P._getRuntime(pa),frameTaskTimes:P._frameTaskTimes,resetRuntimes:()=>P._resetRuntimes(),getRunning:()=>P._getRunning()};return P}t._inheritsLoose(R,Y);var Q=R.prototype;Q.destroy=function(){this._debugHandle&&this._debugHandle.remove();this._microTaskQueued=!1};Q.activate=function(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=B,this._schedule(),this.frame()))}))};
Q.registerTask=function(W,P){const fa=v(W);P=new S(this,W,P,fa);this._tasks.push(P);this.performanceInfo.tasks.has(W)||this.performanceInfo.tasks.set(W,new p(W));return P};Q.registerIdleStateCallbacks=function(W,P){const fa={idleBegin:W,idleEnd:P};this._idleStateCallbacks.push(fa);2===this.state&&this._idleUpdatesStartFired&&fa.idleBegin();const oa=this;return{remove:()=>this._removeIdleStateCallbacks(fa),set idleBegin(pa){oa._idleUpdatesStartFired&&(fa.idleEnd(),2===oa._state&&pa());fa.idleBegin=
pa},set idleEnd(pa){fa.idleEnd=pa}}};Q.updateBudget=function(W){this._test.usedBudget=0;let P=z,fa=W.frameDuration,oa=A;switch(this.state){case 2:P=k.Milliseconds(0);fa=k.Milliseconds(Math.max(H,W.frameDuration));oa=E;break;case 1:fa=k.Milliseconds(Math.max(G,W.frameDuration))}fa=k.Milliseconds(fa-W.elapsedFrameTime-P);if(2!==this.state&&fa<A&&!this._forceTask)return this._forceTask=!0,!1;fa=k.Milliseconds(Math.max(fa,oa));this._budget.reset(fa,this.state);this._maxReschedule=B;this._updateLoad();
return this._schedule()};Q.frame=function(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(W=>W.idleBegin()));this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed};Q.stopFrame=function(){this._budget.reset(k.Milliseconds(0),this._state);this._budget.madeProgress()};Q._removeIdleStateCallbacks=function(W){this._idleUpdatesStartFired&&
W.idleEnd();this._idleStateCallbacks.removeUnordered(W)};Q.removeTask=function(W){this._tasks.removeUnordered(W);this._runQueue.removeUnordered(W)};Q._updateTask=function(W){this._tasks.forAll(P=>{P.name===W&&P.setPriority(W)})};Q._getState=function(W){if(this._runQueue.some(fa=>fa.name===W))return r.TaskState.SCHEDULED;let P=r.TaskState.IDLE;this._tasks.forAll(fa=>{fa.name===W&&fa.needsUpdate&&(1>=fa.schedulePriority?P=r.TaskState.READY:P!==r.TaskState.READY&&(P=r.TaskState.WAITING))});return P};
Q._getRuntime=function(W){let P=0;this._tasks.forAll(fa=>{fa.name===W&&(P+=fa.runtime)});return P};Q._resetRuntimes=function(){this._tasks.forAll(W=>W.runtime=0)};Q._getRunning=function(){const W=new Map;this._tasks.forAll(fa=>{fa.needsUpdate&&W.set(fa.name,(W.get(fa.name)||0)+1)});if(0===W.size)return null;let P="";W.forEach((fa,oa)=>{P=1<fa?P+` ${fa}x ${oa}`:P+` ${oa}`});return P};Q._runIdle=function(){this._run()};Q._runInteracting=function(){this._run()};Q._runAnimating=function(){this._run()};
Q._updateLoad=function(){const W=this._tasks.reduce((P,fa)=>fa.needsUpdate?++P:P,0);this._load=.9*this._load+W*(1-.9)};Q._schedule=function(){if(0>=this._maxReschedule)return!1;this._runQueue.filterInPlace(W=>{if(W.needsUpdate)return!0;W.schedulePriority=W.basePriority;return!1});for(this._tasks.forAll(W=>{0===W.basePriority&&W.needsUpdate&&!this._runQueue.some(P=>P===W)&&this._runQueue.unshift(W)});0===this._runQueue.length;){let W=!1,P=0;this._tasks.forAll(fa=>{if(fa.needsUpdate&&0!==fa.schedulePriority&&
0!==fa.basePriority)switch(W=!0,P=Math.max(P,fa.basePriority),fa.schedulePriority){case 1:fa.schedulePriority=0;this._runQueue.push(fa);break;default:--fa.schedulePriority}});if(!W)return this.updating=!1;this._maxReschedule===B&&(this._maxReschedule=P);--this._maxReschedule}return this.updating=!0};Q._run=function(){const W=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var P=this._budget.now();const fa=this._runQueue.pop();this._budget.resetProgress();try{fa.task.runTask(this._budget)}catch(oa){u.error(`Exception in task "${fa.name}"`,
oa)}fa.schedulePriority=fa.basePriority;P=this._budget.now()-P;fa.runtime+=P;this._frameTaskTimes.set(fa.priority,this._frameTaskTimes.get(fa.priority)+P);this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",fa.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._recordFrameTaskTimes(this._budget.now()-W);return}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-W)};Q._startFrameTaskTimes=function(){for(const W of Object.keys(r.TaskPriority))this._frameTaskTimes.set(r.TaskPriority[W],
0)};Q._recordFrameTaskTimes=function(W){this._frameTaskTimes.forEach((P,fa)=>this.performanceInfo.tasks.get(fa).record(P));this.performanceInfo.total.record(W)};t._createClass(R,[{key:"now",get:function(){return this.nowFunc()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return q.isNone(this._test.state)?this._state:this._test.state},set:function(W){this._state!==W&&(this._state=W,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(P=>
P.idleEnd())))}},{key:"test",get:function(){return this._test}}]);return R}(D);C.__decorate([d.property()],I.prototype,"updating",void 0);C.__decorate([d.property()],I.prototype,"nowFunc",void 0);I=C.__decorate([f.subclass("esri.views.support.Scheduler")],I);y.Scheduler=I;let S=function(Y){function R(W,P,fa,oa){var pa=Y.call(this,{})||this;pa._scheduler=W;pa.name=P;pa._basePriority=oa;pa.runtime=0;pa._queue=new m.PromiseQueue;pa._handles=new x;pa.schedulePriority=pa._basePriority;pa.task=q.isSome(fa)?
fa:pa._queue;pa._handles.add(l.reactTruthy(()=>pa.task.running,()=>W.activate()));return pa}t._inheritsLoose(R,Y);var Q=R.prototype;Q.normalizeCtorArgs=function(){return{}};Q.remove=function(){this.processQueue(L);this._scheduler.removeTask(this);this.schedule=J.schedule;this.reschedule=J.reschedule;this._handles.destroy()};Q.setPriority=function(W){this.name=W;W=v(W);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=W;this._basePriority=W};Q.schedule=function(W,P,fa){return this._queue.push(W,
P,fa)};Q.reschedule=function(W,P,fa){return this._queue.unshift(W,P,fa)};Q.processQueue=function(W){this._queue.runTask(W)};t._createClass(R,[{key:"updating",get:function(){return this._queue.running}},{key:"basePriority",get:function(){return this._basePriority}},{key:"priority",get:function(){return this.name},set:function(W){this.setPriority(W)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}}]);return R}(D);C.__decorate([d.property({constructOnly:!0})],S.prototype,
"task",void 0);C.__decorate([d.property({readOnly:!0})],S.prototype,"updating",null);S=C.__decorate([f.subclass("esri.views.support.SchedulerTask")],S);let O=function(){function Y(Q){this.now=Q;this._budget=this._begin=0;this._state=2;this._didWork=!1;this._enabled=!0}var R=Y.prototype;R.run=function(Q){if(this.done)return!1;!0===Q()&&(this._didWork=!0);return!0};R.madeProgress=function(){this._didWork=!0};R.reset=function(Q,W){this._begin=this.now();this._budget=Q;this._state=W;this._didWork=!1};
R.resetProgress=function(){this._didWork=!1};t._createClass(Y,[{key:"done",get:function(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}},{key:"budget",get:function(){return this._budget}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(Q){this._enabled=Q}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return this.now()-this._begin}},{key:"hasProgressed",
get:function(){return this._didWork}}]);return Y}();y.Budget=O})(K||(K={}));r.TaskState=void 0;(function(y){y.SCHEDULED="s";y.READY="r";y.WAITING="w";y.IDLE="i"})(r.TaskState||(r.TaskState={}));const L=(()=>{const y=new K.Budget(()=>performance.now());y.enabled=!1;return y})(),J=new (function(){function y(){}var I=y.prototype;I.remove=function(){};I.processQueue=function(){};I.schedule=function(S,O,Y){try{if(e.isAborted(O)){const R=e.createAbortError();return Y?Promise.resolve(Y(R)):Promise.reject(R)}return e.when(S(L))}catch(R){return Promise.reject(R)}};
I.reschedule=function(S,O,Y){return this.schedule(S,O,Y)};return y}()),B=Number.MAX_SAFE_INTEGER;r.ImmediateTask=J;r.getTaskPriority=v;r.newScheduler=function(y){return new K.Scheduler({nowFunc:y})};r.noBudget=L;r.taskPriorities=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/PromiseQueue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g,e){r.PromiseQueue=function(k){function n(){var b=k.apply(this,arguments)||this;b._tasks=[];b.running=!1;return b}t._inheritsLoose(n,k);var d=n.prototype;d.destroy=function(){this.cancelAll()};d.runTask=function(b){for(;!b.done&&this._process(b);)b.madeProgress()};d.push=function(b,a,c){this.running=!0;return new Promise((f,m)=>this._tasks.push(new l(f,m,b,a,c)))};d.unshift=function(b,a,c){this.running=!0;return new Promise((f,m)=>this._tasks.unshift(new l(f,m,b,a,c)))};
d._process=function(b){if(0===this._tasks.length)return!1;const a=this._tasks.shift();try{const c=x.isAborted(a.signal);if(c&&!a.abortCallback)a.reject(x.createAbortError());else{const f=c?a.abortCallback(x.createAbortError()):a.callback(b);x.isPromise(f)?f.then(a.resolve,a.reject):a.resolve(f)}}catch(c){a.reject(c)}this.running=0<this._tasks.length;return!0};d.cancelAll=function(){const b=x.createAbortError();for(const a of this._tasks)if(a.abortCallback){const c=a.abortCallback(b);a.resolve(c)}else a.reject(b);
this._tasks.length=0;this.running=!1};t._createClass(n,[{key:"length",get:function(){return this._tasks.length}}]);return n}(D);C.__decorate([w.property()],r.PromiseQueue.prototype,"running",void 0);r.PromiseQueue=C.__decorate([e.subclass("esri.layers.support.PromiseQueue")],r.PromiseQueue);let l=function(k,n,d,b,a){this.resolve=k;this.reject=n;this.callback=d;this.signal=b;this.abortCallback=a};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/support/debugFlags":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p){C=function(g){function e(){var l=g.apply(this,arguments)||this;l.SCHEDULER_LOG_SLOW_TASKS=!1;l.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1;return l}r._inheritsLoose(e,g);return e}(C);t.__decorate([D.property()],C.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);t.__decorate([D.property()],C.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);C=t.__decorate([p.subclass("esri.views.support.DebugFlags")],C);return new C})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],
function(r){r.AGGREGATE_VALID_FILTERS_MASK=254;r.DISPLAY_ID_TEXEL_MASK=8388607;r.DISPLAY_ID_TYPE_AGGREGATE=1;r.DISPLAY_ID_TYPE_FEATURE=0;r.DISPLAY_ID_TYPE_MASK=8388608;r.NONAGGREGATE_VALID_FILTERS_MASK=255;r.createDisplayId=function(t,C){return((C?8388608:0)|t)>>>0};r.getDisplayIdFilterMask=t=>1===(t&8388608)>>>23?254:255;r.getDisplayIdTexel=t=>t&8388607;r.getDisplayIdType=t=>(t&8388608)>>>23;r.isAggregateId=function(t){return 1===(t&8388608)>>>23};Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/views/2d/layers/features/FeatureStore2D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../../chunks/rbush ../../../../geometry/support/aaBoundingBox ./Store2D ./support/FeatureSetReaderPBFIndirect".split(" "),function(r,t,C,D,x,w,q,p,g,e){const l={getObjectId(k){return k.getObjectId()},getAttributes(k){return k.readAttributes()},getAttribute(k,n){return k.readAttribute(n)},
cloneWithGeometry(k,n){return k},getGeometry(k){return k.readHydratedGeometry()},getCentroid(k,n){return k.readCentroid()}};x=function(k){function n(b,a,c){var f=k.call(this,b,a)||this;f.featureAdapter=l;f.events=new D;f._featureSetsByInstance=new Map;f._objectIdToDisplayId=new Map;f._spatialIndexInvalid=!0;f._indexSearchCache=new C(50);f._index=q.rbush(9,m=>({minX:f._storage.getXMin(m),minY:f._storage.getYMin(m),maxX:f._storage.getXMax(m),maxY:f._storage.getYMax(m)}));f._storage=a;f.mode=c;return f}
t._inheritsLoose(n,k);var d=n.prototype;d.hasInstance=function(b){return this._featureSetsByInstance.has(b)};d.onTileData=function(b,a){if(w.isNone(a.addOrUpdate))return a;a.addOrUpdate.attachStorage(this._storage);if("snapshot"===this.mode){for(var c=a.addOrUpdate.getCursor();c.next();){const f=c.getDisplayId();this.setComputedAttributes(this._storage,c,f,b.scale)}return a}this._featureSetsByInstance.set(a.addOrUpdate.instance,a.addOrUpdate);for(c=a.addOrUpdate.getCursor();c.next();)this._insertFeature(c,
b.scale);this._spatialIndexInvalid=!0;this.events.emit("changed");return a};d.search=function(b){this._rebuildIndex();const a=b.id;var c=this._indexSearchCache.find(h=>h.tileId===a);if(w.isSome(c))return c.readers;c=new Map;b=this._searchIndex(b.bounds);const f=[];for(const h of b){var m=this._storage.getInstanceId(h);b=(4294901760&m)>>>16;m&=65535;c.has(b)||c.set(b,[]);c.get(b).push(m)}c.forEach((h,v)=>{v=this._featureSetsByInstance.get(v);f.push(e.FeatureSetReaderIndirect.from(v,h))});this._indexSearchCache.enqueue({tileId:a,
readers:f});return f};d.insert=function(b){const a=b.getCursor(),c=this._storage;for(;a.next();){var f,m=a.getIndex();m|=a.instance<<16;const h=a.getObjectId(),v=null!=(f=this._objectIdToDisplayId.get(h))?f:this._storage.createDisplayId();a.setDisplayId(v);c.setInstanceId(v,m);this._objectIdToDisplayId.set(h,v)}this._featureSetsByInstance.set(b.instance,b);this._spatialIndexInvalid=!0};d.remove=function(b){const a=this._objectIdToDisplayId.get(b);if(a){var c=this._storage.getInstanceId(a),f=65535&
c;c=(4294901760&c)>>>16;var m=this._featureSetsByInstance.get(c);this._objectIdToDisplayId.delete(b);this._storage.releaseDisplayId(a);m.removeAtIndex(f);m.isEmpty&&this._featureSetsByInstance.delete(c);this._spatialIndexInvalid=!0}};d.forEach=function(b){this._objectIdToDisplayId.forEach(a=>{a=this._storage.getInstanceId(a);a=this._lookupFeature(a);b(a)})};d.forEachUnsafe=function(b){this._objectIdToDisplayId.forEach(a=>{var c=this._storage.getInstanceId(a);a=65535&c;c=this._getFeatureSet((4294901760&
c)>>>16);c.setIndex(a);b(c)})};d.forEachInBounds=function(b,a){b=this._searchIndex(b);for(const c of b)b=this.lookupFeatureByDisplayId(c,this._storage),a(w.unwrap(b))};d.forEachBounds=function(b,a,c){this._rebuildIndex();const f=[0,0,0,0];for(const m of b)m.readGeometry()&&(b=m.getDisplayId(),f[0]=this._storage.getXMin(b),f[1]=this._storage.getYMin(b),f[2]=this._storage.getXMax(b),f[3]=this._storage.getYMax(b),a(p.fromRect(c,f)))};d.sweepFeatures=function(b,a,c){this._spatialIndexInvalid=!0;this._objectIdToDisplayId.forEach((f,
m)=>{b.has(f)||(a.releaseDisplayId(f),c&&c.unsetAttributeData(f),this._objectIdToDisplayId.delete(m))});this.events.emit("changed")};d.sweepFeatureSets=function(b){this._spatialIndexInvalid=!0;this._featureSetsByInstance.forEach((a,c)=>{b.has(c)||this._featureSetsByInstance.delete(c)})};d.lookupObjectId=function(b,a){b=this.lookupFeatureByDisplayId(b,a);return w.isNone(b)?null:b.getObjectId()};d.lookupDisplayId=function(b){return this._objectIdToDisplayId.get(b)};d.lookupFeatureByDisplayId=function(b,
a){b=a.getInstanceId(b);return this._lookupFeature(b)};d.lookupByDisplayIdUnsafe=function(b){var a=this._storage.getInstanceId(b);b=65535&a;a=this._getFeatureSet((4294901760&a)>>>16);if(!a)return null;a.setIndex(b);return a};d._insertFeature=function(b,a){const c=this._storage,f=b.getObjectId();var m=b.getIndex();m|=b.instance<<16;c.getInstanceId(b.getDisplayId());let h=this._objectIdToDisplayId.get(f);h||(h=c.createDisplayId(),this._objectIdToDisplayId.set(f,h),this._spatialIndexInvalid=!0);b.setDisplayId(h);
c.setInstanceId(h,m);this.setComputedAttributes(c,b,h,a)};d._searchIndex=function(b){this._rebuildIndex();return this._index.search({minX:b[0],minY:b[1],maxX:b[2],maxY:b[3]})};d._rebuildIndex=function(){if(this._spatialIndexInvalid){var b=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(a=>{for(a=a.getCursor();a.next();){const c=a.getDisplayId();this._storage.setBounds(c,a)&&b.push(c)}}):this._objectIdToDisplayId.forEach(a=>{const c=this._storage.getInstanceId(a);this._storage.setBounds(a,
this._lookupFeature(c))&&b.push(a)});this._index.clear();this._index.load(b);this._indexSearchCache.clear();this._spatialIndexInvalid=!1}};d._lookupFeature=function(b){const a=65535&b;b=this._getFeatureSet((4294901760&b)>>>16);if(!b)return null;b=b.getCursor();b.setIndex(a);return b};d._getFeatureSet=function(b){return this._featureSetsByInstance.get(b)};t._createClass(n,[{key:"storage",get:function(){return this._storage}},{key:"storeStatistics",get:function(){let b=0,a=0,c=0;this.forEach(f=>{if(f=
f.readGeometry())a+=f.isPoint?1:f.lengths.reduce((m,h)=>m+h,0),c+=f.isPoint?1:f.lengths.length,b+=1});return{featureCount:b,vertexCount:a,ringCount:c}}}]);return n}(g.Store2D);r.FeatureStore2D=x;r.featureAdapter=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(r,t){return function(){function C(x){this._start=this.size=0;this.maxSize=x;this._buffer=Array(x)}var D=C.prototype;D.enqueue=function(x){if(this.size===
this.maxSize){const w=this._buffer[this._start];this._buffer[this._start]=x;this._start=(this._start+1)%this.maxSize;return w}this._buffer[(this._start+this.size++)%this.maxSize]=x;return null};D.dequeue=function(){if(0===this.size)return null;const x=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return x};D.peek=function(){return 0===this.size?null:this._buffer[this._start]};D.find=function(x){if(0===this.size)return null;for(const w of this._buffer)if(t.isSome(w)&&
x(w))return w;return null};D.clear=function(x){let w=this.dequeue();for(;t.isSome(w);)x&&x(w),w=this.dequeue()};r._createClass(C,[{key:"entries",get:function(){return this._buffer}}]);return C}()})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(r,t){function C(b,a){if(!(this instanceof C))return new C(b,a);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));a&&("function"===typeof a?this.toBBox=a:this._initFormat(a));this.clear()}
function D(b,a){x(b,0,b.children.length,a,b)}function x(b,a,c,f,m){m||(m=n(null));m.minX=Infinity;m.minY=Infinity;m.maxX=-Infinity;m.maxY=-Infinity;for(var h;a<c;a++)h=b.children[a],w(m,b.leaf?f(h):h);return m}function w(b,a){b.minX=Math.min(b.minX,a.minX);b.minY=Math.min(b.minY,a.minY);b.maxX=Math.max(b.maxX,a.maxX);b.maxY=Math.max(b.maxY,a.maxY);return b}function q(b,a){return b.minX-a.minX}function p(b,a){return b.minY-a.minY}function g(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function e(b){return b.maxX-
b.minX+(b.maxY-b.minY)}function l(b,a){return b.minX<=a.minX&&b.minY<=a.minY&&a.maxX<=b.maxX&&a.maxY<=b.maxY}function k(b,a){return a.minX<=b.maxX&&a.minY<=b.maxY&&a.maxX>=b.minX&&a.maxY>=b.minY}function n(b){return{children:b,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function d(b,a,c,f,m){for(var h=[a,c],v;h.length;)c=h.pop(),a=h.pop(),c-a<=f||(v=a+Math.ceil((c-a)/f/2)*f,t.quickselect(b,v,a,c,m),h.push(a,v,v,c))}C.prototype={all:function(){return this._all(this.data,
[])},search:function(b){var a=this.data,c=[],f=this.toBBox;if(!k(b,a))return c;for(var m=[],h,v,u,F;a;){h=0;for(v=a.children.length;h<v;h++)u=a.children[h],F=a.leaf?f(u):u,k(b,F)&&(a.leaf?c.push(u):l(b,F)?this._all(u,c):m.push(u));a=m.pop()}return c},collides:function(b){var a=this.data,c=this.toBBox;if(!k(b,a))return!1;for(var f=[],m,h,v,u;a;){m=0;for(h=a.children.length;m<h;m++)if(v=a.children[m],u=a.leaf?c(v):v,k(b,u)){if(a.leaf||l(b,u))return!0;f.push(v)}a=f.pop()}return!1},load:function(b){if(!b||
!b.length)return this;if(b.length<this._minEntries){for(var a=0,c=b.length;a<c;a++)this.insert(b[a]);return this}b=this._build(b.slice(),0,b.length-1,0);this.data.children.length?this.data.height===b.height?this._splitRoot(this.data,b):(this.data.height<b.height&&(a=this.data,this.data=b,b=a),this._insert(b,this.data.height-b.height-1,!0)):this.data=b;return this},insert:function(b){b&&this._insert(b,this.data.height-1);return this},clear:function(){this.data=n([]);return this},remove:function(b,
a){if(!b)return this;for(var c=this.data,f=this.toBBox(b),m=[],h=[],v,u,F,z;c||m.length;){c||(c=m.pop(),u=m[m.length-1],v=h.pop(),z=!0);if(c.leaf){a:{F=b;var A=c.children,E=a;if(E){for(var G=0;G<A.length;G++)if(E(F,A[G])){F=G;break a}F=-1}else F=A.indexOf(F)}if(-1!==F){c.children.splice(F,1);m.push(c);this._condense(m);break}}z||c.leaf||!l(c,f)?u?(v++,c=u.children[v],z=!1):c=null:(m.push(c),h.push(v),v=0,u=c,c=c.children[0])}return this},toBBox:function(b){return b},compareMinX:q,compareMinY:p,toJSON:function(){return this.data},
fromJSON:function(b){this.data=b;return this},_all:function(b,a){for(var c=[];b;)b.leaf?a.push.apply(a,b.children):c.push.apply(c,b.children),b=c.pop();return a},_build:function(b,a,c,f){var m=c-a+1,h=this._maxEntries;if(m<=h){var v=n(b.slice(a,c+1));D(v,this.toBBox);return v}f||(f=Math.ceil(Math.log(m)/Math.log(h)),h=Math.ceil(m/Math.pow(h,f-1)));v=n([]);v.leaf=!1;v.height=f;m=Math.ceil(m/h);h=m*Math.ceil(Math.sqrt(h));var u;for(d(b,a,c,h,this.compareMinX);a<=c;a+=h){var F=Math.min(a+h-1,c);d(b,
a,F,m,this.compareMinY);for(u=a;u<=F;u+=m){var z=Math.min(u+m-1,F);v.children.push(this._build(b,u,z,f-1))}}D(v,this.toBBox);return v},_chooseSubtree:function(b,a,c,f){for(var m,h,v,u,F,z,A,E;;){f.push(a);if(a.leaf||f.length-1===c)break;A=E=Infinity;m=0;for(h=a.children.length;m<h;m++)v=a.children[m],F=g(v),z=(Math.max(v.maxX,b.maxX)-Math.min(v.minX,b.minX))*(Math.max(v.maxY,b.maxY)-Math.min(v.minY,b.minY))-F,z<E?(E=z,A=F<A?F:A,u=v):z===E&&F<A&&(A=F,u=v);a=u||a.children[0]}return a},_insert:function(b,
a,c){var f=this.toBBox;c=c?b:f(b);f=[];var m=this._chooseSubtree(c,this.data,a,f);m.children.push(b);for(w(m,c);0<=a;)if(f[a].children.length>this._maxEntries)this._split(f,a),a--;else break;this._adjustParentBBoxes(c,f,a)},_split:function(b,a){var c=b[a],f=c.children.length,m=this._minEntries;this._chooseSplitAxis(c,m,f);f=this._chooseSplitIndex(c,m,f);f=n(c.children.splice(f,c.children.length-f));f.height=c.height;f.leaf=c.leaf;D(c,this.toBBox);D(f,this.toBBox);a?b[a-1].children.push(f):this._splitRoot(c,
f)},_splitRoot:function(b,a){this.data=n([b,a]);this.data.height=b.height+1;this.data.leaf=!1;D(this.data,this.toBBox)},_chooseSplitIndex:function(b,a,c){var f,m;var h=m=Infinity;for(f=a;f<=c-a;f++){var v=x(b,0,f,this.toBBox);var u=x(b,f,c,this.toBBox);var F=Math.max(0,Math.min(v.maxX,u.maxX)-Math.max(v.minX,u.minX))*Math.max(0,Math.min(v.maxY,u.maxY)-Math.max(v.minY,u.minY));v=g(v)+g(u);if(F<h){h=F;var z=f;m=v<m?v:m}else F===h&&v<m&&(m=v,z=f)}return z},_chooseSplitAxis:function(b,a,c){var f=b.leaf?
this.compareMinX:q,m=b.leaf?this.compareMinY:p,h=this._allDistMargin(b,a,c,f);a=this._allDistMargin(b,a,c,m);h<a&&b.children.sort(f)},_allDistMargin:function(b,a,c,f){b.children.sort(f);f=this.toBBox;var m=x(b,0,a,f),h=x(b,c-a,c,f),v=e(m)+e(h),u;for(u=a;u<c-a;u++){var F=b.children[u];w(m,b.leaf?f(F):F);v+=e(m)}for(u=c-a-1;u>=a;u--)F=b.children[u],w(h,b.leaf?f(F):F),v+=e(h);return v},_adjustParentBBoxes:function(b,a,c){for(;0<=c;c--)w(a[c],b)},_condense:function(b){for(var a=b.length-1,c;0<=a;a--)0===
b[a].children.length?0<a?(c=b[a-1].children,c.splice(c.indexOf(b[a]),1)):this.clear():D(b[a],this.toBBox)},_initFormat:function(b){var a=["return a"," - b",";"];this.compareMinX=new Function("a","b",a.join(b[0]));this.compareMinY=new Function("a","b",a.join(b[1]));this.toBBox=new Function("a","return {minX: a"+b[0]+", minY: a"+b[1]+", maxX: a"+b[2]+", maxY: a"+b[3]+"};")}};r.rbush=C})},"esri/chunks/quickselect":function(){define(["exports"],function(r){var t={exports:{}};(function(C){(function(D){D=
D();void 0!==D&&(C.exports=D)})(function(){function D(q,p,g,e,l){for(;e>g;){if(600<e-g){var k=e-g+1,n=p-g+1,d=Math.log(k),b=.5*Math.exp(2*d/3);d=.5*Math.sqrt(d*b*(k-b)/k)*(0>n-k/2?-1:1);D(q,p,Math.max(g,Math.floor(p-n*b/k+d)),Math.min(e,Math.floor(p+(k-n)*b/k+d)),l)}k=q[p];n=g;b=e;x(q,g,p);for(0<l(q[e],k)&&x(q,g,e);n<b;){x(q,n,b);n++;for(b--;0>l(q[n],k);)n++;for(;0<l(q[b],k);)b--}0===l(q[g],k)?x(q,g,b):(b++,x(q,b,e));b<=p&&(g=b+1);p<=b&&(e=b-1)}}function x(q,p,g){var e=q[p];q[p]=q[g];q[g]=e}function w(q,
p){return q<p?-1:q>p?1:0}return function(q,p,g,e,l){D(q,p,g||0,e||q.length-1,l||w)}})})(t);r.quickselect=t.exports})},"esri/views/2d/layers/features/Store2D":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/accessorSupport/diffUtils ../../../../support/arcadeOnDemand ../../arcade/callExpressionWithCursor".split(" "),function(r,t,C,D,x,w,q,p){const g=new Promise((l,k)=>r(["../../../../layers/support/labelFormatUtils"],
l,k));let e=function(){function l(n,d){this._canCacheExpressionValue=!1;this._sourceInfo=n;this._bitsets={computed:d.getBitset(d.createBitset())}}var k=l.prototype;k.invalidate=function(){this._bitsets.computed.clear()};k.updateSchema=function(){var n=C._asyncToGenerator(function*(d,b){var a=w.diff(this._schema,b);if((this._schema=b)&&!x.isNone(a)&&w.hasDiff(a,"attributes")){D("esri-2d-update-debug")&&console.debug("Applying Update - Store:",a);this._bitsets.computed.clear();d.targets[b.name]=!0;
d=b.attributes;b=[];a=[];for(const c in d){const f=d[c];switch(f.type){case "expression":b.push(this._createArcadeComputedField(f));break;case "label-expression":b.push(this._createLabelArcadeComputedField(f));break;case "statistic":a.push(f)}}this._computedFields=yield Promise.all(b);this._canCacheExpressionValue=!this._computedFields.some(c=>"expression"===c.type&&c.expression.referencesScale());this._statisticFields=a}});return function(d,b){return n.apply(this,arguments)}}();k.setComputedAttributes=
function(n,d,b,a){var c=this._bitsets.computed;if(!this._canCacheExpressionValue||!c.has(b)){c.set(b);for(const f of this._computedFields)switch(c=this._evaluateField(d,f,a),f.resultType){case "numeric":n.setComputedNumericAtIndex(b,f.fieldIndex,c);break;case "string":n.setComputedStringAtIndex(b,f.fieldIndex,c)}}};k._createArcadeComputedField=function(){var n=C._asyncToGenerator(function*(d){return{...d,expression:yield q.createRendererExpression(d.valueExpression,this._sourceInfo.spatialReference,
this._sourceInfo.fieldsIndex)}});return function(d){return n.apply(this,arguments)}}();k._createLabelArcadeComputedField=function(){var n=C._asyncToGenerator(function*(d){var b=this._sourceInfo.spatialReference;const a=this._sourceInfo.fieldsIndex,{createLabelFunction:c}=yield g;b=yield c(d.label,a,b);return{...d,builder:b}});return function(d){return n.apply(this,arguments)}}();k._evaluateField=function(n,d,b){switch(d.type){case "label-expression":return n=n.readArcadeFeature(),d.builder.evaluate(n)||
"";case "expression":return{expression:d}=d,p(d,n,{$view:{scale:b}})}};return l}();t.Store2D=e;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/accessorSupport/diffUtils":function(){define(["exports","../Accessor","../Collection","../maybe","./utils"],function(r,t,C,D,x){function w(d){return d instanceof C?Object.keys(d.items):d instanceof t?x.getProperties(d).keys():d?Object.keys(d):[]}function q(d,b){return d instanceof C?d.items[b]:d[b]}function p(d,b){return Array.isArray(d)&&Array.isArray(b)?
d.length!==b.length:!1}function g(d){return d?d.declaredClass:null}function e(d,b){const a=d.diff;if(a&&"function"===typeof a)return a(d,b);const c=w(d),f=w(b);if(0!==c.length||0!==f.length){if(!c.length||!f.length||p(d,b))return{type:"complete",oldValue:d,newValue:b};var m=f.filter(u=>-1===c.indexOf(u)),h=c.filter(u=>-1===f.indexOf(u));h=c.filter(u=>-1<f.indexOf(u)&&q(d,u)!==q(b,u)).concat(m,h).sort();if((m=g(d))&&-1<n.indexOf(m)&&h.length)return{type:"complete",oldValue:d,newValue:b};var v;m=d instanceof
t&&b instanceof t;for(const u of h){h=q(d,u);const F=q(b,u);!(m||"function"!==typeof h&&"function"!==typeof F)||h===F||null==h&&null==F||(h=a&&a[u]&&"function"===typeof a[u]?a[u](h,F):"object"===typeof h&&"object"===typeof F&&g(h)===g(F)?e(h,F):{type:"complete",oldValue:h,newValue:F},D.isSome(h)&&(D.isSome(v)?v.diff[u]=h:v={type:"partial",diff:{[u]:h}}))}return v}}function l(d,b){if(D.isNone(d))return!1;b=b.split(".");for(const a of b){if("complete"===d.type)break;if("partial"===d.type){if(d=d.diff[a],
!d)return!1}else return!1}return!0}function k(d){if(D.isNone(d))return!0;switch(d.type){case "complete":return!1;case "collection":for(const b of d.added)if(!k(b))return!1;for(const b of d.removed)if(!k(b))return!1;for(const b of d.changed)if(!k(b))return!1;return!0;case "partial":for(const b in d.diff)if(!k(d.diff[b]))return!1;return!0}}const n=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];r.diff=function(d,b){if(!("function"===
typeof d||"function"===typeof b||D.isNone(d)&&D.isNone(b)))return D.isNone(d)||D.isNone(b)||"object"===typeof d&&"object"===typeof b&&g(d)!==g(b)?{type:"complete",oldValue:d,newValue:b}:e(d,b)};r.hasDiff=l;r.hasDiffAny=function(d,b){for(const a of b)if(l(d,a))return!0;return!1};r.isEmpty=k;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithCursor":function(){define(["../../../core/Logger"],function(r){return function(t,C,D){t.referencesGeometry();C=C.readArcadeFeature();
try{return t.evaluate({...D,$feature:C})}catch(x){return r.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",x),null}}})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFIndirect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./FeatureSetReader"],function(r,t,C){let D=function(x){function w(p,g){var e=x.call(this,C.FeatureSetReader.createInstance())||this;e._currentIndex=-1;e._reader=p;e._indices=g;return e}t._inheritsLoose(w,
x);w.from=function(p,g){return new w(p.copy(),g)};var q=w.prototype;q.getSize=function(){return this._indices.length};q.getCursor=function(){return this.copy()};q.copy=function(){const p=new w(this._reader.copy(),this._indices);p._currentIndex=this._currentIndex;return p};q.next=function(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length};q._nextIndex=function(){return++this._currentIndex<this._indices.length?(this._reader.setIndex(this._indices[this._currentIndex]),
!0):!1};q.setArcadeSpatialReference=function(p){this._reader.setArcadeSpatialReference(p)};q.attachStorage=function(p){this._reader.attachStorage(p)};q.getStorage=function(){return this._reader.getStorage()};q.getComputedNumeric=function(p){return this._reader.getComputedNumericAtIndex(0)};q.setComputedNumeric=function(p,g){return this._reader.setComputedNumericAtIndex(g,0)};q.getComputedString=function(p){return this._reader.getComputedStringAtIndex(0)};q.setComputedString=function(p,g){return this._reader.setComputedStringAtIndex(0,
g)};q.getComputedNumericAtIndex=function(p){return this._reader.getComputedNumericAtIndex(p)};q.setComputedNumericAtIndex=function(p,g){this._reader.setComputedNumericAtIndex(p,g)};q.getComputedStringAtIndex=function(p){return this._reader.getComputedStringAtIndex(p)};q.setComputedStringAtIndex=function(p,g){return this._reader.setComputedStringAtIndex(p,g)};q.transform=function(p,g,e,l){const k=this.copy();k._reader=this._reader.transform(p,g,e,l);return k};q.readAttribute=function(p,g=!1){return this._reader.readAttribute(p,
g)};q.readAttributes=function(){return this._reader.readAttributes()};q.joinAttributes=function(p){return this._reader.joinAttributes(p)};q.readArcadeFeature=function(){return this._reader.readArcadeFeature()};q.geometry=function(){return this._reader.geometry()};q.field=function(p){return this.readAttribute(p,!0)};q.hasField=function(p){return this._reader.hasField(p)};q.setField=function(p,g){return this._reader.setField(p,g)};q.keys=function(){return this._reader.keys()};q.castToText=function(){return this._reader.castToText()};
q.getQuantizationTransform=function(){return this._reader.getQuantizationTransform()};q.getAttributeHash=function(){return this._reader.getAttributeHash()};q.getObjectId=function(){return this._reader.getObjectId()};q.getDisplayId=function(){return this._reader.getDisplayId()};q.setDisplayId=function(p){return this._reader.setDisplayId(p)};q.getGroupId=function(){return this._reader.getGroupId()};q.setGroupId=function(p){return this._reader.setGroupId(p)};q.getXHydrated=function(){return this._reader.getXHydrated()};
q.getYHydrated=function(){return this._reader.getYHydrated()};q.getX=function(){return this._reader.getX()};q.getY=function(){return this._reader.getY()};q.setIndex=function(p){return this._reader.setIndex(p)};q.getIndex=function(){return this._reader.getIndex()};q.readLegacyFeature=function(){return this._reader.readLegacyFeature()};q.readOptimizedFeature=function(){return this._reader.readOptimizedFeature()};q.readLegacyPointGeometry=function(){return this._reader.readLegacyPointGeometry()};q.readLegacyGeometry=
function(){return this._reader.readLegacyGeometry()};q.readLegacyCentroid=function(){return this._reader.readLegacyCentroid()};q.readGeometryArea=function(){return this._reader.readGeometryArea()};q.readUnquantizedGeometry=function(){return this._reader.readUnquantizedGeometry()};q.readHydratedGeometry=function(){return this._reader.readHydratedGeometry()};q.readGeometry=function(){return this._reader.readGeometry()};q.readCentroid=function(){return this._reader.readCentroid()};q._readAttribute=function(p,
g){throw Error("Error: Should not be called. Underlying _reader should be used instead");};q._readAttributes=function(){throw Error("Error: Should not be called. Underlying _reader should be used instead");};t._createClass(w,[{key:"hasNext",get:function(){return this._currentIndex+1<this._indices.length}},{key:"geometryType",get:function(){return this._reader.geometryType}},{key:"hasFeatures",get:function(){return this._reader.hasFeatures}},{key:"exceededTransferLimit",get:function(){return this._reader.exceededTransferLimit}},
{key:"hasZ",get:function(){return this._reader.hasZ}},{key:"hasM",get:function(){return this._reader.hasM}}]);return w}(C.FeatureSetReader);r.FeatureSetReaderIndirect=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e){var l,k,n;let d=0;C=null!=(l=D("featurelayer-simplify-thresholds"))?l:[.5,.5,.5,.5];const b=C[0],a=C[1],c=C[2],f=C[3];l=null!=(k=D("featurelayer-simplify-payload-size-factors"))?k:[1,2,4];const m=l[0],h=l[1],v=l[2],u=null!=(n=D("featurelayer-simplify-mobile-factor"))?n:2,F=D("esri-mobile");D=function(){function z(E){this.type="FeatureSetReader";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=
null;this._level=0;this.instance=E}z.createInstance=function(){d++;return d=65535<d?0:d};var A=z.prototype;A.getAreaSimplificationThreshold=function(E,G){let H=1;const K=F?u:1;4E6<G?H=v*K:1E6<G?H=h*K:5E5<G?H=m*K:1E5<G&&(H=K);G=0;4E3<E?G=f*H:2E3<E?G=c*H:100<E?G=a:15<E&&(G=b);E=8;4>this._level?E=1:5>this._level?E=2:6>this._level&&(E=4);return G*E};A.setArcadeSpatialReference=function(E){this._arcadeSpatialReference=E};A.attachStorage=function(E){this._storage=E};A.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");
};A.getStorage=function(){return this._storage};A.getComputedNumeric=function(E){return this.getComputedNumericAtIndex(0)};A.setComputedNumeric=function(E,G){return this.setComputedNumericAtIndex(G,0)};A.getComputedString=function(E){return this.getComputedStringAtIndex(0)};A.setComputedString=function(E,G){return this.setComputedStringAtIndex(0,G)};A.getComputedNumericAtIndex=function(E){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),E)};A.setComputedNumericAtIndex=function(E,
G){this._storage.setComputedNumericAtIndex(this.getDisplayId(),E,G)};A.getComputedStringAtIndex=function(E){return this._storage.getComputedStringAtIndex(this.getDisplayId(),E)};A.setComputedStringAtIndex=function(E,G){return this._storage.setComputedStringAtIndex(this.getDisplayId(),E,G)};A.transform=function(E,G,H,K){const L=this.copy();L._tx+=E;L._ty+=G;L._sx*=H;L._sy*=K;return L};A.readAttribute=function(E,G=!1){var H=this._readAttribute(E,G);if(void 0!==H)return H;for(const K of this._joined)if(K.setIndex(this.getIndex()),
H=K._readAttribute(E,G),void 0!==H)return H};A.readAttributes=function(){const E=this._readAttributes();for(const G of this._joined){G.setIndex(this.getIndex());const H=G._readAttributes();for(const K of Object.keys(H))E[K]=H[K]}return E};A.joinAttributes=function(E){this._joined.push(E)};A.readArcadeFeature=function(){return this};A.geometry=function(){var E=this.readHydratedGeometry();E=q.convertToGeometry(E,this.geometryType,this.hasZ,this.hasM);if(E=e.fromJSON(E))E.spatialReference=this._arcadeSpatialReference;
return E};A.field=function(E){return this.readAttribute(E,!0)};A.hasField=function(E){return!0};A.setField=function(E,G){};A.keys=function(){return[]};A.castToText=function(){return""};A.removeIds=function(E){if(x.isNone(this._objectIdToIndex)){var G=new Map;const H=this.getCursor();for(;H.next();)G.set(H.getObjectId(),H.getIndex());this._objectIdToIndex=G}G=this._objectIdToIndex;for(const H of E)G.has(H)&&this.removeAtIndex(G.get(H))};A.removeAtIndex=function(E){x.isNone(this._deleted)&&(this._deleted=
g.StaticBitSet.create(this.getSize()));this._deleted.set(E)};A.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};A.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};A.features=function*(){const E=this.getCursor();for(;E.next();)yield E.readOptimizedFeature()};A._getExists=function(){return x.isNone(this._deleted)||!this._deleted.has(this.getIndex())};A._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const E=this.readUnquantizedGeometry();
if(!E||E.hasIndeterminateRingOrder)return null;const G=x.unwrapOr(this.getQuantizationTransform(),null);return w.getCentroidOptimizedGeometry(new p,E,this.hasM,this.hasZ,G)};A.copyInto=function(E){E.seen=this.seen;E._storage=this._storage;E._arcadeSpatialReference=this._arcadeSpatialReference;E._joined=this._joined;E._tx=this._tx;E._ty=this._ty;E._sx=this._sx;E._sy=this._sy;E._deleted=this._deleted;E._objectIdToIndex=this._objectIdToIndex};t._createClass(z,[{key:"isEmpty",get:function(){return x.isSome(this._deleted)&&
this._deleted.countSet()===this.getSize()}},{key:"level",set:function(E){this._level=E}}]);return z}();r.FeatureSetReader=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(r){let t=function(){function C(x,w){this._mask=0;this._buf=x;this._mask=w}C.fromBuffer=function(x,w){return new C(x,w)};C.create=function(x,w=4294967295){x=new Uint32Array(Math.ceil(x/32));return new C(x,w)};var D=C.prototype;D._getIndex=
function(x){return Math.floor(x/32)};D.has=function(x){x&=this._mask;return!!(this._buf[this._getIndex(x)]&1<<x%32)};D.hasRange=function(x,w){for(;x%32&&x!==w;){if(this.has(x))return!0;x++}for(;w%32&&x!==w;){if(this.has(x))return!0;w--}if(x===w)return!1;for(x/=32;x!==w/32;x++)if(this._buf[x])return!0;return!1};D.set=function(x){x&=this._mask;const w=this._getIndex(x);this._buf[w]|=1<<x%32};D.setRange=function(x,w){for(;x%32&&x!==w;)this.set(x++);for(;w%32&&x!==w;)this.set(w--);if(x!==w)for(x/=32;x!==
w/32;x++)this._buf[x]=4294967295};D.unset=function(x){x&=this._mask;const w=this._getIndex(x);this._buf[w]&=4294967295^1<<x%32};D.resize=function(x){const w=this._buf;x=new Uint32Array(Math.ceil(x/32));x.set(w);this._buf=x};D.or=function(x){for(let w=0;w<this._buf.length;w++)this._buf[w]|=x._buf[w];return this};D.and=function(x){for(let w=0;w<this._buf.length;w++)this._buf[w]&=x._buf[w];return this};D.xor=function(x){for(let w=0;w<this._buf.length;w++)this._buf[w]^=x._buf[w];return this};D.ior=function(x){for(let w=
0;w<this._buf.length;w++)this._buf[w]|=~x._buf[w];return this};D.iand=function(x){for(let w=0;w<this._buf.length;w++)this._buf[w]&=~x._buf[w];return this};D.ixor=function(x){for(let w=0;w<this._buf.length;w++)this._buf[w]^=~x._buf[w];return this};D.any=function(){for(let x=0;x<this._buf.length;x++)if(this._buf[x])return!0;return!1};D.copy=function(x){for(let w=0;w<this._buf.length;w++)this._buf[w]=x._buf[w];return this};D.clone=function(){return new C(this._buf.slice(),this._mask)};D.clear=function(){for(let x=
0;x<this._buf.length;x++)this._buf[x]=0};D.forEachSet=function(x){for(let w=0;w<this._buf.length;w++){let q=this._buf[w],p=32*w;if(q)for(;q;)q&1&&x(p),q>>>=1,p++}};D.countSet=function(){let x=0;this.forEachSet(w=>{x++});return x};return C}();r.StaticBitSet=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/sources/createSource":function(){define("exports ../../../../../core/maybe ../../../../../layers/support/arcgisLayerUrl ./DrillDownFeatureSource ./GeoEventSource ./PagedFeatureSource ./SnapshotFeatureSource".split(" "),
function(r,t,C,D,x,w,q){r.createSource=function(p,g,e,l,k,n){a:{switch(p.type){case "snapshot":p={type:"feature",origin:"snapshot",featureCount:t.unwrapOr(p.featureCount,0),serviceInfo:p,onMessage:l,outSR:g,tileInfoView:e,canAcceptRequest:k,store:n};break a;case "stream":p={type:"geoevent",serviceInfo:p,onMessage:l,outSR:g,canAcceptRequest:k};break a;case "memory":case "on-demand":n=p.source;n=Array.isArray(n)?"local":"path"in n&&C.isHostedAgolService(n.path)?"hosted":"unknown";p={type:"feature",
serviceInfo:p,onMessage:l,outSR:g,origin:n,tileInfoView:e,canAcceptRequest:k};break a}p=void 0}switch(p.type){case "feature":switch(p.origin){case "hosted":case "local":return new w.PagedFeatureSource(p);case "snapshot":return new q.SnapshotFeatureSource(p);case "unknown":return new D.DrillDownFeatureSource(p)}case "geoevent":return new x.GeoEventSource(p)}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/maybe","../../core/urlUtils",
"../../chunks/persistableUrlUtils"],function(r,t,C,D){function x(n){n=C.urlToObject(n);n=n.path.match(e)||n.path.match(l);if(!n)return null;const [,d,b,a,c]=n;n=b.indexOf("/");return{title:q(-1!==n?b.slice(n+1):b),serverType:p[a.toLowerCase()],sublayer:null!=c&&""!==c?parseInt(c,10):null,url:{path:d}}}function w(n){return(n=C.urlToObject(n).path.match(k))?{serviceUrl:n[1],sublayerId:Number(n[2])}:null}function q(n){n=n.replace(/\s*[/_]+\s*/g," ");return n[0].toUpperCase()+n.slice(1)}const p={mapserver:"MapServer",
imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},g=Object.values(p),e=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${g.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),l=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${g.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),k=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;r.cleanTitle=q;r.isAGOLUrl=function(n){return n?(new C.Url(C.makeAbsolute(n))).authority.toLowerCase().includes("arcgis.com"):
!1};r.isArcGISUrl=function(n){return!!e.test(n)};r.isHostedAgolService=function(n){if(!n)return!1;n=n.toLowerCase();const d=-1!==n.indexOf(".arcgis.com/");n=-1!==n.indexOf("//services")||-1!==n.indexOf("//tiles")||-1!==n.indexOf("//features");return d&&n};r.isHostedSecuredProxyService=function(n,d){return d&&n&&-1!==n.toLowerCase().indexOf(d.toLowerCase())};r.isServerOrServicesAGOLUrl=function(n){if(!n)return!1;n=(new C.Url(C.makeAbsolute(n))).authority.toLowerCase();return"server.arcgisonline.com"===
n||"services.arcgisonline.com"===n};r.isWmsServer=function(n){if(!n)return!1;var d=n.toLowerCase();n=-1!==d.indexOf("/services/");const b=-1!==d.indexOf("/mapserver/wmsserver"),a=-1!==d.indexOf("/imageserver/wmsserver");d=-1!==d.indexOf("/wmsserver");return n&&(b||a||d)};r.parse=x;r.parseNonStandardSublayerUrl=w;r.sanitizeUrl=function(n,d){return n?C.removeTrailingSlash(C.removeQueryParameters(n,d)):n};r.sanitizeUrlWithLayerId=function(n){let {url:d}=n;if(!d)return{url:d};d=C.removeQueryParameters(d,
n.logger);const b=C.urlToObject(d),a=x(b.path);let c;t.isSome(a)?(null!=a.sublayer&&null==n.layer.layerId&&(c=a.sublayer),d=a.url.path):n.nonStandardUrlAllowed&&(n=w(b.path),t.isSome(n)&&(d=n.serviceUrl,c=n.sublayerId));return{url:C.removeTrailingSlash(d),layerId:c}};r.serverTypes=g;r.titleFromUrlAndName=function(n,d){const b=[];n&&(n=x(n),t.isSome(n)&&n.title&&b.push(n.title));d&&(d=q(d),b.push(d));if(2===b.length){if(-1!==b[0].toLowerCase().indexOf(b[1].toLowerCase()))return b[0];if(-1!==b[1].toLowerCase().indexOf(b[0].toLowerCase()))return b[1]}return b.join(" - ")};
r.writeUrlWithLayerId=function(n,d,b,a,c){D.write(d,a,"url",c);a.url&&null!=n.layerId&&(a.url=C.join(a.url,b,n.layerId.toString()))};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/maybe","../core/urlUtils"],function(r,t,C){function D(n,d){var b=d&&d.url&&d.url.path;n&&b&&(n=C.makeAbsolute(n,b,{preserveProtocolRelative:!0}),d.portalItem&&d.readResourcePaths&&(b=C.makeRelative(n,d.portalItem.itemUrl),l.test(b)&&d.readResourcePaths.push(d.portalItem.resourceFromPath(b).path)));
return g(n,d&&d.portal)}function x(n,d,b=0){if(!n)return n;!C.isAbsolute(n)&&d&&d.blockedRelativeUrls&&d.blockedRelativeUrls.push(n);var a=C.makeAbsolute(n);if(d){var c=d.verifyItemRelativeUrls&&d.verifyItemRelativeUrls.rootPath||d.url&&d.url.path;c&&(c=g(c,d.portal),a=C.makeRelative(g(a,d.portal),c,c),a!==n&&d.verifyItemRelativeUrls&&d.verifyItemRelativeUrls.writtenUrls.push(a))}n=a;a=(a=d&&d.portal)&&!a.isPortal&&a.urlKey&&a.customBaseUrl?C.changeDomain(n,`${a.urlKey}.${a.customBaseUrl}`,a.portalHostname):
n;C.isAbsolute(a)&&(a=C.normalize(a));null!=d&&d.resources&&null!=d&&d.portalItem&&!C.isAbsolute(a)&&!C.isDataProtocol(a)&&0===b&&d.resources.toKeep.push({resource:d.portalItem.resourceFromPath(a)});return a}function w(n,d,b){return D(n,b)}function q(n,d,b,a){n=x(n,a);void 0!==n&&(d[b]=n)}function p(n){n=t.isSome(n)?n.match(e):null;return t.isSome(n)?n[1]:null}function g(n,d){if(!d||d.isPortal||!d.urlKey||!d.customBaseUrl)return n;const b=`${d.urlKey}.${d.customBaseUrl}`;return C.hasSameOrigin(C.appUrl,
`${C.appUrl.scheme}://${b}`)?C.changeDomain(n,d.portalHostname,b):C.changeDomain(n,b,d.portalHostname)}const e=/\/items\/([^\/]+)\/resources\//,l=/^\.\/resources\//,k=Object.freeze({__proto__:null,fromJSON:D,toJSON:x,read:w,write:q,itemIdFromResourceUrl:p});r.fromJSON=D;r.itemIdFromResourceUrl=p;r.persistableUrlUtils=k;r.read=w;r.toJSON=x;r.write=q})},"esri/views/2d/layers/features/sources/DrillDownFeatureSource":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/has",
"../../../../../core/promiseUtils","./BaseFeatureSource"],function(r,t,C,D,x){var w=(C=C("esri-mobile"))?1:4,q=C?1:3;x=function(p){function g(e){return p.call(this,e)||this}t._inheritsLoose(g,p);g.prototype._fetchDataTile=function(){var e=t._asyncToGenerator(function*(l){var k=this;const n=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,d=this._subscriptions.get(l.key.id),b=d.signal,a=l.getQuantizationParameters();let c=0;const f=function(){var m=t._asyncToGenerator(function*(h,
v){const u=k._queryInfo,F=k.createTileQuery(h,{maxRecordCountFactor:n?q:void 0,returnExceededLimitFeatures:!1,quantizationParameters:a});c++;try{const A=yield k._queue.push({tile:l,query:F,signal:b,depth:v});c--;D.throwIfAborted(b);if(A)if(u!==k._queryInfo)f(h,v);else if(A.exceededTransferLimit&&v<w)for(const E of h.createChildTiles())f(E,v+1);else{var z={id:l.id,addOrUpdate:A,end:0===c,type:"append"};d.add({query:F,message:z});k._onMessage(z)}}catch(A){D.isAbortError(A)||k._onMessage({id:l.id,addOrUpdate:null,
end:!0,type:"append"})}});return function(h,v){return m.apply(this,arguments)}}();f(l,0)});return function(l){return e.apply(this,arguments)}}();return g}(x.BaseFeatureSource);r.DrillDownFeatureSource=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/sources/BaseFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../request ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../controllers/support/sourceAdapters ./DataTileSource ../../../../support/QueueProcessor".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){const k=w.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource");w=function(n){function d(a){var c=n.call(this,a)||this;c.type="feature";c.mode="on-demand";c._adapter=g.createSourceAdapter(a.serviceInfo);c._queue=new l.QueueProcessor({concurrency:8,process:function(){var f=t._asyncToGenerator(function*(m){p.throwIfAborted(m);if(q.isSome(m.tile)){var h=m.tile.key.id,{signal:v}=m;h=x("esri-tiles-debug")?{tile:h.replace(/\//g,"."),depth:m.depth}:void 0;v=
yield c._adapter.executeQuery(m.query,{signal:v,query:{...h,...c._schema.customParameters}});v.level=m.tile.key.level;return v}return c._adapter.executeQuery(m.query,{...m,query:c._schema.customParameters})});return function(m){return f.apply(this,arguments)}}()});c._patchQueue=new l.QueueProcessor({concurrency:8,process:function(){var f=t._asyncToGenerator(function*(m){p.throwIfAborted(m);if(q.isSome(m.tile)){var h=m.tile.key.id,{signal:v}=m;h=x("esri-tiles-debug")?{tile:h.replace(/\//g,"."),depth:m.depth}:
void 0;v=yield c._adapter.executeQuery(m.query,{signal:v,query:{...h,...c._schema.customParameters}});v.level=m.tile.key.level;return v}return c._adapter.executeQuery(m.query,{...m,query:c._schema.customParameters})});return function(m){return f.apply(this,arguments)}}()});return c}t._inheritsLoose(d,n);var b=d.prototype;b.destroy=function(){n.prototype.destroy.call(this);this._adapter.destroy();this._queue.destroy();this._patchQueue.destroy()};b.enableEvent=function(a,c){};b.subscribe=function(a){n.prototype.subscribe.call(this,
a);const c=this._subscriptions.get(a.id);this._fetchDataTile(a).catch(f=>{p.isAbortError(f)||k.error(new D("mapview-query-error","Encountered error when fetching tile",{tile:a,error:f}))}).then(()=>c.end())};b.unsubscribe=function(a){n.prototype.unsubscribe.call(this,a)};b.readers=function(a){return this._subscriptions.get(a).readers()};b.query=function(){var a=t._asyncToGenerator(function*(c){return this._adapter.executeQuery(c,{query:this._schema.customParameters})});return function(c){return a.apply(this,
arguments)}}();b.queryLastEditDate=function(){var a=t._asyncToGenerator(function*(){const c=this._serviceInfo.source;return(yield C(c.path,{query:{...c.query,f:"json"},responseType:"json"})).data.editingInfo.lastEditDate});return function(){return a.apply(this,arguments)}}();b.createTileQuery=function(a,c={}){var f;const m=this.createQuery(c);m.quantizationParameters=null!=(f=c.quantizationParameters)?f:a.getQuantizationParameters();m.resultType="tile";m.geometry=a.extent;m.quantizationParameters&&
"esriGeometryPolyline"===this._serviceInfo.geometryType&&(m.maxAllowableOffset=a.resolution);return m};b._executePatchQuery=function(){var a=t._asyncToGenerator(function*(c,f,m,h){f=f.clone();f.outFields=[this._serviceInfo.objectIdField,...m];f.returnCentroid=!1;f.returnGeometry=!1;m=q.isSome(f.start)?f.start/8E3:0;return this._patchQueue.push({tile:c,query:f,signal:h.signal,depth:m})});return function(c,f,m,h){return a.apply(this,arguments)}}();b._resend=function(){var a=t._asyncToGenerator(function*(c,
f){const {query:m,message:h}=c,v=q.isSome(m.outFields)?m.outFields:[];c=this._queryInfo.outFields;const u=c.filter(F=>-1===v.indexOf(F));if(q.isNone(h.addOrUpdate))this._onMessage({...h,type:"append"});else if(u.length)try{const F=this._subscriptions.get(h.id).tile,z=yield this._executePatchQuery(F,m,u,f);p.throwIfAborted(f);m.outFields=c;h.addOrUpdate.joinAttributes(z);this._onMessage({...h,end:h.end,type:"append"})}catch(F){}else this._onMessage({...h,type:"append"})});return function(c,f){return a.apply(this,
arguments)}}();b._resendSubscription=function(){var a=t._asyncToGenerator(function*(c){if(c.empty)return this._onMessage({id:c.tile.id,addOrUpdate:null,end:!1,type:"append"});const f=c.signal;for(const m of c.requests.done)yield this._resend(m,{signal:f});if(q.isSome(c.edits))return this._onMessage(c.edits)});return function(c){return a.apply(this,arguments)}}();b.resend=function(){var a=t._asyncToGenerator(function*(){const c=Array.from(this._subscriptions.values());yield Promise.all(c.map(f=>this._resendSubscription(f)))});
return function(){return a.apply(this,arguments)}}();t._createClass(d,[{key:"updating",get:function(){return!!this._queue.length||Array.from(this._subscriptions.values()).some(a=>!a.done)}},{key:"maxRecordCountFactor",get:function(){const {query:a}=this._serviceInfo.capabilities;return a.supportsMaxRecordCountFactor?4:null}},{key:"maxPageSize",get:function(){var a,{query:c}=this._serviceInfo.capabilities;c=null!=(a=c.maxRecordCount)?a:8E3;a=q.unwrapOr(this.maxRecordCountFactor,1);return c*a}},{key:"pageSize",
get:function(){return Math.min(8E3,this.maxPageSize)}}]);return d}(e.DataTileSource);r.BaseFeatureSource=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/controllers/support/sourceAdapters":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/workers/Connection ../../../../../../geometry/support/quantizationUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../layers/ogc/ogcFeatureUtils ../../../../../../rest/query/operations/query ../../support/FeatureSetReaderJSON ../../support/FeatureSetReaderPBF".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){function k(m){return n.apply(this,arguments)}function n(){n=t._asyncToGenerator(function*(m){const h=new x;yield h.open(m,{});return h});return n.apply(this,arguments)}let d=function(){function m(h){this.service=h}m.prototype.destroy=function(){};return m}(),b=function(m){function h(u){var F=m.call(this,u)||this;F._portsOpen=k(u.source).then(z=>F.client=z);return F}t._inheritsLoose(h,m);var v=h.prototype;v.destroy=function(){this.client.close();this.client=null};v.executeQuery=
function(){var u=t._asyncToGenerator(function*(F,z){yield this._portsOpen;F=yield this.client.invoke("queryFeatures",F.toJSON(),z);return e.FeatureSetReaderJSON.fromFeatureSet(F,this.service.objectIdField)});return function(F,z){return u.apply(this,arguments)}}();return h}(d),a=function(m){function h(){return m.apply(this,arguments)||this}t._inheritsLoose(h,m);h.prototype.executeQuery=function(){var v=t._asyncToGenerator(function*(u,F){({data:F}=yield g.executeQueryPBFBuffer(this.service.source,u,
F));return l.FeatureSetReaderPBF.fromBuffer(F,this.service.geometryType,!u.quantizationParameters)});return function(u,F){return v.apply(this,arguments)}}();return h}(d),c=function(m){function h(){return m.apply(this,arguments)||this}t._inheritsLoose(h,m);h.prototype.executeQuery=function(){var v=t._asyncToGenerator(function*(u,F){const {source:z,capabilities:A,spatialReference:E,objectIdField:G,geometryType:H}=this.service;if(D.isSome(u.quantizationParameters)&&!A.query.supportsQuantization){u=u.clone();
var K=w.toQuantizationTransform(D.unwrap(u.quantizationParameters));u.quantizationParameters=null;({data:F}=yield g.executeQuery(z,u,E,F));F=q.convertFromFeatureSet(F,G);q.quantizeOptimizedFeatureSet(K,F);return e.FeatureSetReaderJSON.fromOptimizedFeatureSet(F)}({data:F}=yield g.executeQuery(z,u,this.service.spatialReference,F));"esriGeometryPoint"===H&&(F.features=null==(K=F.features)?void 0:K.filter(L=>D.isSome(L.geometry)?(L=L.geometry,Number.isFinite(L.x)&&Number.isFinite(L.y)):!0));return e.FeatureSetReaderJSON.fromFeatureSet(F,
this.service.objectIdField)});return function(u,F){return v.apply(this,arguments)}}();return h}(d),f=function(m){function h(){return m.apply(this,arguments)||this}t._inheritsLoose(h,m);h.prototype.executeQuery=function(){var v=t._asyncToGenerator(function*(u,F){var {capabilities:z}=this.service;if(u.quantizationParameters&&!z.query.supportsQuantization){const A=u.clone();z=w.toQuantizationTransform(D.unwrap(A.quantizationParameters));A.quantizationParameters=null;u=yield p.queryOptimizedFeatureSet(this.service.source,
u,F);q.quantizeOptimizedFeatureSet(z,u);return e.FeatureSetReaderJSON.fromOptimizedFeatureSet(u)}u=yield p.queryOptimizedFeatureSet(this.service.source,u,F);return e.FeatureSetReaderJSON.fromOptimizedFeatureSet(u)});return function(u,F){return v.apply(this,arguments)}}();return h}(d);r.SourceAdapter=d;r.createSourceAdapter=function(m){const {capabilities:h}=m;var v=m.source;return v&&v.capabilities&&v.collection&&v.layerDefinition?new f(m):Array.isArray(m.source)?new b(m):h.query.supportsFormatPBF&&
C("featurelayer-pbf")?new a(m):new c(m)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/workers/Connection":function(){define(["../../chunks/_rollupPluginBabelHelpers","../handleUtils","../Logger","../promiseUtils","./RemoteClient"],function(r,t,C,D,x){const w=C.getLogger("esri.core.workers.Connection");return function(){function q(){this._clients=[];this._clientPromises=[];this._clientIdx=0}var p=q.prototype;p.destroy=function(){this.close()};p.open=function(g,e){return new Promise((l,
k)=>{let n=!0;const d=b=>{D.throwIfAborted(e.signal);n&&(n=!1,b())};this._clients.length=g.length;this._clientPromises.length=g.length;for(let b=0;b<g.length;++b){const a=g[b];D.isPromiseLike(a)?this._clientPromises[b]=a.then(c=>{this._clients[b]=new x(c,e);d(l);return this._clients[b]},()=>{d(k);return null}):(this._clients[b]=new x(a,e),this._clientPromises[b]=Promise.resolve(this._clients[b]),d(l))}})};p.broadcast=function(g,e,l){const k=Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n)k[n]=
this._clientPromises[n].then(d=>d.invoke(g,e,l));return k};p.close=function(){for(const g of this._clientPromises)g.then(e=>e.close());this._clients.length=0;this._clientPromises.length=0};p.getAvailableClient=function(){let g;for(let e=0;e<this._clients.length;++e){const l=this._clients[e];if(!l)g=g||[],g.push(this._clientPromises[e]);else if(!l.isBusy())return Promise.resolve(l)}return g?Promise.race(g):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))};
p.invoke=function(g,e,l){let k=null;Array.isArray(l)?(w.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),k={transferList:l}):k=l;return this.closed?Promise.reject(Error("Connection closed")):this.getAvailableClient().then(n=>n.invoke(g,e,k))};p.on=function(g,e){return Promise.all(this._clientPromises).then(()=>t.handlesGroup(this._clients.map(l=>l.on(g,e))))};p.openPorts=function(){return new Promise(g=>{const e=Array(this._clientPromises.length);let l=e.length;
for(let k=0;k<this._clientPromises.length;++k)this._clientPromises[k].then(n=>{e[k]=n.openPort();0===--l&&g(e)})})};r._createClass(q,[{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"test",get:function(){return{numClients:this._clients.length}}}]);return q}()})},"esri/layers/ogc/ogcFeatureUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../geometry/SpatialReference".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a){function c(){c=t._asyncToGenerator(function*(B,y,I={},S=5){({links:B}=B);B=L(B,"items","application/geo+json")||L(B,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(q.isNone(B))throw new x("ogc-feature-layer:missing-items-page","Missing items url");({data:I}=yield D(B.href,{signal:I.signal,query:{limit:S,...I.customParameters,token:I.apiKey},headers:{accept:"application/geo+json"}}));yield k.validateGeoJSON(I);const O=k.inferLayerProperties(I,
{geometryType:y.geometryType});I=y.fields||O.fields||[];S=null!=y.hasZ?y.hasZ:O.hasZ;B=O.geometryType;const Y=y.objectIdField||O.objectIdFieldName||"OBJECTID";y=y.timeInfo;var R=I.find(W=>W.name===Y);if(R)R.type="esriFieldTypeOID",R.editable=!1,R.nullable=!1;else{if(!O.objectIdFieldType)throw new x("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");I.unshift({name:Y,alias:Y,type:"esriFieldTypeOID",editable:!1,nullable:!1})}Y!==O.objectIdFieldName&&
(R=I.find(W=>W.name===O.objectIdFieldName))&&(R.type="esriFieldTypeInteger");I===O.fields&&0<O.unknownFields.length&&J.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:O.unknownFields}});for(var Q of I){null==Q.name&&(Q.name=Q.alias);null==Q.alias&&(Q.alias=Q.name);"esriFieldTypeOID"!==Q.type&&"esriFieldTypeGlobalID"!==Q.type&&(Q.editable=null==Q.editable?!0:!!Q.editable,Q.nullable=null==Q.nullable?
!0:!!Q.nullable);if(!Q.name)throw new x("ogc-feature-layer:invalid-field-name","field name is missing",{field:Q});if(-1===b.kebabDict.jsonValues.indexOf(Q.type))throw new x("ogc-feature-layer:invalid-field-type",`invalid type for field "${Q.name}"`,{field:Q});}y&&(Q=new d(I),y.startTimeField&&((R=Q.get(y.startTimeField))?(y.startTimeField=R.name,R.type="esriFieldTypeDate"):y.startTimeField=null),y.endTimeField&&((R=Q.get(y.endTimeField))?(y.endTimeField=R.name,R.type="esriFieldTypeDate"):y.endTimeField=
null),y.trackIdField&&((Q=Q.get(y.trackIdField))?y.trackIdField=Q.name:(y.trackIdField=null,J.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:y}}))),y.startTimeField||y.endTimeField||(J.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:y}}),y=null));return{drawingInfo:B?n.createDrawingInfo(B):null,geometryType:B,fields:I,hasZ:!!S,objectIdField:Y,timeInfo:y}});return c.apply(this,
arguments)}function f(){f=t._asyncToGenerator(function*(B,y={}){({links:B}=B);B=L(B,"data","application/json")||L(B,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if(q.isNone(B))throw new x("ogc-feature-layer:missing-collections-page","Missing collections url");const {apiKey:I,customParameters:S,signal:O}=y;({data:y}=yield D(B.href,{signal:O,headers:{accept:"application/json"},query:{...S,token:I}}));return y});return f.apply(this,arguments)}function m(){m=t._asyncToGenerator(function*(B,
y={}){({links:B}=B);B=L(B,"conformance","application/json")||L(B,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if(q.isNone(B))throw new x("ogc-feature-layer:missing-conformance-page","Missing conformance url");const {apiKey:I,customParameters:S,signal:O}=y;({data:y}=yield D(B.href,{signal:O,headers:{accept:"application/json"},query:{...S,token:I}}));return y});return m.apply(this,arguments)}function h(){h=t._asyncToGenerator(function*(B,y={}){const {apiKey:I,customParameters:S,
signal:O}=y;({data:B}=yield D(B,{signal:O,headers:{accept:"application/json"},query:{...S,token:I}}));return B});return h.apply(this,arguments)}function v(){v=t._asyncToGenerator(function*(B,y={}){B=L(B.links,"service-desc","application/vnd.oai.openapi+json;version\x3d3.0");if(q.isNone(B))return J.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const {apiKey:I,customParameters:S,signal:O}=y;({data:y}=yield D(B.href,{signal:O,headers:{accept:"application/vnd.oai.openapi+json;version\x3d3.0"},
query:{...S,token:I}}));return y});return v.apply(this,arguments)}function u(){u=t._asyncToGenerator(function*(B,y,I){B=yield F(B,y,I);return e.convertToFeatureSet(B)});return u.apply(this,arguments)}function F(B,y,I){return z.apply(this,arguments)}function z(){z=t._asyncToGenerator(function*(B,y,I){const {capabilities:{query:{maxRecordCount:S}},collection:O,layerDefinition:Y,queryParameters:{apiKey:R,customParameters:Q},spatialReference:W,supportedCrs:P}=B;({links:B}=O);var fa=L(B,"items","application/geo+json")||
L(B,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(q.isNone(fa))throw new x("ogc-feature-layer:missing-items-page","Missing items url");const {geometry:oa,num:pa,start:sa,timeExtent:ra,where:ua}=y;if(y.objectIds)throw new x("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");B=a.fromJSON(W);y=q.unwrapOr(y.outSpatialReference,B);B=y.isWGS84?null:A(y,P);var M=K(oa,P),T=G(ra);const ha=H(ua);({data:M}=yield D(fa.href,{...I,query:{...Q,
...M,crs:B,datetime:T,query:ha,limit:null!=pa?pa:null!=sa&&void 0!==sa?10:S,startindex:sa,token:R},headers:{accept:"application/geo+json"}}));I=!1;M.links&&(I=!!M.links.find(da=>"next"===da.rel));!I&&Number.isInteger(M.numberMatched)&&Number.isInteger(M.numberReturned)&&(I=M.numberReturned<M.numberMatched);const {fields:V,globalIdField:Z,hasM:ca,hasZ:ea,objectIdField:ja}=Y;fa=Y.geometryType;M=k.createOptimizedFeatures(M,{geometryType:fa,hasZ:ea,objectIdField:ja});if(!B&&y.isWebMercator)for(var la of M)q.isSome(la.geometry)&&
(T=e.convertToGeometry(la.geometry,fa,ea,!1),T.spatialReference=a.WGS84,la.geometry=e.convertFromGeometry(g.project(T,y)));for(var aa of M)aa.objectId=aa.attributes[ja];la=B||!B&&y.isWebMercator?y.toJSON():p.WGS84;aa=new l;aa.exceededTransferLimit=I;aa.features=M;aa.fields=V;aa.geometryType=fa;aa.globalIdFieldName=Z;aa.hasM=ca;aa.hasZ=ea;aa.objectIdFieldName=ja;aa.spatialReference=la;return aa});return z.apply(this,arguments)}function A(B,y){var I,S,O;const {isWebMercator:Y,wkid:R}=B;return R?(B=
Y?null!=(I=null!=(S=null!=(O=y[3857])?O:y[102100])?S:y[102113])?I:y[900913]:y[B.wkid])?`${"http://www.opengis.net/def/crs/"}${B}`:null:null}function E(B){if(q.isNone(B))return"";const {xmin:y,ymin:I,xmax:S,ymax:O}=B;return`${y},${I},${S},${O}`}function G(B){if(q.isNone(B))return null;const {start:y,end:I}=B;return`${q.isSome(y)?y.toISOString():".."}/${q.isSome(I)?I.toISOString():".."}`}function H(B){return q.isNone(B)||!B||"1\x3d1"===B?null:B}function K(B,y){if(!q.isSome(B)||"extent"!==B.type)return null;
const {spatialReference:I}=B;if(!I||I.isWGS84)return{bbox:E(B)};y=A(I,y);return q.isSome(y)?{bbox:E(B),"bbox-crs":y}:I.isWebMercator?{bbox:E(g.project(B,a.WGS84))}:null}function L(B,y,I){return B.find(S=>S.rel===y&&S.type===I)||B.find(S=>S.rel===y&&!S.type)}const J=w.getLogger("esri.layers.graphics.sources.ogcfeature");r.crsDefault="http://www.opengis.net/def/crs/OGC/1.3/CRS84";r.crsPrefix="http://www.opengis.net/def/crs/";r.getCollectionDefinition=function(B,y){return c.apply(this,arguments)};r.getServerCollections=
function(B){return f.apply(this,arguments)};r.getServerConformance=function(B){return m.apply(this,arguments)};r.getServerLandingPage=function(B){return h.apply(this,arguments)};r.getServerOpenApi=function(B){return v.apply(this,arguments)};r.getSpatialReferenceWkid=function(B){B=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(B);B=null==B?void 0:B.groups;if(!B)return null;const {authority:y,code:I}=B;switch(y.toLowerCase()){case "ogc":switch(I.toLowerCase()){case "crs27":return a.GCS_NAD_1927.wkid;
case "crs83":return 4269;case "crs84":case "crs84h":return a.WGS84.wkid;default:return null}case "esri":case "epsg":return B=Number.parseInt(I,10),Number.isNaN(B)?null:B;default:return null}};r.queryFeatureSetJSON=function(B,y,I){return u.apply(this,arguments)};r.queryOptimizedFeatureSet=F;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature","../../OptimizedGeometry","../../../support/fieldUtils"],
function(r,t,C,D,x){function*w(m){switch(m.type){case "Feature":yield m;break;case "FeatureCollection":for(const h of m.features)h&&(yield h)}}function*q(m){if(!m)return null;switch(m.type){case "Point":yield m.coordinates;break;case "LineString":case "MultiPoint":yield*m.coordinates;break;case "MultiLineString":case "Polygon":for(const h of m.coordinates)yield*h;break;case "MultiPolygon":for(const h of m.coordinates)for(const v of h)yield*v}}function*p(m,h={}){const {geometryType:v,objectIdField:u}=
h;for(const z of m){var F;const {geometry:A,properties:E,id:G}=z;if(A&&f[A.type]!==v)continue;m=E||{};let H=null!=(F=m[u])?F:null;u&&null!=G&&!m[u]&&(m[u]=H=G);yield new C.default(A?k(new D,A,h):null,m,null,H)}}function g(m){for(const h of m)if(2<h.length)return!0;return!1}function e(m){let h=0;for(let v=0;v<m.length;v++){const u=m[v],F=m[(v+1)%m.length];h+=u[0]*F[1]-F[0]*u[1]}return 0>=h}function l(m){const h=m[0],v=m[m.length-1];h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]||m.push(h);return m}function k(m,
h,v){switch(h.type){case "LineString":return b(m,h.coordinates,v),m;case "MultiLineString":for(const F of h.coordinates)b(m,F,v);return m;case "MultiPoint":return b(m,h.coordinates,v),m;case "MultiPolygon":for(var u of h.coordinates)for(n(m,u[0],v),h=1;h<u.length;h++)d(m,u[h],v);return m;case "Point":return c(m,h.coordinates,v),m;case "Polygon":u=h.coordinates;n(m,u[0],v);for(h=1;h<u.length;h++)d(m,u[h],v);return m}}function n(m,h,v){h=l(h);e(h)?b(m,h,v):a(m,h,v)}function d(m,h,v){h=l(h);e(h)?a(m,
h,v):b(m,h,v)}function b(m,h,v){for(const u of h)c(m,u,v);m.lengths.push(h.length)}function a(m,h,v){for(let u=h.length-1;0<=u;u--)c(m,h[u],v);m.lengths.push(h.length)}function c(m,h,v){const [u,F,z]=h;m.coords.push(u,F);v.hasZ&&m.coords.push(z||0)}const f={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};r.createOptimizedFeatures=function(m,h){return Array.from(p(w(m),
h))};r.getGeometryType=function(m){return f[m]};r.inferLayerProperties=function(m,h={}){const v=[];var u=new Set;const F=new Set;var z=!1;let A=null,E=!1,G=void 0;({geometryType:h=null}=h);var H=!1;for(const K of w(m)){const {geometry:L,properties:J,id:B}=K;if(L&&(h||(h=f[L.type]),f[L.type]!==h))continue;z||(z=q(L),z=g(z));!E&&(E=null!=B)&&(G=typeof B,A=Object.keys(J).filter(y=>J[y]===B));E&&null!=B&&(1<A.length?A=A.filter(y=>J[y]===B):1===A.length&&(A=J[A[0]]===B?A:[]));if(!H&&J){m=!0;for(const y in J)if(!u.has(y))if(H=
J[y],null==H)m=!1,F.add(y);else{a:switch(typeof H){case "string":H="esriFieldTypeString";break a;case "number":H="esriFieldTypeDouble";break a;default:H="unknown"}"unknown"===H?F.add(y):(F.delete(y),u.add(y),v.push({name:y,alias:y,type:H}))}H=m}}if(u=A&&1===A.length&&A[0]||null)for(const K of v)if(K.name===u&&x.isNumericField(K)){K.type="esriFieldTypeOID";break}return{fields:v,geometryType:h,hasZ:z,objectIdFieldName:u,objectIdFieldType:G,unknownFields:Array.from(F)}};r.validateGeoJSON=function(m){if(!m)throw new t("geojson-layer:empty",
"GeoJSON data is empty");if("Feature"!==m.type&&"FeatureCollection"!==m.type)throw new t("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:m});({crs:m}=m);if(m){var h="string"===typeof m?m:"name"===m.type?m.properties.name:"EPSG"===m.type?m.properties.code:null,v=/.*(CRS84H?|4326)$/i;if(!h||!v.test(h))throw new t("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:m});}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports",
"../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(r,t,C,D,x){r.createCapabilities=function(w,q){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:w},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:q,supportsDelete:q,supportsEditing:q,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,
supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:q,supportsExceedsLimitStatistics:!0},query:D.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:q,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}};r.createDefaultAttributesFunction=
function(w,q){if(t("esri-csp-restrictions"))return()=>({[q]:null,...w});try{let p=`this.${q} = null;`;for(const e in w){const l=e.includes(".")?`["${e}"]`:`.${e}`;p+=`this${l} = ${JSON.stringify(w[e])};`}const g=new Function(p);return()=>new g}catch(p){return()=>({[q]:null,...w})}};r.createDefaultTemplate=function(w={}){return[{name:"New Feature",description:"",prototype:{attributes:C.clone(w)}}]};r.createDrawingInfo=function(w){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===w||"esriGeometryMultipoint"===
w?x.defaultPointSymbolJSON:"esriGeometryPolyline"===w?x.defaultPolylineSymbolJSON:x.defaultPolygonSymbolJSON}}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],function(r){const t=[252,146,31,255],C={type:"esriSMS",style:"esriSMSCircle",size:6,color:t,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},D={type:"esriSLS",style:"esriSLSSolid",width:.75,color:t};r.defaultColor=t;r.defaultOutlineColor=[153,
153,153,255];r.defaultPointSymbolJSON=C;r.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};r.defaultPolylineSymbolJSON=D;r.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};r.errorPointSymbolJSON={type:"esriSMS",
style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};r.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};r.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(r,t){t=new t.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",
esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});r.kebabDict=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/query":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/maybe ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../layers/support/arcgisLayerUrl ./pbfQueryUtils ./queryZScale ../../../tasks/operations/urlUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){function k(c,f,m=!1){const h=c.geometry,v=c.toJSON(),u=c.outSpatialReference;let F,z;if(D.isSome(h)){F=h.spatialReference;z=h.spatialReference.wkid||JSON.stringify(h.spatialReference);v.geometryType=w.getJsonType(h);if("extent"===h.type)v.geometry=`${h.xmin},${h.ymin},${h.xmax},${h.ymax}`;else if("point"===h.type)v.geometry=`${h.x},${h.y}`;else{const A=h.toJSON();delete A.spatialReference;v.geometry=JSON.stringify(A)}v.inSR=z}F||(F=u);v.groupByFieldsForStatistics&&
(v.groupByFieldsForStatistics=v.groupByFieldsForStatistics.join(","));v.objectIds&&(v.objectIds=v.objectIds.join(","));v.orderByFields&&(v.orderByFields=v.orderByFields.join(","));!v.outFields||!v.returnDistinctValues&&(null!=f&&f.returnCountOnly||null!=f&&f.returnExtentOnly||null!=f&&f.returnIdsOnly)?delete v.outFields:-1!==v.outFields.indexOf("*")?v.outFields="*":v.outFields=v.outFields.join(",");v.outSR?v.outSR=v.outSR.wkid||JSON.stringify(v.outSR):h&&(v.returnGeometry||v.returnCentroid)&&(v.outSR=
v.inSR);v.returnGeometry&&delete v.returnGeometry;v.outStatistics&&(v.outStatistics=JSON.stringify(v.outStatistics));v.pixelSize&&(v.pixelSize=JSON.stringify(v.pixelSize));v.quantizationParameters&&(m&&D.isSome(F)&&D.isSome(c.quantizationParameters)&&D.isSome(c.quantizationParameters.extent)&&F.equals(c.quantizationParameters.extent.spatialReference)&&delete v.quantizationParameters.extent.spatialReference,v.quantizationParameters=JSON.stringify(v.quantizationParameters));v.parameterValues&&(v.parameterValues=
JSON.stringify(v.parameterValues));v.rangeValues&&(v.rangeValues=JSON.stringify(v.rangeValues));v.dynamicDataSource&&(v.layer=JSON.stringify({source:v.dynamicDataSource}),delete v.dynamicDataSource);if(v.timeExtent){const {start:A,end:E}=v.timeExtent;if(null!=A||null!=E)v.time=A===E?A:`${null==A?"null":A},${null==E?"null":E}`;delete v.timeExtent}return v}function n(){n=t._asyncToGenerator(function*(c,f,m,h){c=D.isSome(f.timeExtent)&&f.timeExtent.isEmpty?{data:{features:[]}}:yield a(c,f,"json",h);
e.applyFeatureSetZUnitScaling(f,m,c.data);return c});return n.apply(this,arguments)}function d(){d=t._asyncToGenerator(function*(c,f,m,h){if(D.isSome(f.timeExtent)&&f.timeExtent.isEmpty)return Promise.resolve({data:m.createFeatureResult()});c=yield b(c,f,h);c.data=g.parsePBFFeatureQuery(c.data,m);return c});return d.apply(this,arguments)}function b(c,f,m){return a(c,f,"pbf",m)}function a(c,f,m,h={},v={}){const u="string"===typeof c?x.urlToObject(c):c;c=f.geometry?[f.geometry]:[];h.responseType="pbf"===
m?"array-buffer":"json";return q.normalizeCentralMeridian(c,null,h).then(F=>{F=F&&F[0];D.isSome(F)&&(f=f.clone(),f.geometry=F);F=p.isHostedAgolService(u.path);F=l.mapParameters({...u.query,f:m,...v,...k(f,v,F)});return C(x.join(u.path,"query"),{...h,query:{...F,...h.query}})})}r.executeQuery=function(c,f,m,h){return n.apply(this,arguments)};r.executeQueryForCount=function(c,f,m){return D.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):a(c,f,"json",m,{returnIdsOnly:!0,
returnCountOnly:!0})};r.executeQueryForExtent=function(c,f,m){return D.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):a(c,f,"json",m,{returnExtentOnly:!0,returnCountOnly:!0}).then(h=>{const v=h.data;if(v.hasOwnProperty("extent"))return h;if(v.features)throw Error("Layer does not support extent calculation.");if(v.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return h})};r.executeQueryForIds=function(c,f,m){return D.isSome(f.timeExtent)&&
f.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):a(c,f,"json",m,{returnIdsOnly:!0})};r.executeQueryPBF=function(c,f,m,h){return d.apply(this,arguments)};r.executeQueryPBFBuffer=b;r.queryToQueryStringParameters=k;r.runQuery=a;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(r,t){r.parsePBFFeatureQuery=function(C,D){var x=t.parseFeatureQuery(C,D);C=x.queryResult.featureResult;
D=x.queryResult.queryGeometry;x=x.queryResult.queryGeometryType;if(C&&C.features&&C.features.length&&C.objectIdFieldName){const w=C.objectIdFieldName;for(const q of C.features)q.attributes&&(q.objectId=q.attributes[w])}C&&(C.queryGeometry=D,C.queryGeometryType=x);return C};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define("exports ../../../core/Error ../../../core/maybe ../../../core/pbf ../../../layers/graphics/OptimizedGeometry ./pbfOptimizedFeatureSet".split(" "),
function(r,t,C,D,x,w){function q(A){return A>=u.length?null:u[A]}function p(A,E,G){for(G=E.createPointGeometry(G);A.next();)switch(A.tag()){case 3:{var H=A.getUInt32();H=A.pos()+H;let K=0;for(;A.pos()<H;)E.addCoordinatePoint(G,A.getSInt64(),K++);break}default:A.skip()}return G}function g(A,E,G){const H=E.createGeometry(G);for(G=2+(G.hasZ?1:0)+(G.hasM?1:0);A.next();)switch(A.tag()){case 2:var K=A.getUInt32();K=A.pos()+K;for(var L=0;A.pos()<K;)E.addLength(H,A.getUInt32(),L++);break;case 3:K=A.getUInt32();
K=A.pos()+K;L=0;for(E.allocateCoordinates(H);A.pos()<K;)E.addCoordinate(H,A.getSInt64(),L),L++,L===G&&(L=0);break;default:A.skip()}return H}function e(A){const E=new x;let G="esriGeometryPoint";for(;A.next();)switch(A.tag()){case 2:var H=A.getUInt32();for(H=A.pos()+H;A.pos()<H;)E.lengths.push(A.getUInt32());break;case 3:H=A.getUInt32();for(H=A.pos()+H;A.pos()<H;)E.coords.push(A.getSInt64());break;case 1:G=w.OPTIMIZED_GEOMETRY_TYPES[A.getEnum()];break;default:A.skip()}return{queryGeometry:E,queryGeometryType:G}}
function l(A){for(;A.next();)switch(A.tag()){case 1:return A.getString();case 2:return A.getFloat();case 3:return A.getDouble();case 4:return A.getSInt32();case 5:return A.getUInt32();case 6:return A.getInt64();case 7:return A.getUInt64();case 8:return A.getSInt64();case 9:return A.getBool();default:return A.skip(),null}return null}function k(A){const E={type:q(0)};for(;A.next();)switch(A.tag()){case 1:E.name=A.getString();break;case 2:E.type=q(A.getEnum());break;case 3:E.alias=A.getString();break;
case 4:var G=A.getEnum();G=G>=F.length?null:F[G];E.sqlType=G;break;case 5:A.skip();break;case 6:E.defaultValue=A.getString();break;default:A.skip()}return E}function n(A){const E={};for(;A.next();)switch(A.tag()){case 1:E.name=A.getString();break;case 2:E.isSystemMaintained=A.getBool();break;default:A.skip()}return E}function d(A,E,G,H){const K=E.createFeature(G);let L=0;for(;A.next();)switch(A.tag()){case 1:{const J=H[L++].name;K.attributes[J]=A.processMessage(l);break}case 2:K.geometry=A.processMessageWithArgs(g,
E,G);break;case 4:K.centroid=A.processMessageWithArgs(p,E,G);break;default:A.skip()}return K}function b(A){const E=[1,1,1,1];for(;A.next();)switch(A.tag()){case 1:E[0]=A.getDouble();break;case 2:E[1]=A.getDouble();break;case 4:E[2]=A.getDouble();break;case 3:E[3]=A.getDouble();break;default:A.skip()}return E}function a(A){const E=[0,0,0,0];for(;A.next();)switch(A.tag()){case 1:E[0]=A.getDouble();break;case 2:E[1]=A.getDouble();break;case 4:E[2]=A.getDouble();break;case 3:E[3]=A.getDouble();break;
default:A.skip()}return E}function c(A){const E={originPosition:0>=z.length?null:z[0]};for(;A.next();)switch(A.tag()){case 1:var G=A.getEnum();E.originPosition=G>=z.length?null:z[G];break;case 2:E.scale=A.processMessage(b);break;case 3:E.translate=A.processMessage(a);break;default:A.skip()}return E}function f(A){const E={};for(;A.next();)switch(A.tag()){case 1:E.shapeAreaFieldName=A.getString();break;case 2:E.shapeLengthFieldName=A.getString();break;case 3:E.units=A.getString();break;default:A.skip()}return E}
function m(A,E){for(E=E.createSpatialReference();A.next();)switch(A.tag()){case 1:E.wkid=A.getUInt32();break;case 5:E.wkt=A.getString();break;case 2:E.latestWkid=A.getUInt32();break;case 3:E.vcsWkid=A.getUInt32();break;case 4:E.latestVcsWkid=A.getUInt32();break;default:A.skip()}return E}function h(A,E){const G=E.createFeatureResult();G.geometryType=0>=E.geometryTypes.length?null:E.geometryTypes[0];let H=!1;for(;A.next();)switch(A.tag()){case 1:G.objectIdFieldName=A.getString();break;case 3:G.globalIdFieldName=
A.getString();break;case 4:G.geohashFieldName=A.getString();break;case 5:G.geometryProperties=A.processMessage(f);break;case 7:var K=A.getEnum();G.geometryType=K>=E.geometryTypes.length?null:E.geometryTypes[K];break;case 8:G.spatialReference=A.processMessageWithArgs(m,E);break;case 10:G.hasZ=A.getBool();break;case 11:G.hasM=A.getBool();break;case 12:G.transform=A.processMessage(c);break;case 9:K=A.getBool();G.exceededTransferLimit=K;break;case 13:E.addField(G,A.processMessage(k));break;case 15:H||
(E.prepareFeatures(G),H=!0);E.addFeature(G,A.processMessageWithArgs(d,E,G,G.fields));break;case 2:G.uniqueIdField=A.processMessage(n);break;default:A.skip()}E.finishFeatureResult(G);return G}function v(A,E){const G={};let H=null;for(;A.next();)switch(A.tag()){case 4:H=A.processMessageWithArgs(e);break;case 1:G.featureResult=A.processMessageWithArgs(h,E);break;default:A.skip()}C.isSome(H)&&G.featureResult&&E.addQueryGeometry(G,H);return G}const u="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),
F="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),z=["upperLeft","lowerLeft"];r.parseFeatureQuery=function(A,E){try{const G=new D(new Uint8Array(A),new DataView(A));
for(A={};G.next();)switch(G.tag()){case 2:A.queryResult=G.processMessageWithArgs(v,E);break;default:G.skip()}return A}catch(G){throw new t("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:G});}};r.parseFieldType=q;r.parseTransform=c;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),
function(r,t,C,D,x,w){const q=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let p=function(){function g(l){this.options=l;this.geometryTypes=q;this._vertexDimension=this._coordinatePtr=0}var e=g.prototype;e.createFeatureResult=function(){return new x};e.prepareFeatures=function(l){this._vertexDimension=2;l.hasZ&&this._vertexDimension++;l.hasM&&this._vertexDimension++};e.finishFeatureResult=function(l){if(l&&l.features&&l.hasZ&&this.options.sourceSpatialReference&&
l.spatialReference&&!C.equals(l.spatialReference,this.options.sourceSpatialReference)&&!l.spatialReference.vcsWkid){var k=t.getMetersPerVerticalUnitForSR(this.options.sourceSpatialReference),n=t.getMetersPerVerticalUnitForSR(l.spatialReference);k/=n;if(1!==k)for(const d of l.features)if(D.hasGeometry(d))for(l=d.geometry.coords,n=2;n<l.length;n+=3)l[n]*=k}};e.addFeature=function(l,k){l.features.push(k)};e.createFeature=function(){return new D.default};e.createSpatialReference=function(){return{wkid:0}};
e.createGeometry=function(){return new w};e.addField=function(l,k){l.fields.push(k)};e.allocateCoordinates=function(l){l.coords.length=l.lengths.reduce((k,n)=>k+n,0)*this._vertexDimension;this._coordinatePtr=0};e.addCoordinate=function(l,k){l.coords[this._coordinatePtr++]=k};e.addCoordinatePoint=function(l,k){l.coords.push(k)};e.addLength=function(l,k){l.lengths.push(k)};e.addQueryGeometry=function(l,k){l.queryGeometry=k.queryGeometry;l.queryGeometryType=k.queryGeometryType};e.createPointGeometry=
function(){return new w};return g}();r.OPTIMIZED_GEOMETRY_TYPES=q;r.OptimizedFeatureSetParserContext=p;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../core/maybe","../../../geometry/support/zscale"],function(r,t,C){r.applyFeatureSetZUnitScaling=function(D,x,w){if(w&&w.features&&w.hasZ&&(D=C.getGeometryZScaler(w.geometryType,x,D.outSpatialReference),!t.isNone(D)))for(const q of w.features)D(q.geometry)};Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/tasks/operations/urlUtils":function(){define(["exports"],function(r){function t(C){const D={};for(const x in C){if("declaredClass"===x)continue;const w=C[x];if(null!=w&&"function"!==typeof w)if(Array.isArray(w)){D[x]=[];for(let q=0;q<w.length;q++)D[x][q]=t(w[q])}else"object"===typeof w?w.toJSON&&(D[x]=JSON.stringify(w)):D[x]=w}return D}r.mapParameters=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),
function(r,t,C,D,x,w){function q({coords:g,lengths:e}){let l=0;for(const k of e){for(e=1;e<k;e++)g[2*(l+e)]+=g[2*(l+e)-2],g[2*(l+e)+1]+=g[2*(l+e)-1];l+=k}}let p=function(g){function e(k,n,d){k=g.call(this,k)||this;k._featureIndex=-1;k._dateFields=new Set;k._geometryType=d;k._features=n;return k}t._inheritsLoose(e,g);e.fromFeatures=function(k,n,d){d=D.convertFromFeatures([],k,n,!1,!1,d);for(let b=0;b<d.length;b++)d[b].displayId=k[b].displayId;return e.fromOptimizedFeatures(d,n)};e.fromFeatureSet=function(k,
n){k=D.convertFromFeatureSet(k,n);return e.fromOptimizedFeatureSet(k)};e.fromOptimizedFeatureSet=function(k){const {features:n,geometryType:d}=k,b=e.fromOptimizedFeatures(n,d);b._exceededTransferLimit=k.exceededTransferLimit;b._transform=k.transform;for(const a of k.fields)"esriFieldTypeDate"===a.type&&b._dateFields.add(a.name);return b};e.fromOptimizedFeatures=function(k,n,d){const b=w.FeatureSetReader.createInstance();k=new e(b,k,n);k._transform=d;return k};var l=e.prototype;l.removeIds=function(k){const n=
new Set(k);this._features=this._features.filter(d=>!n.has(d.objectId))};l.append=function(k){for(const n of k)this._features.push(n)};l.getSize=function(){return this._features.length};l.getCursor=function(){return this.copy()};l.getQuantizationTransform=function(){return this._transform};l.getAttributeHash=function(){let k="";for(const n in this._current.attributes)k+=this._current.attributes[n];return k};l.getIndex=function(){return this._featureIndex};l.setIndex=function(k){this._featureIndex=
k};l.getObjectId=function(){return this._current.objectId};l.getDisplayId=function(){return this._current.displayId};l.setDisplayId=function(k){this._current.displayId=k};l.getGroupId=function(){return this._current.groupId};l.setGroupId=function(k){this._current.groupId=k};l.copy=function(){const k=new e(this.instance,this._features,this.geometryType);this.copyInto(k);return k};l.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};
l.readLegacyFeature=function(){return D.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};l.readOptimizedFeature=function(){return this._current};l.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};l.readLegacyGeometry=function(){const k=this.readGeometry();return D.convertToGeometry(k,this.geometryType,this.hasZ,this.hasM)};l.readLegacyCentroid=function(){const k=this.readCentroid();return C.isNone(k)?null:{x:k.coords[0]*this._sx+
this._tx,y:k.coords[1]*this._sy+this._ty}};l.readGeometryArea=function(){return x.hasGeometry(this._current)?D.getQuantizedArea(this._current.geometry,2):0};l.readUnquantizedGeometry=function(){var k=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!k)return k;k=k.clone();q(k);return k};l.readHydratedGeometry=function(){var k=this._current.geometry;if(C.isNone(k))return null;k=k.clone();C.isSome(this._transform)&&D.unquantizeOptimizedGeometry(k,k,this.hasZ,this.hasM,this._transform);
return k};l.getXHydrated=function(){if(!x.hasGeometry(this._current))return 0;const k=this._current.geometry.coords[0],n=this.getQuantizationTransform();return C.isNone(n)?k:k*n.scale[0]+n.translate[0]};l.getYHydrated=function(){if(!x.hasGeometry(this._current))return 0;const k=this._current.geometry.coords[1],n=this.getQuantizationTransform();return C.isNone(n)?k:n.translate[1]-k*n.scale[1]};l.getX=function(){return x.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:
0};l.getY=function(){return x.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};l.readGeometry=function(){if(!x.hasGeometry(this._current))return null;const k=this._current.geometry.clone();if(k.isPoint)return k.coords[0]=k.coords[0]*this._sx+this._tx,k.coords[1]=k.coords[1]*this._sy+this._ty,k;let n=0;for(const d of k.lengths)k.coords[2*n]=k.coords[2*n]*this._sx+this._tx,k.coords[2*n+1]=k.coords[2*n+1]*this._sy+this._ty,n+=d;return k};l.readCentroid=function(){if(!x.hasGeometry(this._current))return null;
if(!this._current.centroid){var k=this._computeCentroid();if(!k)return null;k.coords[0]=(k.coords[0]-this._tx)/this._sx;k.coords[1]=(k.coords[1]-this._ty)/this._sy;this._current.centroid=k}k=this._current.centroid.clone();k.coords[0]=k.coords[0]*this._sx+this._tx;k.coords[1]=k.coords[1]*this._sx+this._ty;return k};l._readAttribute=function(k,n){var d=this._current.attributes[k];if(void 0!==d)return null!=d&&n&&this._dateFields.has(k)?new Date(d):d;d=this.readAttributes();k=k.toLocaleLowerCase().trim();
for(const b in d)if(b.toLocaleLowerCase().trim()===k)return k=this._current.attributes[b],null!=k&&n&&this._dateFields.has(b)?new Date(k):k};l.copyInto=function(k){g.prototype.copyInto.call(this,k);k._featureIndex=this._featureIndex;k._transform=this._transform;k._dateFields=this._dateFields};l._readAttributes=function(){return this._current.attributes};t._createClass(e,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},
{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return e}(w.FeatureSetReader);r.FeatureSetReaderJSON=p;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBF":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/pbf ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ./FeatureSetReader ./FeatureSetReaderPBFHeader".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){function k(c){if(c<=a.small.delta.length)return a.small;if(c<=a.large.delta.length)return a.large;a.large.delta=new Int32Array(Math.round(1.25*c));a.large.decoded=new Int32Array(Math.round(1.25*c));return a.large}function n(c){var f=c.getLength();for(f=c.pos()+f;c.pos()<f&&c.next();)switch(c.tag()){case 1:return c.getString();case 2:return c.getFloat();case 3:return c.getDouble();case 4:return c.getSInt32();case 5:return c.getUInt32();case 6:return c.getInt64();case 7:return c.getUInt64();
case 8:return c.getSInt64();case 9:return c.getBool();default:return c.skip(),null}return null}function d(c,f,m,h){return 0===c*h-m*f&&0<c*m+f*h}const b=D.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF"),a={small:{delta:new Int32Array(128),decoded:new Int32Array(128)},large:{delta:new Int32Array(128E3),decoded:new Int32Array(128E3)}};D=function(c){function f(h,v,u,F){h=c.call(this,h)||this;h._hasNext=!1;h._isPoints=!1;h._featureIndex=-1;h._featureOffset=0;h._cache={area:0,unquantGeometry:void 0,
geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0};h._geometryType=F;h._reader=v;h._header=u;h._hasNext=u.hasFeatures;h._isPoints="esriGeometryPoint"===F;return h}t._inheritsLoose(f,c);f.fromBuffer=function(h,v,u=!1){a:{try{const A=new w(new Uint8Array(h),new DataView(h));for(;A.next();)switch(A.tag()){case 2:b:{for(var F=A.getMessage();F.next();)switch(F.tag()){case 1:var z=F.getMessage();break b;default:F.skip()}z=null}break a;default:A.skip()}}catch(A){h=new C("query:parsing-pbf",
"Error while parsing FeatureSet PBF payload",{error:A}),b.error(h)}z=null}h=z;u=l.parseHeader(h,"esriGeometryPoint"===v,u);z=e.FeatureSetReader.createInstance();return new f(z,h,u,v)};var m=f.prototype;m.getSize=function(){return this.size};m.getQuantizationTransform=function(){return this._header.transform};m.getCursor=function(){return this.copy()};m.getIndex=function(){return this._featureIndex};m.setIndex=function(h){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;
this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;this._featureIndex=h};m.getAttributeHash=function(){let h="";this._header.fields.forEach(({index:v})=>{h+=this._readAttributeAtIndex(v)+"."});return h};m.getObjectId=function(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)};m.getDisplayId=function(){return this._header.displayIds[this._featureIndex]};m.setDisplayId=function(h){this._header.displayIds[this._featureIndex]=h};m.getGroupId=
function(){return this._header.groupIds[this._featureIndex]};m.setGroupId=function(h){this._header.groupIds[this._featureIndex]=h};m.readLegacyFeature=function(){if(void 0===this._cache.legacyFeature){var h,v=this.readCentroid();v={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),centroid:null!=(h=v&&{x:v.coords[0],y:v.coords[1]})?h:null};return this._cache.legacyFeature=v}return this._cache.legacyFeature};m.readOptimizedFeature=function(){if(void 0===
this._cache.optFeature){const h=new p.default(this.readGeometry(),this.readAttributes(),this.readCentroid());h.objectId=this.getObjectId();h.displayId=this.getDisplayId();return this._cache.optFeature=h}return this._cache.optFeature};m.getXHydrated=function(){const h=this._header.centroid[2*this._featureIndex],v=this.getQuantizationTransform();return x.isNone(v)?h:h*v.scale[0]+v.translate[0]};m.getYHydrated=function(){const h=this._header.centroid[2*this._featureIndex+1],v=this.getQuantizationTransform();
return x.isNone(v)?h:v.translate[1]-h*v.scale[1]};m.getX=function(){return this._header.centroid[2*this._featureIndex]*this._sx+this._tx};m.getY=function(){return this._header.centroid[2*this._featureIndex+1]*this._sy+this._ty};m.readLegacyPointGeometry=function(){const h=this.getX(),v=this.getY();return{x:h,y:v}};m.readLegacyGeometry=function(h){h=this.readGeometry(h);return q.convertToGeometry(h,this.geometryType,!1,!1)};m.readLegacyCentroid=function(){const h=this.readCentroid();if(!h)return null;
const [v,u]=h.coords;return{x:v,y:u}};m.readGeometryArea=function(){this._cache.area||this.readGeometry(!0);return this._cache.area};m.readUnquantizedGeometry=function(h=!1){if(void 0===this._cache.unquantGeometry){h=this.readGeometry(h);if(!h)return this._cache.unquantGeometry=null;var v=k(h.coords.length).decoded;h=h.clone(v);v=h.coords;let u=0;for(const F of h.lengths){for(let z=1;z<F;z++){const A=2*(u+z),E=2*(u+z-1);v[A]+=v[E];v[A+1]+=v[E+1]}u+=F}return this._cache.unquantGeometry=h}return this._cache.unquantGeometry};
m.readHydratedGeometry=function(){if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;var h=this.getXHydrated(),v=this.getYHydrated();return new g([],[h,v])}h=this.readGeometry();if(!h)return null;h=h.clone();v=this.getQuantizationTransform();x.isSome(v)&&q.unquantizeOptimizedGeometry(h,h,this.hasZ,this.hasM,v);return h};m.readGeometry=function(h=!1){if(void 0===this._cache.geometry){var v=null;if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;
h=this.getX();v=this.getY();v=new g([],[h,v])}else{const u=this._header.offsets.geometry[this._featureIndex],F=this._reader;if(0===u)return null;F.move(u);try{v=h?this._parseGeometryForDisplay(F):this._parseGeometry(F)}catch(z){return console.error("Failed to parse geometry!",z),null}}return this._cache.geometry=v}return this._cache.geometry};m.readCentroid=function(){if(void 0===this._cache.centroid){var h=null;h=this._header.centroid[2*this._featureIndex]+this._tx;const v=this._header.centroid[2*
this._featureIndex+1]+this._ty;if(268435455===h){if(h=this._computeCentroid())this._header.centroid[2*this._featureIndex]=h.coords[0]-this._tx,this._header.centroid[2*this._featureIndex+1]=h.coords[1]-this._ty}else h=new g([],[h,v]);return this._cache.centroid=h}return this._cache.centroid};m.copy=function(){var h=this._reader.clone();h=new f(this.instance,h,this._header,this.geometryType);this.copyInto(h);return h};m.next=function(){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=
void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;for(this._cache.optFeature=void 0;++this._featureIndex<this.size&&!this._getExists(););return this._featureIndex<this.size};m._readAttribute=function(h,v){h=this._header.hasField(h)?h:h.toLowerCase().trim();var u=this._header.getFieldIndex(h);if(null!=u)return u=this._readAttributeAtIndex(u),v&&null!=u?this._header.isDateField(h)?new Date(u):u:u};m._readAttributes=function(){const h={};this._header.fields.forEach(({fieldName:v,index:u})=>
{h[v]=this._readAttributeAtIndex(u)});return h};m.copyInto=function(h){c.prototype.copyInto.call(this,h);h._featureIndex=this._featureIndex;h._featureOffset=this._featureOffset;h._hasNext=this._hasNext};m._readAttributeAtIndex=function(h){const v=this._reader;v.move(this._header.offsets.attributes[this._featureIndex*this._header.fieldCount+h]);return n(v)};m._parseGeometry=function(h){var v=h.getLength();v=h.pos()+v;const u=[],F=[];for(;h.pos()<v&&h.next();)switch(h.tag()){case 2:var z=h.getUInt32();
for(z=h.pos()+z;h.pos()<z;)F.push(h.getUInt32());break;case 3:z=h.getUInt32();z=h.pos()+z;u.push(h.getSInt32()+this._tx);u.push(h.getSInt32()+this._ty);this.hasZ&&h.getSInt32();for(this.hasM&&h.getSInt32();h.pos()<z;)u.push(h.getSInt32()),u.push(h.getSInt32()),this.hasZ&&h.getSInt32(),this.hasM&&h.getSInt32();break;default:h.skip()}return new g(F,u)};m._parseGeometryForDisplay=function(h){var v=h.getLength();const u=h.pos()+v,F=[];v=[];let z=0,A=0;var E=null;let G=0;const H="esriGeometryPolygon"===
this.geometryType;for(;h.pos()<u&&h.next();)switch(h.tag()){case 2:E=h.getUInt32();for(E=h.pos()+E;h.pos()<E;){var K=h.getUInt32();F.push(K);z+=K}E=k(2*z).delta;break;case 3:h.getUInt32();K=2+(this.hasZ?1:0)+(this.hasM?1:0);for(const R of F)if(A+K*R>E.length)for(var L=0;L<R;L++)h.getSInt32(),h.getSInt32(),this.hasZ&&h.getSInt32(),this.hasM&&h.getSInt32();else if(H){L=this.getAreaSimplificationThreshold(R,this._header.vertexCount);var J=2,B=1,y=h.getSInt32(),I=h.getSInt32();E[A++]=y;E[A++]=I;this.hasZ&&
h.getSInt32();this.hasM&&h.getSInt32();var S=h.getSInt32(),O=h.getSInt32();this.hasZ&&h.getSInt32();for(this.hasM&&h.getSInt32();J<R;){var Y=h.getSInt32();let Q=h.getSInt32();this.hasZ&&h.getSInt32();this.hasM&&h.getSInt32();const W=y+S,P=I+O,fa=W+Y,oa=P+Q;.5*Math.abs(y*P+W*oa+fa*I-y*oa-W*I-fa*P)>=L?(G+=-.5*(W-y)*(P+I),1<B&&d(E[A-2],E[A-1],S,O)?(E[A-2]+=S,E[A-1]+=O):(E[A++]=S,E[A++]=O,B++),y=W,I=P):(Y+=S,Q+=O);S=Y;O=Q;J++}3>B?A-=2*B:(G+=-.5*(y+S-y)*(I+O+I),d(E[A-2],E[A-1],S,O)?(E[A-2]+=S,E[A-1]+=
O,v.push(B)):(E[A++]=S,E[A++]=O,v.push(++B)))}else{L=0;J=h.getSInt32();B=h.getSInt32();this.hasZ&&h.getSInt32();this.hasM&&h.getSInt32();E[A++]=J;E[A++]=B;L+=1;for(y=1;y<R;y++)I=h.getSInt32(),S=h.getSInt32(),O=J+I,Y=B+S,G+=-.5*(O-J)*(Y+B),this.hasZ&&h.getSInt32(),this.hasM&&h.getSInt32(),2<y&&d(E[A-2],E[A-1],I,S)?(E[A-2]+=I,E[A-1]+=S):(E[A++]=I,E[A++]=S,L+=1),J=O,B=Y;v.push(L)}break;default:h.skip()}this._cache.area=G;if(!v.length)return null;if(this._tx||this._ty){h=0;for(const R of v)E[2*h]+=this._tx,
E[2*h+1]+=this._ty,h+=R}return new g(v,E)};t._createClass(f,[{key:"geometryType",get:function(){return this._geometryType}},{key:"size",get:function(){return this._header.featureCount}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}},{key:"stride",get:function(){return 2+(this.hasZ?1:0)+(this.hasM?1:0)}},{key:"hasFeatures",get:function(){return this._header.hasFeatures}},{key:"hasNext",get:function(){return this._hasNext}},{key:"exceededTransferLimit",get:function(){return this._header.exceededTransferLimit}}]);
return f}(e.FeatureSetReader);r.FeatureSetReaderPBF=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFHeader":function(){define(["exports","../../../../../core/Error","../../../../../rest/query/operations/pbfFeatureServiceParser"],function(r,t,C){let D=function(){function x(){this.fieldMap=new Map;this.fields=[];this.hasFeatures=!1;this.vertexCount=this.objectIdFieldIndex=this.featureCount=this.fieldCount=0;this.offsets={attributes:[],
geometry:[]};this.centroid=[]}var w=x.prototype;w.hasField=function(q){return this.fieldMap.has(q)};w.isDateField=function(q){var p;return null==(p=this.fieldMap.get(q))?void 0:p.isDate};w.getFieldIndex=function(q){var p;return null==(p=this.fieldMap.get(q))?void 0:p.index};return x}();r.FeatureSetHeader=D;r.parseHeader=function(x,w,q=!1){const p=x.pos(),g=new D;let e=0,l=0,k=null,n=null,d=null,b=!1;for(;x.next();)switch(x.tag()){case 1:k=x.getString();break;case 3:n=x.getString();break;case 12:d=
x.processMessage(C.parseTransform);break;case 9:g.exceededTransferLimit=x.getBool();if(g.exceededTransferLimit){g.offsets.geometry=q?new Float64Array(8E3):new Int32Array(8E3);g.centroid=q?new Float64Array(16E3):new Int32Array(16E3);for(var a=0;a<g.centroid.length;a++)g.centroid[a]=268435455}break;case 13:a=x;var c=a.getLength();c=a.pos()+c;for(var f={name:"",isDate:!1};a.pos()<c&&a.next();)switch(a.tag()){case 1:f.name=a.getString();break;case 2:"esriFieldTypeDate"===C.parseFieldType(a.getEnum())&&
(f.isDate=!0);break;default:a.skip()}a=f;f=a.name;c=a.name.toLowerCase().trim();f={fieldName:f,index:e++,isDate:a.isDate};g.fields.push(f);g.fieldMap.set(a.name,f);g.fieldMap.set(c,f);break;case 15:a=x.getLength();a=x.pos()+a;g.exceededTransferLimit||(c=g.centroid,g.offsets.geometry.push(0),c.push(268435455),c.push(268435455));!b&&g.exceededTransferLimit&&(b=!0,g.offsets.attributes=q?new Float64Array(8E3*e):new Uint32Array(8E3*e));for(c=l*e;x.pos()<a&&x.next();)switch(x.tag()){case 1:b?g.offsets.attributes[c++]=
x.pos():g.offsets.attributes.push(x.pos());f=x.getLength();x.skipLen(f);break;case 2:if(w)for(f=x.getLength(),f=x.pos()+f;x.pos()<f&&x.next();)switch(x.tag()){case 3:x.getUInt32();var m=x.getSInt64(),h=x.getSInt64();g.centroid[2*l]=m;g.centroid[2*l+1]=h;break;default:x.skip()}else g.offsets.geometry[l]=x.pos(),f=x.getLength(),g.vertexCount+=f,x.skipLen(f);break;case 4:f=x.getLength();for(f=x.pos()+f;x.pos()<f&&x.next();)switch(x.tag()){case 3:x.getUInt32();m=x.getSInt64();h=x.getSInt64();g.centroid[2*
l]=m;g.centroid[2*l+1]=h;break;default:x.skip()}break;default:x.skip()}l++;g.hasFeatures=!0;break;default:x.skip()}w=k||n;if(!w)throw new t("FeatureSet has no objectId or globalId field name");g.featureCount=l;g.fieldCount=e;g.objectIdFieldIndex=g.getFieldIndex(w);g.transform=d;g.displayIds=new Uint32Array(g.featureCount);g.groupIds=new Uint16Array(g.featureCount);x.move(p);return g};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/sources/DataTileSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../TimeExtent ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../rest/support/Query ./DataTileSubscription".split(" "),
function(r,t,C,D,x,w,q,p,g,e){function l(n,d){const b=new Set;n&&n.forEach(a=>b.add(a));d&&d.forEach(a=>b.add(a));return b.has("*")?["*"]:Array.from(b)}let k=function(){function n(b){this.events=new D;this._resolver=q.createResolver();this._didEdit=!1;this._subscriptions=new Map;this._outSR=b.outSR;this._serviceInfo=b.serviceInfo;this._onTileUpdateMessage=b.onMessage}var d=n.prototype;d.destroy=function(){};d._onMessage=function(){var b=t._asyncToGenerator(function*(a){var c;const f=this._subscriptions.get(a.id);
if(f)return a={...a,remove:null!=(c=a.remove)?c:[],status:a.status},this._onTileUpdateMessage(a,f.options)});return function(a){return b.apply(this,arguments)}}();d.update=function(b,a){var c,f=a.fields.length;a.outFields=l(null==(c=this._schema)?void 0:c.outFields,a.outFields);a.outFields=a.outFields.length>=.75*f?["*"]:a.outFields;a.outFields.sort();if(c=p.diff(this._schema,a)){x("esri-2d-update-debug")&&console.debug("Applying Update - Source:",c);f="orderByFields"in this._serviceInfo&&this._serviceInfo.orderByFields?
this._serviceInfo.orderByFields:this._serviceInfo.objectIdField+" ASC";f={returnCentroid:x("esri-2d-query-centroid-enabled")&&"esriGeometryPolygon"===this._serviceInfo.geometryType,returnGeometry:!0,timeReferenceUnknownClient:"stream"!==this._serviceInfo.type&&this._serviceInfo.timeReferenceUnknownClient,outFields:a.outFields,outSpatialReference:this._outSR,orderByFields:[f],where:a.definitionExpression||"1\x3d1",gdbVersion:a.gdbVersion,historicMoment:a.historicMoment,timeExtent:C.fromJSON(a.timeExtent),
customParameters:a.customParameters};var m=this._schema&&p.hasDiff(c,"outFields");this._schema&&p.hasDiffAny(c,["timeExtent","definitionExpression","gdbVersion","historicMoment","customParameters"])&&(b.why.mesh.push("Layer filter and/or custom parameters changed"),b.why.source.push("Layer filter and/or custom parameters changed"),b.mesh=!0,b.source=!0,b.queryFilter=!0);m&&(b.why.source.push("Layer required fields changed"),b.source=!0);p.diff(f,this._queryInfo)&&(this._queryInfo=f);this._schema=
a;this._resolver.resolve()}};d.whenInitialized=function(){return this._resolver.promise};d.applyUpdate=function(){var b=t._asyncToGenerator(function*(a){a.queryFilter||a.source&&this._didEdit?(this.refresh(),this._didEdit=!1):(this._subscriptions.forEach(c=>c.applyUpdate(a)),yield this.resend())});return function(a){return b.apply(this,arguments)}}();d.refresh=function(){for(const b of this._tiles())this.unsubscribe(b),this.subscribe(b)};d.subscribe=function(b){const a=new e.DataTileSubscription(b);
this._subscriptions.set(b.id,a)};d.unsubscribe=function(b){const a=this.get(b.id);w.isSome(a)&&a.abort();this._subscriptions.delete(b.id)};d.createQuery=function(b={}){return new g({...this._queryInfo,historicMoment:this._queryInfo.historicMoment?new Date(this._queryInfo.historicMoment):null,...b})};d.get=function(b){return this._subscriptions.has(b)?this._subscriptions.get(b):null};d.queryLastEditDate=function(){var b=t._asyncToGenerator(function*(){throw Error("Service does not support query type");
});return function(){return b.apply(this,arguments)}}();d.query=function(){var b=t._asyncToGenerator(function*(a){throw Error("Service does not support query");});return function(a){return b.apply(this,arguments)}}();d._tiles=function*(){const b=Array.from(this._subscriptions.values());for(const a of b)yield a.tile};d.edit=function(){var b=t._asyncToGenerator(function*(a,c){var f=this,m=Array.from(this._subscriptions.values());const h=m.map(({tile:v})=>v);for(const v of m)v.removeIds(c);a.length&&
(m=h.map(v=>{const u=this.createTileQuery(v);u.objectIds=a;return{tile:v,query:u}}).map(function(){var v=t._asyncToGenerator(function*({tile:u,query:F}){return{tile:u,result:yield f.query(F),query:F}});return function(u){return v.apply(this,arguments)}}()),m=(yield q.eachAlwaysValues(m)).map(function(){var v=t._asyncToGenerator(function*({tile:u,result:F}){(F.hasFeatures||c.length||a.length)&&(u=f._subscriptions.get(u.key.id))&&u.edit(F,a)});return function(u){return v.apply(this,arguments)}}()),
yield q.eachAlways(m));this._didEdit=!0});return function(a,c){return b.apply(this,arguments)}}();return n}();r.DataTileSource=k;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/TimeExtent":function(){define("./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./core/JSONSupport ./core/maybe ./core/timeUtils ./core/accessorSupport/decorators/property ./core/arrayUtils ./core/has ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k){var n;C=n=function(a){function c(m){m=a.call(this,m)||this;m.end=null;m.start=null;return m}r._inheritsLoose(c,a);var f=c.prototype;f.readEnd=function(m,h){return null!=h.end?new Date(h.end):null};f.writeEnd=function(m,h){h.end=m?m.getTime():null};f.readStart=function(m,h){return null!=h.start?new Date(h.start):null};f.writeStart=function(m,h){h.start=m?m.getTime():null};f.clone=function(){return new n({end:this.end,start:this.start})};f.equals=function(m){if(!m)return!1;
const h=D.isSome(this.start)?this.start.getTime():this.start,v=D.isSome(this.end)?this.end.getTime():this.end,u=D.isSome(m.start)?m.start.getTime():m.start;m=D.isSome(m.end)?m.end.getTime():m.end;return h===u&&v===m};f.expandTo=function(m){if(this.isEmpty||this.isAllTime)return this.clone();const h=D.andThen(this.start,u=>x.truncateDate(u,m)),v=D.andThen(this.end,u=>x.offsetDate(x.truncateDate(u,m),1,m));return new n({start:h,end:v})};f.intersection=function(m){if(!m)return this.clone();if(this.isEmpty||
m.isEmpty)return n.empty;if(this.isAllTime)return m.clone();if(m.isAllTime)return this.clone();var h=D.mapOr(this.start,-Infinity,A=>A.getTime());const v=D.mapOr(this.end,Infinity,A=>A.getTime()),u=D.mapOr(m.start,-Infinity,A=>A.getTime());m=D.mapOr(m.end,Infinity,A=>A.getTime());let F,z;u>=h&&u<=v?F=u:h>=u&&h<=m&&(F=h);v>=u&&v<=m?z=v:m>=h&&m<=v&&(z=m);return isNaN(F)||isNaN(z)?n.empty:(h=new n,h.start=-Infinity===F?null:new Date(F),h.end=Infinity===z?null:new Date(z),h)};f.offset=function(m,h){if(this.isEmpty||
this.isAllTime)return this.clone();const v=new n,{start:u,end:F}=this;D.isSome(u)&&(v.start=x.offsetDate(u,m,h));D.isSome(F)&&(v.end=x.offsetDate(F,m,h));return v};f.union=function(m){if(!m||m.isEmpty)return this.clone();if(this.isEmpty)return m.clone();if(this.isAllTime||m.isAllTime)return d.clone();const h=D.isSome(this.start)&&D.isSome(m.start)?new Date(Math.min(this.start.getTime(),m.start.getTime())):null;m=D.isSome(this.end)&&D.isSome(m.end)?new Date(Math.max(this.end.getTime(),m.end.getTime())):
null;return new n({start:h,end:m})};r._createClass(c,[{key:"isAllTime",get:function(){return this.equals(n.allTime)}},{key:"isEmpty",get:function(){return this.equals(n.empty)}}],[{key:"allTime",get:function(){return d}},{key:"empty",get:function(){return b}}]);return c}(C.JSONSupport);t.__decorate([w.property({type:Date,json:{write:{allowNull:!0}}})],C.prototype,"end",void 0);t.__decorate([e.reader("end")],C.prototype,"readEnd",null);t.__decorate([k.writer("end")],C.prototype,"writeEnd",null);t.__decorate([w.property({readOnly:!0,
json:{read:!1}})],C.prototype,"isAllTime",null);t.__decorate([w.property({readOnly:!0,json:{read:!1}})],C.prototype,"isEmpty",null);t.__decorate([w.property({type:Date,json:{write:{allowNull:!0}}})],C.prototype,"start",void 0);t.__decorate([e.reader("start")],C.prototype,"readStart",null);t.__decorate([k.writer("start")],C.prototype,"writeStart",null);C=n=t.__decorate([l.subclass("esri.TimeExtent")],C);const d=new C,b=new C({start:void 0,end:void 0});return C})},"esri/core/timeUtils":function(){define(["exports",
"./has"],function(r,t){function C(w,q,p){return 0===w?0:w*D[q]/D[p]}const D={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8},x={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",
setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};r.convertTime=C;r.makeUTCTime=function(w,q,p="milliseconds"){q=new Date(C(q,p,"milliseconds"));q.setUTCFullYear(w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate());
return q};r.offsetDate=function(w,q,p){w=new Date(w.getTime());if(q&&p){const {getter:g,setter:e,multiplier:l}=x[p];w[e](w[g]()+q*l)}return w};r.offsetDateUTC=function(w,q,p="milliseconds"){w=w.getTime();q=C(q,p,"milliseconds");return new Date(w+q)};r.resetUTCDate=function(w,q){w=new Date(w.getTime());w.setUTCFullYear(q.getFullYear(),q.getMonth(),q.getDate());return w};r.timeSinceUTCMidnight=function(w,q="milliseconds"){const p=C(w.getUTCHours(),"hours","milliseconds"),g=C(w.getUTCMinutes(),"minutes",
"milliseconds"),e=C(w.getUTCSeconds(),"seconds","milliseconds");w=w.getUTCMilliseconds();return C(p+g+e+w,"milliseconds",q)};r.truncateDate=function(w,q){switch(q){case "milliseconds":return new Date(w.getTime());case "seconds":return new Date(w.getFullYear(),w.getMonth(),w.getDate(),w.getHours(),w.getMinutes(),w.getSeconds());case "minutes":return new Date(w.getFullYear(),w.getMonth(),w.getDate(),w.getHours(),w.getMinutes());case "hours":return new Date(w.getFullYear(),w.getMonth(),w.getDate(),w.getHours());
case "days":return new Date(w.getFullYear(),w.getMonth(),w.getDate());case "weeks":return new Date(w.getFullYear(),w.getMonth(),w.getDate()-w.getDay());case "months":return new Date(w.getFullYear(),w.getMonth(),1);case "years":return new Date(w.getFullYear(),0,1);case "decades":return new Date(w.getFullYear()-w.getFullYear()%10,0,1);case "centuries":return new Date(w.getFullYear()-w.getFullYear()%100,0,1);default:return new Date}};r.truncateLocalTime=function(w){const q=new Date(0);q.setHours(0);
q.setMinutes(0);q.setSeconds(0);q.setMilliseconds(0);q.setFullYear(w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate());return q};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/Query":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./QuantizationParameters ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h){var v;const u=new x.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});x=new x.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});w=v=function(F){function z(E){E=F.call(this,E)||this;E.aggregateIds=null;E.cacheHint=void 0;E.datumTransformation=null;E.distance=void 0;E.dynamicDataSource=void 0;E.formatOf3DObjects=null;E.gdbVersion=null;E.geometry=null;E.geometryPrecision=void 0;E.groupByFieldsForStatistics=null;E.having=null;E.historicMoment=null;E.maxAllowableOffset=void 0;E.maxRecordCountFactor=
1;E.multipatchOption=null;E.num=void 0;E.objectIds=null;E.orderByFields=null;E.outFields=null;E.outSpatialReference=null;E.outStatistics=null;E.parameterValues=null;E.pixelSize=null;E.quantizationParameters=null;E.rangeValues=null;E.relationParameter=null;E.resultType=null;E.returnCentroid=!1;E.returnDistinctValues=!1;E.returnExceededLimitFeatures=!0;E.returnGeometry=!1;E.returnQueryGeometry=!1;E.returnM=void 0;E.returnZ=void 0;E.sourceSpatialReference=null;E.spatialRelationship="intersects";E.start=
void 0;E.sqlFormat=null;E.text=null;E.timeExtent=null;E.timeReferenceUnknownClient=!1;E.units=null;E.where=null;return E}r._inheritsLoose(z,F);z.from=function(E){return d.ensureClass(v,E)};var A=z.prototype;A.castDatumTransformation=function(E){return"number"===typeof E||"object"===typeof E?E:null};A.writeHistoricMoment=function(E,G){G.historicMoment=E&&E.getTime()};A.writeParameterValues=function(E,G){if(E){const H={};for(const K in E){const L=E[K];Array.isArray(L)?H[K]=L.map(J=>J instanceof Date?
J.getTime():J):H[K]=L instanceof Date?L.getTime():L}G.parameterValues=H}};A.writeStart=function(E,G){G.resultOffset=this.start;G.resultRecordCount=this.num||10;G.where="1\x3d1"};A.writeWhere=function(E,G){G.where=E||"1\x3d1"};A.clone=function(){return new v(q.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,
having:this.having,historicMoment:p.isSome(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,
rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,
sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))};return z}(w.JSONSupport);w.MAX_MAX_RECORD_COUNT_FACTOR=5;t.__decorate([g.property({json:{write:!0}})],w.prototype,"aggregateIds",void 0);t.__decorate([g.property({type:Boolean,json:{write:!0}})],w.prototype,"cacheHint",void 0);t.__decorate([g.property({json:{write:!0}})],w.prototype,"datumTransformation",void 0);t.__decorate([e.cast("datumTransformation")],
w.prototype,"castDatumTransformation",null);t.__decorate([g.property({type:Number,json:{write:{overridePolicy(F){return{enabled:0<F}}}}})],w.prototype,"distance",void 0);t.__decorate([g.property({type:a.DataLayerSource,json:{write:!0}})],w.prototype,"dynamicDataSource",void 0);t.__decorate([g.property({type:String,json:{write:!0}})],w.prototype,"formatOf3DObjects",void 0);t.__decorate([g.property({type:String,json:{write:!0}})],w.prototype,"gdbVersion",void 0);t.__decorate([g.property({types:C.geometryTypes,
json:{read:b.fromJSON,write:!0}})],w.prototype,"geometry",void 0);t.__decorate([g.property({type:Number,json:{write:!0}})],w.prototype,"geometryPrecision",void 0);t.__decorate([g.property({type:[String],json:{write:!0}})],w.prototype,"groupByFieldsForStatistics",void 0);t.__decorate([g.property({type:String,json:{write:!0}})],w.prototype,"having",void 0);t.__decorate([g.property({type:Date})],w.prototype,"historicMoment",void 0);t.__decorate([n.writer("historicMoment")],w.prototype,"writeHistoricMoment",
null);t.__decorate([g.property({type:Number,json:{write:!0}})],w.prototype,"maxAllowableOffset",void 0);t.__decorate([g.property({type:Number,cast(F){return 1>F?1:F>v.MAX_MAX_RECORD_COUNT_FACTOR?v.MAX_MAX_RECORD_COUNT_FACTOR:F},json:{write:{overridePolicy(F){return{enabled:1<F}}}}})],w.prototype,"maxRecordCountFactor",void 0);t.__decorate([g.property({type:["xyFootprint"],json:{write:!0}})],w.prototype,"multipatchOption",void 0);t.__decorate([g.property({type:Number,json:{read:{source:"resultRecordCount"}}})],
w.prototype,"num",void 0);t.__decorate([g.property({json:{write:!0}})],w.prototype,"objectIds",void 0);t.__decorate([g.property({type:[String],json:{write:!0}})],w.prototype,"orderByFields",void 0);t.__decorate([g.property({type:[String],json:{write:!0}})],w.prototype,"outFields",void 0);t.__decorate([g.property({type:m,json:{name:"outSR",write:!0}})],w.prototype,"outSpatialReference",void 0);t.__decorate([g.property({type:[f],json:{write:{enabled:!0,overridePolicy(){return{enabled:p.isSome(this.outStatistics)&&
0<this.outStatistics.length}}}}})],w.prototype,"outStatistics",void 0);t.__decorate([g.property({json:{write:!0}})],w.prototype,"parameterValues",void 0);t.__decorate([n.writer("parameterValues")],w.prototype,"writeParameterValues",null);t.__decorate([g.property({type:h,json:{write:!0}})],w.prototype,"pixelSize",void 0);t.__decorate([g.property({type:c,json:{write:!0}})],w.prototype,"quantizationParameters",void 0);t.__decorate([g.property({type:[Object],json:{write:!0}})],w.prototype,"rangeValues",
void 0);t.__decorate([g.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],w.prototype,"relationParameter",void 0);t.__decorate([g.property({type:String,json:{write:!0}})],w.prototype,"resultType",void 0);t.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],w.prototype,"returnCentroid",void 0);t.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],w.prototype,
"returnDistinctValues",void 0);t.__decorate([g.property({type:Boolean,json:{default:!0,write:!0}})],w.prototype,"returnExceededLimitFeatures",void 0);t.__decorate([g.property({type:Boolean,json:{write:!0}})],w.prototype,"returnGeometry",void 0);t.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],w.prototype,"returnQueryGeometry",void 0);t.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],w.prototype,"returnM",void 0);t.__decorate([g.property({type:Boolean,json:{write:{overridePolicy(F){return{enabled:F}}}}})],
w.prototype,"returnZ",void 0);t.__decorate([g.property({type:m,json:{write:!0}})],w.prototype,"sourceSpatialReference",void 0);t.__decorate([l.enumeration(u,{ignoreUnknown:!1,name:"spatialRel"})],w.prototype,"spatialRelationship",void 0);t.__decorate([g.property({type:Number,json:{read:{source:"resultOffset"}}})],w.prototype,"start",void 0);t.__decorate([n.writer("start"),n.writer("num")],w.prototype,"writeStart",null);t.__decorate([g.property({type:String,json:{write:!0}})],w.prototype,"sqlFormat",
void 0);t.__decorate([g.property({type:String,json:{write:!0}})],w.prototype,"text",void 0);t.__decorate([g.property({type:D,json:{write:!0}})],w.prototype,"timeExtent",void 0);t.__decorate([g.property({type:Boolean,json:{default:!1,write:!0}})],w.prototype,"timeReferenceUnknownClient",void 0);t.__decorate([l.enumeration(x,{ignoreUnknown:!1}),g.property({json:{write:{overridePolicy(F){return{enabled:F&&0<this.distance}}}}})],w.prototype,"units",void 0);t.__decorate([g.property({type:String,json:{write:{overridePolicy(F){return{enabled:null!=
F||0<this.start}}}}})],w.prototype,"where",void 0);t.__decorate([n.writer("where")],w.prototype,"writeWhere",null);return w=v=t.__decorate([k.subclass("esri.rest.support.Query")],w)})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m){function h(){z||(z=d.createTypeReader({types:v()}));return z}function v(){A||(A={key:"type",base:null,typeMap:{"data-layer":r.DataLayerSource,"map-layer":a.MapLayerSource}});return A}var u,F;D=D.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});r.JoinTableDataSource=u=function(E){function G(K){K=E.call(this,K)||this;K.type="join-table";return K}t._inheritsLoose(G,E);var H=G.prototype;H.readLeftTableSource=function(K,
L,J){return h()(K,L,J)};H.castLeftTableSource=function(K){return n.ensureOneOfType(v(),K)};H.readRightTableSource=function(K,L,J){return h()(K,L,J)};H.castRightTableSource=function(K){return n.ensureOneOfType(v(),K)};H.clone=function(){var K,L;const {leftTableKey:J,rightTableKey:B,leftTableSource:y,rightTableSource:I,joinType:S}=this,O={leftTableKey:J,rightTableKey:B,leftTableSource:null!=(K=null==y?void 0:y.clone())?K:void 0,rightTableSource:null!=(L=null==I?void 0:I.clone())?L:void 0,joinType:S};
return new u(O)};return G}(x.JSONSupport);C.__decorate([e.enumeration({joinTable:"join-table"})],r.JoinTableDataSource.prototype,"type",void 0);C.__decorate([w.property({type:String,json:{write:!0}})],r.JoinTableDataSource.prototype,"leftTableKey",void 0);C.__decorate([w.property({type:String,json:{write:!0}})],r.JoinTableDataSource.prototype,"rightTableKey",void 0);C.__decorate([w.property({json:{write:!0}})],r.JoinTableDataSource.prototype,"leftTableSource",void 0);C.__decorate([l.reader("leftTableSource")],
r.JoinTableDataSource.prototype,"readLeftTableSource",null);C.__decorate([g.cast("leftTableSource")],r.JoinTableDataSource.prototype,"castLeftTableSource",null);C.__decorate([w.property({json:{write:!0}})],r.JoinTableDataSource.prototype,"rightTableSource",void 0);C.__decorate([l.reader("rightTableSource")],r.JoinTableDataSource.prototype,"readRightTableSource",null);C.__decorate([g.cast("rightTableSource")],r.JoinTableDataSource.prototype,"castRightTableSource",null);C.__decorate([e.enumeration(D)],
r.JoinTableDataSource.prototype,"joinType",void 0);r.JoinTableDataSource=u=C.__decorate([k.subclass("esri.layers.support.source.JoinTableDataSource")],r.JoinTableDataSource);let z=null,A=null;g={key:"type",base:null,typeMap:{"join-table":r.JoinTableDataSource,"query-table":c.QueryTableDataSource,raster:f.RasterDataSource,table:m.TableDataSource}};r.DataLayerSource=F=function(E){function G(H){H=E.call(this,H)||this;H.type="data-layer";return H}t._inheritsLoose(G,E);G.prototype.clone=function(){const {fields:H,
dataSource:K}=this;return new F({fields:H,dataSource:K})};return G}(x.JSONSupport);C.__decorate([e.enumeration({dataLayer:"data-layer"})],r.DataLayerSource.prototype,"type",void 0);C.__decorate([w.property({type:[b],json:{write:!0}})],r.DataLayerSource.prototype,"fields",void 0);C.__decorate([w.property({types:g,json:{write:!0}})],r.DataLayerSource.prototype,"dataSource",void 0);r.DataLayerSource=F=C.__decorate([k.subclass("esri.layers.support.source.DataLayerSource")],r.DataLayerSource);r.DataLayerSource.from=
n.ensureType(r.DataLayerSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/Field":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n){var d;const b=new C.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});C=d=function(a){function c(m){m=a.call(this,m)||this;
m.alias=null;m.defaultValue=void 0;m.description=null;m.domain=null;m.editable=!0;m.length=-1;m.name=null;m.nullable=!0;m.type=null;m.valueType=null;return m}r._inheritsLoose(c,a);var f=c.prototype;f.readDescription=function(m,{description:h}){let v;try{v=JSON.parse(h)}catch(u){}return v?v.value:null};f.readValueType=function(m,{description:h}){let v;try{v=JSON.parse(h)}catch(u){}return v?b.fromJSON(v.fieldValueType):null};f.clone=function(){return new d({alias:this.alias,defaultValue:this.defaultValue,
description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})};return c}(D.JSONSupport);t.__decorate([x.property({type:String,json:{write:!0}})],C.prototype,"alias",void 0);t.__decorate([x.property({type:[String,Number],json:{write:{allowNull:!0}}})],C.prototype,"defaultValue",void 0);t.__decorate([x.property()],C.prototype,"description",void 0);t.__decorate([e.reader("description")],
C.prototype,"readDescription",null);t.__decorate([x.property({types:k.types,json:{read:{reader:k.fromJSON},write:!0}})],C.prototype,"domain",void 0);t.__decorate([x.property({type:Boolean,json:{write:!0}})],C.prototype,"editable",void 0);t.__decorate([x.property({type:p.Integer,json:{write:!0}})],C.prototype,"length",void 0);t.__decorate([x.property({type:String,json:{write:!0}})],C.prototype,"name",void 0);t.__decorate([x.property({type:Boolean,json:{write:!0}})],C.prototype,"nullable",void 0);t.__decorate([g.enumeration(n.kebabDict)],
C.prototype,"type",void 0);t.__decorate([x.property()],C.prototype,"valueType",void 0);t.__decorate([e.reader("valueType",["description"])],C.prototype,"readValueType",null);return C=d=t.__decorate([l.subclass("esri.layers.support.Field")],C)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(r,t,C,D,x,w){t={key:"type",base:D,typeMap:{range:w,"coded-value":C,inherited:x}};r.CodedValueDomain=C;
r.DomainBase=D;r.InheritedDomain=x;r.RangeDomain=w;r.fromJSON=function(q){if(!q||!q.type)return null;switch(q.type){case "range":return w.fromJSON(q);case "codedValue":return C.fromJSON(q);case "inherited":return x.fromJSON(q)}return null};r.types=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(r,t,C,D,x,w,q,p,g){var e;x=e=function(l){function k(d){d=l.call(this,d)||this;d.codedValues=null;d.type="coded-value";return d}r._inheritsLoose(k,l);var n=k.prototype;n.getName=function(d){let b=null;if(this.codedValues){const a=String(d);this.codedValues.some(c=>{String(c.code)===a&&(b=c.name);return!!b})}return b};n.clone=function(){return new e({codedValues:C.clone(this.codedValues),name:this.name})};return k}(g);t.__decorate([D.property({type:[p.default],json:{write:!0}})],x.prototype,
"codedValues",void 0);t.__decorate([w.enumeration({codedValue:"coded-value"})],x.prototype,"type",void 0);return x=e=t.__decorate([q.subclass("esri.layers.support.CodedValueDomain")],x)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g){var e;r.CodedValue=e=function(l){function k(n){n=l.call(this,n)||this;n.name=null;n.code=null;return n}t._inheritsLoose(k,l);k.prototype.clone=function(){return new e({name:this.name,code:this.code})};return k}(D.JSONSupport);C.__decorate([x.property({type:String,json:{write:!0}})],r.CodedValue.prototype,"name",void 0);C.__decorate([x.property({type:[String,Number],json:{write:!0}})],r.CodedValue.prototype,"code",void 0);r.CodedValue=e=C.__decorate([g.subclass("esri.layers.support.CodedValue")],
r.CodedValue);r.default=r.CodedValue;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/Domain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(r,t,C,D,x,w,q,p,g,e){C=
new C.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});D=function(l){function k(n){n=l.call(this,n)||this;n.name=null;n.type=null;return n}r._inheritsLoose(k,l);return k}(D.JSONSupport);t.__decorate([x.property({type:String,json:{write:!0}})],D.prototype,"name",void 0);t.__decorate([g.enumeration(C)],D.prototype,"type",void 0);return D=t.__decorate([e.subclass("esri.layers.support.Domain")],D)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/set ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(r,t,C,D,x,w,q,p,g,e){var l;C=l=function(k){function n(d){d=k.call(this,d)||this;d.type="inherited";return d}r._inheritsLoose(n,k);n.prototype.clone=function(){return new l};return n}(e);t.__decorate([p.enumeration({inherited:"inherited"})],C.prototype,"type",void 0);return C=l=t.__decorate([g.subclass("esri.layers.support.InheritedDomain")],C)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(r,t,C,D,x,w,q,p,g){var e;D=e=function(l){function k(n){n=l.call(this,n)||this;n.maxValue=null;n.minValue=null;n.type="range";return n}r._inheritsLoose(k,l);k.prototype.clone=function(){return new e({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};return k}(g);t.__decorate([C.property({type:Number,json:{type:[Number],read:{source:"range",reader(l,k){return k.range&&k.range[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",
writer(l,k,n){k[n]=[this.minValue||0,l]}}}})],D.prototype,"maxValue",void 0);t.__decorate([C.property({type:Number,json:{type:[Number],read:{source:"range",reader(l,k){return k.range&&k.range[0]}},write:{target:"range",writer(l,k,n){k[n]=[l,this.maxValue||0]}}}})],D.prototype,"minValue",void 0);t.__decorate([q.enumeration({range:"range"})],D.prototype,"type",void 0);return D=e=t.__decorate([p.subclass("esri.layers.support.RangeDomain")],D)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g,e){var l;r.MapLayerSource=l=function(k){function n(d){d=k.call(this,d)||this;d.type="map-layer";return d}t._inheritsLoose(n,k);n.prototype.clone=function(){const {mapLayerId:d,gdbVersion:b}=this;return new l({mapLayerId:d,gdbVersion:b})};return n}(D.JSONSupport);C.__decorate([g.enumeration({mapLayer:"map-layer"})],r.MapLayerSource.prototype,"type",void 0);C.__decorate([x.property({type:p.Integer,json:{write:!0}})],r.MapLayerSource.prototype,"mapLayerId",void 0);C.__decorate([x.property({type:String,
json:{write:!0}})],r.MapLayerSource.prototype,"gdbVersion",void 0);r.MapLayerSource=l=C.__decorate([e.subclass("esri.layers.support.source.MapLayerSource")],r.MapLayerSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n){var d;r.QueryTableDataSource=d=function(b){function a(c){c=b.call(this,c)||this;c.type="query-table";return c}t._inheritsLoose(a,b);a.prototype.clone=function(){var c;const {workspaceId:f,query:m,oidFields:h,spatialReference:v,geometryType:u}=this,F={workspaceId:f,query:m,oidFields:h,spatialReference:null!=(c=null==v?void 0:v.clone())?c:void 0,geometryType:u};return new d(F)};return a}(x.JSONSupport);C.__decorate([e.enumeration({queryTable:"query-table"})],r.QueryTableDataSource.prototype,
"type",void 0);C.__decorate([w.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"workspaceId",void 0);C.__decorate([w.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"query",void 0);C.__decorate([w.property({type:String,json:{write:!0}})],r.QueryTableDataSource.prototype,"oidFields",void 0);C.__decorate([w.property({type:k,json:{write:!0}})],r.QueryTableDataSource.prototype,"spatialReference",void 0);C.__decorate([e.enumeration(n.featureGeometryTypeKebabDictionary)],
r.QueryTableDataSource.prototype,"geometryType",void 0);r.QueryTableDataSource=d=C.__decorate([l.subclass("esri.layers.support.source.QueryTableDataSource")],r.QueryTableDataSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g,e){var l;r.RasterDataSource=l=function(k){function n(d){d=k.call(this,d)||this;d.type="raster";return d}t._inheritsLoose(n,k);n.prototype.clone=function(){const {workspaceId:d,dataSourceName:b}=this;return new l({workspaceId:d,dataSourceName:b})};return n}(D.JSONSupport);C.__decorate([g.enumeration({raster:"raster"})],r.RasterDataSource.prototype,"type",void 0);C.__decorate([x.property({type:String,json:{write:!0}})],r.RasterDataSource.prototype,"dataSourceName",void 0);
C.__decorate([x.property({type:String,json:{write:!0}})],r.RasterDataSource.prototype,"workspaceId",void 0);r.RasterDataSource=l=C.__decorate([e.subclass("esri.layers.support.source.RasterDataSource")],r.RasterDataSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g,e){var l;r.TableDataSource=l=function(k){function n(d){d=k.call(this,d)||this;d.type="table";return d}t._inheritsLoose(n,k);n.prototype.clone=function(){const {workspaceId:d,gdbVersion:b,dataSourceName:a}=this;return new l({workspaceId:d,gdbVersion:b,dataSourceName:a})};return n}(D.JSONSupport);C.__decorate([g.enumeration({table:"table"})],r.TableDataSource.prototype,"type",void 0);C.__decorate([x.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"workspaceId",
void 0);C.__decorate([x.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"gdbVersion",void 0);C.__decorate([x.property({type:String,json:{write:!0}})],r.TableDataSource.prototype,"dataSourceName",void 0);r.TableDataSource=l=C.__decorate([e.subclass("esri.layers.support.source.TableDataSource")],r.TableDataSource);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(r,t,C,D,x,w,q,p,g,e){var l;C=new D.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});x=l=function(k){function n(d){d=k.call(this,d)||this;d.extent=null;d.mode="view";d.originPosition="upper-left";d.tolerance=1;return d}r._inheritsLoose(n,k);n.prototype.clone=function(){return new l(w.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};return n}(x.JSONSupport);t.__decorate([q.property({type:e,json:{write:{overridePolicy(){return{enabled:"view"===
this.mode}}}}})],x.prototype,"extent",void 0);t.__decorate([q.property({type:["view","edit"],json:{write:!0}})],x.prototype,"mode",void 0);t.__decorate([q.property({type:String,json:{read:C.read,write:C.write}})],x.prototype,"originPosition",void 0);t.__decorate([q.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],x.prototype,"tolerance",void 0);return x=l=t.__decorate([g.subclass("esri.rest.support.QuantizationParameters")],x)})},"esri/rest/support/StatisticDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(r,t,C,D,x,w,q,p,g){var e;C=new C.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"});D=e=function(l){function k(d){d=l.call(this,d)||this;d.maxPointCount=void 0;d.maxRecordCount=void 0;d.maxVertexCount=void 0;d.onStatisticField=null;d.outStatisticFieldName=null;d.statisticType=null;d.statisticParameters=null;return d}r._inheritsLoose(k,l);var n=
k.prototype;n.writeStatisticParameters=function(d,b){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)b.statisticParameters=x.clone(d)};n.clone=function(){return new e({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:x.clone(this.statisticParameters)})};return k}(D.JSONSupport);
t.__decorate([w.property({type:Number,json:{write:!0}})],D.prototype,"maxPointCount",void 0);t.__decorate([w.property({type:Number,json:{write:!0}})],D.prototype,"maxRecordCount",void 0);t.__decorate([w.property({type:Number,json:{write:!0}})],D.prototype,"maxVertexCount",void 0);t.__decorate([w.property({type:String,json:{write:!0}})],D.prototype,"onStatisticField",void 0);t.__decorate([w.property({type:String,json:{write:!0}})],D.prototype,"outStatisticFieldName",void 0);t.__decorate([w.property({type:String,
json:{read:{source:"statisticType",reader:C.read},write:{target:"statisticType",writer:C.write}}})],D.prototype,"statisticType",void 0);t.__decorate([w.property({type:Object})],D.prototype,"statisticParameters",void 0);t.__decorate([g.writer("statisticParameters")],D.prototype,"writeStatisticParameters",null);return D=e=t.__decorate([p.subclass("esri.rest.support.StatisticDefinition")],D)})},"esri/views/2d/layers/features/sources/DataTileSubscription":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/CircularArray ../../../../../core/maybe ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(r,t,C,D,x,w){let q=function(){function p(e){this.requests={done:[],stream:new C(10)};this._edits=null;this._abortController=new AbortController;this.didSend=this._done=!1;this.tile=e}var g=p.prototype;g.end=function(){this._done=!0};g.clear=function(){this.requests.done=[]};g.applyUpdate=function(e){this.requests.done.forEach(l=>l.message.status.unset(e));D.isSome(this._edits)&&this._edits.status.unset(e)};g.add=function(e){var l;e.message.status=null!=(l=e.message.status)?l:w.UpdateToken.empty();
e.message.end&&this.requests.done.forEach(k=>{D.isSome(k.message)&&k.message.end&&(k.message.end=!1)});this.requests.done.push(e)};g.edit=function(e,l){const k=e.getQuantizationTransform(),n=e.geometryType,d=Array.from(e.features()),b=d.map(a=>a.objectId);l=[...l,...b];this.removeIds(l);this._invalidate();D.isNone(this._edits)?this._edits={type:"append",addOrUpdate:x.FeatureSetReaderJSON.fromOptimizedFeatures(d,n,D.unwrap(k)),id:this.tile.id,status:w.UpdateToken.empty(),end:!0}:(this.requests.done.forEach(a=>
a.message.end=!1),D.unwrap(this._edits.addOrUpdate).append(e.features()))};g.readers=function*(){for(const {message:e}of this.requests.done)D.isSome(e.addOrUpdate)&&(yield e.addOrUpdate);D.isSome(this._edits)&&D.isSome(this._edits.addOrUpdate)&&(yield this._edits.addOrUpdate)};g._invalidate=function(){for(const e of this.requests.done)e.message.status=w.UpdateToken.empty();D.isSome(this._edits)&&(this._edits.status=w.UpdateToken.empty())};g.removeIds=function(e){this._invalidate();for(const {message:l}of this.requests.done){const k=
l.addOrUpdate;D.isSome(k)&&(k.removeIds(e),k.isEmpty&&(l.addOrUpdate=null))}D.isSome(this._edits)&&D.isSome(this._edits.addOrUpdate)&&this._edits.addOrUpdate.removeIds(e);this.requests.done=this.requests.done.filter(l=>l.message.addOrUpdate||l.message.end)};g.abort=function(){this._abortController.abort()};t._createClass(p,[{key:"signal",get:function(){return this._abortController.signal}},{key:"options",get:function(){return{signal:this._abortController.signal}}},{key:"empty",get:function(){return!this.requests.done.length}},
{key:"edits",get:function(){return this._edits}},{key:"done",get:function(){return this._done}}]);return p}();r.DataTileSubscription=q;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/UpdateToken":function(){define(["exports"],function(r){let t=function(){function C(){this.source=!1;this.targets={feature:!1,aggregate:!1};this.storage={filters:!1,data:!1};this.queryFilter=this.mesh=!1;this.why={mesh:[],source:[]}}C.create=function(x){const w=new C;for(const q in x){const p=
x[q];if("object"===typeof p)for(const g in p)w[q][g]=p[g];w[q]=p}return w};C.empty=function(){return C.create({})};C.all=function(){return C.create({source:!0,targets:{feature:!0,aggregate:!0},storage:{filters:!0,data:!0},mesh:!0})};var D=C.prototype;D.unset=function(x){x.source&&(this.source=!1);x.targets.feature&&(this.targets.feature=!1);x.targets.aggregate&&(this.targets.aggregate=!1);x.storage.filters&&(this.storage.filters=!1);x.storage.data&&(this.storage.data=!1);x.mesh&&(this.mesh=!1);x.queryFilter&&
(this.queryFilter=!1)};D.any=function(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||this.queryFilter};D.describe=function(){let x=0,w="";if(this.mesh){x+=20;w+="-\x3e (20) Mesh needs update\n";for(const q of this.why.mesh)w+=`    + ${q}\n`}if(this.source){x+=10;w+="-\x3e (10) The source needs update\n";for(const q of this.why.source)w+=`    + ${q}\n`}this.targets.feature&&(x+=5,w+="-\x3e (5) Feature target parameters changed\n");
this.storage.filters&&(x+=5,w+="-\x3e (5) Feature filter parameters changed\n");this.targets.aggregate&&(x+=4,w+="-\x3e (4) Aggregate target parameters changed\n");this.storage.data&&(x+=1,w+="-\x3e (1) Texture storage parameters changed");console.debug(`Applying ${5>x?"Fastest":10>x?"Fast":15>x?"Moderate":20>x?"Slow":"Very Slow"} update of cost ${x}/45 `);console.debug(w)};D.toJSON=function(){return{queryFilter:this.queryFilter,source:this.source,targets:this.targets,storage:this.storage,mesh:this.mesh}};
return C}();r.UpdateToken=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/support/QueueProcessor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),function(r,t,C,D,x,w){let q=function(g,e){this.item=g;this.controller=e;this.promise=null},p=function(){function g(l){this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=
this._schedule=null;this.concurrency=1;l.concurrency&&(this.concurrency=l.concurrency);this._queue=new x(l.peeker);this.process=l.process;const k=l.scheduler;l.priority&&C.isSome(k)&&(this._task=k.registerTask(l.priority,this))}var e=g.prototype;e.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};e.abort=function(l){(l=this._controllers.get(l))&&l.abort()};e.clear=function(){this._queue.clear();const l=
[];this._controllers.forEach(k=>l.push(k));this._controllers.clear();l.forEach(k=>k.abort());this._processingItems.clear();this._cancelNext()};e.forEach=function(l){this._deferreds.forEach((k,n)=>l(n))};e.get=function(l){return(l=this._deferreds.get(l))?l.promise:void 0};e.isOngoing=function(l){return this._processingItems.has(l)};e.has=function(l){return this._deferreds.has(l)};e.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};e.push=function(l,k){const n=this.get(l);if(n)return n;
const d=new AbortController;let b=null;k&&(b=D.onAbort(k,()=>d.abort()));const a=()=>{c.remove();C.isSome(b)&&b.remove();this._deferreds.delete(l);this._controllers.delete(l);this._queue.remove(l);this._processingItems.delete(l);this._scheduleNext()},c=D.onAbortOrThrow(d.signal,()=>{const m=this._processingItems.get(l);m&&m.controller.abort();a();f.reject(D.createAbortError())}),f=D.createDeferred();this._deferreds.set(l,f);this._controllers.set(l,d);f.promise.then(a,a);this._queue.push(l);this._scheduleNext();
return f.promise};e.last=function(){return this._queue.last()};e.peek=function(){return this._queue.peek()};e.popLast=function(){return this._queue.popLast()};e.reset=function(){const l=[];this._processingItems.forEach(k=>l.push(k));this._processingItems.clear();for(const k of l)this._queue.push(k.item),k.controller.abort();this._scheduleNext()};e.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};e.takeAll=function(){const l=[];for(;this._queue.length;)l.push(this._queue.pop());
this.clear();return l};e.runTask=function(l){for(;!l.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),l.madeProgress()};e._scheduleNext=function(){this._task||this._isPaused||this._schedule||(this._schedule=w.schedule(()=>{this._schedule=null;this._next()}))};e._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};e._cancelNext=function(){this._schedule&&(this._schedule.remove(),
this._schedule=null)};e._processResult=function(l,k){this._canProcessFulfillment(l)&&(this._scheduleNext(),this._deferreds.get(l.item).resolve(k))};e._processError=function(l,k){this._canProcessFulfillment(l)&&(this._scheduleNext(),this._deferreds.get(l.item).reject(k))};e._canProcessFulfillment=function(l){return this._deferreds.get(l.item)&&this._processingItems.get(l.item)===l?!0:!1};e._process=function(l){if(!C.isNone(l)){var k=new AbortController,n=new q(l,k);this._processingItems.set(l,n);try{var d=
this.process(l,k.signal)}catch(b){this._processError(n,b)}D.isPromiseLike(d)?(n.promise=d,d.then(b=>this._processResult(n,b),b=>this._processError(n,b))):this._processResult(n,d)}};t._createClass(g,[{key:"length",get:function(){return this._processingItems.size+this._queue.length}},{key:"running",get:function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency}},{key:"test",get:function(){return{update:l=>this.runTask(l)}}}]);return g}();r.QueueProcessor=p;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/core/Queue":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(r,t){return function(){function C(x=w=>w.values().next().value){this._peeker=x;this._items=new Set}var D=C.prototype;D.clear=function(){this._items.clear()};D.last=function(){if(0!==this._items.size){for(var x of this._items);return x}};D.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};D.push=function(x){this.contains(x)||this._items.add(x)};D.contains=
function(x){return this._items.has(x)};D.pop=function(){if(0!==this.length){var x=this.peek();this._items.delete(t.assumeNonNull(x));return x}};D.popLast=function(){if(0!==this.length){var x=this.last();this._items.delete(t.assumeNonNull(x));return x}};D.remove=function(x){this._items.delete(x)};D.filter=function(x){this._items.forEach(w=>{x(w)||this._items.delete(w)});return this};r._createClass(C,[{key:"length",get:function(){return this._items.size}}]);return C}()})},"esri/views/2d/layers/features/sources/GeoEventSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../../chunks/rbush ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/StreamFeatureManager ../../../../../layers/graphics/sources/connections/createConnection ./DataTileSource ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k){function n(c,f){const m=c.weakClone();if(D.isSome(c.geometry)){const h=w.quantizeX(f,c.geometry.coords[0]);c=w.quantizeY(f,c.geometry.coords[1]);m.geometry=new q([],[h,c])}return m}function d(c){switch(c){case "esriGeometryPoint":return n;default:return(f,m)=>{const h=f.weakClone(),v=new q;f=w.quantizeOptimizedGeometry(v,f.geometry,!1,!1,c,m,!1,!1);h.geometry=f;return h}}}function b(c){switch(c){case "esriGeometryPoint":return f=>D.isSome(f.geometry)?{minX:f.geometry.coords[0],
minY:f.geometry.coords[1],maxX:f.geometry.coords[0],maxY:f.geometry.coords[1]}:{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};default:return f=>{let m=Infinity,h=Infinity,v=-Infinity,u=-Infinity;D.isSome(f.geometry)&&f.geometry.forEachVertex((F,z)=>{m=Math.min(m,F);h=Math.min(h,z);v=Math.max(v,F);u=Math.max(u,z)});return{minX:m,minY:h,maxX:v,maxY:u}}}}let a=function(){function c(m,h){this.onUpdate=m;this._geometryType=h;this._objectIdToFeature=new Map}var f=c.prototype;f.add=function(m){this._objectIdToFeature.set(m.objectId,
m);this._index=null};f.get=function(m){return this._objectIdToFeature.has(m)?this._objectIdToFeature.get(m):null};f.forEach=function(m){this._objectIdToFeature.forEach(m)};f.search=function(m){if(!this._index){{var h=this._features;const v=x.rbush(9,b(this._geometryType));v.load(h);h=v}this._index=h}return this._index.search({minX:m.bounds[0],minY:m.bounds[1],maxX:m.bounds[2],maxY:m.bounds[3]})};f.removeById=function(m){const h=this._objectIdToFeature.get(m);return h?(this._objectIdToFeature.delete(m),
this._index=null,h):null};f.update=function(m,h){this.onUpdate(m,h)};t._createClass(c,[{key:"_features",get:function(){const m=[];this._objectIdToFeature.forEach(h=>m.push(h));return m}},{key:"size",get:function(){return this._objectIdToFeature.size}}]);return c}();C=function(c){function f(h){var v=c.call(this,h)||this;v.type="geoevent";v._dataReceiveEventEnabled=!1;v._level=0;v._updateInfo={websocket:0,client:0};var {outSR:u}=h;const {geometryType:F,objectIdField:z,timeInfo:A,purgeOptions:E,source:G,
spatialReference:H,serviceFilter:K,maxReconnectionAttempts:L,maxReconnectionInterval:J,updateInterval:B,enableDataReceived:y,customParameters:I}=h.serviceInfo,S=new a(v._onUpdate.bind(t._assertThisInitialized(v)),F),O=new p.default(S,z,A,E);u=g.createConnection(G,H,u,F,K,L,J,I);v._store=S;v._manager=O;v._connection=u;v._quantize=d(F);v._dataReceiveEventEnabled=y;v._handles=[v._connection.on("feature",R=>v._onFeature(R)),v._connection.watch("connectionStatus",R=>v.events.emit("connectionStatus",R)),
v._connection.watch("errorString",R=>v.events.emit("errorString",R))];let Y=performance.now();v._updateIntervalId=setInterval(()=>{var R=performance.now(),Q=R-Y;2500<Q&&(Y=R,R=Math.round(v._updateInfo.client/(Q/1E3)),Q=Math.round(v._updateInfo.websocket/(Q/1E3)),v._updateInfo.client=0,v._updateInfo.websocket=0,v.events.emit("updateRate",{client:R,websocket:Q}));h.canAcceptRequest()&&v._manager.checkForUpdates()},B);return v}t._inheritsLoose(f,c);var m=f.prototype;m.destroy=function(){c.prototype.destroy.call(this);
clearInterval(this._updateIntervalId);this._handles.forEach(h=>h.remove());this._connection.destroy()};m._fetchDataTile=function(){};m.resume=function(){};m.enableEvent=function(h,v){"data-received"===h&&(this._dataReceiveEventEnabled=v)};m.subscribe=function(h){c.prototype.subscribe.call(this,h);const v=this._subscriptions.get(h.id);this._level=h.level;const u=this._getTileFeatures(h);this._onMessage({type:"append",id:h.key.id,addOrUpdate:u,end:!0});v.didSend=!0};m.unsubscribe=function(h){c.prototype.unsubscribe.call(this,
h)};m.readers=function*(h){h=this._subscriptions.get(h);const {tile:v}=h;yield this._getTileFeatures(v);for(const u of h.requests.stream.entries)D.isSome(u)&&D.isSome(u.addOrUpdate)&&(yield u.addOrUpdate)};m.createTileQuery=function(h){throw Error("Service does not support tile  queries");};m.resend=function(){var h=t._asyncToGenerator(function*(){this._subscriptions.forEach(v=>{({tile:v}=v);v={type:"append",id:v.id,addOrUpdate:this._getTileFeatures(v),end:!0};this._onMessage(v)})});return function(){return h.apply(this,
arguments)}}();m._getTileFeatures=function(h){const v=this._store.search(h).map(u=>this._quantize(u,h.transform));return l.FeatureSetReaderJSON.fromOptimizedFeatures(v,this._serviceInfo.geometryType,h.transform)};m._onFeature=function(h){this._updateInfo.websocket++;try{this._dataReceiveEventEnabled&&this.events.emit("feature",h);const v=w.convertFromFeature(h,this._serviceInfo.geometryType,!1,!1,this._serviceInfo.objectIdField);this._manager.add(v)}catch(v){}};m._onUpdate=function(h,v){D.isSome(h)&&
(this._updateInfo.client+=h.length);this._subscriptions.forEach((u,F)=>{u.didSend&&u.tile.level===this._level&&this._onMessage({type:"append",id:F,addOrUpdate:null,clear:!0,end:!1})});this._subscriptions.forEach((u,F)=>{if(u.didSend&&u.tile.level===this._level){var z=this._getTileFeatures(u.tile);F={type:"append",id:F,addOrUpdate:z,remove:[],end:!0,status:k.UpdateToken.empty()};u.requests.stream.enqueue(F);this._onMessage(F)}})};t._createClass(f,[{key:"updating",get:function(){return!1}}]);return f}(e.DataTileSource);
r.GeoEventSource=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/data/StreamFeatureManager":function(){define(["exports","../../../core/CircularArray","../../../core/mathUtils","../../../core/maybe"],function(r,t,C,D){let x=function(){function w(p,g,e,l,k=128){this._trackIdToObservations=new Map;this._idCounter=0;this._lastPurge=performance.now();this._addOrUpdated=new Map;this._removed=[];this._maxAge=0;this._timeInfo=e;this._purgeOptions=l;this.store=p;this.objectIdField=
g;this.purgeInterval=k;this._useGeneratedIds="__esri_stream_id__"===this.objectIdField}var q=w.prototype;q.add=function(p){if(this._useGeneratedIds){var g=this._nextId();p.attributes[this.objectIdField]=g;p.objectId=g}else p.objectId=p.attributes[this.objectIdField];this._addOrUpdated.set(p.objectId,p);this._maxAge=Math.max(this._maxAge,p.attributes[this._timeInfo.startTimeField]);if(this._timeInfo.trackIdField){g=p.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(g)){var e=
D.isSome(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:1E3;e=C.clamp(e,0,1E3);this._trackIdToObservations.set(g,new t(e))}p=this._trackIdToObservations.get(g).enqueue(p.objectId);D.isSome(p)&&(this._addOrUpdated.has(p)?this._addOrUpdated.delete(p):this._removed.push(p))}else D.isNone(this._trackIdLessObservations)&&(this._trackIdLessObservations=new t(1E5)),this._trackIdLessObservations.enqueue(p.objectId)};q.checkForUpdates=function(){const p=this._getToAdd();
var g=this._getToRemove();const e=performance.now();e-this._lastPurge>=this.purgeInterval&&(this._purge(e),this._lastPurge=e);const l=[];if(D.isSome(g))for(const k of g)g=this.store.removeById(k),D.isSome(g)&&l.push(g);if(D.isSome(p))for(const k of p)k.attributes.__esri_timestamp__=e,this.store.add(k);(p||l)&&this.store.update(p,l)};q._getToAdd=function(){if(!this._addOrUpdated.size)return null;const p=Array(this._addOrUpdated.size);let g=0;this._addOrUpdated.forEach(e=>p[g++]=e);this._addOrUpdated.clear();
return p};q._getToRemove=function(){const p=this._removed;if(!this._removed.length)return null;this._removed=[];return p};q._nextId=function(){const p=this._idCounter;this._idCounter=(this._idCounter+1)%4294967294+1;return p};q._purge=function(p){const g=this._purgeOptions;D.isSome(g)&&(this._purgeSomeByDisplayCount(g),this._purgeByAge(g),this._purgeByAgeReceived(p,g),this._purgeTracks())};q._purgeSomeByDisplayCount=function(p){if(p.displayCount){var g=this.store.size;if(g>p.displayCount){if(this._timeInfo.trackIdField)for(const e of this._trackIdToObservations.values())if(g>
p.displayCount&&e.size){const l=D.unwrap(e.dequeue());this._removed.push(l);g--}if(D.isSome(this._trackIdLessObservations))for(p=g-p.displayCount;0<p--;)g=this._trackIdLessObservations.dequeue(),D.isSome(g)&&this._removed.push(g)}}};q._purgeByAge=function(p){var g;if(p.age&&null!=(g=this._timeInfo)&&g.startTimeField){var e=this._maxAge-6E4*p.age;this.store.forEach(l=>{l.attributes[this._timeInfo.startTimeField]<e&&this._removed.push(l.objectId)})}};q._purgeByAgeReceived=function(p,g){if(g.ageReceived){var e=
p-6E4*g.ageReceived;this.store.forEach(l=>{l.attributes.__esri_timestamp__<e&&this._removed.push(l.objectId)})}};q._purgeTracks=function(){this._trackIdToObservations.forEach((p,g)=>{0===p.size&&this._trackIdToObservations.delete(g)})};return w}();r.DEFAULT_STREAM_ID_FIELD="__esri_stream_id__";r.ESRI_TIMESTAMP="__esri_timestamp__";r.default=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/connections/createConnection":function(){define(["exports","./GeoEventConnection",
"./WebSocketConnection"],function(r,t,C){r.createConnection=function(D,x,w,q,p,g,e,l){const k=0===D.path.indexOf("wss://")||0===D.path.indexOf("ws://");D={source:D,sourceSpatialReference:x,spatialReference:w,geometryType:q,filter:p,maxReconnectionAttempts:g,maxReconnectionInterval:e,customParameters:l};return k?new C.WebSocketConnection(D):new t(D)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/layers/graphics/sources/connections/GeoEventConnection":function(){define("require ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/set ../../../../core/accessorSupport/decorators/subclass ./WebSocketConnection ../../../../rest/query/operations/query ../../../../rest/support/Query ../../../../geometry/support/jsonUtils ../../../../geometry/SpatialReference".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h){const v=q.getLogger("esri.layers.graphics.sources.connections.GeoEventConnection"),u={maxQueryDepth:5,maxRecordCountFactor:3};D=function(F){function z(E){return F.call(this,{...u,...E})||this}t._inheritsLoose(z,F);var A=z.prototype;A._open=function(){var E=t._asyncToGenerator(function*(){var G=yield this._fetchServiceDefinition(this._config.source);G.timeInfo.trackIdField||v.warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");
G=this._fetchWebSocketUrl(G.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices());yield this._buddyServicesQuery;yield this._tryCreateWebSocket(G);const {filter:H,outFields:K}=this._config;this.destroyed||this._setFilter(H,K)});return function(){return E.apply(this,arguments)}}();A._onMessage=function(E){let G;try{G=this._enrich(JSON.parse(E.data)),p.isSome(this._featureZScaler)&&this._featureZScaler(G.geometry)}catch(H){v.error(new w("geoevent-connection",
"Failed to parse message",H));return}this.onFeature(G)};A._fetchServiceDefinition=function(){var E=t._asyncToGenerator(function*(G){return this._serviceDefinition=G=(yield x(G.path,{query:{f:"json",...this._config.customParameters},responseType:"json"})).data});return function(G){return E.apply(this,arguments)}}();A._fetchWebSocketUrl=function(E,G){const {urls:H,token:K}=E[0];E=this._inferWebSocketBaseUrl(H);return e.addQueryParameters(`${E}/subscribe`,{outSR:""+G.wkid,token:K})};A._inferWebSocketBaseUrl=
function(E){if(1===E.length)return E[0];for(const G of E)if(-1!==G.indexOf("wss"))return G;v.error(new w("geoevent-connection","Unable to infer WebSocket url",E));return null};A._setFilter=function(){var E=t._asyncToGenerator(function*(G,H){const K=this._websocket;if(!(p.isNone(K)||p.isNone(G)&&p.isNone(H))){G=JSON.stringify({filter:this._serializeFilter(G,H)});var L=!1,J=g.createResolver();K.onmessage=B=>{B=JSON.parse(B.data);B.filter&&(B.error&&(v.error(new w("geoevent-connection","Failed to set service filter",
B.error)),this._set("errorString",`Could not set service filter - ${B.error}`),J.reject(B.error)),K.onmessage=this._onMessage.bind(this),L=!0,J.resolve())};K.send(G);setTimeout(()=>{L||(this.destroyed||this._websocket!==K||v.error(new w("geoevent-connection","Server timed out when setting filter")),J.reject())},1E4);return J.promise}});return function(G,H){return E.apply(this,arguments)}}();A._serializeFilter=function(E,G){const H={};if(p.isNone(E)&&p.isNone(G))return H;if(p.isSome(E)&&E.geometry)try{const K=
m.fromJSON(E.geometry);if("extent"!==K.type)throw new w(`Expected extent but found type ${K.type}`);H.geometry=JSON.stringify(K.shiftCentralMeridian())}catch(K){v.error(new w("geoevent-connection","Encountered an error when setting connection geometryDefinition",K))}p.isSome(E)&&E.where&&"1 \x3d 1"!==E.where&&(H.where=E.where);p.isSome(G)&&(H.outFields=G.join(","));return H};A._enrich=function(E){if(!this._relatedFeatures)return E;const G=E.attributes[this._serviceDefinition.relatedFeatures.joinField];
if(!this._relatedFeatures.has(G))return v.warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",E),E;const {attributes:H,geometry:K}=this._relatedFeatures.get(G);for(const L in H)E.attributes[L]=H[L];K&&(E.geometry=K);E.geometry||E.centroid||v.error(new w("geoevent-connection","Found malformed feature - no geometry found",E));return E};A._queryBuddyServices=function(){var E=t._asyncToGenerator(function*(){try{const {relatedFeatures:G,keepLatestArchive:H}=this._serviceDefinition,
K=this._queryRelatedFeatures(G),L=this._queryArchive(H);yield K;const J=yield L;if(J)for(const B of J.features)this.onFeature(this._enrich(B))}catch(G){v.error(new w("geoevent-connection","Encountered an error when querying buddy services",{error:G}))}});return function(){return E.apply(this,arguments)}}();A._queryRelatedFeatures=function(){var E=t._asyncToGenerator(function*(G){G&&(G=yield this._queryBuddy(G.featuresUrl),this._addRelatedFeatures(G))});return function(G){return E.apply(this,arguments)}}();
A._queryArchive=function(){var E=t._asyncToGenerator(function*(G){if(G)return this._queryBuddy(G.featuresUrl)});return function(G){return E.apply(this,arguments)}}();A._queryBuddy=function(){var E=t._asyncToGenerator(function*(G){const H=new (yield new Promise((S,O)=>r(["../../../FeatureLayer"],Y=>S(Object.freeze({__proto__:null,default:Y})),O))).default({url:G});var {capabilities:K}=yield H.load();const L=K.query.supportsMaxRecordCountFactor,J=K.query.supportsPagination;K=K.query.supportsCentroid;
const B=this._config.maxRecordCountFactor;var y=H.capabilities.query.maxRecordCount;y=L?y*B:y;const I=new f;I.outFields=p.unwrapOr(this._config.outFields,["*"]);I.where=p.unwrapOr(p.get(this._config.filter,"where"),"1\x3d1");I.returnGeometry=!0;I.returnExceededLimitFeatures=!0;I.outSpatialReference=h.fromJSON(this._config.spatialReference);K&&(I.returnCentroid=!0);L&&(I.maxRecordCountFactor=B);if(J)return I.num=y,H.destroy(),this._queryPages(G,I);G=yield c.executeQuery(G,I,this._config.sourceSpatialReference);
H.destroy();return G.data});return function(G){return E.apply(this,arguments)}}();A._queryPages=function(){var E=t._asyncToGenerator(function*(G,H,K=[],L=0){H.start=p.isSome(H.num)?L*H.num:null;const {data:J}=yield c.executeQuery(G,H,this._config.sourceSpatialReference);if(J.exceededTransferLimit&&L<this._config.maxQueryDepth)return J.features.forEach(B=>K.push(B)),this._queryPages(G,H,K,L+1);K.forEach(B=>J.features.push(B));return J});return function(G,H){return E.apply(this,arguments)}}();A._addRelatedFeatures=
function(E){const G=new Map;E=E.features;const H=this._serviceDefinition.relatedFeatures.joinField;for(const K of E)G.set(K.attributes[H],K);this._relatedFeatures=G};return z}(a.WebSocketConnection);return D=C.__decorate([b.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],D)})},"esri/layers/graphics/sources/connections/WebSocketConnection":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/zscale ./StreamConnection".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b){const a=x.getLogger("esri.layers.graphics.sources.connections.WebSocketConnection");r.ReadyState=void 0;(function(c){c[c.CONNECTING=0]="CONNECTING";c[c.OPEN=1]="OPEN";c[c.CLOSING=2]="CLOSING";c[c.CLOSED=3]="CLOSED"})(r.ReadyState||(r.ReadyState={}));r.WebSocketConnection=function(c){function f(h){var v=c.call(this)||this;v.errorString=null;const {geometryType:u,spatialReference:F,sourceSpatialReference:z}=h;v._config=h;v._featureZScaler=d.getGeometryZScaler(u,
z,F);v._open();return v}t._inheritsLoose(f,c);var m=f.prototype;m._open=function(){var h=t._asyncToGenerator(function*(){yield this._tryCreateWebSocket();this.destroyed||(yield this._handshake())});return function(){return h.apply(this,arguments)}}();m.destroy=function(){w.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close());this._websocket=null};m._tryCreateWebSocket=function(){var h=
t._asyncToGenerator(function*(v=this._config.source.path,u=1E3,F=0){try{if(!this.destroyed){var z=p.addQueryParameters(v,this._config.customParameters);this._websocket=yield this._createWebSocket(z);this.notifyChange("connectionStatus")}}catch(A){if(z=u/1E3,this._config.maxReconnectionAttempts&&F>=this._config.maxReconnectionAttempts)a.error(new D("websocket-connection","Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),this.destroy();else return a.error(new D("websocket-connection",
`Failed to connect. Attempting to reconnect in ${z}s`,A)),yield q.after(u),this._tryCreateWebSocket(v,Math.min(1.5*u,1E3*this._config.maxReconnectionInterval),F+1)}});return function(){return h.apply(this,arguments)}}();m._createWebSocket=function(h){return new Promise((v,u)=>{const F=new WebSocket(h);F.onopen=()=>{F.onopen=null;this.destroyed?(F.onclose=null,F.close()):(F.onclose=z=>this._onClose(z),F.onerror=z=>this._onError(z),F.onmessage=z=>this._onMessage(z),v(F))};F.onclose=z=>{F.onopen=F.onclose=
null;u(z)}})};m._handshake=function(){var h=t._asyncToGenerator(function*(v=1E4){const u=this._websocket;if(!w.isNone(u)){var F=q.createResolver(),z=u.onmessage,{filter:A,outFields:E,spatialReference:G}=this._config;F.timeout(v);u.onmessage=H=>{var K;let L=null;try{L=JSON.parse(H.data)}catch(J){}L&&"object"===typeof L||(a.error(new D("websocket-connection","Protocol violation. Handshake failed - malformed message",H.data)),F.reject(),this.destroy());(null==(K=L.spatialReference)?void 0:K.wkid)!==
(null==G?void 0:G.wkid)&&(a.error(new D("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${G.wkid}`,H.data)),F.reject(),this.destroy());"json"!==L.format&&(a.error(new D("websocket-connection","Protocol violation. Handshake failed - format is not set",H.data)),F.reject(),this.destroy());A&&L.filter!==A&&a.error(new D("websocket-connection","Tried to set filter, but server doesn't support it"));E&&L.outFields!==E&&a.error(new D("websocket-connection","Tried to set outFields, but server doesn't support it"));
u.onmessage=z;F.resolve()};u.send(JSON.stringify({filter:A,outFields:E,format:"json",spatialReference:{wkid:G.wkid}}));return F.promise}});return function(){return h.apply(this,arguments)}}();m._onMessage=function(h){try{const v=JSON.parse(h.data);if("featureResult"!==v.type)throw new D("websocket-connection","Protocol violation - Expected to find message of type 'featureResult'",v);for(const u of v.features)w.isSome(this._featureZScaler)&&this._featureZScaler(u.geometry),this.onFeature(u)}catch(v){a.error(new D("websocket-connection",
"Failed to parse message",v)),this.destroy()}};m._onError=function(h){this._set("errorString","Encountered an error over WebSocket connection");a.error("websocket-connection","Encountered an error over WebSocket connection")};m._onClose=function(h){this._websocket=null;this.notifyChange("connectionStatus");1E3!==h.code&&a.error("websocket-connection",`WebSocket closed unexpectedly with error code ${h.code}`);this.destroyed||this._open()};t._createClass(f,[{key:"connectionStatus",get:function(){if(w.isNone(this._websocket))return"disconnected";
switch(this._websocket.readyState){case r.ReadyState.CONNECTING:case r.ReadyState.OPEN:return"connected";case r.ReadyState.CLOSING:case r.ReadyState.CLOSED:return"disconnected"}}}]);return f}(b);C.__decorate([g.property()],r.WebSocketConnection.prototype,"connectionStatus",null);C.__decorate([g.property()],r.WebSocketConnection.prototype,"errorString",void 0);r.WebSocketConnection=C.__decorate([n.subclass("esri.layers.graphics.sources.connections.WebSocketConnection")],r.WebSocketConnection);Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/layers/graphics/sources/connections/StreamConnection":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/HandleOwner ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/set ../../../../core/accessorSupport/decorators/subclass".split(" "),function(r,t,C,D,x,w,q,p,g,e){C=function(l){function k(){return l.apply(this,
arguments)||this}r._inheritsLoose(k,l);k.prototype.onFeature=function(n){this.emit("feature",n)};return k}(C.EventedMixin(D.HandleOwner));return C=t.__decorate([e.subclass("esri.layers.graphics.sources.connections.StreamConnection")],C)})},"esri/views/2d/layers/features/sources/PagedFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),
function(r,t,C,D,x,w,q){const p=D.getLogger("esri.views.2d.layers.features.sources.FeatureSource");D=function(g){function e(k){return g.call(this,k)||this}t._inheritsLoose(e,g);var l=e.prototype;l._fetchDataTile=function(){var k=t._asyncToGenerator(function*(n){const d=this._subscriptions.get(n.key.id);let b=!1,a=0,c=0;const f=(v,u)=>{c--;w.throwIfAborted(d);const F=n.id,z=v.reader;v=v.query;z.exceededTransferLimit?(u={id:F,addOrUpdate:z,end:b&&0===c,type:"append"},d.add({message:u,query:v}),this._onMessage(u)):
(b=!0,u={id:F,addOrUpdate:z,end:0===c,type:"append"},d.add({message:u,query:v}),this._onMessage(u))};let m=0,h=0;for(;!b&&20>h++;){let v;for(let u=0;u<m+1;u++){const F=a++;c++;v=this._fetchDataTilePage(n,F,d).then(z=>z&&f(z,F)).catch(z=>{b=!0;w.isAbortError(z)||(p.error(new C("mapview-query-error","Encountered error when fetching tile",{tile:n,error:z})),this._onMessage({id:n.id,addOrUpdate:null,end:b,type:"append"}))})}yield v;w.throwIfAborted(d);m=Math.min(m+2,6)}});return function(n){return k.apply(this,
arguments)}}();l._fetchDataTilePage=function(){var k=t._asyncToGenerator(function*(n,d,b){w.throwIfAborted(b);const a=this._queryInfo;var c={start:this.pageSize*d,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:n.getQuantizationParameters()};x.isSome(this.maxRecordCountFactor)&&(c.maxRecordCountFactor=this.maxRecordCountFactor);c=this.createTileQuery(n,c);try{const f=yield this._queue.push({tile:n,query:c,signal:b.signal,depth:d});w.throwIfAborted(b);return f?a!==this._queryInfo?
this._fetchDataTilePage(n,d,b):{reader:f,query:c}:null}catch(f){return w.throwIfNotAbortError(f),null}});return function(n,d,b){return k.apply(this,arguments)}}();return e}(q.BaseFeatureSource);r.PagedFeatureSource=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/sources/SnapshotFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/RandomLCG ./BaseFeatureSource ../support/FeatureSetReaderPBFIndirect ../support/UpdateToken".split(" "),
function(r,t,C,D,x,w,q,p,g,e){function l(d,b,a){var c=d.getXHydrated();d=d.getYHydrated();c=b.getColumnForX(c);c=Math.floor(b.normalizeCol(c));b=Math.floor(b.getRowForY(d));return`${a}/${b}/${c}`}function k(d,b){if(x.isNone(d))return null;b=b.transform;const a=d.getQuantizationTransform();if(x.isNone(a)){const [A,E]=b.scale,[G,H]=b.translate;return d.transform(-G/A,H/E,1/A,1/-E)}const [c,f]=a.scale,[m,h]=a.translate,[v,u]=b.scale,[F,z]=b.translate;return d.transform((m-F)/v,(-h+z)/u,c/v,f/u)}const n=
D.getLogger("esri.views.2d.layers.features.sources.SnapshotFeatureSource");C=function(d){function b(c){var f=d.call(this,c)||this;f.mode="snapshot";f._loading=!0;f._controller=new AbortController;f._downloadPromise=null;f._didSendEnd=!1;f._queries=[];f._invalidated=!1;f._hasAggregates=!1;f._random=new q(1E3);f._store=c.store;f._markedIdsBufId=f._store.storage.createBitset();return f}t._inheritsLoose(b,d);var a=b.prototype;a.destroy=function(){d.prototype.destroy.call(this);this._controller.abort()};
a.update=function(c,f){d.prototype.update.call(this,c,f);this._hasAggregates=c.targets.aggregate};a.resend=function(){var c=t._asyncToGenerator(function*(f=!1){yield this._downloadPromise;this._invalidated||f?(f=x.unwrapOrThrow(this._schema.featureCount,"Expected featureCount to be defined"),this._invalidated=!1,this._subscriptions.forEach(m=>m.clear()),this._downloadPromise=this._download(f),yield this._downloadPromise):(f=this._queries.map(({query:m,reader:h})=>this._sendPatchQuery(m,h)),yield Promise.all(f),
this._subscriptions.forEach(m=>{m.requests.done.forEach(h=>this._onMessage(h.message))}))});return function(){return c.apply(this,arguments)}}();a.refresh=function(){var c=t._asyncToGenerator(function*(){yield this.resend(!0)});return function(){return c.apply(this,arguments)}}();a._sendPatchQuery=function(){var c=t._asyncToGenerator(function*(f,m){const h=x.isSome(f.outFields)?f.outFields:[],v=this._queryInfo.outFields,u=v.filter(A=>-1===h.indexOf(A));if(u.length){var F=f.clone(),z=this._signal;
F.returnGeometry=!1;F.returnCentroid=!1;F.outFields=u;f.outFields=v;f=yield this._queue.push({query:F,depth:0,signal:z});w.throwIfAborted({signal:z});m.joinAttributes(f)}});return function(f,m){return c.apply(this,arguments)}}();a._fetchDataTile=function(){var c=t._asyncToGenerator(function*(f){if(!this._downloadPromise){var m=x.unwrapOrThrow(this._schema.featureCount,"Expected featureCount to be defined");this._downloadPromise=this._download(m)}var h=this._store.search(f);m=this._subscriptions.get(f.key.id);
const v=h.length-1;for(let F=0;F<v;F++){var u=k(h[F],f);u={type:"append",id:f.id,addOrUpdate:u,end:!1,status:e.UpdateToken.empty()};m.add({query:null,message:u});this._hasAggregates||(yield w.after(1));this._onMessage(u)}h=k(0<=v?h[v]:null,f);f={type:"append",id:f.id,addOrUpdate:h,end:this._didSendEnd,status:e.UpdateToken.empty()};m.add({query:null,message:f});this._onMessage(f)});return function(f){return c.apply(this,arguments)}}();a._download=function(){var c=t._asyncToGenerator(function*(f){try{yield this.whenInitialized();
const m=this._store.storage.getBitset(this._markedIdsBufId),h=new Set;m.clear();const v=Array.from({length:Math.ceil(f/this.pageSize)},(u,F)=>F).sort((u,F)=>this._random.getInt()-this._random.getInt()).map(u=>this._downloadPage(u,m,h));yield Promise.all(v);this._store.sweepFeatures(m,this._store.storage);this._store.sweepFeatureSets(h)}catch(m){n.error("mapview-snapshot-source","Encountered and error when downloading feature snapshot",m)}this._sendEnd();this._loading=!1});return function(f){return c.apply(this,
arguments)}}();a._downloadPage=function(){var c=t._asyncToGenerator(function*(f,m,h){var v=this.pageSize;v={start:f*v,num:v,cacheHint:!0};x.isSome(this.maxRecordCountFactor)&&(v.maxRecordCountFactor=this.maxRecordCountFactor);v=this.createQuery(v);const u=this._signal;f=yield this._queue.push({query:v,depth:f,signal:u});w.throwIfAborted({signal:u});this._queries.push({query:v,reader:f});this._store.insert(f);h.add(f.instance);for(h=f.getCursor();h.next();)m.set(h.getDisplayId());this._send(f)});return function(f,
m,h){return c.apply(this,arguments)}}();a._send=function(c){if(this._subscriptions.size){var f=null,m=new Map,h=new Set,v=new Map;this._subscriptions.forEach(F=>{var z,A=F.tile;m.set(A.key.id,null);f=A.tileInfoView;h.add(A.level);const {row:E,col:G}=A.key;A=`${A.level}/${E}/${G}`;const H=null!=(z=v.get(A))?z:[];H.push(F);v.set(A,H)});for(const F of h){const z=f.getLODInfoAt(F),A=c.getCursor();for(;A.next();){var u=l(A,z,F);const E=A.getIndex();if(v.has(u))for(const G of v.get(u)){u=G.tile.id;let H=
m.get(u);x.isNone(H)&&(H=[],m.set(u,H));H.push(E)}}}m.forEach((F,z)=>{if(x.isSome(F)){const A=this._subscriptions.get(z);F=k(g.FeatureSetReaderIndirect.from(c,F),A.tile);z={type:"append",id:z,addOrUpdate:F,end:!1,status:e.UpdateToken.empty()};A.add({query:null,message:z});this._onMessage(z)}})}};a._sendEnd=function(){this._subscriptions.forEach(c=>{const f={type:"append",id:c.tile.id,addOrUpdate:null,end:!0,status:e.UpdateToken.empty()};c.add({query:null,message:f});this._onMessage(f)});this._didSendEnd=
!0};t._createClass(b,[{key:"loading",get:function(){return this._loading}},{key:"_signal",get:function(){return this._controller.signal}}]);return b}(p.BaseFeatureSource);r.SnapshotFeatureSource=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b){function a(u,F){return z=>F(u(z))}const c=x.getLogger("esri.views.layers.2d.features.support.AttributeStore"),f=d.createDebugLogger(d.DEBUG_ATTR_UPDATES,c);var m=D("esri-shared-array-buffer"),h=D("esri-atomics");let v=function(){function u(z,A,E,G){this.size=0;this.texelSize=4;const {pixelType:H,layout:K,textureOnly:L}=G;this.textureOnly=L||!1;this.pixelType=H;this._ctype=A;this.layout=K;this._resetRange();this._shared=z;this.size=E;L||(this.data=this._initData(H,
E,z,A))}var F=u.prototype;F.unsetComponentAllTexels=function(z,A){const E=q.unwrap(this.data);for(let G=0;G<this.size*this.size;G++)E[G*this.texelSize+z]&=~A;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};F.setComponentAllTexels=function(z,A){const E=q.unwrap(this.data);for(let G=0;G<this.size*this.size;G++)E[G*this.texelSize+z]|=255&A;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};F.setComponent=function(z,A,E){const G=q.unwrap(this.data);for(const H of E)G[H*this.texelSize+z]|=A,
this.dirtyStart=Math.min(this.dirtyStart,H),this.dirtyEnd=Math.max(this.dirtyEnd,H)};F.setComponentTexel=function(z,A,E){q.unwrap(this.data)[E*this.texelSize+z]|=A;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};F.unsetComponentTexel=function(z,A,E){q.unwrap(this.data)[E*this.texelSize+z]&=~A;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};F.getData=function(z,A){z=k.getDisplayIdTexel(z);return q.unwrap(this.data)[z*this.texelSize+
A]};F.setData=function(z,A,E){z=k.getDisplayIdTexel(z);0===(this.layout&1<<A)?c.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[z*this.texelSize+A]=E,this.dirtyStart=Math.min(this.dirtyStart,z),this.dirtyEnd=Math.max(this.dirtyEnd,z))};F.lock=function(){5121===this.pixelType&&this._shared&&h&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};F.unlock=function(){5121===this.pixelType&&this._shared&&h&&"local"!==this._ctype&&Atomics.store(this.data,
0,0)};F.expand=function(z){this.size=z;if(!this.textureOnly){z=this._initData(this.pixelType,z,this._shared,this._ctype);const A=q.unwrap(this.data);z.set(A);this.data=z}};F.toMessage=function(){const z=this.dirtyStart,A=this.dirtyEnd;var E=this.texelSize;if(z>A)return null;this._resetRange();const G=!this._shared&&"local"!==this._ctype,H=this.pixelType,K=this.layout,L=q.unwrap(this.data);E=G&&L.slice(z*E,(A+1)*E)||null;return{start:z,end:A,data:E,pixelType:H,layout:K}};F._initData=function(z,A,E,
G){E=E&&"local"!==G?SharedArrayBuffer:ArrayBuffer;z=n.getPixelArrayCtor(z);A=new z(new E(A*A*4*z.BYTES_PER_ELEMENT));for(z=0;z<A.length;z+=4)A[z+1]=255;return A};F._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};t._createClass(u,[{key:"buffer",get:function(){return q.andThen(this.data,z=>z.buffer)}}]);return u}();return function(){function u(z,A){this._client=z;this.config=A;this._attributeComputeMap=new Map;this._blocks=[];this._filters=Array(l.MAX_FILTERS);this._targetType=0;
this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;z=A.supportsTextureFloat?5126:5121;f(`Creating AttributeStore ${m?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:z,layout:15},{pixelType:z,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var F=u.prototype;F.destroy=function(){this._abortController.abort()};F.update=function(z,A){this.config=
A;A=A.schema.processors[0].storage;const E=g.diff(this._schema,A);if(z.targets.feature||z.targets.aggregate)z.storage.data=!0;if(E&&(D("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",E),z.storage.data=!0,this._schema=A,this._attributeComputeMap.clear(),!q.isNone(A))){switch(A.target){case "feature":this._targetType=k.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=k.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===A.type)for(const G in A.mapping){if(z=A.mapping[G],
q.isSome(z))for(const H of z.mapping)this._bindAttribute(H)}else for(const G of A.mapping)this._bindAttribute(G)}};F.onTileData=function(z,A){if(!q.isNone(A.addOrUpdate))for(z=A.addOrUpdate.getCursor();z.next();)A=z.getDisplayId(),this.setAttributeData(A,z)};F.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=new AbortController};F.setHighlight=function(){var z=t._asyncToGenerator(function*(A,E){const G=this._getBlock(0);E=E.map(H=>
k.getDisplayIdTexel(H));G.lock();G.unsetComponentAllTexels(0,1);G.setComponent(0,1,E);G.unlock();this._idsToHighlight.clear();for(const H of A)this._idsToHighlight.add(H);yield this.sendUpdates()});return function(A,E){return z.apply(this,arguments)}}();F.updateFilters=function(){var z=t._asyncToGenerator(function*(A,E){const {config:G,service:H,spatialReference:K}=E;({filters:E}=G);E=E.map((L,J)=>this._updateFilter(L,J,H,K));(yield Promise.all(E)).some(L=>L)&&(A.storage.filters=!0,D("esri-2d-update-debug")&&
console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(A,E){return z.apply(this,arguments)}}();F.setData=function(z,A,E,G){const H=k.getDisplayIdTexel(z);this._ensureSizeForTexel(H);this._getBlock(A).setData(z,E,G)};F.getData=function(z,A,E){return this._getBlock(A).getData(z,E)};F.getHighlightFlag=function(z){return this._idsToHighlight.has(z)?l.HIGHLIGHT_FLAG:0};F.unsetAttributeData=function(z){z=k.getDisplayIdTexel(z);this._getBlock(0).setData(z,0,0)};F.setAttributeData=
function(z,A){const E=k.getDisplayIdTexel(z);this._ensureSizeForTexel(E);this._getBlock(0).setData(E,0,this.getFilterFlags(A));if(this._targetType===k.getDisplayIdType(z)){z=this._attributeComputeMap;var G=this.config.supportsTextureFloat?1:2;z.size&&z.forEach((H,K)=>{const L=K*G%4;K=this._getBlock(Math.floor(K*G/4)+l.ATTRIBUTE_DATA_VV);H=H(A);if(this.config.supportsTextureFloat)K.setData(E,L,H);else if(H===l.NAN_MAGIC_NUMBER)K.setData(E,L,255),K.setData(E,L+1,255);else{H=w.clamp(Math.round(H),-32767,
32766)+32768;const J=(H&65280)>>8;K.setData(E,L,H&255);K.setData(E,L+1,J)}})}};F.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=p.createResolver(),this._nextUpdate.promise;const z={blocks:this._blocks.map(A=>q.isSome(A)?A.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var A=()=>{this._currUpdate=null;if(this._nextUpdate){const E=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>E.resolve())}};
A=this._client.update(z,this._signal).then(A).catch(A);this._client.render(this._signal);return A}).catch(A=>{if(p.isAbortError(A))return this._createResourcesPromise=null,this._createResources();c.error(new C("mapview-attribute-store","Encountered an error during client update",A));return Promise.resolve()})};F._ensureSizeForTexel=function(z){for(;z>=this._size*this._size&&!this._expand(););};F._bindAttribute=function(z){function A(){return z.normalizationField?H=>{const K=H.readAttribute(z.normalizationField);
return K?H.readAttribute(z.field)/K:null}:H=>H.readAttribute(z.field)}function E(){z.normalizationField&&c.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return H=>H.getComputedNumericAtIndex(z.fieldIndex)}let G;if(null!=z.fieldIndex)G=E();else if(z.field)G=A();else return;z.valueRepresentation&&(G=a(G,H=>b.getVisualVariableSizeValueRepresentationRatio(H,z.valueRepresentation)));this._attributeComputeMap.set(z.binding,a(G,H=>null===
H||isNaN(H)||Infinity===H?l.NAN_MAGIC_NUMBER:H))};F._createResources=function(){if(q.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(l.ATTRIBUTE_DATA_ANIMATION);f("Initializing AttributeStore");var z={shared:m&&"local"!==this._client.type,size:this._size,blocks:q.mapMany(this._blocks,A=>({textureOnly:A.textureOnly,buffer:A.buffer,pixelType:A.pixelType}))};this._createResourcesPromise=z=this._client.initialize(z,this._signal).catch(A=>{p.isAbortError(A)?this._createResourcesPromise=
null:c.error(new C("mapview-attribute-store","Encountered an error during client initialization",A))});z.then(()=>q.isNone(this._createResourcesPromise)?this._createResources():void 0);return z};F._getBlock=function(z){var A=this._blocks[z];if(q.isSome(A))return A;f(`Initializing AttributeBlock at index ${z}`);A=new v(m,this._client.type,this._size,this._blockDescriptors[z]);this._blocks[z]=A;this._createResourcesPromise=null;return A};F._expand=function(){if(this._size<this.config.maxTextureSize){const z=
this._size<<=1;f("Expanding block size to",z,this._blocks);q.forEachSome(this._blocks,A=>A.expand(z));this._createResourcesPromise=null;this._size=z;return 0}c.error(new C("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};F._updateFilter=function(){var z=t._asyncToGenerator(function*(A,E,G,H){const K=this._filters[E],L=q.isSome(K)&&K.hash;if(!K&&!A||L===JSON.stringify(A))return!1;if(q.isNone(A)){if(!K)return!1;A=1<<E+1;G=this._getBlock(0);this._filters[E]=null;G.setComponentAllTexels(0,
A);this.sendUpdates();return!0}yield(yield this._getFilter(E,G)).update(A,H);return!0});return function(A,E,G,H){return z.apply(this,arguments)}}();F._getFilter=function(){var z=t._asyncToGenerator(function*(A,E){var G=this._filters[A];if(q.isSome(G))return G;({default:G}=yield new Promise((H,K)=>r(["./FeatureFilter"],L=>H(Object.freeze({__proto__:null,default:L})),K)));E=new G({geometryType:E.geometryType,hasM:!1,hasZ:!1,timeInfo:E.timeInfo,fieldsIndex:new e(E.fields)});return this._filters[A]=E});
return function(A,E){return z.apply(this,arguments)}}();F.isVisible=function(z){return!!(this._getBlock(0).getData(z,0)&2)};F.getFilterFlags=function(z){let A=0;var E=k.getDisplayIdFilterMask(z.getDisplayId());for(let H=0;H<this._filters.length;H++){var G=this._filters[H];G=!(E&1<<H)||q.isNone(G)||G.check(z);A|=(G?1:0)<<H}E=0;this._idsToHighlight.size&&(z=z.getObjectId(),E=this.getHighlightFlag(z));return A<<1|E};t._createClass(u,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",
get:function(){return this._abortController.signal}}]);return u}()})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ./color ./enums ./SymbolProperties ../../../webgl/Texture".split(" "),function(r,t,C,D,x,w,q,p,g){function e(O){const Y={};for(const R of O)Y[R.name]=R.strideInBytes;return Y}function l(O){switch(O){case q.WGLGeometryType.MARKER:return K;case q.WGLGeometryType.FILL:return L;
case q.WGLGeometryType.LINE:return J;case q.WGLGeometryType.TEXT:return B;case q.WGLGeometryType.LABEL:return y}}function k(O){switch(O%4){case 0:case 2:return 4;case 1:case 3:return 1}}function n(O){switch(O){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function d(O){const Y={};for(const R in O){let Q=0;Y[R]=O[R].map(W=>{const P={...W,normalized:W.normalized||!1,divisor:W.divisor||0,offset:Q,stride:0};Q+=W.count*n(W.type);return P});Y[R].forEach(W=>
W.stride=Q)}return Y}const b=C.getLogger("esri.views.2d.engine.webgl.Utils");C=[{name:"geometry",strideInBytes:36,divisor:0}];const a=[{name:"geometry",strideInBytes:32,divisor:0}],c=[{name:"geometry",strideInBytes:20,divisor:0}],f=[{name:"geometry",strideInBytes:12,divisor:0}],m=[{name:"geometry",strideInBytes:40,divisor:0}],h=[{name:"geometry",strideInBytes:36,divisor:0}],v=[{name:"geometry",strideInBytes:36,divisor:0}],u=e(C),F=e(a),z=e(c),A=e(f),E=e(m),G=e(h),H=e(v),K=["geometry"],L=["geometry"],
J=["geometry"],B=["geometry"],y=["geometry"],I=new Map,S=O=>{if(!O)return!1;O=O.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(O)&&/[\dz]$/i.test(O)&&4<O.length?!0:!1};r.C_FILL_STRIDE_SPEC=F;r.C_FILL_STRIDE_SPEC_DD=A;r.C_FILL_STRIDE_SPEC_SIMPLE=z;r.C_FILL_VERTEX_DEF=a;r.C_FILL_VERTEX_DEF_DD=f;r.C_FILL_VERTEX_DEF_SIMPLE=c;r.C_ICON_STRIDE_SPEC=u;r.C_ICON_VERTEX_DEF=C;r.C_LABEL_STRIDE_SPEC=H;r.C_LABEL_VERTEX_DEF=v;r.C_LINE_STRIDE_SPEC=E;r.C_LINE_VERTEX_DEF=m;r.C_TEXT_STRIDE_SPEC=G;r.C_TEXT_VERTEX_DEF=
h;r.C_VBO_GEOMETRY="geometry";r.C_VBO_INFO={["geometry"]:35044};r.C_VBO_PERINSTANCE="per_instance";r.C_VBO_PERINSTANCE_VV="per_instance_vv";r.allocateTypedArrayBuffer=function(O,Y){switch(Y%4){case 0:case 2:return new Uint32Array(Math.floor(O*Y/4));case 1:case 3:return new Uint8Array(O*Y)}};r.allocateTypedArrayBufferwithData=function(O,Y){switch(Y%4){case 0:case 2:return new Uint32Array(O);case 1:case 3:return new Uint8Array(O)}};r.charCodes=function(O){const Y=[];for(let R=0;R<O.length;R++)Y.push(O.charCodeAt(R));
return Y};r.copyMeshData=function(O,Y,R,Q,W,P,fa){for(const sa in P){var oa=P[sa].stride,pa=k(oa);const ra=P[sa].data,ua=R[sa].data,M=oa*W.vertexCount/pa,T=oa*O/pa;oa=oa*W.vertexFrom/pa;for(pa=0;pa<M;++pa)ua[pa+T]=ra[pa+oa]}R=W.indexCount;for(P=0;P<R;++P)Q[P+Y]=fa[P+W.indexFrom]-W.vertexFrom+O};r.createGeometryData=function(O,Y){const R=[];for(let Q=0;5>Q;++Q){const W=l(Q),P={};for(const fa of W)P[fa]={data:Y(Q,fa)};R.push({data:O(Q),buffers:P})}return R};r.createProgramDescriptor=(O,Y)=>{if(!I.has(O)){const W=
d(Y);var R=W;var Q={};for(const P in R){const fa=R[P];Q[P]=fa.length?fa[0].stride:0}R=Q;Q=new Map;for(const P in Y)for(const fa of Y[P])Q.set(fa.name,fa.location);Y=Q;I.set(O,{strides:R,bufferLayouts:W,attributes:Y})}return I.get(O)};r.createTextureFromTexelData=function(O,Y){let R,Q;D.isPowerOfTwo(Y.width)&&D.isPowerOfTwo(Y.height)?(R=!0,Q=9987):(R=!1,Q=9729);return new g(O,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:R,samplingMode:Q,wrapMode:33071,flipped:!0},Y)};r.forEachGeometryType=
function(O){O(q.WGLGeometryType.FILL);O(q.WGLGeometryType.LINE);O(q.WGLGeometryType.MARKER);O(q.WGLGeometryType.TEXT);O(q.WGLGeometryType.LABEL)};r.geometryToMappedGeometry=function(O){return{vertexFrom:void 0,vertexTo:void 0,geometry:O}};r.getBytes=n;r.getCapType=function(O){switch(O){case "butt":return 0;case "round":return 1;case "square":return 2;default:return b.error(new t("mapview-invalid-type",`Cap type ${O} is not a valid option. Defaulting to round`)),1}};r.getJoinType=function(O){switch(O){case "miter":return 2;
case "bevel":return 0;case "round":return 1;default:return b.error(new t("mapview-invalid-type",`Join type ${O} is not a valid option. Defaulting to round`)),1}};r.getNamedBuffers=l;r.getPMSResourceSize=function(O){const Y="maxVVSize"in O&&O.maxVVSize;O="width"in O&&O.width||"size"in O&&O.size||0;return Y?Y:O};r.getPixelArrayCtor=function(O){switch(O){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;default:b.error(new t("webgl-utils",`Unable to handle type ${O}`))}};
r.getPixelBytes=function(O){switch(O){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:b.error(new t("webgl-utils",`Unable to handle type ${O}`))}};r.getStrides=function(O,{fill:Y}){switch(O){case q.WGLGeometryType.MARKER:return u;case q.WGLGeometryType.FILL:return"dot-density"===Y?A:"simple"===Y?z:F;case q.WGLGeometryType.LINE:return E;case q.WGLGeometryType.TEXT:return G;case q.WGLGeometryType.LABEL:return H}};r.getTextProperties=function(O){return p.TextProperties.pool.acquire(O.color?
w.copyAndPremultiply(O.color):[255,255,255,255],O.haloColor?w.copyAndPremultiply(O.haloColor):[255,255,255,255],x.pt2px(O.haloSize),x.pt2px(O.font.size),O.angle*Math.PI/180,O.xoffset/O.font.size,O.yoffset/O.font.size,"left"===O.horizontalAlignment?0:"right"===O.horizontalAlignment?1:.5,"top"===O.verticalAlignment?0:"bottom"===O.verticalAlignment?1:.5)};r.getTransformParams=function(O){const {transform:Y,hasZ:R,hasM:Q}=O;return{transform:Y,hasZ:R,hasM:Q}};r.getUrl=O=>"imageData"in O&&O.imageData&&
"contentType"in O&&O.contentType?`data:${O.contentType};base64,${O.imageData}`:"url"in O?O.url:null;r.getVVType=function(O){switch(O){case "opacity":return q.VVType.OPACITY;case "color":return q.VVType.COLOR;case "rotation":return q.VVType.ROTATION;case "size":return q.VVType.SIZE;default:return b.error(`Cannot interpret unknown vv: ${O}`),null}};r.is3D=O=>O.type&&-1!==O.type.toLowerCase().indexOf("3d");r.isDefined=function(O){return null!=O};r.isGIF=O=>"url"in O&&O.url&&O.url.includes(".gif")||"contentType"in
O&&"image/gif"===O.contentType||"imageData"in O&&O.imageData.includes("data:image/gif");r.isImageResource=O=>"url"in O&&O.url||"imageData"in O&&O.imageData;r.isNumber=function(O){return"number"===typeof O};r.isPNG=O=>"url"in O&&O.url&&O.url.includes(".png")||"contentType"in O&&"image/png"===O.contentType||"imageData"in O&&O.imageData.includes("data:image/png");r.isSVGImage=O=>O.includes("data:image/svg+xml");r.isSVGResource=O=>"path"in O&&S(O.path);r.isSimple=function(O){switch(O.type){case "line":return"CIMSolidStroke"===
O.cim.type&&!O.dashTemplate;case "fill":return"CIMSolidFill"===O.cim.type;case "esriSFS":return"esriSFSSolid"===O.style||"esriSFSNull"===O.style;case "esriSLS":return"esriSLSSolid"===O.style||"esriSLSNull"===O.style;default:return!1}};r.isValidSVG=S;r.shouldRepeat=function(O){switch("cim"in O?O.cim.type:O.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}};r.strideToPackingFactor=k;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/core/screenUtils":function(){define(["exports"],function(r){function t(D){return D?72*D/96:0}const C=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;r.castRenderScreenPointArray=function(D){return D};r.castRenderScreenPointArray3=function(D){return D};r.castScreenPointArray=function(D){return D};r.createRenderScreenPoint=function(D=0,x=0){return{x:D,y:x}};r.createRenderScreenPointArray=function(D=0,x=0){return[D,x]};r.createRenderScreenPointArray3=function(D=0,x=0,w=0){return[D,
x,w]};r.createScreenPoint=function(D=0,x=0){return{x:D,y:x}};r.createScreenPointArray=function(D=0,x=0){return[D,x]};r.pt2px=function(D){return D?D/72*96:0};r.px2pt=t;r.screenPointArrayToObject=function(D,x){return x?(x.x=D[0],x.y=D[1],x):{x:D[0],y:D[1]}};r.screenPointObjectToArray=function(D,x){return x?(x[0]=D.x,x[1]=D.y,2<x.length&&(x[2]=0),x):[D.x,D.y]};r.toPt=function(D){if("string"===typeof D){var x=D.match(C);if(x){var w=Number(x[1]);x=x[3]&&x[3].toLowerCase();D="-"===D.charAt(0);w="px"===
x?t(w):w;return D?-w:w}console.warn("screenUtils.toPt: input not recognized!");return null}return D};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","./number"],function(r,t){function C(w,q){Array.isArray(q)?(w[0]=q[0],w[1]=q[1],w[2]=q[2],w[3]=q[3]):(w[0]=q.r,w[1]=q.g,w[2]=q.b,w[3]=q.a);return w}function D(w,q=0,p=!1){const g=w[q+3];w[q+0]*=g;w[q+1]*=g;w[q+2]*=g;p||(w[q+3]*=255);return w}const x=[0,0,0,0];r.copyAndPremultiply=function(w){return D(C([],
w))};r.premultiplyAlpha=D;r.premultiplyAlphaRGBA=function(w){if(!w)return 0;const {r:q,g:p,b:g,a:e}=w;return t.i8888to32(q*e,p*e,g*e,255*e)};r.premultiplyAlphaRGBAArray=function(w){if(!w)return 0;const [q,p,g,e]=w;return t.i8888to32(e/255*q,e/255*p,e/255*g,e)};r.premultiplyAlphaUint32=function(w){D(C(x,w));return t.i8888to32(x[0],x[1],x[2],x[3])};r.white=[255,255,255,1];Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(r){function t(x,
w,q){return Math.round(Math.max(Math.min(x,q),w))}const C=new Float32Array(1),D=new Uint32Array(C.buffer);r.i16=function(x){return t(x,-32768,32767)};r.i1616to32=function(x,w){return 65535&x|w<<16};r.i32=function(x){return t(x,-2147483648,2147483647)};r.i8=function(x){return t(x,-128,127)};r.i8816to32=function(x,w,q){return x&255|(w&255)<<8|q<<16};r.i8888to32=function(x,w,q,p){return x&255|(w&255)<<8|(q&255)<<16|p<<24};r.numTo32=function(x){return x|0};r.toFloat32=function(x){D[0]=x;return C[0]};
r.toUint32=function(x){C[0]=x;return D[0]};r.u16=function(x){return t(x,0,65535)};r.u32=function(x){return t(x,0,4294967295)};r.u32to4Xu8=function(x){return[x&255,(x&65280)>>>8,(x&16711680)>>>16,(x&4278190080)>>>24]};r.u4u4to8=function(x,w){return 15&x|(15&w)<<4};r.u8=function(x){return t(x,0,255)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(r){r.WGLGeometryType=void 0;(function(t){t[t.FILL=0]="FILL";t[t.LINE=1]="LINE";
t[t.MARKER=2]="MARKER";t[t.TEXT=3]="TEXT";t[t.LABEL=4]="LABEL"})(r.WGLGeometryType||(r.WGLGeometryType={}));r.WGLGeometryTransactionStatus=void 0;(function(t){t[t.SUCCEEDED=0]="SUCCEEDED";t[t.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(r.WGLGeometryTransactionStatus||(r.WGLGeometryTransactionStatus={}));r.WGLDrawPhase=void 0;(function(t){t[t.NONE=0]="NONE";t[t.MAP=1]="MAP";t[t.LABEL=2]="LABEL";t[t.LABEL_ALPHA=4]="LABEL_ALPHA";t[t.HITTEST=8]="HITTEST";t[t.HIGHLIGHT=16]="HIGHLIGHT";t[t.CLIP=32]=
"CLIP";t[t.DEBUG=64]="DEBUG";t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(r.WGLDrawPhase||(r.WGLDrawPhase={}));r.VVType=void 0;(function(t){t[t.SIZE=0]="SIZE";t[t.COLOR=1]="COLOR";t[t.OPACITY=2]="OPACITY";t[t.ROTATION=3]="ROTATION"})(r.VVType||(r.VVType={}));r.WGLVVFlag=void 0;(function(t){t[t.NONE=0]="NONE";t[t.OPACITY=1]="OPACITY";t[t.COLOR=2]="COLOR";t[t.ROTATION=4]="ROTATION";t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";t[t.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";
t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(r.WGLVVFlag||(r.WGLVVFlag={}));r.WGLVVTarget=void 0;(function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(r.WGLVVTarget||(r.WGLVVTarget={}));r.MosaicType=void 0;(function(t){t[t.SPRITE=0]="SPRITE";t[t.GLYPH=1]="GLYPH"})(r.MosaicType||(r.MosaicType={}));Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(r,t){let C=function(){function D(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var x=D.prototype;x.acquire=function(w,q,p,g,e,l,k,n,d){this.color=w;this.haloColor=q;this.haloSize=p;this.size=g;this.angle=e;this.offsetX=l;this.offsetY=k;this.hAnchor=n;this.vAnchor=
d};x.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return D}();C.pool=new t(C);r.TextProperties=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/webgl/Texture":function(){define("../../chunks/_rollupPluginBabelHelpers ../../core/mathUtils ../../core/maybe ./checkWebGLError ./enums ./capabilities/isWebGL2Context".split(" "),
function(r,t,C,D,x,w){let q=function(){function p(e,l,k=null){this._context=e;this.type="texture";this._glName=null;this._descriptor=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;e.instanceCounter.increment(x.ResourceType.Texture,this);this._descriptor={target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,...l};34067===this._descriptor.target?this.setDataCubeMap(k):this.setData(k)}var g=p.prototype;g.dispose=function(){this._context.gl&&
this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(x.ResourceType.Texture,this))};g.release=function(){this.dispose()};g.resize=function(e,l){const k=this._descriptor;if(k.width!==e||k.height!==l)k.width=e,k.height=l,34067===this._descriptor.target?this.setDataCubeMap(null):this.setData(null)};g.setDataCubeMap=function(e=null){for(let l=34069;34074>=l;l++)this.setData(e,l)};g.setData=function(e,
l=3553){if(this._context&&this._context.gl){var k=this._context.gl;this._glName||(this._glName=k.createTexture());void 0===e&&(e=null);null===e&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var n=this._context.bindTexture(this,p.TEXTURE_UNIT_FOR_UPDATES),d=this._descriptor;p._validateTexture(this._context,d);k.pixelStorei(k.UNPACK_ALIGNMENT,d.unpackAlignment);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,d.flipped?1:0);k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
d.preMultiplyAlpha?1:0);var b=d.pixelFormat,a=d.internalFormat?d.internalFormat:this._deriveInternalFormat(b,d.dataType);if(e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){var c=e.width,f=e.height;e instanceof HTMLVideoElement&&(c=e.videoWidth,f=e.videoHeight);k.texImage2D(l,0,a,b,d.dataType,e);D.checkWebGLError(k);d.hasMipmap&&this.generateMipmap();void 0===d.width&&(d.width=c);void 0===d.height&&(d.height=f)}else{null!=d.width&&
null!=d.height||console.error("Width and height must be specified!");k.DEPTH24_STENCIL8&&a===k.DEPTH_STENCIL&&(a=k.DEPTH24_STENCIL8);c=d.width;f=d.height;var m=e;if(C.isSome(m)&&"type"in m&&"compressed"===m.type)for(b=Math.round(Math.log(Math.max(c,f))/Math.LN2)+1,d.hasMipmap=d.hasMipmap&&b===e.levels.length,b=0;;++b){k.compressedTexImage2D(l,b,a,c,f,0,e.levels[Math.min(b,e.levels.length-1)]);if(1===c&&1===f||!d.hasMipmap)break;c=Math.max(1,c>>1);f=Math.max(1,f>>1)}else if(C.isSome(e))k.texImage2D(l,
0,a,c,f,0,b,d.dataType,e),D.checkWebGLError(k),d.hasMipmap&&this.generateMipmap();else for(e=0;;++e){k.texImage2D(l,e,a,c,f,0,b,d.dataType,null);D.checkWebGLError(k);if(1===c&&1===f||!d.hasMipmap)break;c=Math.max(1,c>>1);f=Math.max(1,f>>1)}}p._applySamplingMode(k,this._descriptor);p._applyWrapMode(k,this._descriptor);p._applyAnisotropicFilteringParameters(this._context,this._descriptor);D.checkWebGLError(k);this._context.bindTexture(n,p.TEXTURE_UNIT_FOR_UPDATES)}};g.updateData=function(e,l,k,n,d,
b,a=3553){b||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const c=this._context.gl,f=this._descriptor,m=this._context.bindTexture(this,p.TEXTURE_UNIT_FOR_UPDATES);(0>l||0>k||n>f.width||d>f.height||l+n>f.width||k+d>f.height)&&console.error("An attempt to update out of bounds of the texture!");c.pixelStorei(c.UNPACK_ALIGNMENT,f.unpackAlignment);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,f.flipped?1:0);c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
f.preMultiplyAlpha?1:0);b instanceof ImageData||b instanceof HTMLImageElement||b instanceof HTMLCanvasElement||b instanceof HTMLVideoElement?c.texSubImage2D(a,e,l,k,f.pixelFormat,f.dataType,b):c.texSubImage2D(a,e,l,k,n,d,f.pixelFormat,f.dataType,b);this._context.bindTexture(m,p.TEXTURE_UNIT_FOR_UPDATES)};g.generateMipmap=function(){const e=this._descriptor;e.hasMipmap||(this._samplingModeDirty=e.hasMipmap=!0,p._validateTexture(this._context,e));9729===e.samplingMode?(this._samplingModeDirty=!0,e.samplingMode=
9985):9728===e.samplingMode&&(this._samplingModeDirty=!0,e.samplingMode=9984);const l=this._context.bindTexture(this,p.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(e.target);this._context.bindTexture(l,p.TEXTURE_UNIT_FOR_UPDATES)};g.setSamplingMode=function(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)};g.setWrapMode=function(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,p._validateTexture(this._context,this._descriptor),
this._wrapModeDirty=!0)};g.applyChanges=function(){const e=this._context.gl,l=this._descriptor;this._samplingModeDirty&&(p._applySamplingMode(e,l),this._samplingModeDirty=!1);this._wrapModeDirty&&(p._applyWrapMode(e,l),this._wrapModeDirty=!1)};g._deriveInternalFormat=function(e,l){if("webgl"===this._context.webglVersion)return e;switch(l){case 5126:switch(e){case 6408:return 34836;case 6407:return 34837;default:throw Error("Unable to derive format");}default:return e}};p._validateTexture=function(e,
l){(0>l.width||0>l.height)&&console.error("Negative dimension parameters are not allowed!");const k=t.isPowerOfTwo(l.width)&&t.isPowerOfTwo(l.height);w(e.gl)||k||("number"===typeof l.wrapMode?33071!==l.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):(33071!==l.wrapMode.s||33071!==l.wrapMode.t)&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),l.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};p._applySamplingMode=
function(e,l){let k=l.samplingMode,n=l.samplingMode;if(9985===k||9987===k)k=9729,l.hasMipmap||(n=9729);else if(9984===k||9986===k)k=9728,l.hasMipmap||(n=9728);e.texParameteri(l.target,e.TEXTURE_MAG_FILTER,k);e.texParameteri(l.target,e.TEXTURE_MIN_FILTER,n)};p._applyWrapMode=function(e,l){"number"===typeof l.wrapMode?(e.texParameteri(l.target,e.TEXTURE_WRAP_S,l.wrapMode),e.texParameteri(l.target,e.TEXTURE_WRAP_T,l.wrapMode)):(e.texParameteri(l.target,e.TEXTURE_WRAP_S,l.wrapMode.s),e.texParameteri(l.target,
e.TEXTURE_WRAP_T,l.wrapMode.t))};p._applyAnisotropicFilteringParameters=function(e,l){var k;const n=e.capabilities.textureFilterAnisotropic;n&&e.gl.texParameterf(l.target,n.TEXTURE_MAX_ANISOTROPY,null!=(k=l.maxAnisotropy)?k:1)};r._createClass(p,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"isDirty",get:function(){return this._samplingModeDirty||this._wrapModeDirty}}]);return p}();q.TEXTURE_UNIT_FOR_UPDATES=0;return q})},"esri/views/webgl/checkWebGLError":function(){define(["exports",
"../../core/Error","../../core/has","../../core/Logger"],function(r,t,C,D){function x(p,g){switch(g){case p.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case p.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case p.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case p.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";
case p.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case p.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const w=D.getLogger("esri/views/webgl"),q=!!C("enable-feature:webgl-debug");r.checkWebGLError=function(p){if(q){const g=p.getError();g&&(p=x(p,g),w.error(new t("webgl-error","WebGL error occured",{message:p,stack:Error().stack})))}};r.hasFeatureFlagWebGLDebug=q;r.webglDebugEnabled=function(){return q};r.webglValidateShadersEnabled=
function(){return q};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/webgl/enums":function(){define(["exports"],function(r){r.ResourceType=void 0;var t=r.ResourceType||(r.ResourceType={});t[t.Texture=0]="Texture";t[t.Buffer=1]="Buffer";t[t.VAO=2]="VAO";t[t.VertexShader=3]="VertexShader";t[t.FragmentShader=4]="FragmentShader";t[t.Program=5]="Program";t[t.Framebuffer=6]="Framebuffer";t[t.Renderbuffer=7]="Renderbuffer";t[t.COUNT=8]="COUNT";r.BASE_TEXTURE_UNIT=33984;r.DepthStencilAttachment=
33306;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(r){return window.WebGL2RenderingContext&&r instanceof window.WebGL2RenderingContext}})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(r){r.DEBUG_ATTR_UPDATES=!1;r.createDebugLogger=(t,C)=>t&&((...D)=>C.warn("DEBUG:",...D))||(()=>null);Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(r,t,C,D,x,w,q){function p(b){return{value:b.value,size:C.toPt(b.size)}}function g(b){return b.map(a=>p(a))}function e(b){return"string"===typeof b||"number"===typeof b?C.toPt(b):{type:"size",expression:b.expression,stops:g(b.stops)}}function l(b){const a={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof b.field)if(b.stops){if(8<b.stops.length)return null;b=b.stops;for(var c=0;8>c;++c){const f=b[Math.min(c,b.length-1)];a.values[c]=f.value;a.opacities[c]=f.opacity}}else return null;
else if(b.stops&&0<=b.stops.length)for(b=b.stops&&0<=b.stops.length&&b.stops[0].opacity,c=0;8>c;c++)a.values[c]=Infinity,a.opacities[c]=b;else return null;return a}function k(b,a,c){b[4*a]=c.r/255;b[4*a+1]=c.g/255;b[4*a+2]=c.b/255;b[4*a+3]=c.a}function n(b){if(t.isNone(b)||b.normalizationField)return null;const a={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof b.field)if(b.stops){if(8<b.stops.length)return null;a.field=
b.field;b=b.stops;for(var c=0;8>c;++c){const f=b[Math.min(c,b.length-1)];a.values[c]=f.value;k(a.colors,c,f.color)}}else return null;else if(b.stops&&0<=b.stops.length)for(b=b.stops&&0<=b.stops.length&&b.stops[0].color,c=0;8>c;c++)a.values[c]=Infinity,k(a.colors,c,b);else return null;for(b=0;32>b;b+=4)D.premultiplyAlpha(a.colors,b,!0);return a}const d=b=>{const a=[],c=[];b=g(b);const f=b.length;for(let m=0;6>m;m++){const h=b[Math.min(m,f-1)];a.push(h.value);c.push(null==h.size?x.NAN_MAGIC_NUMBER:
C.pt2px(h.size))}return{values:new Float32Array(a),sizes:new Float32Array(c)}};r.convertColorVariable=n;r.convertVisualVariables=function(b){const a=b&&0<b.length?{}:null,c=a?{}:null;if(!a)return{vvFields:a,vvRanges:c};for(const f of b)if(f.field&&(a[f.type]=f.field),"size"===f.type)switch(c.size||(c.size={}),b=f,q.getTypeOfSizeVisualVariable(b)){case w.WGLVVFlag.SIZE_MINMAX_VALUE:c.size.minMaxValue={minDataValue:b.minDataValue,maxDataValue:b.maxDataValue,minSize:e(b.minSize),maxSize:e(b.maxSize)};
break;case w.WGLVVFlag.SIZE_SCALE_STOPS:c.size.scaleStops={stops:g(b.stops)};break;case w.WGLVVFlag.SIZE_FIELD_STOPS:if(b.levels){const m={};for(const h in b.levels)m[h]=d(b.levels[h]);c.size.fieldStops={type:"level-dependent",levels:m}}else c.size.fieldStops={type:"static",...d(b.stops)};break;case w.WGLVVFlag.SIZE_UNIT_VALUE:c.size.unitValue={unit:b.valueUnit,valueRepresentation:b.valueRepresentation}}else"color"===f.type?c.color=n(f):"opacity"===f.type?c.opacity=l(f):"rotation"===f.type&&(c.rotation=
{type:f.rotationType});return{vvFields:a,vvRanges:c}};r.getVisualVariableSizeValueRepresentationRatio=function(b,a){if(!b||!a)return b;switch(a){case "radius":case "distance":return 2*b;case "area":return Math.sqrt(b)}return b};r.getVisualVariablesFields=function(b){const a=b&&0<b.length?{}:null;a&&b.forEach(c=>{const f=c.type;c.field&&(a[f]=c.field)});return a};r.normalizeSizeElement=e;r.normalizeSizeStops=g;r.stopToSizeStop=p;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports",
"../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(r,t,C,D,x){const w=C.getLogger("esri.views.2d.engine.webgl");r.getTypeOfSizeVisualVariable=function(q){if(x.isNumber(q.minDataValue)&&x.isNumber(q.maxDataValue)&&null!=q.minSize&&null!=q.maxSize)return D.WGLVVFlag.SIZE_MINMAX_VALUE;if((q.expression&&"view.scale"===q.expression||q.valueExpression&&"$view.scale"===q.valueExpression)&&Array.isArray(q.stops))return D.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=q.field||q.expression&&
"view.scale"!==q.expression||q.valueExpression&&"$view.scale"!==q.valueExpression)&&(Array.isArray(q.stops)||"levels"in q&&q.levels))return D.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=q.field||q.expression&&"view.scale"!==q.expression||q.valueExpression&&"$view.scale"!==q.valueExpression)&&null!=q.valueUnit)return D.WGLVVFlag.SIZE_UNIT_VALUE;w.error(new t("mapview-bad-type","Found invalid size VisualVariable",q));return D.WGLVVFlag.NONE};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/definitions ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m){let h=function(v){function u(z,A,E,G,H){A=new d([],[A,E]);z=v.call(this,A,G,null,z)||this;z.geohashBoundsInfo=H;return z}t._inheritsLoose(u,v);u.create=function(z,A,E,G,H,K,L,J){A=new u(A,E,G,K,L);A.displayId=z.createDisplayId(!0);A.referenceId=J;A.tileLevel=H;return A};var F=u.prototype;F.update=function(z,A,E,G,H,K){this.geometry.coords[0]=z;this.geometry.coords[1]=A;this.tileLevel=E;this.attributes=G;this.geohashBoundsInfo=H;this.referenceId=null;
this.referenceId=K;return this};F.toJSON=function(){return{objectId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null,attributes:{...this.attributes,clusterId:this.objectId},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};t._createClass(u,[{key:"count",get:function(){return this.attributes.cluster_count}}]);return u}(n.OptimizedFeatureWithGeometry);C=function(v){function u(z,A,E){var G=v.call(this,z,E)||this;G.events=new D;G._geohashLevel=0;G._tileLevel=
0;G._aggregateValueRanges={};G._aggregateValueRangesChanged=!1;G._geohashBuf=[];G._clusters=new Map;G._tiles=new Map;G.geometryInfo=z.geometryInfo;G._spatialReference=A;G._projectionSupportCheck=b.checkProjectionSupport(A,m.WGS84);G._bitsets.geohash=E.getBitset(E.createBitset());G._bitsets.inserted=E.getBitset(E.createBitset());return G}t._inheritsLoose(u,v);var F=u.prototype;F.updateSchema=function(){var z=t._asyncToGenerator(function*(A,E){const G=this._schema;try{yield v.prototype.updateSchema.call(this,
A,E),yield this._projectionSupportCheck}catch(K){}const H=q.diff(G,E);if(!E||w.isNone(H)&&!A.source&&!A.storage.filters)G&&(A.mesh=!0);else{if(q.hasDiff(H,"params.fields")||!this._tree||A.source)this._tree=new p.GeohashTree(this._statisticFields),this._rebuildTree(),x("esri-2d-update-debug")&&console.debug("Aggregate mesh needs update due to tree changing");x("esri-2d-update-debug")&&console.debug("Applying Update - ClusterStore:",H);A.targets[E.name]=!0;A.mesh=!1;this._aggregateValueRanges={}}});
return function(A,E){return z.apply(this,arguments)}}();F.clear=function(){this._rebuildTree()};F.sweepFeatures=function(z,A){this._bitsets.inserted.forEachSet(E=>{z.has(E)||(E=A.lookupByDisplayIdUnsafe(E),this._remove(E))})};F.sweepClusters=function(z,A,E){this._clusters.forEach((G,H)=>{G&&G.tileLevel!==E&&(z.releaseDisplayId(G.displayId),A.unsetAttributeData(G.displayId),this._clusters.delete(H))})};F.onTileData=function(z,A,E,G,H=!0){if(!this._schema||w.isNone(A.addOrUpdate))return A;var K=this._getTransforms(z,
this._spatialReference);{const L=A.addOrUpdate.getCursor();for(;L.next();)this._update(L,G)}if(A.status.mesh||!H)return A;G=[];this._getClustersForTile(G,z,this._schema.params.clusterRadius,E,K);A.addOrUpdate=f.FeatureSetReaderJSON.fromOptimizedFeatures(G,"esriGeometryPoint");A.addOrUpdate.attachStorage(E);A.end=!0;for(K=A.addOrUpdate.getCursor();K.next();)G=K.getDisplayId(),this._bitsets.computed.unset(G),this.setComputedAttributes(E,K,G,z.scale);this._aggregateValueRangesChanged&&A.end&&(this.events.emit("valueRangesChanged",
{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1);return A};F.onTileUpdate=function({added:z,removed:A}){z.length&&(this._tileLevel=z=z[0].level,this._setGeohashLevel(z));if(this._schema){var E=this._schema.params.clusterRadius;A.forEach(G=>{this._tiles.delete(G.key.id);this._markTileClustersForDeletion(G,E)})}};F.getAggregate=function(z){for(const A of this._clusters.values())if((null==A?void 0:A.displayId)===z)return A.toJSON();return null};F.getAggregates=function(){const z=
[];for(const A of this._clusters.values())(null==A?void 0:A.tileLevel)===this._tileLevel&&z.push(A.toJSON());return z};F.getDisplayId=function(z){return(z=this._clusters.get(z))?z.displayId:null};F.getFeatureDisplayIdsForAggregate=function(z){z=this._clusters.get(z);if(!z)return[];z=z.geohashBoundsInfo;return this._tree.getRegionDisplayIds(z.xLL,z.yLL,z.xTR,z.yTR,z.level)};F.getDisplayIdForReferenceId=function(z){for(const A of this._clusters.values())if((null==A?void 0:A.referenceId)===z)return A.displayId;
return null};F.getAggregateValueRanges=function(){return this._aggregateValueRanges};F.forEach=function(z){for(const [A,E]of this._clusters)E&&z(E,A)};F.size=function(){let z=0;this.forEach(A=>z++);return z};F._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};F._remove=function(z){const A=z.getDisplayId(),E=z.getXHydrated(),G=z.getYHydrated(),H=this._geohashBuf[2*A],K=this._geohashBuf[2*A+1];this._bitsets.inserted.has(A)&&(this._bitsets.inserted.unset(A),
this._tree.removeCursor(z,E,G,H,K,this._geohashLevel))};F._update=function(z,A){const E=z.getDisplayId(),G=this._bitsets.inserted;A=A.isVisible(E);var H=G.has(E);A!==H&&(A?(A=z.getXHydrated(),H=z.getYHydrated(),this._setGeohash(E,A,H)&&(this._tree.insertCursor(z,E,A,H,this._geohashBuf[2*E],this._geohashBuf[2*E+1],this._geohashLevel),G.set(E))):this._remove(z))};F._setGeohash=function(z,A,E){if(this._bitsets.geohash.has(z))return!0;const G=this._geohashBuf;if(this._spatialReference.isWebMercator)A=
A/e.earth.radius*57.29577951308232,g.setGeohashBuf(G,z,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-E/e.earth.radius))),A-360*Math.floor((A+180)/360),12);else{E=b.project({x:A,y:E},this._spatialReference,m.WGS84);if(!E)return!1;g.setGeohashBuf(G,z,E.y,E.x,12)}this._bitsets.geohash.set(z);return!0};F._getClustersForTile=function(z,A,E,G,H,K=!0){var L=this._schema.params.clusterPixelBuffer,J=2*E;E=this._getGeohashLevel(A.key.level);const B=Math.ceil(2**A.key.level*a.TILE_SIZE/J);var y=Math.ceil(L/
J)+0,I=Math.ceil(a.TILE_SIZE/J);const {row:S,col:O}=A.key;var Y=Math.floor(O*a.TILE_SIZE/J)-y;J=Math.floor(S*a.TILE_SIZE/J)-y;L=Y+I+2*y;y=J+I+2*y;for(I=A.tileInfoView.getLODInfoAt(A.key.level);Y<=L;Y++)for(let W=J;W<=y;W++){var R=Y;I.wrap&&(R=0>Y?Y+B:Y%B);const P=I.wrap&&0>Y,fa=I.wrap&&Y%B!==Y;R=this._lookupCluster(G,I,A.key.level,R,W,E);if(w.isSome(R)){var Q=w.andThen(H,oa=>P?oa.left:fa?oa.right:oa.tile);if((!K||!w.isNone(Q))&&R.count&&w.isSome(Q)&&K){const oa=R.geometry.clone();let pa=R.attributes;
oa.coords[0]=k.quantizeX(Q,oa.coords[0]);oa.coords[1]=k.quantizeY(Q,oa.coords[1]);1===R.count&&w.isSome(R.referenceId)&&(pa={...R.attributes,referenceId:R.referenceId});Q=new n.default(oa,pa);Q.displayId=R.displayId;z.push(Q)}}}};F._getGeohashLevel=function(z){return Math.min(Math.ceil(z/2+2),12)};F._setGeohashLevel=function(z){z=this._getGeohashLevel(z);z=1*(Math.floor(z/1)+1)-1;this._geohashLevel!==z&&(this._geohashLevel=z,this._rebuildTree(),this._bitsets.geohash.clear())};F._getTransforms=function(z,
A){const E={originPosition:"upperLeft",scale:[z.resolution,z.resolution],translate:[z.bounds[0],z.bounds[3]]};A=l.getInfo(A);if(!A)return{tile:E,left:null,right:null};const [G,H]=A.valid;return{tile:E,left:{...E,translate:[H,z.bounds[3]]},right:{...E,translate:[G-H+z.bounds[0],z.bounds[3]]}}};F._getClusterId=function(z,A,E){return(z&15)<<28|(A&16383)<<14|E&16383};F._markForDeletion=function(z,A,E){z=this._getClusterId(z,A,E);this._clusters.delete(z)};F._getClusterBounds=function(z,A,E){var G=this._schema.params.clusterRadius,
H=2*G;A=E%2?A*H:A*H-G;const K=E*H;G=A+H;E=2**z.level*a.TILE_SIZE;z.wrap&&0>A&&(A=0);z.wrap&&G>E&&(G=E);E=K/a.TILE_SIZE;G/=a.TILE_SIZE;H=(K-H)/a.TILE_SIZE;A=z.getXForColumn(A/a.TILE_SIZE);E=z.getYForRow(E);G=z.getXForColumn(G);z=z.getYForRow(H);return[A,E,G,z]};F._lookupCluster=function(z,A,E,G,H,K){const L=this._getClusterId(E,G,H),J=this._clusters.get(L),[B,y,I,S]=this._getClusterBounds(A,G,H);var O={x:B,y};H={x:I,y:S};var Y=G=A=0,R=0;if(this._spatialReference.isWebMercator)A=O.x/e.earth.radius*
57.29577951308232,A-=360*Math.floor((A+180)/360),G=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-O.y/e.earth.radius))),Y=H.x/e.earth.radius*57.29577951308232,Y-=360*Math.floor((Y+180)/360),R=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-H.y/e.earth.radius)));else{G=b.project(O,this._spatialReference,m.WGS84);H=b.project(H,this._spatialReference,m.WGS84);if(!G||!H)return null;A=G.x;G=G.y;Y=H.x;R=H.y}O={geohashX:0,geohashY:0};H={geohashX:0,geohashY:0};g.setGeohashXY(O,G,A,K);g.setGeohashXY(H,
R,Y,K);G=O.geohashX;Y=O.geohashY;R=H.geohashX;H=H.geohashY;A={xLL:G,yLL:Y,xTR:R,yTR:H,level:K};H=this._tree.getRegionStatistics(G,Y,R,H,K);const {count:Q,xTotal:W,yTotal:P,referenceId:fa}=H;K=Q?W/Q:0;G=Q?P/Q:0;if(0===Q)return this._clusters.set(L,null),null;H={cluster_count:Q,...H.attributes};z=w.isSome(J)?J.update(K,G,E,H,A,fa):h.create(z,L,K,G,E,H,A,fa);0===Q&&(z.geometry.coords[0]=(B+I)/2,z.geometry.coords[1]=(y+S)/2);this._clusters.set(L,z);this._updateAggregateValueRangeForCluster(z,z.tileLevel);
return z};F._updateAggregateValueRangeForCluster=function(z,A){const E=this._aggregateValueRanges[A]||{minValue:Infinity,maxValue:0},G=E.minValue,H=E.maxValue;E.minValue=Math.min(G,z.count);E.maxValue=Math.max(H,z.count);this._aggregateValueRanges[A]=E;if(G!==E.minValue||H!==E.maxValue)this._aggregateValueRangesChanged=!0};F._markTileClustersForDeletion=function(z,A){var E=2*A;A=Math.ceil(a.TILE_SIZE/E);const {row:G,col:H}=z.key,K=Math.floor(H*a.TILE_SIZE/E);E=Math.floor(G*a.TILE_SIZE/E);for(let L=
K;L<K+A;L++)for(let J=E;J<E+A;J++)this._markForDeletion(z.key.level,L,J)};return u}(c.Store2D);r.ClusterInfo=h;r.ClusterStore=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geohash/GeohashTree":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../core/CircularArray ../core/maybe ./geohashUtils ../views/2d/layers/features/support/FeatureSetReaderJSON".split(" "),function(r,t,C,D,x,w){let q=function(){function g(l=[],k=8096){this._nodes=0;this._root=new p(0,0,0);this._statisticFields=
l;this._pool=k?new C(8096):null}var e=g.prototype;e._acquire=function(l,k,n){this._nodes++;let d=null;D.isSome(this._pool)&&(d=this._pool.dequeue());return D.isSome(d)?d.realloc(l,k,n):new p(l,k,n)};e._release=function(l){this._nodes--;D.isSome(this._pool)&&this._pool.enqueue(l)};e.dropLevels=function(l){this._forEachNode(k=>{if(k.depth>=l)for(let n=0;n<k.children.length;n++){const d=k.children[n];k.children[n]=null;d&&this._release(d)}})};e.clear=function(){this.dropLevels(0)};e.insert=function(l,
k,n=0){const d=w.FeatureSetReaderJSON.fromOptimizedFeatures([l],"esriGeometryPoint").getCursor();d.next();const b=d.readGeometry();if(b){var [a,c]=b.coords;this.insertCursor(d,l.displayId,a,c,l.geohashX,l.geohashY,k,n)}};e.insertCursor=function(l,k,n,d,b,a,c,f=0){let m=this._root,h=0,v=0,u=0;for(;null!==m;){m.depth>=f&&(m.count+=1,m.xTotal+=n,m.yTotal+=d,m.xGeohashTotal+=b,m.yGeohashTotal+=a,m.displayId=k,this._updateStatisticsCursor(l,m,1));if(h>=c){m.add(k);break}var F=Math.ceil((h+1)/2),z=Math.floor((h+
1)/2);const E=1-h%2;var A=30-(3*F+2*z);F=30-(2*F+3*z);A=(b&7*E+3*(1-E)<<A)>>A;F=(a&3*E+7*(1-E)<<F)>>F;z=A+F*(8*E+4*(1-E));const G=2*E+3*(1-E);v=v<<3*E+2*(1-E)|A;u=u<<G|F;null==m.children[z]&&(m.children[z]=this._acquire(v,u,h+1));h+=1;m=m.children[z]}};e.remove=function(l,k){const n=w.FeatureSetReaderJSON.fromOptimizedFeatures([l],"esriGeometryPoint").getCursor();n.next();const d=n.readGeometry();if(d){var [b,a]=d.coords;this.removeCursor(n,b,a,l.geohashX,l.geohashY,k)}};e.removeCursor=function(l,
k,n,d,b,a){let c=this._root,f=0;for(;null!==c;){--c.count;c.xTotal-=k;c.yTotal-=n;c.xGeohashTotal-=d;c.yGeohashTotal-=b;this._updateStatisticsCursor(l,c,-1);if(f>=a){c.remove(l.getDisplayId());break}var m=Math.ceil((f+1)/2);const u=Math.floor((f+1)/2);var h=1-f%2,v=30-(3*m+2*u);m=30-(2*m+3*u);h=((d&7*h+3*(1-h)<<v)>>v)+((b&3*h+7*(1-h)<<m)>>m)*(8*h+4*(1-h));v=c.children[h];1===v.count&&(this._release(v),c.children[h]=null);f+=1;c=v}};e.find=function(l,k,n){return this._root.find(l,k,n,0,0,0)};e.findSingleOccupancyNode=
function(l,k,n,d,b){let a=this._root;for(;null!==a;){var c=a.depth,f=a.xNode,m=a.yNode;const A=1-c%2;var h=a.xGeohashTotal/a.count,v=a.yGeohashTotal/a.count;if(1===a.count&&l<h&&h<=n&&k<v&&v<=d)return a;if(c>=b)a=a.next;else{v=Math.ceil((c+1)/2);c=Math.floor((c+1)/2);h=30-(3*v+2*c);var u=30-(2*v+3*c),F=~((1<<h)-1),z=~((1<<u)-1);f<<=3*A+2*(1-A);m<<=2*A+3*(1-A);c=Math.max(f,(l&F)>>h);v=Math.max(m,(k&z)>>u);h=Math.min(f+8*A+4*(1-A),(n&F)>>h);u=Math.min(m+4*A+8*(1-A),(d&z)>>u);for(F=z=null;v<=u;v++)for(let E=
c;E<=h;E++){const G=a.children[E-f+(v-m)*(8*A+4*(1-A))];G&&(z||(z=G,z.next=a.next),F&&(F.next=G),F=G,G.next=a.next)}a=z||a.next}}return null};e.getRegionDisplayIds=function(l,k,n,d,b){let a=this._root;const c=[];for(;null!==a;){var f=a.depth,m=a.xNode,h=a.yNode;if(f>=b)f=a.xGeohashTotal/a.count,m=a.yGeohashTotal/a.count,l<=f&&f<=n&&k<=m&&m<=d&&a.displayIds.forEach(G=>c.push(G)),a=a.next;else{var v=Math.ceil((f+1)/2),u=Math.floor((f+1)/2);f=1-f%2;var F=30-(3*v+2*u),z=30-(2*v+3*u),A=~((1<<F)-1),E=~((1<<
z)-1);m<<=3*f+2*(1-f);h<<=2*f+3*(1-f);v=Math.max(m,(l&A)>>F);u=Math.max(h,(k&E)>>z);F=Math.min(m+8*f+4*(1-f),(n&A)>>F);z=Math.min(h+4*f+8*(1-f),(d&E)>>z);for(A=E=null;u<=z;u++)for(let G=v;G<=F;G++){const H=a.children[G-m+(u-h)*(8*f+4*(1-f))];H&&(E||(E=H,E.next=a.next),A&&(A.next=H),A=H,H.next=a.next)}a=E||a.next}}return c};e.getRegionStatistics=function(l,k,n,d,b){let a=this._root,c=0,f=0,m=0;const h={};let v=0;for(;null!==a;){var u=a.depth,F=a.xNode,z=a.yNode;if(u>=b)u=a.xGeohashTotal/a.count,F=
a.yGeohashTotal/a.count,l<u&&u<=n&&k<F&&F<=d&&(c+=a.count,f+=a.xTotal,m+=a.yTotal,1===a.count&&(v=a.displayId),this._aggregateStatistics(h,a.statistics)),a=a.next;else{var A=Math.ceil((u+1)/2),E=Math.floor((u+1)/2);u=1-u%2;var G=30-(3*A+2*E),H=30-(2*A+3*E),K=~((1<<G)-1),L=~((1<<H)-1);F<<=3*u+2*(1-u);z<<=2*u+3*(1-u);A=Math.max(F,(l&K)>>G);E=Math.max(z,(k&L)>>H);G=Math.min(F+8*u+4*(1-u),(n&K)>>G);H=Math.min(z+4*u+8*(1-u),(d&L)>>H);K=L=null;for(let J=E;J<=H;J++)for(let B=A;B<=G;B++){const y=a.children[B-
F+(J-z)*(8*u+4*(1-u))];if(y)if(J!==E&&J!==H&&B!==A&&B!==G){const I=y.xGeohashTotal/y.count,S=y.yGeohashTotal/y.count;l<I&&I<=n&&k<S&&S<=d&&(c+=y.count,f+=y.xTotal,m+=y.yTotal,1===y.count&&(v=y.displayId),this._aggregateStatistics(h,y.statistics))}else L||(L=y,L.next=a.next),K&&(K.next=y),K=y,y.next=a.next}a=L||a.next}}l=this._normalizeStatistics(h,c);return{count:c,attributes:l,xTotal:f,yTotal:m,referenceId:v}};e._forEachNode=function(l){let k=this._root;for(;null!==k;){const n=this._linkChildren(k)||
k.next;l(k);k=n}};e._linkChildren=function(l){let k=null,n=null;for(let d=0;d<=l.children.length;d++){const b=l.children[d];b&&(k||(k=b,k.next=l.next),n&&(n.next=b),n=b,b.next=l.next)}return k};e._updateStatisticsCursor=function(l,k,n){for(const c of this._statisticFields){const f=c.name,m=c.inField?l.readAttribute(c.inField):l.getComputedNumericAtIndex(c.inFieldIndex);switch(c.statisticType){case "norm":k.statistics[f]||(k.statistics[f]={});var d=l.readAttribute(c.inNormalizationField),b=k.statistics[f].onStatisticField||
0,a=k.statistics[f].onStatisticNormalizationField||0;null==m||isNaN(m)||null==d||0===d||isNaN(d)||(k.statistics[f].onStatisticField=b+n*m,k.statistics[f].onStatisticNormalizationField=a+n*d);break;case "sum":case "avg":k.statistics[f]||(k.statistics[f]={value:0,nanCount:0});d=k.statistics[f].value;b=k.statistics[f].nanCount;null==m||isNaN(m)?k.statistics[f].nanCount=b+n:k.statistics[f].value=d+n*m;break;case "avg_angle":{k.statistics[f]||(k.statistics[f]={x:0,y:0,nanCount:0});d=k.statistics[f].x;
b=k.statistics[f].y;a=k.statistics[f].nanCount;const h=Math.PI/180;null==m||isNaN(m)?k.statistics[f].nanCount=a+n:(k.statistics[f].x=d+n*Math.cos(m*h),k.statistics[f].y=b+n*Math.sin(m*h));break}case "mode":k.statistics[f]||(k.statistics[f]={}),k.statistics[f][m]=(k.statistics[f][m]||0)+n}}};e._aggregateStatistics=function(l,k){for(const n of this._statisticFields){const d=n.name;switch(n.statisticType){case "sum":case "avg":case "avg_angle":case "mode":case "norm":l[d]||(l[d]={});for(const b in k[d])l[d][b]=
(l[d][b]||0)+k[d][b]}}};e._normalizeStatistics=function(l,k){const n={};for(const b of this._statisticFields){const a=b.name;switch(b.statisticType){case "norm":var d=l[a];if(k&&null==d.onStatisticNormalizationField)break;if(k&&d.onStatisticNormalizationField){n[a]=d.onStatisticField/d.onStatisticNormalizationField;break}n[a]=0;break;case "sum":{if(!k)break;const {value:c,nanCount:f}=l[a];if(!(k-f))break;n[a]=c;break}case "avg":{if(!k)break;const {value:c,nanCount:f}=l[a];if(!(k-f))break;n[a]=c/(k-
f);break}case "avg_angle":{if(!k)break;const {x:c,y:f,nanCount:m}=l[a];if(!(k-m))break;n[a]=180/Math.PI*Math.atan2(f/(k-m),c/(k-m));break}case "mode":{d=l[a];let c=0,f=null;for(const m in d){const h=d[m];h>c&&(c=h,f=m)}n[a]="null"===f?null:f}}}return n};t._createClass(g,[{key:"count",get:function(){return this._root.count}},{key:"size",get:function(){return this._nodes}},{key:"poolSize",get:function(){return D.mapOr(this._pool,0,l=>l.size)}},{key:"depth",get:function(){let l=0;this._forEachNode(k=>
l=Math.max(l,k.depth));return l}}]);return g}(),p=function(){function g(l,k,n){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.displayId=0;this.displayIds=new Set;this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this.children=Array(32);for(let d=0;d<this.children.length;d++)this.children[d]=null;this.xNode=l;this.yNode=k;this.depth=n}var e=g.prototype;e.realloc=function(l,k,n){for(let d=0;d<this.children.length;d++)this.children[d]=null;this.xNode=
l;this.yNode=k;this.depth=n;this.next=null;this.count=this.yTotal=this.xTotal=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};this.displayIds.clear();return this};e.add=function(l){this.displayIds.add(l)};e.remove=function(l){this.displayIds.delete(l)};e.getLngLatBounds=function(){var l=this.depth;const k=Math.ceil(l/2);l=Math.floor(l/2);return x.decodeGeohashXY({geohashX:this.xNode<<30-(3*k+2*l),geohashY:this.yNode<<30-(2*k+3*l)},this.depth)};e.find=function(l,k,n,d,b,a){if(d>=n)return this;
var c=1-d%2;const f=3*c+2*(1-c),m=2*c+3*(1-c),h=30-b-f,v=30-a-m;c=this.children[((l&7*c+3*(1-c)<<h)>>h)+((k&3*c+7*(1-c)<<v)>>v)*(8*c+4*(1-c))];return null==c?null:c.find(l,k,n,d+1,b+f,a+m)};return g}();r.GeohashTree=q;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/geohash/geohashUtils":function(){define(["exports"],function(r){function t(b){return 57>=b?b-48:104>=b?b-88:107>=b?b-89:110>=b?b-90:b-91}function C(b,a,c){b[0]=a;b[1]=c;return b}function D(b,a){const c=(b[0]+b[1])/2,f=!a;b[0]=
f*b[0]+a*c;b[1]=f*c+a*b[1]}function x(b,a){a=a>(b[0]+b[1])/2;D(b,a);return a}function w(b,a){const c=C(n,-90,90),f=C(d,-180,180);for(let h=0;h<a.length;h++){var m=a.charCodeAt(h);m=t(m);0===h%2?(D(f,!!(16&m)),D(f,!!(4&m)),D(f,!!(1&m)),D(c,!!(8&m)),D(c,!!(2&m))):(D(c,!!(16&m)),D(c,!!(4&m)),D(c,!!(1&m)),D(f,!!(8&m)),D(f,!!(2&m)))}b[0]=(c[0]+c[1])/2;b[1]=(f[0]+f[1])/2;return b}function q(b,a,c){let f="";const m=C(n,-90,90),h=C(d,-180,180);for(let v=0;v<c;v++){let u=0;v%2?(u|=x(m,b)<<4,u|=x(h,a)<<3,u|=
x(m,b)<<2,u|=x(h,a)<<1,u|=x(m,b)<<0):(u|=x(h,a)<<4,u|=x(m,b)<<3,u|=x(h,a)<<2,u|=x(m,b)<<1,u|=x(h,a)<<0);f+="0123456789bcdefghjkmnpqrstuvwxyz"[u]}return f}function p(b){return 180/2**Math.floor(5*b/2)}function g(b){return 360/2**Math.ceil(5*b/2)}function e(b,a){return a?1&b|(4&b)>>1|(16&b)>>2:(2&b)>>1|(8&b)>>2}function l(b,a){return a?(2&b)>>1|(8&b)>>2:1&b|(4&b)>>1|(16&b)>>2}function k(b,a,c){var f=!((b.length-1)%2);const m=b.substring(0,b.length-1);var h=t(b.charCodeAt(b.length-1)),v=0,u=0;let F=
0;var z=0;f?(v=8,u=4,F=1&h|(4&h)>>1|(16&h)>>2,z=(2&h)>>1|(8&h)>>2):(v=4,u=8,z=1&h|(4&h)>>1|(16&h)>>2,F=(2&h)>>1|(8&h)>>2);a=F+a;h=z+c;c=Math.floor(a/v);z=Math.floor(h/u);v=a-c*v;u=h-z*u;f="0123456789bcdefghjkmnpqrstuvwxyz"[f?v&1|(u&1)<<1|(v&2)<<1|(u&2)<<2|(v&4)<<2:u&1|(v&1)<<1|(u&2)<<1|(v&2)<<2|(u&4)<<2];return 1<b.length&&(c||z)?k(m,c,z)+f:m+f}const n=new Float64Array(2),d=new Float64Array(2);r.convertGeohash32ToXY=function(b,a){let c=b=0,f=30,m=30;for(let u=0;u<a.length;u++){var h=a.charCodeAt(u),
v=t(h);h=0===u%2;const F=e(v,h);v=l(v,h);f-=h?3:2;m-=h?2:3;b|=F<<f;c|=v<<m}return{geohashX:b,geohashY:c}};r.decodeBase32Char=t;r.decodeGeohash=w;r.decodeGeohashXY=function(b,a){let c=-90,f=90,m=-180,h=180;for(let E=0;E<a;E++){var v=Math.ceil((E+1)/2),u=Math.floor((E+1)/2),F=1-E%2,z=30-(3*v+2*u),A=30-(2*v+3*u);u=3*F+2*(1-F);v=2*F+3*(1-F);z=(7*F+3*(1-F)<<z&b.geohashX)>>z;F=(3*F+7*(1-F)<<A&b.geohashY)>>A;for(--u;0<=u;u--){A=(m+h)/2;const G=z&1<<u?1:0;m=(1-G)*m+G*A;h=(1-G)*A+G*h}for(--v;0<=v;v--)z=(c+
f)/2,u=F&1<<v?1:0,c=(1-u)*c+u*z,f=(1-u)*z+u*f}return[m,c,h,f]};r.encodeBase32Char=function(b){return"0123456789bcdefghjkmnpqrstuvwxyz"[b]};r.encodeGeohash=q;r.forEachIntersectingGeohash=function(b,a,c,f,m,h){var v=Math.abs(c-b),u=Math.abs(f-a);const F=p(m),z=g(m);u=Math.ceil(u/z);v=Math.ceil(v/F);m=q(b,a,m);for(let A=0;A<u;A++)for(let E=0;E<v;E++){const G=k(m,A,E),[H,K]=w([0,0],G);h(G,Math.abs((Math.min(c,H+F/2)-Math.max(b,H-F/2))*(Math.min(f,K+z/2)-Math.max(a,K-z/2)))/(F*z))}};r.getIntersectingGeohashes=
function(b,a,c,f,m){c=Math.abs(c-b);f=Math.abs(f-a);var h=p(m);const v=g(m);f=Math.ceil(f/v);c=Math.ceil(c/h);b=q(b,a,m);a=[];for(m=0;m<f;m++)for(h=0;h<c;h++)a.push(k(b,m,h));return a};r.getRelativeGeohash=k;r.latDistPerGeohash=p;r.lonDistPerGeohash=g;r.setGeohashBuf=function(b,a,c,f,m){m%2&&(m+=1);let h=0,v=0,u=-90,F=90,z=-180,A=180;for(let K=0;K<m/2;K++){for(var E=0;5>E;E++){var G=(z+A)/2,H=f>G?1:0;h|=H<<29-(E+5*K);z=(1-H)*z+H*G;A=(1-H)*G+H*A}for(E=0;5>E;E++)G=(u+F)/2,H=c>G?1:0,v|=H<<29-(E+5*K),
u=(1-H)*u+H*G,F=(1-H)*G+H*F}b[2*a]=h;b[2*a+1]=v};r.setGeohashXY=function(b,a,c,f){f%2&&(f+=1);let m=0,h=0,v=-90,u=90,F=-180,z=180;for(let H=0;H<f/2;H++){for(var A=0;5>A;A++){var E=(F+z)/2,G=c>E?1:0;m|=G<<29-(A+5*H);F=(1-G)*F+G*E;z=(1-G)*E+G*z}for(A=0;5>A;A++)E=(v+u)/2,G=a>E?1:0,h|=G<<29-(A+5*H),v=(1-G)*v+G*E,u=(1-G)*E+G*u}b.geohashX=m;b.geohashY=h};r.unpackXBits=e;r.unpackYBits=l;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports",
"../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(r,t,C,D){function x(q,p,g){if(!(q.length>p))for(;q.length<=p;)q.push(g)}let w=function(){function q(){this._numerics=[];this._strings=[];this._idGenerator=new C.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var p=q.prototype;p.createBitset=function(){const g=this._bitsets.length;this._bitsets.push(D.StaticBitSet.create(this._allocatedSize,t.DISPLAY_ID_TEXEL_MASK));
return g+1};p.getBitset=function(g){return this._bitsets[g-1]};p._expand=function(){this._allocatedSize<<=1;for(const g of this._bitsets)g.resize(this._allocatedSize)};p._ensureNumeric=function(g,e){this._numerics[g]||(this._numerics[g]=[]);x(this._numerics[g],e,0)};p._ensureInstanceId=function(g){x(this._instanceIds,g,0)};p._ensureString=function(g,e){this._strings[g]||(this._strings[g]=[]);x(this._strings[g],e,null)};p.createDisplayId=function(g=!1){const e=this._idGenerator.createId();e>this._allocatedSize&&
this._expand();return t.createDisplayId(e,g)};p.releaseDisplayId=function(g){for(const e of this._bitsets)e.unset(g);return this._idGenerator.releaseId(g&t.DISPLAY_ID_TEXEL_MASK)};p.getComputedNumeric=function(g,e){return this.getComputedNumericAtIndex(g&t.DISPLAY_ID_TEXEL_MASK,0)};p.setComputedNumeric=function(g,e,l){return this.setComputedNumericAtIndex(g&t.DISPLAY_ID_TEXEL_MASK,l,0)};p.getComputedString=function(g,e){return this.getComputedStringAtIndex(g&t.DISPLAY_ID_TEXEL_MASK,0)};p.setComputedString=
function(g,e,l){return this.setComputedStringAtIndex(g&t.DISPLAY_ID_TEXEL_MASK,0,l)};p.getComputedNumericAtIndex=function(g,e){g&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(e,g);return this._numerics[e][g]};p.setComputedNumericAtIndex=function(g,e,l){g&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(e,g);this._numerics[e][g]=l};p.getInstanceId=function(g){g&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(g);return this._instanceIds[g]};p.setInstanceId=function(g,e){g&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(g);
this._instanceIds[g]=e};p.getComputedStringAtIndex=function(g,e){g&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(e,g);return this._strings[e][g]};p.setComputedStringAtIndex=function(g,e,l){g&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(e,g);this._strings[e][g]=l};p.getXMin=function(g){return this._bounds[4*(g&t.DISPLAY_ID_TEXEL_MASK)]};p.getYMin=function(g){return this._bounds[4*(g&t.DISPLAY_ID_TEXEL_MASK)+1]};p.getXMax=function(g){return this._bounds[4*(g&t.DISPLAY_ID_TEXEL_MASK)+2]};p.getYMax=function(g){return this._bounds[4*
(g&t.DISPLAY_ID_TEXEL_MASK)+3]};p.setBounds=function(g,e){e=e.readHydratedGeometry();if(!e||!e.coords.length)return!1;let l=Infinity,k=Infinity,n=-Infinity,d=-Infinity;e.forEachVertex((b,a)=>{l=Math.min(l,b);k=Math.min(k,a);n=Math.max(n,b);d=Math.max(d,a)});g&=t.DISPLAY_ID_TEXEL_MASK;x(this._bounds,4*g+4,0);this._bounds[4*g]=l;this._bounds[4*g+1]=k;this._bounds[4*g+2]=n;this._bounds[4*g+3]=d;return!0};return q}();r.ComputedAttributeStorage=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports",
"../../../engine/webgl/DisplayId"],function(r,t){let C=function(){function D(){this._freeIds=[];this._idCounter=1}var x=D.prototype;x.createId=function(w=!1){return t.createDisplayId(this._getFreeId(),w)};x.releaseId=function(w){this._freeIds.push(w)};x._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return D}();r.DisplayIdGenerator=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/has ../../../../../chunks/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(r,t,C,D,x,w,q){const p={added:[],removed:[]},g=new Set,e=new q(0,0,0,0);return function(l){function k(d){var b=l.call(this)||this;b._tiles=new Map;b._index=D.rbush(9,C("esri-csp-restrictions")?a=>({minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);b.tiles=[];b.tileScheme=d;return b}r._inheritsLoose(k,l);var n=k.prototype;n.destroy=function(){this.clear()};n.clear=function(){this.tiles.length=0;this._tiles.clear();
this._index.clear()};n.has=function(d){return this._tiles.has(d)};n.get=function(d){return this._tiles.get(d)};n.boundsIntersections=function(d){return this._index.search({minX:d[0],minY:d[1],maxX:d[2],maxY:d[3]})};n.updateTiles=function(d){const b={added:[],removed:[]};for(const a of d.added)if(!this.has(a)){const c=new x.Tile(this.tileScheme,a);this._tiles.set(a,c);this._index.insert(c);b.added.push(c)}for(const a of d.removed)this.has(a)&&(d=this.get(a),this._tiles.delete(a),this._index.remove(d),
b.removed.push(d));this.tiles.length=0;this._tiles.forEach(a=>this.tiles.push(a));(b.added.length||b.removed.length)&&this.emit("update",b)};n.setViewState=function(d){if(d=this.tileScheme.getTileCoverage(d,0)){var {spans:b,lodInfo:a}=d,{level:c}=a;if(0<b.length)for(const {row:m,colFrom:h,colTo:v}of b)for(var f=h;f<=v;f++){const u=e.set(c,m,a.normalizeCol(f),a.getWorldForColumn(f)).id;g.add(u);if(!this.has(u)){const F=new x.Tile(this.tileScheme,u);this._tiles.set(u,F);this._index.insert(F);this.tiles.push(F);
p.added.push(F)}}for(c=this.tiles.length-1;0<=c;c--)f=this.tiles[c],g.has(f.id)||(this._tiles.delete(f.id),this.tiles.splice(c,1),this._index.remove(f),p.removed.push(f));(p.added.length||p.removed.length)&&this.emit("update",p);w.pool.release(d);g.clear();p.added.length=0;p.removed.length=0}};return k}(t)})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../rest/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(r,t,C,D,x,w,q){let p=function(){function g(l,k){this.key=new q(0,0,0,0);this.bounds=x.create();this.objectIds=new Set;this.key.set(k);k=l.getLODInfoAt(this.key);this.tileInfoView=l;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=k.resolution;this.scale=k.scale;this.level=k.level}var e=g.prototype;e.createChildTiles=function(){const l=this.key.getChildKeys(),k=C.acquire();for(let n=0;n<l.length;n++)k[n]=new g(this.tileInfoView,l[n]);return k};e.getQuantizationParameters=
function(){return w.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};t._createClass(g,[{key:"id",get:function(){return this.key.id}},{key:"extent",get:function(){return D.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,
this.resolution],translate:[this.bounds[0],this.bounds[3]]}}}]);return g}();r.Tile=p;r.default=p;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(r,t){let C=function(){function D(w,q,p,g){this.set(w,q,p,g)}D.getId=function(w,q,p,g){return"object"===typeof w?`${w.level}/${w.row}/${w.col}/${w.world}`:`${w}/${q}/${p}/${g}`};var x=D.prototype;x.acquire=function(w,q,p,g){this.set(w,
q,p,g)};x.contains=function(w){const q=w.level-this.level;return this.row===w.row>>q&&this.col===w.col>>q&&this.world===w.world};x.equals=function(w){return this.level===w.level&&this.row===w.row&&this.col===w.col&&this.world===w.world};x.clone=function(){return new D(this)};x.release=function(){this.world=this.col=this.row=this.level=0};x.set=function(w,q,p,g){if(null==w)this.world=this.col=this.row=this.level=0;else if("object"===typeof w)this.level=w.level||0,this.row=w.row||0,this.col=w.col||
0,this.world=w.world||0;else if("string"===typeof w){const [e,l,k,n]=w.split("/");this.level=parseFloat(e);this.row=parseFloat(l);this.col=parseFloat(k);this.world=parseFloat(n)}else this.level=+w,this.row=+q,this.col=+p,this.world=+g||0;return this};x.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};x.getParentKey=function(){return 0>=this.level?null:new D(this.level-1,this.row>>1,this.col>>1,this.world)};x.getChildKeys=function(){const w=this.level+1,q=this.row<<
1,p=this.col<<1,g=this.world;return[new D(w,q,p,g),new D(w,q,p+1,g),new D(w,q+1,p,g),new D(w,q+1,p+1,g)]};x.compareRowMajor=function(w){return this.row<w.row?-1:this.row>w.row?1:this.col<w.col?-1:this.col>w.col?1:0};r._createClass(D,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(w){this.set(w)}},{key:"hash",get:function(){return(this.world&3)<<30|(this.col&4095)<<22|(this.row&4095)<<8|this.level&63}}]);return D}();C.pool=new t(C,null,null,25,
50);return C})},"esri/views/2d/tiling/TileCoverage":function(){define(["../../../core/ObjectPool"],function(r){let t=function(){function C(){this.spans=[]}var D=C.prototype;D.acquire=function(x){this.lodInfo=x};D.release=function(){this.lodInfo=null;this.spans.length=0};D.forEach=function(x,w){const {spans:q,lodInfo:p}=this,{level:g}=p;if(0!==q.length)for(const {row:e,colFrom:l,colTo:k}of q)for(let n=l;n<=k;n++)x.call(w,g,e,p.normalizeCol(n),p.getWorldForColumn(n))};return C}();t.pool=new r(t);return t})},
"esri/views/2d/tiling/TileInfoView":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(r,t,C,D,x,w){const q=new x("0/0/0/0");let p=function(){function e(k,n,d,b,a,c,f,m){this.x=k;this.ymin=n;this.ymax=d;this.invM=b;this.leftAdjust=a;this.rightAdjust=c;this.leftBound=f;this.rightBound=m}e.create=function(k,n){k[1]>n[1]&&([k,n]=[n,k]);const [d,b]=k,[a,c]=n;k=a-d;n=c-b;n=0!==n?
k/n:0;const f=(Math.ceil(b)-b)*n,m=(Math.floor(b)-b)*n;return new e(d,Math.floor(b),Math.ceil(c),n,0>k?f:m,0>k?m:f,0>k?a:d,0>k?d:a)};var l=e.prototype;l.incrRow=function(){this.x+=this.invM};l.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};l.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return e}();const g=[[0,0],[0,0],[0,0],[0,0]];return function(){function e(k,n=null){this.tileInfo=k;this.fullExtent=n;this.scales=[];this._lodInfos=
null;this._infoByScale={};this._infoByLevel={};const d=k.lods.slice();d.sort(function(a,c){return c.scale-a.scale});const b=this._lodInfos=d.map(a=>C.create(k,a,n));d.forEach((a,c)=>{this._infoByLevel[a.level]=b[c];this._infoByScale[a.scale]=b[c];this.scales[c]=a.scale},this);this._wrap=k.isWrappable}var l=e.prototype;l.getLODInfoAt=function(k){return this._infoByLevel["number"===typeof k?k:k.level]};l.getTileBounds=function(k,n,d=!1){q.set(n);return(n=this._infoByLevel[q.level])?n.getTileBounds(k,
q,d):k};l.getTileCoords=function(k,n,d=!1){q.set(n);return(n=this._infoByLevel[q.level])?n.getTileCoords(k,q,d):k};l.getTileCoverage=function(k,n=192,d="closest"){d="closest"===d?this.getClosestInfoForScale(k.scale):this.getSmallestInfoForScale(k.scale);const b=D.pool.acquire(d),a=this._wrap;var c=Infinity;let f=-Infinity;const m=b.spans;g[0][0]=g[0][1]=g[1][1]=g[3][0]=-n;g[1][0]=g[2][0]=k.size[0]+n;g[2][1]=g[3][1]=k.size[1]+n;for(h of g)k.toMap(h,h),h[0]=d.getColumnForX(h[0]),h[1]=d.getRowForY(h[1]);
k=[];var h=3;for(n=0;4>n;n++)g[n][1]===g[h][1]?h=n:(h=p.create(g[n],g[h]),c=Math.min(h.ymin,c),f=Math.max(h.ymax,f),void 0===k[h.ymin]&&(k[h.ymin]=[]),k[h.ymin].push(h),h=n);if(null==c||null==f||100<f-c)return null;for(n=[];c<f;){null!=k[c]&&(n=n.concat(k[c]));h=Infinity;var v=-Infinity;for(var u=n.length-1;0<=u;u--){var F=n[u];h=Math.min(h,F.getLeftCol());v=Math.max(v,F.getRightCol())}h=Math.floor(h);v=Math.floor(v);if(c>=d.first[1]&&c<=d.last[1])if(a)if(d.size[0]<d.worldSize[0])for(u=Math.floor(v/
d.worldSize[0]),F=Math.floor(h/d.worldSize[0]);F<=u;F++)m.push(new w(c,Math.max(d.getFirstColumnForWorld(F),h),Math.min(d.getLastColumnForWorld(F),v)));else m.push(new w(c,h,v));else h>d.last[0]||v<d.first[0]||(h=Math.max(h,d.first[0]),v=Math.min(v,d.last[0]),m.push(new w(c,h,v)));c+=1;for(h=n.length-1;0<=h;h--)v=n[h],v.ymax>=c?v.incrRow():n.splice(h,1)}return b};l.getTileParentId=function(k){q.set(k);k=this._lodInfos.indexOf(this._infoByLevel[q.level])-1;if(0>k)return null;this._getTileIdAtLOD(q,
this._lodInfos[k],q);return q.id};l.getTileResolution=function(k){return(k=this._infoByLevel["object"===typeof k?k.level:k])?k.resolution:-1};l.getTileScale=function(k){return(k=this._infoByLevel[k.level])?k.scale:-1};l.intersects=function(k,n){q.set(n);n=this._infoByLevel[q.level];const d=k.lodInfo;if(d.resolution>n.resolution){this._getTileIdAtLOD(q,d,q);var b=d.denormalizeCol(q.col,q.world);for(var a of k.spans)if(a.row===q.row&&a.colFrom<=b&&a.colTo>=b)return!0}if(d.resolution<n.resolution){const [f,
m,h,v]=k.spans.reduce((u,F)=>{u[0]=Math.min(u[0],F.row);u[1]=Math.max(u[1],F.row);u[2]=Math.min(u[2],F.colFrom);u[3]=Math.max(u[3],F.colTo);return u},[Infinity,-Infinity,Infinity,-Infinity]);b=n.denormalizeCol(q.col,q.world);k=d.getColumnForX(n.getXForColumn(b));a=d.getRowForY(n.getYForRow(q.row));b=d.getColumnForX(n.getXForColumn(b+1))-1;n=d.getRowForY(n.getYForRow(q.row+1))-1;return!(k>v||b<h||a>m||n<f)}const c=d.denormalizeCol(q.col,q.world);return k.spans.some(f=>f.row===q.row&&f.colFrom<=c&&
f.colTo>=c)};l.normalizeBounds=function(k,n,d){k[0]=n[0];k[1]=n[1];k[2]=n[2];k[3]=n[3];this._wrap&&(n=t.getInfo(this.tileInfo.spatialReference),d=-d*(n.valid[1]-n.valid[0]),k[0]+=d,k[2]+=d);return k};l.getSmallestInfoForScale=function(k){const n=this.scales;if(this._infoByScale[k])return this._infoByScale[k];if(k>n[0])return this._infoByScale[n[0]];for(let d=1;d<n.length-1;d++)if(k>n[d]+1E-6)return this._infoByScale[n[d-1]];return this._infoByScale[n[n.length-1]]};l.getClosestInfoForScale=function(k){const n=
this.scales;if(this._infoByScale[k])return this._infoByScale[k];k=n.reduce((d,b)=>Math.abs(b-k)<Math.abs(d-k)?b:d,n[0]);return this._infoByScale[k]};l.scaleToLevel=function(k){const n=this.scales;if(this._infoByScale[k])return this._infoByScale[k].level;for(let d=n.length-1;0<=d;d--)if(k<n[d])return d===n.length-1?this._infoByScale[n[n.length-1]].level:this._infoByScale[n[d]].level+(n[d]-k)/(n[d]-n[d+1]);return this._infoByScale[n[0]].level};l.scaleToZoom=function(k){return this.tileInfo.scaleToZoom(k)};
l._getTileIdAtLOD=function(k,n,d){const b=this._infoByLevel[d.level];k.set(d);if(n.resolution<b.resolution)return null;if(n.resolution===b.resolution)return k;k.level=n.level;k.col=Math.floor(d.col*b.resolution/n.resolution+.01);k.row=Math.floor(d.row*b.resolution/n.resolution+.01);return k};r._createClass(e,[{key:"spatialReference",get:function(){return this.tileInfo.spatialReference}}]);return e}()})},"esri/views/2d/tiling/LODInfo":function(){define(["../../../core/maybe","../../../geometry/support/spatialReferenceUtils",
"./TileKey"],function(r,t,C){function D(w,q,p){w[0]=q;w[1]=p;return w}const x=new C("0/0/0/0");return function(){function w(p,g,e,l,k,n,d,b,a,c,f,m){this.level=p;this.resolution=g;this.scale=e;this.origin=l;this.first=k;this.last=n;this.size=d;this.norm=b;this.worldStart=a;this.worldEnd=c;this.worldSize=f;this.wrap=m}w.create=function(p,g,e=null){var l=t.getInfo(p.spatialReference);const k=g.origin||[p.origin.x,p.origin.y],n=[p.size[0]*g.resolution,p.size[1]*g.resolution],d=[-Infinity,-Infinity],
b=[Infinity,Infinity],a=[Infinity,Infinity];r.isSome(e)&&(D(d,Math.max(0,Math.floor((e.xmin-k[0])/n[0])),Math.max(0,Math.floor((k[1]-e.ymax)/n[1]))),D(b,Math.max(0,Math.floor((e.xmax-k[0])/n[0])),Math.max(0,Math.floor((k[1]-e.ymin)/n[1]))),D(a,b[0]-d[0]+1,b[1]-d[1]+1));const {cols:c,rows:f}=g;!e&&c&&f&&(D(d,c[0],f[0]),D(b,c[1],f[1]),D(a,c[1]-c[0]+1,f[1]-f[0]+1));let m;p.isWrappable?(p=[Math.ceil(Math.round((l.valid[1]-l.valid[0])/g.resolution)/p.size[0]),a[1]],l=[Math.floor((l.origin[0]-k[0])/n[0]),
d[1]],e=[p[0]+l[0]-1,b[1]],m=!0):(l=d,e=b,p=a,m=!1);return new w(g.level,g.resolution,g.scale,k,d,b,a,n,l,e,p,m)};var q=w.prototype;q.normalizeCol=function(p){if(!this.wrap)return p;const g=this.worldSize[0];return 0>p?g-1-Math.abs((p+1)%g):p%g};q.denormalizeCol=function(p,g){return this.wrap?this.worldSize[0]*g+p:p};q.getWorldForColumn=function(p){return this.wrap?Math.floor(p/this.worldSize[0]):0};q.getFirstColumnForWorld=function(p){return p*this.worldSize[0]+this.first[0]};q.getLastColumnForWorld=
function(p){return p*this.worldSize[0]+this.first[0]+this.size[0]-1};q.getColumnForX=function(p){return(p-this.origin[0])/this.norm[0]};q.getXForColumn=function(p){return this.origin[0]+p*this.norm[0]};q.getRowForY=function(p){return(this.origin[1]-p)/this.norm[1]};q.getYForRow=function(p){return this.origin[1]-p*this.norm[1]};q.getTileBounds=function(p,g,e=!1){x.set(g);var l=e?x.col:this.denormalizeCol(x.col,x.world),k=x.row;g=this.getXForColumn(l);e=this.getYForRow(k+1);l=this.getXForColumn(l+1);
k=this.getYForRow(k);p[0]=g;p[1]=e;p[2]=l;p[3]=k;return p};q.getTileCoords=function(p,g,e=!1){x.set(g);g=e?x.col:this.denormalizeCol(x.col,x.world);Array.isArray(p)?D(p,this.getXForColumn(g),this.getYForRow(x.row)):(p.x=this.getXForColumn(g),p.y=this.getYForRow(x.row));return p};return w}()})},"esri/views/2d/tiling/TileSpan":function(){define(function(){return function(r,t,C){this.row=r;this.colFrom=t;this.colTo=C}})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/BidiText ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/set ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/accessorSupport/diffUtils ../../../../../geometry/SpatialReference ../../../engine/webgl/DisplayId ../../../engine/webgl/mesh/MeshData ../../../engine/webgl/mesh/factories/WGLMeshFactory ../../../engine/webgl/mesh/templates/WGLTemplateStore ../../../engine/webgl/util/Matcher ../textUtils ./BaseProcessor ../support/ResourceManagerProxy".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h,v,u){function F(A,E){return(!A.minScale||A.minScale>=E)&&(!A.maxScale||A.maxScale<=E)}function z(A){A=A.message;const E={message:{data:{},tileKey:A.tileKey,tileKeyOrigin:A.tileKeyOrigin},transferList:[]};for(const K in A.data){var G=A.data[K];E.message.data[K]=null;if(q.isSome(G)){var H=G.stride;const L=G.indices.slice(0),J=G.vertices.slice(0),B=G.records.slice(0);G=q.andThen(G.metrics,y=>y.slice(0));H={stride:H,indices:L,vertices:J,records:B,metrics:G};
E.transferList.push(L,J,B);E.message.data[K]=H}}return E}w.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");D=function(A){function E(){var H=A.apply(this,arguments)||this;H.type="symbol";H._matchers={feature:null,aggregate:null};H._bufferData=new Map;H._bufferIds=new Map;return H}r._inheritsLoose(E,A);var G=E.prototype;G.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._resourceManagerProxy=new u(this.remoteClient)};G.destroy=
function(){this._resourceManagerProxy.destroy()};G.forEachBufferId=function(H){this._bufferIds.forEach(K=>{K.forEach(H)})};G.update=function(){var H=r._asyncToGenerator(function*(K,L){L=L.schema.processors[0];if("symbol"===L.type){var J=n.diff(this._schema,L);n.hasDiff(J,"mesh")&&(x("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",J),K.mesh=!0,K.why.mesh.push("Symbology changed"),this._schema=L,this._factory=this._createFactory(L),this._factory.update(L,this.tileStore.tileScheme.tileInfo))}});
return function(K,L){return H.apply(this,arguments)}}();G.onTileMessage=function(H,K,L,J){p.throwIfAborted(J);return this._onTileData(H,K,L,J)};G.onTileClear=function(H){this._bufferData.delete(H.key.id);this._bufferIds.delete(H.key.id);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:H.id,data:{clear:!0}})};G.onTileError=function(H,K,L){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:H.id,error:K},{signal:L.signal})};G.onTileUpdate=function(H){for(const K of H.removed)this._bufferData.has(K.key.id)&&
this._bufferData.delete(K.key.id),this._bufferIds.has(K.key.id)&&this._bufferIds.delete(K.key.id);for(const K of H.added)this._bufferData.forEach(L=>{for(const J of L)J.message.tileKey===K.id&&this._updateTileMesh("append",K,z(J),[],!1,!1,null)})};G._addBufferData=function(H,K){this._bufferData.has(H)||this._bufferData.set(H,[]);this._bufferData.get(H).push(z(K))};G._createFactory=function(H){const {geometryType:K,objectIdField:L,fields:J}=this.service,B=d.fromJSON(this.spatialReference),y={geometryType:K,
fields:J,spatialReference:B},I=new f.WGLTemplateStore((Y,R)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",Y,R),this.tileStore.tileScheme.tileInfo),{matcher:S,aggregateMatcher:O}=H.mesh;this._store=I;this._matchers.feature=m.createMatcher(S,I,y,this._resourceManagerProxy);this._matchers.aggregate=q.andThen(O,Y=>m.createMatcher(Y,I,y,this._resourceManagerProxy));return new c.WGLMeshFactory(K,L,I)};G._onTileData=function(){var H=r._asyncToGenerator(function*(K,L,J,B){p.throwIfAborted(B);
const {type:y,addOrUpdate:I,remove:S}=L;var O=L.end;const Y=!!this._schema.mesh.sortKey;if(!I)return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:K.id,data:{type:y,addOrUpdate:null,remove:S,clear:!1,end:O,sort:Y}},B);J=this._processFeatures(K,I,J,B);try{var R=yield J;if(q.isNone(R))return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:K.id,data:{type:y,addOrUpdate:null,remove:S,clear:!1,end:O,sort:Y}},B);O=[];for(const Q of R){R=!1;const W=Q.message.bufferIds,P=K.key.id,
fa=Q.message.tileKey;if(P!==fa&&q.isSome(W)){if(!this.tileStore.get(fa)){this._addBufferData(P,Q);O.push(Q);continue}let oa=this._bufferIds.get(fa);oa||(oa=new Set,this._bufferIds.set(fa,oa));const pa=Array.from(W);for(const sa of pa)if(oa.has(sa)){R=!0;break}else oa.add(sa)}R||(this._addBufferData(P,Q),O.push(Q))}yield p.all(O.map(Q=>{const W=K.key.id===Q.message.tileKey;return this._updateTileMesh(y,K,Q,W?L.remove:[],W&&L.end,L.clear,B.signal)}))}catch(Q){this._handleError(K,Q,B)}});return function(K,
L,J,B){return H.apply(this,arguments)}}();G._updateTileMesh=function(){var H=r._asyncToGenerator(function*(K,L,J,B,y,I,S){I=J.message.tileKey;const O=!!this._schema.mesh.sortKey;I!==L.key.id&&(y=!1);L=q.andThen(J,Y=>Y.message);J=q.andThen(J,Y=>Y.transferList)||[];K={type:K,addOrUpdate:L,remove:B,clear:!1,end:y,sort:O};S={transferList:q.unwrap(J)||[],signal:S};p.throwIfAborted(S);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:I,data:K},S)});return function(K,L,J,B,y,I,S){return H.apply(this,
arguments)}}();G._processFeatures=function(){var H=r._asyncToGenerator(function*(K,L,J,B){if(q.isNone(L)||!L.hasFeatures)return null;const y={transform:K.transform,hasZ:!1,hasM:!1},I=this._factory,S={viewingMode:"",scale:K.scale},O=yield this._matchers.feature,Y=yield this._matchers.aggregate;p.throwIfAborted(B);const R=this._getLabelInfos(K,L);yield I.analyze(L.getCursor(),this._resourceManagerProxy,O,Y,y,S);p.throwIfAborted(B);return this._writeFeatureSet(K,L,y,R,I,J)});return function(K,L,J,B){return H.apply(this,
arguments)}}();G._writeFeatureSet=function(H,K,L,J,B,y){var I=K.getSize();y=new a.MeshData(H.key.id,{features:I,records:I,metrics:0},this._schema.mesh.matcher.stride,y,!0);I={viewingMode:"",scale:H.scale};for(K=K.getCursor();K.next();)try{const S=K.getDisplayId(),O=q.isSome(J)?J.get(S):null;B.writeCursor(y,K,L,I,H.level,O)}catch(S){}return y.serialize(H.tileInfoView.tileInfo.isWrappable)};G._handleError=function(H,K,L){if(!p.isAbortError(K))return this.remoteClient.invoke("tileRenderer.onTileError",
{tileKey:H.id,error:K.message},{signal:L.signal})};G._getLabelingSchemaForScale=function(H){var K=this._schema.mesh.labels;if(q.isNone(K))return null;if("subtype"===K.type){const L={type:"subtype",classes:{}};let J=!1;for(const B in K.classes){const y=K.classes[B].filter(I=>F(I,H.scale));J=J||!!y.length;L.classes[B]=y}return J?L:null}K=K.classes.filter(L=>F(L,H.scale));return K.length?{type:"simple",classes:K}:null};G._getLabels=function(H,K){if("subtype"===K.type){var L;const J=q.unwrapOrThrow(this.service.subtypeField,
"Expected to find subtype Field");H=H.readAttribute(J);return null==H?[]:null!=(L=K.classes[H])?L:[]}return K.classes};G._getLabelInfos=function(H,K){H=this._getLabelingSchemaForScale(H);if(q.isNone(H))return null;const L=new Map;for(K=K.getCursor();K.next();){const B=K.getDisplayId(),y=[],I=b.isAggregateId(B),S=I&&1!==K.readAttribute("cluster_count")?"aggregate":"feature";var J=this._getLabels(K,H);for(const O of J){if(O.target!==S)continue;J=K.getStorage();J=I&&"feature"===S?J.getComputedStringAtIndex(K.readAttribute("referenceId"),
O.fieldIndex):J.getComputedStringAtIndex(B,O.fieldIndex);if(!J)continue;J=C.bidiText(J.toString());const Y=J[1];this._store.getMosaicItem(O.symbol,h.codepoints(J[0])).then(R=>{y[O.index]={glyphs:R.glyphMosaicItems,rtl:Y,index:O.index}})}L.set(B,y)}return L};r._createClass(E,[{key:"supportsTileUpdates",get:function(){return!0}}]);return E}(v);return D=t.__decorate([k.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],D)})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],
function(r,t){const C=new t;r.bidiText=function(D){if(!C.hasBidiChar(D))return[D,!1];let x;x="rtl"===C.checkContextual(D)?"IDNNN":"ICNNN";return[C.bidiTransform(D,x,"VLYSN"),!0]};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n){function d(a){switch(a){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function b(a){switch(a){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}C=function(){function a(f,m,h,v,u){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,
isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=m;this.tileKey=f;this._hasAggregate=v;this._pixelBufferEnabled=u;this._strideOptions=h}var c=a.prototype;c.serialize=function(f){const m=[];m.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((h,v)=>{var u=1<<v;v=d(u);u=b(u);v=n.getPow2NeighborKey(new x(this.tileKey),v,u,f);v=this._serializeTileVertexData(this.tileKey,v.id,h.vertexData);v.message.bufferIds=h.displayIds;m.push(v)});
return m};c._serializeTileVertexData=function(f,m,h){var v,u,F,z,A;const E=[];h={[e.WGLGeometryType.MARKER]:null==(v=h.get(e.WGLGeometryType.MARKER))?void 0:v.serialize(E),[e.WGLGeometryType.FILL]:null==(u=h.get(e.WGLGeometryType.FILL))?void 0:u.serialize(E),[e.WGLGeometryType.LINE]:null==(F=h.get(e.WGLGeometryType.LINE))?void 0:F.serialize(E),[e.WGLGeometryType.TEXT]:null==(z=h.get(e.WGLGeometryType.TEXT))?void 0:z.serialize(E),[e.WGLGeometryType.LABEL]:null==(A=h.get(e.WGLGeometryType.LABEL))?void 0:
A.serialize(E)};return{message:{tileKeyOrigin:f,tileKey:m,data:h},transferList:E}};c.featureStart=function(f,m){this._current.insertAfter=f;this._current.sortKey=m};c.featureEnd=function(){};c.recordStart=function(f,m,h,v){this._current.writer=this._getVertexWriter(h);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=v;this._current.id=f;this._current.materialKey=m;this._current.geometryType=
h;this._current.isDotDensity=!1;this._current.writer.recordStart()};c.recordCount=function(){return this._current.writer.recordCount};c.vertexCount=function(){return this._current.writer.vertexCount};c.indexCount=function(){return this._current.writer.indexCount};c.vertexEnsureSize=function(f){this._current.writer.vertexEnsureSize(f)};c.indexEnsureSize=function(f){this._current.writer.indexEnsureSize(f)};c.vertexBounds=function(f,m,h,v){this._current.bufferingEnabled&&this._addOverlap(f,m,h,v)};c.vertexWrite=
function(f){this._current.writer.writeVertex(f)};c.vertexWriteF32=function(f){this._current.writer.writeVertexF32(f)};c.vertexEnd=function(){};c.vertexWriter=function(){return this._current.writer.vertexWriter};c.indexWrite=function(f){this._current.writer.writeIndex(f)};c.indexWriter=function(){return this._current.writer.indexWriter};c.metricWriter=function(){return this._current.writer.metricWriter};c.metricStart=function(f,m,h,v,u,F,z,A){this._current.writer=this._getVertexWriter(e.WGLGeometryType.LABEL);
const E=this._current.writer.metricWriter;E.push(g.getDisplayIdTexel(f));E.push(m);E.push(h);E.push(v);E.push(u);E.push(F);E.push(z);E.push(A);E.push(255);this._current.metricBoxLenPointer=E.push(0)};c.metricEnd=function(){const f=this._current.writer.metricWriter;0===f.getValue(this._current.metricBoxLenPointer)&&f.seek(f.length-10)};c.metricBoxWrite=function(f,m,h,v){const u=this._current.writer.metricWriter;u.incr(this._current.metricBoxLenPointer);u.push(0);u.push(0);u.push(f);u.push(m);u.push(h);
u.push(v)};c.recordEnd=function(){var f=this._current.indexStart,m=this._current.writer.indexCount;if(f===m)return!1;this.hasRecords=!0;var h=this._current.vertStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,f,m-f,h,this._current.writer.vertexCount-h,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===e.WGLGeometryType.LABEL)return!0;f=this._current.writer;for(m=
0;8>m;m++){var v=1<<m;if(this._current.overlaps&v){this._data.neighbors[m]||(this._data.neighbors[m]={vertexData:new Map,displayIds:new Set});h=this._data.neighbors[m];var u=this._current.geometryType;if(!h.vertexData.has(u)){var F=l.getStrides(u,this._strideOptions).geometry;F=new k.VertexDataWriter(u,F,p.PATCH_PIXEL_BUFFER_ALLOC_SIZE);h.vertexData.set(u,F)}u=h.vertexData.get(this._current.geometryType);F=4096*-d(v);v=4096*-b(v);u.copyLastFrom(f,F,v);h.displayIds.add(this._current.id)}}return!0};
c._addOverlap=function(f,m,h,v){this._current.overlaps|=255^((f<0+h?148:f>=p.TILE_SIZE-h?41:189)|(m<0+v?224:m>=p.TILE_SIZE-v?7:231))};c._getVertexWriter=function(f){if(!this._data.self.has(f)){const m=this._data.self,h=l.getStrides(f,this._strideOptions).geometry;m.set(f,new k.VertexDataWriter(f,h,this.hint.records))}return this._data.self.get(f)};t._createClass(a,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);
return a}();r.MeshData=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/tiling/PagedTileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),function(r,t,C,D,x,w,q,p,g,e){function l(a,
c){a.length=0;c.forEach(f=>a.push(f));return a}const k=new Set,n=[],d=new Map,b=[0,0];C=function(a){function c(m){m=a.call(this,m)||this;m._keyToItem=new Map;m.concurrency=6;m.strategy="scale-first";m.tileInfoView=null;return m}r._inheritsLoose(c,a);var f=c.prototype;f.initialize=function(){const {concurrency:m,process:h}=this;this._queue=new e.QueueProcessor({concurrency:m,process:(v,u)=>{v=this._keyToItem.get(v);return h(v,{signal:u})},peeker:v=>v.values().next().value})};f.destroy=function(){this.clear();
this._queue.destroy();this._queue=null};f.abort=function(m){this._queue.abort("string"===typeof m?m:m.id)};f.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};f.has=function(m){return"string"===typeof m?this._keyToItem.has(m):this._keyToItem.has(m.id)};f.isOngoing=function(m){m="string"===typeof m?m:m.id;return this.has(m)&&this._queue.isOngoing(m)};f.pause=function(){this._queue.pause()};f.push=function(m,h){const v=m.key.id+"-"+h;if(this.has(v))return this.get(v);
h=this._queue.push(v);const u=()=>{this._keyToItem.delete(v);this.notifyChange("updating")};this._keyToItem.set(v,m);h.then(u,u);this.notifyChange("updating");return h};f.reset=function(){this._queue.reset();this.notifyChange("updating")};f.resume=function(){this._queue.resume()};f._peekByScaleFirst=function(m){if(!this.state)return m.values().next().value;const h=this.tileInfoView;let v=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;m.forEach(G=>{G=this._keyToItem.get(G);const H=this.tileInfoView.getTileScale(G.key);
d.has(H)||(d.set(H,[]),v=Math.max(H,v),u=Math.min(H,u));d.get(H).push(G.key);k.add(H)});let F=this.state.scale;d.has(F)||(l(n,k),n.sort((G,H)=>G-H),F=n.reduce((G,H)=>Math.abs(H-F)<Math.abs(G-F)?H:G,n[0]));F=Math.min(F,v);F=Math.max(F,u);m=d.get(F);const z=h.getClosestInfoForScale(F),A=z.getColumnForX(this.state.center[0]),E=z.getRowForY(this.state.center[1]);m.sort((G,H)=>{const K=z.denormalizeCol(G.col,G.world),L=z.denormalizeCol(H.col,H.world);return Math.sqrt((A-K)*(A-K)+(E-G.row)*(E-G.row))-Math.sqrt((A-
L)*(A-L)+(E-H.row)*(E-H.row))});k.clear();d.clear();return m[0].id};f._peekByCenterFirst=function(m){if(!this.state)return m.values().next().value;const h=this.tileInfoView,v=this.state.center;let u=Number.POSITIVE_INFINITY,F=null;m.forEach(z=>{z=this._keyToItem.get(z);h.getTileCoords(b,z.key);const A=g.distance(b,v);A<u&&(u=A,F=z.key)});return F.id};r._createClass(c,[{key:"length",get:function(){return this._queue?this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},
{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return c}(C);t.__decorate([D.property({constructOnly:!0})],C.prototype,"concurrency",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,"process",void 0);t.__decorate([D.property()],C.prototype,"state",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,"strategy",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,"tileInfoView",void 0);t.__decorate([D.property({readOnly:!0})],
C.prototype,"updating",null);return C=t.__decorate([p.subclass("esri.views.2d.tiling.PagedTileQueue")],C)})},"esri/chunks/vec2":function(){define(["exports","./common"],function(r,t){function C(R,Q){R[0]=Q[0];R[1]=Q[1];return R}function D(R,Q,W){R[0]=Q;R[1]=W;return R}function x(R,Q,W){R[0]=Q[0]+W[0];R[1]=Q[1]+W[1];return R}function w(R,Q,W){R[0]=Q[0]-W[0];R[1]=Q[1]-W[1];return R}function q(R,Q,W){R[0]=Q[0]*W[0];R[1]=Q[1]*W[1];return R}function p(R,Q,W){R[0]=Q[0]/W[0];R[1]=Q[1]/W[1];return R}function g(R,
Q){R[0]=Math.ceil(Q[0]);R[1]=Math.ceil(Q[1]);return R}function e(R,Q){R[0]=Math.floor(Q[0]);R[1]=Math.floor(Q[1]);return R}function l(R,Q,W){R[0]=Math.min(Q[0],W[0]);R[1]=Math.min(Q[1],W[1]);return R}function k(R,Q,W){R[0]=Math.max(Q[0],W[0]);R[1]=Math.max(Q[1],W[1]);return R}function n(R,Q){R[0]=Math.round(Q[0]);R[1]=Math.round(Q[1]);return R}function d(R,Q,W){R[0]=Q[0]*W;R[1]=Q[1]*W;return R}function b(R,Q,W,P){R[0]=Q[0]+W[0]*P;R[1]=Q[1]+W[1]*P;return R}function a(R,Q){const W=Q[0]-R[0];R=Q[1]-
R[1];return Math.sqrt(W*W+R*R)}function c(R,Q){const W=Q[0]-R[0];R=Q[1]-R[1];return W*W+R*R}function f(R){const Q=R[0];R=R[1];return Math.sqrt(Q*Q+R*R)}function m(R){const Q=R[0];R=R[1];return Q*Q+R*R}function h(R,Q){R[0]=-Q[0];R[1]=-Q[1];return R}function v(R,Q){R[0]=1/Q[0];R[1]=1/Q[1];return R}function u(R,Q){var W=Q[0];const P=Q[1];W=W*W+P*P;0<W&&(W=1/Math.sqrt(W),R[0]=Q[0]*W,R[1]=Q[1]*W);return R}function F(R,Q){return R[0]*Q[0]+R[1]*Q[1]}function z(R,Q,W){Q=Q[0]*W[1]-Q[1]*W[0];R[0]=R[1]=0;R[2]=
Q;return R}function A(R,Q,W,P){const fa=Q[0];Q=Q[1];R[0]=fa+P*(W[0]-fa);R[1]=Q+P*(W[1]-Q);return R}function E(R,Q){Q=Q||1;const W=2*t.RANDOM()*Math.PI;R[0]=Math.cos(W)*Q;R[1]=Math.sin(W)*Q;return R}function G(R,Q,W){const P=Q[0];Q=Q[1];R[0]=W[0]*P+W[2]*Q;R[1]=W[1]*P+W[3]*Q;return R}function H(R,Q,W){const P=Q[0];Q=Q[1];R[0]=W[0]*P+W[2]*Q+W[4];R[1]=W[1]*P+W[3]*Q+W[5];return R}function K(R,Q,W){const P=Q[0];Q=Q[1];R[0]=W[0]*P+W[3]*Q+W[6];R[1]=W[1]*P+W[4]*Q+W[7];return R}function L(R,Q,W){const P=Q[0];
Q=Q[1];R[0]=W[0]*P+W[4]*Q+W[12];R[1]=W[1]*P+W[5]*Q+W[13];return R}function J(R,Q,W,P){const fa=Q[0]-W[0];Q=Q[1]-W[1];const oa=Math.sin(P);P=Math.cos(P);R[0]=fa*P-Q*oa+W[0];R[1]=fa*oa+Q*P+W[1];return R}function B(R,Q){var W=R[0];R=R[1];const P=Q[0];Q=Q[1];let fa=W*W+R*R;0<fa&&(fa=1/Math.sqrt(fa));let oa=P*P+Q*Q;0<oa&&(oa=1/Math.sqrt(oa));W=(W*P+R*Q)*fa*oa;return 1<W?0:-1>W?Math.PI:Math.acos(W)}function y(R){return"vec2("+R[0]+", "+R[1]+")"}function I(R,Q){return R[0]===Q[0]&&R[1]===Q[1]}function S(R,
Q){const W=R[0];R=R[1];const P=Q[0];Q=Q[1];return Math.abs(W-P)<=t.EPSILON*Math.max(1,Math.abs(W),Math.abs(P))&&Math.abs(R-Q)<=t.EPSILON*Math.max(1,Math.abs(R),Math.abs(Q))}function O(R,Q,W,P,fa){let oa=Q[0]-W[0];W=Q[1]-W[1];fa=(P[0]*oa+P[1]*W)*(fa-1);oa=P[0]*fa;W=P[1]*fa;R[0]=Q[0]+oa;R[1]=Q[1]+W;return R}const Y=Object.freeze({__proto__:null,copy:C,set:D,add:x,subtract:w,multiply:q,divide:p,ceil:g,floor:e,min:l,max:k,round:n,scale:d,scaleAndAdd:b,distance:a,squaredDistance:c,length:f,squaredLength:m,
negate:h,inverse:v,normalize:u,dot:F,cross:z,lerp:A,random:E,transformMat2:G,transformMat2d:H,transformMat3:K,transformMat4:L,rotate:J,angle:B,str:y,exactEquals:I,equals:S,projectAndScale:O,len:f,sub:w,mul:q,div:p,dist:a,sqrDist:c,sqrLen:m});r.add=x;r.angle=B;r.ceil=g;r.copy=C;r.cross=z;r.dist=a;r.distance=a;r.div=p;r.divide=p;r.dot=F;r.equals=S;r.exactEquals=I;r.floor=e;r.inverse=v;r.len=f;r.length=f;r.lerp=A;r.max=k;r.min=l;r.mul=q;r.multiply=q;r.negate=h;r.normalize=u;r.projectAndScale=O;r.random=
E;r.rotate=J;r.round=n;r.scale=d;r.scaleAndAdd=b;r.set=D;r.sqrDist=c;r.sqrLen=m;r.squaredDistance=c;r.squaredLength=m;r.str=y;r.sub=w;r.subtract=w;r.transformMat2=G;r.transformMat2d=H;r.transformMat3=K;r.transformMat4=L;r.vec2=Y})},"esri/views/2d/tiling/TileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(r,t,C,D,x,w,q,p,g,e){function l(a,c){a.length=0;c.forEach(f=>a.push(f));return a}const k=new Set,n=[],d=new Map,b=[0,0];C=function(a){function c(m){m=a.call(this,m)||this;m._keyToItem=new Map;m.concurrency=6;m.strategy="scale-first";m.tileInfoView=null;return m}r._inheritsLoose(c,a);var f=c.prototype;f.initialize=function(){const {concurrency:m,process:h,strategy:v}=this;this._queue=new e.QueueProcessor({concurrency:m,process:(u,F)=>{u=this._keyToItem.get(u);return h(u,{signal:F})},peeker:"scale-first"===
v?u=>this._peekByScaleFirst(u):u=>this._peekByCenterFirst(u)})};f.destroy=function(){this.clear();this._queue.destroy();this._queue=null};f.abort=function(m){this._queue.abort("string"===typeof m?m:m.id)};f.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};f.has=function(m){return"string"===typeof m?this._keyToItem.has(m):this._keyToItem.has(m.id)};f.isOngoing=function(m){m="string"===typeof m?m:m.id;return this.has(m)&&this._queue.isOngoing(m)};f.pause=function(){this._queue.pause()};
f.push=function(m){const h=m.key.id;if(this._queue.has(h))return this._queue.get(h);const v=this._queue.push(h),u=()=>{this._keyToItem.delete(h);this.notifyChange("updating")};this._keyToItem.set(h,m);v.then(u,u);this.notifyChange("updating");return v};f.reset=function(){this._queue.reset()};f.resume=function(){this._queue.resume()};f._peekByScaleFirst=function(m){if(!this.state)return m.values().next().value;const h=this.tileInfoView;let v=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;m.forEach(G=>
{G=this._keyToItem.get(G);const H=this.tileInfoView.getTileScale(G.key);d.has(H)||(d.set(H,[]),v=Math.max(H,v),u=Math.min(H,u));d.get(H).push(G.key);k.add(H)});let F=this.state.scale;d.has(F)||(l(n,k),n.sort((G,H)=>G-H),F=n.reduce((G,H)=>Math.abs(H-F)<Math.abs(G-F)?H:G,n[0]));F=Math.min(F,v);F=Math.max(F,u);m=d.get(F);const z=h.getClosestInfoForScale(F),A=z.getColumnForX(this.state.center[0]),E=z.getRowForY(this.state.center[1]);m.sort((G,H)=>{const K=z.denormalizeCol(G.col,G.world),L=z.denormalizeCol(H.col,
H.world);return Math.sqrt((A-K)*(A-K)+(E-G.row)*(E-G.row))-Math.sqrt((A-L)*(A-L)+(E-H.row)*(E-H.row))});k.clear();d.clear();return m[0].id};f._peekByCenterFirst=function(m){if(!this.state)return m.values().next().value;const h=this.tileInfoView,v=this.state.center;let u=Number.POSITIVE_INFINITY,F=null;m.forEach(z=>{z=this._keyToItem.get(z);h.getTileCoords(b,z.key);const A=g.distance(b,v);A<u&&(u=A,F=z.key)});return F.id};r._createClass(c,[{key:"length",get:function(){return this._queue?this._queue.length:
0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return c}(C);t.__decorate([D.property({constructOnly:!0})],C.prototype,"concurrency",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,"process",void 0);t.__decorate([D.property()],C.prototype,"state",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,"strategy",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,
"tileInfoView",void 0);t.__decorate([D.property({readOnly:!0})],C.prototype,"updating",null);return C=t.__decorate([p.subclass("esri.views.2d.tiling.TileQueue")],C)})},"esri/views/2d/tiling/TileStrategy":function(){define(["../../../geometry/support/aaBoundingRect","./TileCache","./TileCoverage","./TileKey"],function(r,t,C,D){const x=new D(0,0,0,0),w=new Map,q=[],p=[];return function(){function g(l){this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy="closest";
this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=l.acquireTile;this.releaseTile=l.releaseTile;this.tileInfoView=l.tileInfoView;this.resampling=null==l.resampling||!!l.resampling;l.cachePolicy&&(this.cachePolicy=l.cachePolicy);l.coveragePolicy&&(this.coveragePolicy=l.coveragePolicy);null!=l.buffer&&(this.buffer=l.buffer);l.cacheSize&&(this._tileCache=new t(l.cacheSize,this.tileInfoView,k=>{this.releaseTile(k)}))}var e=g.prototype;e.destroy=function(){this.tileIndex.clear()};
e.update=function(l){const {resampling:k,tileIndex:n}=this,d=this.tileInfoView.getTileCoverage(l.state,this.buffer,this.coveragePolicy);p.length=0;q.length=0;w.clear();if(d){var {minScale:b,maxScale:a}=this.tileInfoView.tileInfo,{spans:c,lodInfo:f}=d,{level:m}=f,{scale:h,center:v,resolution:u}=l.state,F=!l.stationary&&h>this._previousScale;this._previousScale=h;this.tiles.length=0;if(!k&&(h>b||h<a))return this.tiles.length=0,w.clear(),n.forEach(H=>{this.releaseTile(H)}),n.clear(),p.length=0,q.length=
0,w.clear(),C.pool.release(d),!0;n.forEach(H=>H.visible=!0);var z=l=0;if(0<c.length)for(const {row:H,colFrom:K,colTo:L}of c)for(let J=K;J<=L;J++){l++;const B=x.set(m,H,f.normalizeCol(J),f.getWorldForColumn(J)).id;if(n.has(B)){var A=n.get(B);A.isReady?(w.set(B,A),z++):F||this._addParentTile(B,w)}else{if(this._tileCache&&this._tileCache.has(B)){if(A=this._tileCache.pop(B),this.tileIndex.set(B,A),A.isReady){w.set(B,A);z++;continue}}else A=this.acquireTile(x),this.tileIndex.set(B,A);F||this._addParentTile(B,
w)}}var E=z===l;n.forEach((H,K)=>{x.set(K);if(!w.has(K)){var L=this.tileInfoView.intersects(d,x),J="purge"===this.cachePolicy?x.level!==m:x.level>m;!L||!F&&E?!J&&L||q.push(K):H.isReady?J&&"purge"===this.cachePolicy&&this._hasReadyAncestor(x,m)?q.push(K):p.push(K):J&&q.push(K)}});for(var G of p)(l=n.get(G))&&l.isReady&&w.set(G,l);for(const H of q)G=n.get(H),this._tileCache?this._tileCache.add(G):this.releaseTile(G),n.delete(H);w.forEach(H=>this.tiles.push(H));n.forEach(H=>{w.has(H.key.id)||(H.visible=
!1)});this._tileCache&&this._tileCache.prune(m,v,u);C.pool.release(d);w.clear();return E}};e.clear=function(l=!0){const {tileIndex:k}=this;l&&k.forEach(n=>{this.releaseTile(n)});k.clear()};e.updateCacheSize=function(l){this._tileCache&&(this._tileCache.maxSize=l)};e._addParentTile=function(l,k){let n=null;for(;;){l=this.tileInfoView.getTileParentId(l);if(!l)break;if(this.tileIndex.has(l)){if((n=this.tileIndex.get(l))&&n.isReady){k.has(n.key.id)||k.set(n.key.id,n);break}}else if(this._tileCache&&this._tileCache.has(l)&&
(n=this._tileCache.pop(l),this.tileIndex.set(l,n),n&&n.isReady)){k.has(n.key.id)||k.set(n.key.id,n);break}}};e._hasReadyAncestor=function(l,k){const n=r.create();this.tileInfoView.getTileBounds(n,l,!0);for(const d of this.tileIndex.values())if(d.isReady&&d.key.level>=k&&d.key.level<l.level){const b=r.create();this.tileInfoView.getTileBounds(b,d.key,!0);if(r.contains(b,n))return!0}return!1};return g}()})},"esri/views/2d/tiling/TileCache":function(){define(["../../../chunks/vec2"],function(r){return function(){function t(D,
x,w){this.maxSize=D;this.tileInfoView=x;this.removedFunc=w;this._tilePerId=new Map;this._tileKeysPerLevel=[]}var C=t.prototype;C.has=function(D){return this._tilePerId.has(D)};C.get=function(D){return this._tilePerId.get(D)};C.pop=function(D){const x=this._tilePerId.get(D);if(!x)return null;const w=this._tileKeysPerLevel[x.key.level];this._tilePerId["delete"](D);for(let q=0;q<w.length;q++)if(w[q].id===D){w.splice(q,1);break}x.visible=!0;return x};C.add=function(D){D.visible=!1;const x=D.key,w=x.id;
this._tilePerId.has(w)||(this._tilePerId.set(w,D),D=x.level,this._tileKeysPerLevel[D]||(this._tileKeysPerLevel[D]=[]),this._tileKeysPerLevel[D].push(x))};C.prune=function(D,x,w){let q=this._tilePerId.size;if(!(q<=this.maxSize)){for(var p=this._tileKeysPerLevel.length-1;q>this.maxSize&&0<=p;)p!==D&&(q=this._pruneAroundCenterTile(q,x,w,p)),p--;q>this.maxSize&&(q=this._pruneAroundCenterTile(q,x,w,D))}};C._pruneAroundCenterTile=function(D,x,w,q){q=this._tileKeysPerLevel[q];if(!q||0===q.length)return D;
const {size:p,origin:g}=this.tileInfoView.tileInfo,e=w*p[0],l=w*p[1],k=[0,0],n=[0,0];for(q.sort((d,b)=>{k[0]=g.x+e*(d.col+.5);k[1]=g.y-l*(d.row+.5);n[0]=g.x+e*(b.col+.5);n[1]=g.y-l*(b.row+.5);return r.squaredDistance(k,x)-r.squaredDistance(n,x)});0<q.length&&(w=q.pop(),this._removeTile(w.id),D--,D!==this.maxSize););return D};C._removeTile=function(D){const x=this._tilePerId.get(D);this.removedFunc&&this.removedFunc(x);this._tilePerId["delete"](D)};return t}()})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(r,t,C,D,x){let w=function(){function q(g,e,l){this._start={index:0,vertex:0};l=D.getMeshSizeHint(g,e,l);e/=4;this.geometryType=g;this._records=new x(Int32Array,l.recordBytes);this._indices=new x(Uint32Array,l.indexBytes);this._vertices=new x(Uint32Array,l.vertexBytes);this._metrics=new x(Float32Array,0);this._strideInt=e}var p=q.prototype;p.serialize=function(g){const e=this._records.buffer(),
l=this._indices.buffer(),k=this._vertices.buffer(),n=this._metrics.length?this._metrics.buffer():null,d=4*this._strideInt;g.push(e,l,k);return{stride:d,records:e,indices:l,vertices:k,metrics:n}};p.vertexEnsureSize=function(g){this._vertices.ensureSize(g)};p.indexEnsureSize=function(g){this._indices.ensureSize(g)};p.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};p.recordEnd=function(g,e,l,k,n,d,b,a){this._records.push(g);this._records.push(e);
this._records.push(l);this._records.push(k);this._records.push(n);this._records.push(d);this._records.push(b);this._records.writeF32(a)};p.writeIndex=function(g){this._indices.push(g)};p.writeVertex=function(g){this._vertices.push(g)};p.writeVertexF32=function(g){this._vertices.writeF32(g)};p.copyLastFrom=function(g,e,l){var k=g._records.length-C.DISPLAY_RECORD_INT_PER_ELEMENT;const n=g._records.getValue(k),d=g._records.getValue(k+1),b=g._records.getValue(k+2),a=g._records.getValue(k+4),c=g._records.getValue(k+
6);k=g._records.getValue(k+7);const f=this._vertices.length;var m=(g._start.vertex-this._vertices.length)/this._strideInt;const h=this._indices.length,v=this.vertexCount;for(var u=g._start.index;u!==g._indices.length;u++){const F=g._indices.getValue(u);this._indices.push(F-m)}for(m=g._start.vertex;m!==g._vertices.length;m++)u=g._vertices.getValue(m),this._vertices.push(u);for(g=f;g<=this._vertices.length;g+=this._strideInt)this._vertices.i1616Add(g,e,l);this._records.push(n);this._records.push(d);
this._records.push(b);this._records.push(h);this._records.push(a);this._records.push(v);this._records.push(c);this._records.push(k)};t._createClass(q,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/C.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},
{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return q}();r.VertexDataWriter=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(r,t,C){const D=new Map;D.set(C.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});D.set(C.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});
D.set(C.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});D.set(C.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});D.set(C.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});r.getMeshHeuristic=function(x){return D.get(x)};r.getMeshSizeHint=function(x,w,q){const {indicesPerRecord:p,multiplier:g,verticesPerRecord:e}=D.get(x);return{recordBytes:q*t.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:g*
p*q*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:g*e*q*w}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function t(D,x){this._pos=0;x=x?this._roundToNearest(x,D.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(x);this._buffer=new D(this._array);this._ctor=D;this._i16View=new Int16Array(this._array)}var C=t.prototype;C._roundToNearest=function(D,x){D=Math.round(D);
return D+(x-D%x)};C._ensureSize=function(D){if(this._pos+D>=this._buffer.length){D=this._roundToNearest(1.25*(this._array.byteLength+D*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);D=new ArrayBuffer(D);const x=new this._ctor(D);x.set(this._buffer,0);this._array=D;this._buffer=x;this._i16View=new Int16Array(this._array)}};C.ensureSize=function(D){this._ensureSize(D)};C.writeF32=function(D){this._ensureSize(1);const x=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=D;this._pos++;
return x};C.push=function(D){this._ensureSize(1);const x=this._pos;this._buffer[this._pos++]=D;return x};C.writeFixed=function(D){this._buffer[this._pos++]=D};C.setValue=function(D,x){this._buffer[D]=x};C.i1616Add=function(D,x,w){this._i16View[2*D]+=x;this._i16View[2*D+1]+=w};C.getValue=function(D){return this._buffer[D]};C.incr=function(D){if(this._buffer.length<D)throw Error("Increment index overflows the target buffer");this._buffer[D]++};C.decr=function(D){this._buffer[D]--};C.writeRegion=function(D){this._ensureSize(D.length);
const x=this._pos;this._buffer.set(D,this._pos);this._pos+=D.length;return x};C.writeManyFrom=function(D,x,w){for(this._ensureSize(w-x);x!==w;x++)this.writeFixed(D._buffer[x])};C.buffer=function(){const D=this._array.slice(0,4*this._pos);this.destroy();return D};C.toArray=function(){const D=this._array,x=[];for(let w=0;w<D.byteLength/4;w++)x.push(D[w]);return x};C.seek=function(D){this._pos=D};C.destroy=function(){this._buffer=this._array=null};r._createClass(t,[{key:"length",get:function(){return this._pos}}]);
return t}()})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(r,t){function C(D,x,w,q){D=D.clone();const p=1<<D.level;x=D.col+x;w=D.row+w;q&&0>x?(D.col=x+p,--D.world):x>=p?(D.col=x-p,D.world+=1):D.col=x;D.row=w;return D}r.getPow2NeighborKey=C;r.getPow2NeighborTile=function(D,x,w){x=C(D.key,x,w,D.tileInfoView.tileInfo.isWrappable);return new t.Tile(D.tileInfoView,x)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(r,t,C,D,x,w,q,p,g,e){C=function(){function l(n,d,b){this._loadPromise=w.loadLibtess();this._geometryType=n;this._idField=d;this._templateStore=b}var k=l.prototype;k.update=function(n,d){D.isSome(n.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(n.mesh.labels,d));this._schema=n};k._createLabelTemplates=function(n,d){const b=new Map;if("simple"===n.type){for(var a of n.classes)n=p.fromLabelClass(a,d),b.set(a.index,n);return b}for(const c in n.classes){a=n.classes[c];for(const f of a)a=
p.fromLabelClass(f,d),b.set(f.index,a)}return b};k.analyze=function(){var n=t._asyncToGenerator(function*(d,b,a,c,f,m,h){if(!x.isAborted(h)){var v;"dictionary"===a.type&&(v=yield a.analyze(this._idField,d.copy(),b,f,m,h));for(b=0;d.next();){var u=void 0;u=v?v[b++]:D.isSome(c)&&q.isAggregateId(d.getDisplayId())&&1!==d.readAttribute("cluster_count")?c.match(this._idField,d,this._geometryType,f,m):a.match(this._idField,d,this._geometryType,f,m);d.setGroupId(u);if(e.isDynamicId(u)){u=this._templateStore.getDynamicTemplateGroup(u);
for(const F of u)F&&F.analyze&&F.analyze(this._templateStore,d,f,m)}}yield this._loadPromise;return this._templateStore.finalize(h)}});return function(d,b,a,c,f,m,h){return n.apply(this,arguments)}}();k.analyzeGraphics=function(){var n=t._asyncToGenerator(function*(d,b,a,c,f,m){if(!x.isAborted(m)){d=d.getCursor();for(a&&(yield a.analyze(this._idField,d.copy(),b,c,f,m));d.next();){b=d.getGroupId();if(null==b||-1===b)b=a.match(this._idField,d,d.geometryType,c,f),d.setGroupId(b);if(e.isDynamicId(b)){const h=
this._templateStore.getDynamicTemplateGroup(b);for(const v of h)v&&v.analyze&&v.analyze(this._templateStore,d,c,f)}d.setGroupId(b)}yield this._loadPromise;return this._templateStore.finalize(m)}});return function(d,b,a,c,f,m){return n.apply(this,arguments)}}();k.writeGraphic=function(n,d,b){const a=d.getGroupId(),c=d.getDisplayId(),f=this._templateStore.getTemplateGroup(a);n.featureStart(d.insertAfter,0);if(null!=c){if(e.isDynamicId(a))for(const m of f)m&&m.bindFeature(d,null,null);if(f){for(const m of f)m&&
m.write(n,d,b);n.featureEnd()}}};k.writeCursor=function(n,d,b,a,c,f){const m=d.getGroupId(),h=d.getDisplayId(),v=this._templateStore.getTemplateGroup(m),u=this._schema.mesh.sortKey;let F=0;D.isSome(u)&&(F=null!=u.fieldIndex?d.getComputedNumericAtIndex(u.fieldIndex):null!=u.field?d.readAttribute(u.field):d.readAttribute(this._idField),F*="asc"===u.order?1:-1);n.featureStart(0,null==F||isNaN(F)?0:F);if(null!=h&&v){if(e.isDynamicId(m))for(const z of v)z.bindFeature(d,b,a);for(const z of v)z.write(n,
d,c);D.isSome(f)&&n.hasRecords&&(b=f&&this._findLabelRef(v),this._writeLabels(n,d,f,b,c));n.featureEnd()}};k._findLabelRef=function(n){for(const d of n)if(d instanceof g)return d;return null};k._writeLabels=function(n,d,b,a,c){for(const f of b)if(D.isSome(f)&&f){const {glyphs:m,rtl:h,index:v}=f;b=this._labelTemplates.get(v);b.setZoomLevel(c);b.bindReferenceTemplate(a);b.bindTextInfo(m,h);b.write(n,d,null)}};t._createClass(l,[{key:"templates",get:function(){return this._templateStore}}]);return l}();
r.WGLMeshFactory=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./meshUtils ./segmentUtils ./WGLTextTemplate".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b){const a=C.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),c=(m,h="mapview-labeling")=>a.error(new t(h,m)),f=function(m){const h=new Map;return v=>{h.has(v)||h.set(v,m(v));return h.get(v)}}(m=>{let h=0;if(0===m)return Infinity;for(;!(m%2);)h++,m/=2;return h});return function(m){function h(u,F,z,A){var E,G,H;var K=m.call(this,u,z.font.size,z.haloSize||0,z.font.size,z.color&&p.premultiplyAlphaRGBAArray(z.color)||0,z.haloColor&&p.premultiplyAlphaRGBAArray(z.haloColor)||
0,z.horizontalAlignment,z.verticalAlignment,n.isMapAligned(F.labelPlacement)?1:0,z.font.decoration,!1,z.angle||0,z.xoffset,z.yoffset,z.lineWidth,z.lineHeight,null,null,null,null,null)||this;K._outLineLabelAngle=0;K._refPlacementPadding=0;K._refPlacementDirX=0;K._refPlacementDirY=0;K._refOffsetX=0;K._refOffsetY=0;K._zoomLevel=0;K.geometryType=e.WGLGeometryType.LABEL;K._allowOverrun=null!=(E=F.allowOverrun)?E:!1;K._repeatLabel=null!=(G=F.repeatLabel)?G:!0;K._labelPosition=null!=(H=F.labelPosition)?
H:"curved";E=!!F.minScale&&A.scaleToZoom(F.minScale)||0;E=D.clamp(E,0,25.5);A=!!F.maxScale&&A.scaleToZoom(F.maxScale)||255;A=D.clamp(A,0,25.5);const [L,J]=q.getAlignmentFromPlacement(F.labelPlacement);K._xAlignD=L;K._yAlignD=J;K._minZoom=E;K._maxZoom=A;K._refPlacementPadding=w.pt2px(z.haloSize)+g.TEXT_PLACEMENT_PADDING;K._repeatLabelDistance=F.repeatLabelDistance?w.pt2px(F.repeatLabelDistance):128;u=k.LabelMaterialKey.load(u);u.sdf=!0;K._materialKey=u.data;return K}r._inheritsLoose(h,m);h.fromLabelClass=
function(u,F){if("esriServerLinePlacementCenterAlong"===u.labelPlacement){const z=u.symbol;z.xoffset=0;z.yoffset=0;z.angle=0;z.font.decoration="none"}return new h(u.materialKey,u,u.symbol,F)};var v=h.prototype;v.setZoomLevel=function(u){this._zoomLevel=u};v.bindReferenceTemplate=function(u){let F=q.getXDirection(this._xAlignD),z=q.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(x.isNone(u))this._refSymbolAndPlacementOffset=l.i8888to32(0,0,Math.floor(127*F+127),Math.floor(127*z+
127));else{if("circle"===u.boundsType&&(F||z)){var A=Math.sqrt(F*F+z*z);F/=A;z/=A}A=Math.max(u.height,u.width);this._refSymbolAndPlacementOffset=l.i8888to32(4*this._refPlacementPadding,A,Math.floor(127*F+127),Math.floor(127*z+127));this._referenceSize=A;this._refPlacementDirX=F;this._refPlacementDirY=z;this._refOffsetX=u.xOffset;this._refOffsetY=u.yOffset}};v._write=function(u,F){if(!x.isNone(this._shapingInfo)){var z=this._shapingInfo,A=F.getDisplayId(),E="esriGeometryPolygon"===F.geometryType?F.readLegacyCentroid():
F.readLegacyGeometry();if(E)switch(this.current={out:u,inId:A,inShaping:z,zoomLevel:this._zoomLevel},F.geometryType){case "esriGeometryPolyline":this._placeLineLabels(E);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(E);break;default:c("mapview-labeling",`Geometry of type ${F.geometryType} is not supported`)}}};v._isVisible=function(u,F){const z=Math.floor(10*this.current.zoomLevel);return Math.floor(10*u)<=z&&z<=Math.floor(10*F)};v._placePointLabels=function(u){const {out:F,
inId:z,inShaping:A}=this.current;this._writeGlyphs(F,z,u,A)};v._placeLineLabels=function(u){u=d.smoothPaths(u.paths,this.current.inShaping.bounds.width);const F=this._placeSubdivGlyphs.bind(this),z=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const A of u)d.pathDivide(A,z,F,this._repeatLabel)};v._placeSubdivGlyphs=function(u,F,z,A){var E=f(F);z=Math.log2(Math.min(z,A-z)/(Math.sqrt(this._repeatLabelDistance)/2+this._shapedBox.width/2/2));E=Math.max(this._minZoom,this.current.zoomLevel+1-
(0===F?z:Math.min(E,z)));z=this.current.zoomLevel-E;A=this._shapedBox.width/2*2**z;this.current.inShaping.isMultiline?0===F&&this._placeStraight(u,E):this._allowOverrun&&0>z?this._placeStraightAlong(u,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(u,E):"curved"===this._labelPosition&&this._placeCurved(u,E,A)};v._placeStraight=function(u,F){const {out:z,inId:A,inShaping:E}=this.current;this._writeGlyphs(z,A,u,E,F)};v._placeCurved=function(u,F,z){const {out:A,inId:E}=this.current;
A.metricStart(E,F,u.x,u.y,0,0,0,0);const G=u.clone(),H=(180/Math.PI*u.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*u.angle%360*(254/360));this._placeFirst(G,F,1);this._placeBack(u,G,F,z,1);this._placeForward(u,G,F,z,1);this._outLineLabelAngle=Math.round(254/360*H);this._placeFirst(G,F,0);this._placeBack(u,G,F,z,0);this._placeForward(u,G,F,z,0);A.metricEnd()};v._placeStraightAlong=function(u,F){const {out:z,inId:A}=this.current;z.metricStart(A,F,u.x,u.y,0,0,0,0);const E=u.clone(),
G=(180/Math.PI*u.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*u.angle%360*(254/360));this._placeFirst(E,F,1,!0);this._outLineLabelAngle=Math.round(254/360*G);this._placeFirst(E,F,0,!0);z.metricEnd()};v._placeBack=function(u,F,z,A,E){const G=u.clone();for(u=u.backwardLength+0;G.prev()&&!(u>=A);)this._placeOnSegment(G,F,u,z,-1,E),u+=G.length+0};v._placeForward=function(u,F,z,A,E){const G=u.clone();for(u=u.remainingLength+0;G.next()&&!(u>=A);)this._placeOnSegment(G,F,u,z,1,E),u+=G.length+
0};v._placeFirst=function(u,F,z,A=!1){const E=this.current.inShaping;var G=E.glyphs;const H=this.current.zoomLevel,{out:K,inId:L}=this.current;for(const J of G)G=J.x>E.bounds.x?z:1-z,G=Math.max(0,H+Math.log2(Math.abs(J.x+J.width/2-E.bounds.x)/(G*u.remainingLength+(1-G)*u.backwardLength))),G=Math.max(F,A?0:G),J.maxZoom=25,J.angle=u.angle+(1-z)*Math.PI,J.minZoom=G,this._writeGlyph(K,L,u.x,u.y,J),z&&this._isVisible(J.minZoom,J.maxZoom)&&(G=J.bounds,K.metricBoxWrite(G.center[0],G.center[1],G.width,G.height))};
v._placeOnSegment=function(u,F,z,A,E,G){var H=this.current.inShaping.glyphs;const {out:K,inId:L}=this.current,J=this.current.inShaping,B=this.current.zoomLevel;var y=u.x+u.dx/u.length*-E*z,I=u.y+u.dy/u.length*-E*z;for(const O of H)if((H=O.x>J.bounds.x?G:1-G)&&1===E||!H&&-1===E){var S=Math.abs(O.x+O.width/2-J.bounds.x);H=Math.max(0,B+Math.log2(S/z)-.1);S=Math.max(A,B+Math.log2(S/(z+u.length+0)));0!==H&&(O.angle=u.angle+(1-G)*Math.PI,O.minZoom=S,O.maxZoom=H,this._writeGlyph(K,L,y,I,O),G&&this._isVisible(O.minZoom,
O.maxZoom)&&(H=O.bounds,K.metricBoxWrite(H.center[0]+(u.x-F.x),H.center[1]+(u.y-F.y),H.width,H.height)))}};v._writeGlyphs=function(u,F,z,A,E=this._minZoom){if(!(0>z.x||512<=z.x||0>z.y||512<=z.y)){var G=z.x+this._refOffsetX;z=z.y-this._refOffsetY;for(const H of A.glyphs)H.minZoom=E,H.maxZoom=this._maxZoom,this._writeGlyph(u,F,G,z,H);A=A.boundsT;u.metricStart(F,E,G,z,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);u.metricBoxWrite(A.center[0],A.center[1],A.width,
A.height);u.metricEnd()}};v._writeVertexCommon=function(u,F,z,A){const E=this._color,G=this._haloColor,H=l.i8888to32(0,0,this._size,this._haloSize);A=l.i8888to32(Math.floor(10*Math.max(A.minZoom,this._minZoom)),Math.floor(10*Math.min(A.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);u.vertexWrite(z);u.vertexWrite(F);u.vertexWrite(E);u.vertexWrite(G);u.vertexWrite(H);u.vertexWrite(this._refSymbolAndPlacementOffset);u.vertexWrite(A)};r._createClass(h,[{key:"_shapedBox",get:function(){return x.unwrap(this._shapingInfo).bounds}}]);
return h}(b)})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(r){r.HAlign=void 0;(function(t){t[t.Left=-1]="Left";t[t.Center=0]="Center";t[t.Right=1]="Right"})(r.HAlign||(r.HAlign={}));r.VAlign=void 0;(function(t){t[t.Top=1]="Top";t[t.Center=0]="Center";t[t.Bottom=-1]="Bottom";t[t.Baseline=2]="Baseline"})(r.VAlign||(r.VAlign={}));r.getAlignmentFromPlacement=function(t){switch(t){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[r.HAlign.Right,
r.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[r.HAlign.Center,r.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[r.HAlign.Left,r.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[r.HAlign.Right,r.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[r.HAlign.Center,
r.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[r.HAlign.Left,r.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[r.HAlign.Right,r.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[r.HAlign.Center,r.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[r.HAlign.Left,r.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[r.HAlign.Center,
r.VAlign.Center];default:return console.debug(`Found invalid placement type ${t}`),[r.HAlign.Center,r.VAlign.Center]}};r.getJustification=function(t){switch(t){case "left":return r.HAlign.Left;case "right":return r.HAlign.Right;case "center":case "justify":return r.HAlign.Center}};r.getXAnchorDirection=function(t){switch(t){case "left":return r.HAlign.Left;case "right":return r.HAlign.Right;case "center":case "justify":return r.HAlign.Center}};r.getXDirection=function(t){switch(t){case r.HAlign.Right:return-1;
case r.HAlign.Center:return 0;case r.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}};r.getYAnchorDirection=function(t){switch(t){case "top":return r.VAlign.Top;case "middle":return r.VAlign.Center;case "baseline":return r.VAlign.Baseline;case "bottom":return r.VAlign.Bottom}};r.getYDirection=function(t){switch(t){case r.VAlign.Top:return 1;case r.VAlign.Center:return 0;case r.VAlign.Bottom:case r.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),
0}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../enums","../mesh/templates/meshUtils"],function(r,t,C,D,x){function w(c,f){const m=D.WGLVVFlag.SIZE_FIELD_STOPS|D.WGLVVFlag.SIZE_MINMAX_VALUE|D.WGLVVFlag.SIZE_SCALE_STOPS|D.WGLVVFlag.SIZE_UNIT_VALUE;c=(c&(D.WGLVVTarget.FIELD_TARGETS_OUTLINE|D.WGLVVTarget.MINMAX_TARGETS_OUTLINE|D.WGLVVTarget.SCALE_TARGETS_OUTLINE|
D.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return f.isOutline||f.isOutlinedFill?m&c:m&~c}let q=function(){function c(m){this._data=0;this._data=m}c.load=function(m){const h=this.shared;h.data=m;return h};var f=c.prototype;f.setBit=function(m,h){m=1<<m;this._data=h?this._data|m:this._data&~m};f.bit=function(m){return(this._data&1<<m)>>m};f.setBits=function(m,h,v){for(let u=h,F=0;u<v;u++,F++)this.setBit(u,0!==(m&1<<F))};f.bits=function(m,h){let v=0;for(let u=m,F=0;u<h;u++,F++)v|=this.bit(u)<<F;return v};
f.hasVV=function(){return!1};f.setVV=function(m,h){};f.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}};f.getVariationHash=function(){return this._data&~(7&this.textureBinding)};t._createClass(c,[{key:"data",get:function(){return this._data},set:function(m){this._data=m}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(m){this.setBits(m,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(m){this.setBit(20,
m)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(m){this.setBit(11,m)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(m){this.setBit(12,m)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(m){this.setBits(m,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case D.WGLGeometryType.FILL:return"fill";case D.WGLGeometryType.MARKER:return"marker";case D.WGLGeometryType.LINE:return"line";case D.WGLGeometryType.TEXT:return"text";
case D.WGLGeometryType.LABEL:return"label";default:throw new C(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return c}();q.shared=new q(0);const p=c=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,f);var h=m.prototype;h.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};h.setVV=function(v,u){f.prototype.setVV.call(this,v,u);v&=w(v,u);this.vvSizeMinMaxValue=
!!(v&D.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(v&D.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(v&D.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(v&D.WGLVVFlag.SIZE_SCALE_STOPS)};t._createClass(m,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(v){this.setBit(16,v)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(v){this.setBit(17,v)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(v){this.setBit(18,
v)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(v){this.setBit(19,v)}}]);return m}(c),g=c=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,f);var h=m.prototype;h.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvRotation};h.setVV=function(v,u){f.prototype.setVV.call(this,v,u);this.vvRotation=!u.isOutline&&!!(v&D.WGLVVFlag.ROTATION)};t._createClass(m,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(v){this.setBit(15,
v)}}]);return m}(c),e=c=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,f);var h=m.prototype;h.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvColor};h.setVV=function(v,u){f.prototype.setVV.call(this,v,u);this.vvColor=!u.isOutline&&!!(v&D.WGLVVFlag.COLOR)};t._createClass(m,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(v){this.setBit(13,v)}}]);return m}(c),l=c=>function(f){function m(){return f.apply(this,arguments)||this}t._inheritsLoose(m,
f);var h=m.prototype;h.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvOpacity};h.setVV=function(v,u){f.prototype.setVV.call(this,v,u);this.vvOpacity=!u.isOutline&&!!(v&D.WGLVVFlag.OPACITY)};t._createClass(m,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(v){this.setBit(14,v)}}]);return m}(c);let k=function(c){function f(){return c.apply(this,arguments)||this}t._inheritsLoose(f,c);f.load=function(m){const h=this.shared;h.data=m;return h};f.from=function(m){const h=
this.load(0);h.geometryType=D.WGLGeometryType.FILL;h.dotDensity="dot-density"===m.stride.fill;h.simple="simple"===m.stride.fill;h.outlinedFill=m.isOutlinedFill;h.dotDensity||h.setVV(m.vvFlags,m);return h.data};f.prototype.getVariation=function(){return{...c.prototype.getVariation.call(this),dotDensity:this.dotDensity,outlinedFill:this.outlinedFill,simple:this.simple,vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,
vvSizeUnitValue:this.vvSizeUnitValue}};t._createClass(f,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(m){this.setBit(15,m)}},{key:"simple",get:function(){return!!this.bit(22)},set:function(m){this.setBit(22,m)}},{key:"outlinedFill",get:function(){return!!this.bit(21)},set:function(m){this.setBit(21,m)}}]);return f}(e(l(p(q))));k.shared=new k(0);let n=function(c){function f(){return c.apply(this,arguments)||this}t._inheritsLoose(f,c);f.load=function(m){const h=this.shared;h.data=
m;return h};f.from=function(m){const h=this.load(0);h.geometryType=D.WGLGeometryType.MARKER;h.setVV(m.vvFlags,m);return h.data};f.prototype.getVariation=function(){return{...c.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(e(l(g(p(q)))));n.shared=new n(0);let d=function(c){function f(){return c.apply(this,
arguments)||this}t._inheritsLoose(f,c);f.load=function(m){const h=this.shared;h.data=m;return h};f.from=function(m){const h=this.load(0);h.geometryType=D.WGLGeometryType.LINE;h.setVV(m.vvFlags,m);return h.data};f.prototype.getVariation=function(){return{...c.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(e(l(p(q))));
d.shared=new d(0);let b=function(c){function f(){return c.apply(this,arguments)||this}t._inheritsLoose(f,c);f.load=function(m){const h=this.shared;h.data=m;return h};f.from=function(m){const h=this.load(0);h.geometryType=D.WGLGeometryType.TEXT;h.setVV(m.vvFlags,m);return h.data};f.prototype.getVariation=function(){return{...c.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,
vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(e(l(g(p(q)))));b.shared=new b(0);let a=function(c){function f(){return c.apply(this,arguments)||this}t._inheritsLoose(f,c);f.load=function(m){const h=this.shared;h.data=m;return h};f.from=function(m){const h=this.load(0);h.geometryType=D.WGLGeometryType.LABEL;h.setVV(m.vvFlags,m);h.mapAligned=x.isMapAligned(m.placement);return h.data};f.prototype.getVariation=function(){return{...c.prototype.getVariation.call(this),
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(p(q));a.shared=new a(0);r.FillMaterialKey=k;r.LabelMaterialKey=a;r.LineMaterialKey=d;r.MarkerMaterialKey=n;r.MaterialKeyBase=q;r.TextMaterialKey=b;r.createMaterialKey=function(c,f){switch(c){case D.WGLGeometryType.FILL:return k.from(f);case D.WGLGeometryType.LINE:return d.from(f);case D.WGLGeometryType.MARKER:return n.from(f);case D.WGLGeometryType.TEXT:return b.from(f);
case D.WGLGeometryType.LABEL:return a.from(f);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${c}`);}};r.getSizeFlagsMask=w;r.hydrateMaterialKey=function(c){switch(q.load(c).geometryType){case D.WGLGeometryType.MARKER:return new n(c);case D.WGLGeometryType.FILL:return new k(c);case D.WGLGeometryType.LINE:return new d(c);case D.WGLGeometryType.TEXT:return new b(c);case D.WGLGeometryType.LABEL:return new a(c)}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["exports"],
function(r){r.isMapAligned=function(t){switch(t){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(r,
t,C,D){function x(e){return e.length-1}function w(e){let l=0;for(let k=0;k<x(e);k++)l+=q(e,k);return l}function q(e,l,k=1){const [n,d]=e[l+1];return Math.sqrt(n*n+d*d)*k}function p(e,l,k,n,d){if(!(k<l)){var b=n.clone().seek(k/2);C.isNone(b)||(e(b.clone(),k,d),k=(k-l)/2,b=C.unwrap(b.seek(l/2)),p(e,l,k,n,d+1),p(e,l,k,b,d+1))}}let g=function(){function e(k,n,d,b,a){this._segments=k;this._index=n;this._distance=d;this._xStart=b;this._yStart=a;this._done=!1}e.create=function(k){return new e(k,0,0,k[0][0],
k[0][1])};var l=e.prototype;l.clone=function(){return new e(this._segments,this._index,this._distance,this.xStart,this.yStart)};l.equals=function(k){return this._index===k._index||k._index===this._index-1&&(0===this._distance||1===k._distance)||k._index===this._index+1&&(1===this._distance||0===k._distance)};l.leq=function(k){return this._index<k._index||this._index===k._index&&this._distance<=k._distance};l.geq=function(k){return this._index>k._index||this._index===k._index&&this._distance>=k._distance};
l.hasPrev=function(){return 0<=this._index-1};l.hasNext=function(){return this._index+1<x(this._segments)};l.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};l.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};l._seekBackwards=function(k,n){var d=this.backwardLength;if(k<=d)return this._distance=(d-k)/this.length,
this;for(d=this.backwardLength;this.prev();){if(d+this.length>k)return this._seekBackwards(k-d);d+=this.length}this._distance=0;return n?this:null};l.seek=function(k,n=!1){if(0>k)return this._seekBackwards(Math.abs(k),n);if(k<=this.remainingLength)return this._distance=(this.backwardLength+k)/this.length,this;let d=this.remainingLength;for(;this.next();){if(d+this.length>k)return this.seek(k-d,n);d+=this.length}this._distance=1;return n?this:null};t._createClass(e,[{key:"_segment",get:function(){return this._segments[this._index+
1]}},{key:"angle",get:function(){const k=this.dy;let n=Math.acos((0*k+-1*-this.dx)/(1*this.length));0<k&&(n=2*Math.PI-n);return n}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:k,dy:n}=this;return Math.sqrt(k*k+n*n)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return e}();r.SegmentCursor=g;r.pathDivide=function(e,l,k,n=!0){const d=w(e);e=g.create(e);const b=d/2;if(n){n=Math.floor(Math.max((d-l)/2,0)/l);e.seek(b-n*l);for(let a=-n;a<=n;a++)512>e.x&&0<=e.x&&512>e.y&&0<=e.y&&k(e.clone(),a,b+a*l,d),e.seek(l)}else e.seek(b),k(e.clone(),0,b+0*l,d)};r.pathLength=w;r.pathSubdivide=function(e,l,k){p(k,l,w(e),g.create(e),0)};r.segmentAt=function(e,l){return e[l+1]};r.segmentCount=x;r.segmentLength=q;r.smoothPaths=function(e,l){for(let G=0;G<e.length;G++){var k=e[G];
const H=[];H.push(k[0]);for(var n=1;n<k.length;n++){let [K,L]=H[n-1];K+=k[n][0];L+=k[n][1];H.push([K,L])}a:{k=H;n=l;if(0>=n)break a;const K=k.length;if(3>K)break a;const L=[];var d=0;L.push(0);for(var b=1;b<K;b++)d+=D.dist(k[b],k[b-1]),L.push(d);n=Math.min(n,.2*d);d=[];d.push(k[0][0]);d.push(k[0][1]);b=k[K-1][0];const J=k[K-1][1];var a=D.sub([0,0],k[0],k[1]);D.normalize(a);k[0][0]+=n*a[0];k[0][1]+=n*a[1];D.sub(a,k[K-1],k[K-2]);D.normalize(a);k[K-1][0]+=n*a[0];k[K-1][1]+=n*a[1];for(a=1;a<K;a++)L[a]+=
n;L[K-1]+=n;a=.5*n;for(let B=1;B<K-1;B++){let y=0,I=0,S=0;for(var c=B-1;0<=c&&!(L[c+1]<L[B]-a);c--){var f=a+L[c+1]-L[B],m=L[c+1]-L[c],h=L[B]-L[c]<a?1:f/m;if(1E-6>Math.abs(h))break;var v=h*h,u=h*f-.5*v*m,F=h*m/n,z=k[c+1],A=k[c][0]-z[0],E=k[c][1]-z[1];y+=F/u*(z[0]*h*f+.5*v*(f*A-m*z[0])-v*h*m*A/3);I+=F/u*(z[1]*h*f+.5*v*(f*E-m*z[1])-v*h*m*E/3);S+=F}for(c=B+1;c<K&&!(L[c-1]>L[B]+a);c++){f=a-L[c-1]+L[B];m=L[c]-L[c-1];h=L[c]-L[B]<a?1:f/m;if(1E-6>Math.abs(h))break;v=h*h;u=h*f-.5*v*m;F=h*m/n;z=k[c-1];A=k[c][0]-
z[0];E=k[c][1]-z[1];y+=F/u*(z[0]*h*f+.5*v*(f*A-m*z[0])-v*h*m*A/3);I+=F/u*(z[1]*h*f+.5*v*(f*E-m*z[1])-v*h*m*E/3);S+=F}d.push(y/S);d.push(I/S)}d.push(b);d.push(J);for(let B=0,y=0;B<K;B++)k[B][0]=d[y++],k[B][1]=d[y++]}k=[];k.push(H[0]);for(n=1;n<H.length;n++){const [K,L]=H[n-1],[J,B]=H[n];k.push([Math.round(J-K),Math.round(B-L)])}e[G]=k}return e};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(r){function t(C,
D){return Math.sqrt(C*C+D*D)}r.DEFAULT_MAX_ZOOM=100;r.DEFAULT_MIN_ZOOM=0;r.dist=function(C,D){return t(C[0]-D[0],C[1]-D[1])};r.getLimitCosine=function(C=2){return 1/Math.max(C,1)};r.getMinMaxZoom=function(C,D){const x=!!C.minScale&&D.scaleToZoom(C.minScale)||0;C=!!C.maxScale&&D.scaleToZoom(C.maxScale)||100;return[x,C]};r.isExtent=function(C){return void 0!==C.xmin&&void 0!==C.ymin&&void 0!==C.xmax&&void 0!==C.ymax};r.isFunction=function(C){return"function"===typeof C};r.isMultipoint=function(C){return void 0!==
C.points};r.isPoint=function(C){return void 0!==C.x&&void 0!==C.y};r.isPolygon=function(C){return void 0!==C.rings};r.isPolyline=function(C){return void 0!==C.paths};r.len=t;r.normalize=function(C){const D=t(C[0],C[1]);C[0]/=D;C[1]/=D};r.sub=function(C,D,x){C[0]=D[0]-x[0];C[1]=D[1]-x[1];return C};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){return function(k){function n(d,b,a,c,f,m,h,v,u,F,z,A,E,G,H,K,L,J,B=!1,y,I){var S=k.call(this)||this;S._xOffset=C.pt2px(E);S._yOffset=C.pt2px(G);S._decoration=F||"none";S._color=f;S._haloColor=m;S._haloSize=Math.min(Math.floor(5*C.pt2px(C.toPt(a))),127);S._size=Math.min(Math.round(C.pt2px(b)),127);b=Math.min(Math.round(C.pt2px(c||b)),127);S._referenceSize=Math.round(Math.sqrt(256*b));S._scale=S._size/w.GLYPH_SIZE;S._angle=A;S._justify=D.getJustification(h||"center");
S._xAlignD=D.getXAnchorDirection(h||"center");S._yAlignD=D.getYAnchorDirection(v||"baseline");S._baseline="baseline"===(v||"baseline");S._bitset=(1===u?1:0)|(z?1:0)<<1;d=p.MaterialKeyBase.load(d);d.sdf=!0;S._materialKey=d.data;S._lineWidth=C.pt2px(H)||512;S._lineHeight=K||1;S._textPlacement=L;S._effects=J;S._isCIM=B;S._minMaxZoom=q.i1616to32(Math.round(y*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(I*w.MIN_MAX_ZOOM_PRECISION_FACTOR));return S}r._inheritsLoose(n,k);n.fromText=function(d,b){const a=
new n(d.materialKey,d.font.size,d.haloSize||0,d.font.size,d.color&&x.premultiplyAlphaRGBAArray(d.color)||0,d.haloColor&&x.premultiplyAlphaRGBAArray(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,0,d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.lineWidth,d.lineHeight,null,null,!1,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM),[,c]=t.bidiText(d.text);a.bindTextInfo(b,c);a._vertexBoundsScale=d.maxVVSize?d.maxVVSize/d.font.size:1;return a};n.fromCIMText=function(d,b,a){var c=d.scaleFactor||
1;const f=d.size*d.sizeRatio*c,[m,h]=g.getMinMaxZoom(d.scaleInfo,a);a=new n(d.materialKey,f,d.outlineSize*d.sizeRatio,d.referenceSize,x.premultiplyAlphaRGBA(d.color),x.premultiplyAlphaRGBA(d.outlineColor),d.horizontalAlignment,d.verticalAlignment,d.alignment,d.decoration,d.colorLocked,d.angle,d.offsetX*d.sizeRatio*c,d.offsetY*d.sizeRatio*c,512,1,d.markerPlacement,d.effects,!0,m,h);[,c]=t.bidiText(d.text);a.bindTextInfo(b,c);a._vertexBoundsScale=d.maxVVSize?d.maxVVSize/f:1;return a};return n}(e(l))})},
"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(r,t,C,D,x,w,q,p,g,e){return l=>function(k){function n(...b){b=k.call(this,
...b)||this;b._isCIM=!1;b._vertexBoundsScale=1;b.geometryType=q.WGLGeometryType.TEXT;b._aux=p.i8888to32(0,0,b._referenceSize,b._bitset);return b}r._inheritsLoose(n,k);var d=n.prototype;d.bindTextInfo=function(b,a){this._shapingInfo=b&&b.length?t.andThen(b,c=>e.shapeGlyphs(c,a,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:w.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,
Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};d._write=function(b,a,c){const f=a.getDisplayId();this._writeGeometry(b,a,f,c)};d._writeGeometry=function(b,a,c,f){const m=this._shapingInfo;if(!t.isNone(m)){if(t.isSome(this._textPlacement))return a=null!=f?f:a.readLegacyGeometryForDisplay(),this._writePlacedText(b,c,a,m);a=f?D.deltaDecodeGeometry(D.convertFromGeometry(f),2):"esriGeometryPolygon"===a.geometryType?a.readCentroid():a.readGeometryForDisplay();if(!t.isNone(a)){if(a.isPoint){const [h,
v]=a.coords;return!b.hasAggregates&&b.hasPixelBufferEnabled&&(0>h||512<=h||0>v||512<=v)?void 0:this._writeGlyphs(b,c,{x:h,y:v},m)}a.forEachVertex((h,v)=>this._writeGlyphs(b,c,{x:h,y:v},m))}}};d._writePlacedText=function(b,a,c,f){var m=t.unwrap(this._textPlacement);if(c=x.CIMMarkerPlacementHelper.getPlacement(c,m,C.pt2px(1)))for(var h=c.next();null!=h;){m=h.getAngle();f.setRotation(m);const v=h.tx;h=h.ty;0>v||512<=v||0>h||512<=h||(this._writeGlyphs(b,a,{x:v,y:h},f),f.setRotation(-m));h=c.next()}};
d._writeGlyphs=function(b,a,c,f){const m=g.MaterialKeyBase.load(this._materialKey),h=p.i1616to32(Math.round(8*c.x),Math.round(8*c.y)),v=this._vertexBoundsScale,u=f.bounds,F=2*Math.max(u.width,u.height);for(const z of f.glyphs)m.textureBinding=z.textureBinding,b.recordStart(a,m.data,this.geometryType,!0),b.vertexBounds(c.x+u.x+this._xOffset,c.y+u.y-this._yOffset,F*v,F*v),this._writeVertices(b,a,h,z),b.recordEnd()};d._writeGlyph=function(b,a,c,f,m){var h=g.MaterialKeyBase.load(this._materialKey);const v=
p.i1616to32(Math.round(8*c),Math.round(8*f));h.textureBinding=m.textureBinding;b.recordStart(a,h.data,this.geometryType,!0);h=m.bounds;const u=this._vertexBoundsScale;b.vertexBounds(c+h.x*u,f+h.y*u,h.width*u,h.height*u);this._writeVertices(b,a,v,m);b.recordEnd()};d._writeVertices=function(b,a,c,f){const m=b.vertexCount();this._writeVertexCommon(b,a,c,f);b.vertexWrite(f.offsets.upperLeft);b.vertexWrite(f.texcoords.upperLeft);b.vertexEnd();this._writeVertexCommon(b,a,c,f);b.vertexWrite(f.offsets.upperRight);
b.vertexWrite(f.texcoords.upperRight);b.vertexEnd();this._writeVertexCommon(b,a,c,f);b.vertexWrite(f.offsets.lowerLeft);b.vertexWrite(f.texcoords.lowerLeft);b.vertexEnd();this._writeVertexCommon(b,a,c,f);b.vertexWrite(f.offsets.lowerRight);b.vertexWrite(f.texcoords.lowerRight);b.vertexEnd();b.indexWrite(m+0);b.indexWrite(m+1);b.indexWrite(m+2);b.indexWrite(m+1);b.indexWrite(m+3);b.indexWrite(m+2)};d._writeVertexCommon=function(b,a,c,f){f=this._color;const m=this._haloColor,h=p.i8888to32(0,0,this._referenceSize,
this._bitset),v=p.i8888to32(0,0,this._size,this._haloSize);b.vertexWrite(c);b.vertexWrite(a);b.vertexWrite(f);b.vertexWrite(m);b.vertexWrite(v);b.vertexWrite(h);b.vertexWrite(this._minMaxZoom)};return n}(l)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(r,t,C){let D=function(){function x(){}x.getPlacement=function(w,q,p){const g=C.getPlacementOperator(q);if(!g)return null;w=t.cloneAndDecodeGeometry(w);return g.execute(w,
q,p)};return x}();r.CIMMarkerPlacementHelper=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(r,t,C,D){function x(d){if(d){var b=d.length;for(--b;0<b;--b)d[b][0]-=d[b-1][0],d[b][1]-=d[b-1][1]}}function w(d){if(d)for(const b of d)x(b)}function q(d){if(d){const b=d.length;for(let a=1;a<b;++a)d[a][0]+=d[a-1][0],d[a][1]+=d[a-1][1]}}function p(d){if(d)for(const b of d)q(b)}
function g(d){d&&(C.isPolygon(d)?p(d.rings):C.isPolyline(d)?p(d.paths):C.isMultipoint(d)&&q(d.points))}function e(d){d&&d.reverse()}function l(d){return{rings:[[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]]]}}let k=function(){function d(b,a,c,f){this.acceptPolygon=a;this.acceptPolyline=c;this.geomUnitsPerPoint=f;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;b&&(C.isPolygon(b)?a&&(this.multiPath=b.rings,this.isClosed=!0):C.isPolyline(b)?c&&(this.multiPath=
b.paths,this.isClosed=!1):C.isExtent(b)&&a&&(this.multiPath=l(b).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new D.Placement}d.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const b=this.processPath(this.multiPath[this.pathIndex]);if(b)return b}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return d}(),n=function(){function d(b,
a,c,f){this.inputGeometries=b;this.acceptPolygon=a;this.acceptPolyline=c;this.geomUnitsPerPoint=f;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}d.prototype.next=function(){for(;;){if(!this.multiPath){for(var b=this.inputGeometries.next();b;)if(C.isPolygon(b)?this.acceptPolygon&&(this.multiPath=b.rings,this.isClosed=!0):C.isPolyline(b)?this.acceptPolyline&&(this.multiPath=b.paths,this.isClosed=!1):C.isExtent(b)&&this.acceptPolygon&&(this.multiPath=l(b).rings,this.isClosed=!0),this.multiPath){this.pathCount=
this.multiPath.length;this.pathIndex=-1;break}else b=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,b=this.processPath(this.multiPath[this.pathIndex]))return b;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return d}();r.PathGeometryCursor=n;r.PathTransformationCursor=k;r.cloneAndDecodeGeometry=function(d){d=t.clone(d);g(d);return d};r.deltaDecodeGeometry=g;r.deltaEncodeGeometry=function(d){d&&
(C.isPolygon(d)?w(d.rings):C.isPolyline(d)?w(d.paths):C.isMultipoint(d)&&x(d.points))};r.getCoord2D=function(d,b,a){return[d[0]+(b[0]-d[0])*a,d[1]+(b[1]-d[1])*a]};r.getId=function(d){return d[4]};r.isClosedPath=function(d){return d&&0!==d.length?d[0][0]===d[d.length-1][0]&&d[0][1]===d[d.length-1][1]:!1};r.reverseMultipath=function(d){if(d)for(const b of d)e(b)};r.reversePath=e;r.setId=function(d,b){d[4]=b};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],
function(r){let t=function(){function D(){this.setIdentity()}var x=D.prototype;x.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};x.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};x.setTranslate=function(w,q){this.tx=w;this.ty=q};x.setTranslateZ=function(w){this.tz=w};x.setRotateCS=function(w,q){this.rz=void 0;this.rz_c=w;this.rz_s=q};x.setRotate=function(w){this.rz=
w;this.rz_s=this.rz_c=void 0};x.setRotateY=function(w){this.ry=w};x.setScale=function(w){this.s=w};x.setMeasure=function(w){this.m=w};return D}(),C=function(){function D(){}D.prototype.next=function(){return null};return D}();r.EmptyPlacementCursor=C;r.Placement=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h,v,u){r.getEffectOperator=function(F){if(!F)return null;switch(F.type){case "CIMGeometricEffectAddControlPoints":return t.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return C.EffectArrow.local();case "CIMGeometricEffectBuffer":return D.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return x.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return w.EffectCut.local();case "CIMGeometricEffectDashes":return q.EffectDashes.local();
case "CIMGeometricEffectDonut":return p.EffectDonut.local();case "CIMGeometricEffectJog":return g.EffectJog.local();case "CIMGeometricEffectMove":return e.EffectMove.local();case "CIMGeometricEffectOffset":return l.EffectOffset.local();case "CIMGeometricEffectReverse":return k.EffectReverse.local();case "CIMGeometricEffectRotate":return n.EffectRotate.local();case "CIMGeometricEffectScale":return d.EffectScale.local();case "CIMGeometricEffectWave":return b.EffectWave.local()}return null};r.getPlacementOperator=
function(F){if(!F)return null;switch(F.type){case "CIMMarkerPlacementAlongLineSameSize":return a.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return c.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return f.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return m.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return h.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return v.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return u.PlacementPolygonCenter.local()}return null};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=
null;let w=function(){function q(g,e,l){this._inputGeometries=g;this._angleTolerance=void 0!==e.angleTolerance?e.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var p=q.prototype;p.next=function(){for(var g=this._inputGeometries.next();g;){if(C.isPolygon(g))return this._isClosed=!0,g=t.clone(g),this._processMultipath(g.rings),g;if(C.isPolyline(g))return this._isClosed=!1,g=t.clone(g),this._processMultipath(g.paths),g;if(C.isExtent(g)){if(this._maxCosAngle)return g;
this._isClosed=!0;g=[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]];this._processPath(g);return{rings:[g]}}g=this._inputGeometries.next()}return null};p._processMultipath=function(g){if(g)for(const e of g)this._processPath(e)};p._processPath=function(g){if(g){let e=g.length,l=g[0],k,n,d,b,a,c;this._isClosed&&++e;for(let f=1;f<e;++f){let m;m=this._isClosed&&f===e-1?g[0]:g[f];const h=m[0]-l[0],v=m[1]-l[1],u=Math.sqrt(h*h+v*v);1<f&&0<u&&0<d&&(k*h+n*v)/u/d<=this._maxCosAngle&&
D.setId(l,1);1===f&&(b=h,a=v,c=u);0<u&&(l=m,k=h,n=v,d=u)}this._isClosed&&0<d&&0<c&&(k*b+n*a)/c/d<=this._maxCosAngle&&D.setId(g[0],1)}};return q}();r.EffectAddControlPoints=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=
function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(q){function p(e,l,k){e=q.call(this,e,!1,!0)||this;e._curveHelper=new D.CurveHelper;e._width=(void 0!==l.width?l.width:5)*k;e._arrowType=void 0!==l.geometricEffectArrowType?l.geometricEffectArrowType:"OpenEnded";e._offsetFlattenError=D.PIXEL_TOLERANCE*k;return e}t._inheritsLoose(p,q);var g=p.prototype;g.processPath=function(e){switch(this._arrowType){default:return this._constructSimpleArrow(e,!0);case "Block":return this._constructSimpleArrow(e,
!1);case "Crossed":return this._constructCrossedArrow(e)}};g._constructSimpleArrow=function(e,l){var k=this._curveHelper.calculatePathLength(e),n=this._width;k<2*n&&(n=k/2);k=this._curveHelper.getSubCurve(e,0,k-n);if(!k)return null;var d=n/2;if(this._curveHelper.isEmpty(k,!1))return null;n=this._constructOffset(k,-d);if(!n)return null;k=this._constructOffset(k,d);if(!k)return null;const b=this._constructArrowBasePoint(n,-d/2);if(!b)return null;d=this._constructArrowBasePoint(k,d/2);if(!d)return null;
e=e[e.length-1];l||(this._makeControlPoint(k,!0),this._makeControlPoint(n,!0));const a=new D.PathHelper;a.addPath(k,!0);a.lineTo(d);this._makeControlPoint(a.path());a.lineTo(e);this._makeControlPoint(a.path());a.lineTo(b);this._makeControlPoint(a.path());a.addPath(n,!1);return l?{paths:[a.path()]}:(a.close(),{rings:[a.path()]})};g._constructCrossedArrow=function(e){var l=this._curveHelper.calculatePathLength(e),k=this._width;l<3.732050807568877*k&&(k=l/3.732050807568877);var n=this._curveHelper.getSubCurve(e,
0,l-2.732050807568877*k);if(!n)return null;var d=k/2;if(this._curveHelper.isEmpty(n,!1))return null;const b=this._constructOffset(n,d);if(!b)return null;n=this._constructOffset(n,-d);if(!n)return null;l=this._curveHelper.getSubCurve(e,0,l-k);if(!l||this._curveHelper.isEmpty(l,!1))return null;k=this._constructOffset(l,d);if(!k)return null;var a=this._constructOffset(l,-d);if(!a)return null;l=k[k.length-1];k=this._constructArrowBasePoint(k,d/2);if(!k)return null;const c=a[a.length-1];d=this._constructArrowBasePoint(a,
-d/2);if(!d)return null;e=e[e.length-1];this._makeControlPoint(b,!1);this._makeControlPoint(n,!1);a=new D.PathHelper;a.addPath(b,!0);this._makeControlPoint(a.path());a.lineTo(c);a.lineTo(d);this._makeControlPoint(a.path());a.lineTo(e);this._makeControlPoint(a.path());a.lineTo(k);this._makeControlPoint(a.path());a.lineTo(l);this._makeControlPoint(a.path());a.addPath(n,!1);return{paths:[a.path()]}};g._constructOffset=function(e,l){return this._curveHelper.offset(e,l,"Rounded",4,this._offsetFlattenError)};
g._constructArrowBasePoint=function(e,l){if(!e||2>e.length)return null;var k=e[e.length-2];e=e[e.length-1];k=[e[0]-k[0],e[1]-k[1]];this._curveHelper.normalize(k);return[e[0]+k[1]*l,e[1]-k[0]*l]};g._makeControlPoint=function(e,l=!1){l?C.setId(e[0],1):C.setId(e[e.length-1],1)};return p}(C.PathGeometryCursor);r.EffectArrow=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports"],function(r){let t=function(){function D(){this._path=[]}var x=D.prototype;
x.path=function(){return this._path};x.addPath=function(w,q){q||w.reverse();Array.prototype.push.apply(this._path,w);q||w.reverse()};D.mergePath=function(w,q){q&&Array.prototype.push.apply(w,q)};x.startPath=function(w){this._path.push(w)};x.lineTo=function(w){this._path.push(w)};x.close=function(){const w=this._path;1<w.length&&(w[0][0]!==w[w.length-1][0]||w[0][1]!==w[w.length-1][1])&&w.push([w[0][0],w[0][1]])};return D}(),C=function(){function D(w,q){}var x=D.prototype;x.normalize=function(w){const q=
Math.sqrt(w[0]*w[0]+w[1]*w[1]);w[0]/=q;w[1]/=q};x.calculateLength=function(w,q){const p=q[0]-w[0];w=q[1]-w[1];return Math.sqrt(p*p+w*w)};x.calculateSegLength=function(w,q){return this.calculateLength(w[q],w[q+1])};x.calculatePathLength=function(w){let q=0;const p=w?w.length:0;for(let g=0;g<p-1;++g)q+=this.calculateSegLength(w,g);return q};x.calculatePathArea=function(w){let q=0;const p=w?w.length:0;for(let g=0;g<p-1;++g)q+=(w[g+1][0]-w[g][0])*(w[g+1][1]+w[g][1]);return q/2};x.getCoord2D=function(w,
q,p){return[w[0]+(q[0]-w[0])*p,w[1]+(q[1]-w[1])*p]};x.getSegCoord2D=function(w,q,p){return this.getCoord2D(w[q],w[q+1],p)};x.getAngle=function(w,q,p){return Math.atan2(q[1]-w[1],q[0]-w[0])};x.getSegAngle=function(w,q,p){return this.getAngle(w[q],w[q+1],p)};x.getAngleCS=function(w,q,p){p=q[0]-w[0];w=q[1]-w[1];q=Math.sqrt(p*p+w*w);return 0<q?[p/q,w/q]:[1,0]};x.getSegAngleCS=function(w,q,p){return this.getAngleCS(w[q],w[q+1],p)};x.cut=function(w,q,p,g){p=0>=p?w[q]:this.getSegCoord2D(w,q,p);w=1<=g?w[q+
1]:this.getSegCoord2D(w,q,g);return[p,w]};x.addSegment=function(w,q,p){p&&w.push(q[0]);w.push(q[1])};x.getSubCurve=function(w,q,p){const g=[];return this.appendSubCurve(g,w,q,p)?g:null};x.appendSubCurve=function(w,q,p,g){const e=q?q.length-1:0;let l=0,k=!0,n=0;for(;n<e;){const b=this.calculateSegLength(q,n);if(0!==b){if(k){if(l+b>p){var d=(p-l)/b;let a=1,c=!1;l+b>=g&&(a=(g-l)/b,c=!0);(d=this.cut(q,n,d,a))&&this.addSegment(w,d,k);if(c)break;k=!1}}else{if(l+b>g){(q=this.cut(q,n,0,(g-l)/b))&&this.addSegment(w,
q,k);break}this.addSegment(w,[q[n],q[n+1]],k)}l+=b}++n}return!0};x.getCIMPointAlong=function(w,q){const p=w?w.length-1:0;let g=0,e=-1;for(;e<p;){++e;const l=this.calculateSegLength(w,e);if(0!==l){if(g+l>q)return this.getCoord2D(w[e],w[e+1],(q-g)/l);g+=l}}return null};x.isEmpty=function(w,q){if(!w||1>=w.length)return!0;const p=w?w.length-1:0;let g=-1;for(;g<p;)if(++g,w[g+1][0]!==w[g][0]||w[g+1][1]!==w[g][1]||q&&w[g+1][2]!==w[g][2])return!1;return!0};x.offset=function(w,q,p,g,e){if(!w||2>w.length)return null;
var l=0,k=w[l++];for(e=l;l<w.length;){var n=w[l];if(n[0]!==k[0]||n[1]!==k[1])l!==e&&(w[e]=w[l]),k=w[e++];l++}(l=w[0][0]===w[e-1][0]&&w[0][1]===w[e-1][1])&&--e;if(e<(l?3:2))return null;n=[];k=l?w[e-1]:null;let d=w[0];for(let f=0;f<e;f++){const m=f===e-1?l?w[0]:null:w[f+1];if(k)if(m){var b=[m[0]-d[0],m[1]-d[1]];this.normalize(b);k=[d[0]-k[0],d[1]-k[1]];this.normalize(k);var a=k[0]*b[1]-k[1]*b[0],c=k[0]*b[0]+k[1]*b[1];if(0<=a===0>=q)1>c&&(b=[b[0]-k[0],b[1]-k[1]],this.normalize(b),k=Math.sqrt((1+c)/2),
k>1/g&&(k=-Math.abs(q)/k,n.push([d[0]-b[0]*k,d[1]-b[1]*k])));else switch(p){case "Mitered":if(c=Math.sqrt((1+c)/2),0<c&&1/c<g){b=[b[0]-k[0],b[1]-k[1]];this.normalize(b);k=Math.abs(q)/c;n.push([d[0]-b[0]*k,d[1]-b[1]*k]);break}case "Bevelled":n.push([d[0]+k[1]*q,d[1]-k[0]*q]);n.push([d[0]+b[1]*q,d[1]-b[0]*q]);break;case "Rounded":if(1>c){n.push([d[0]+k[1]*q,d[1]-k[0]*q]);c=Math.floor(2.5*(1-c));if(0<c){let h=a=1/c;for(let v=1;v<c;v++,h+=a){const u=[k[1]*(1-h)+b[1]*h,-k[0]*(1-h)-b[0]*h];this.normalize(u);
n.push([d[0]+u[0]*q,d[1]+u[1]*q])}}n.push([d[0]+b[1]*q,d[1]-b[0]*q])}break;default:0>a?(n.push([d[0]+(k[1]+k[0])*q,d[1]+(k[1]-k[0])*q]),n.push([d[0]+(b[1]-b[0])*q,d[1]-(b[0]+b[1])*q])):(c=Math.sqrt((1+Math.abs(c))/2),b=[b[0]-k[0],b[1]-k[1]],this.normalize(b),k=q/c,n.push([d[0]-b[0]*k,d[1]-b[1]*k]))}}else b=[d[0]-k[0],d[1]-k[1]],this.normalize(b),n.push([d[0]+b[1]*q,d[1]-b[0]*q]);else b=[m[0]-d[0],m[1]-d[1]],this.normalize(b),n.push([d[0]+b[1]*q,d[1]-b[0]*q]);k=d;d=m}if(n.length<(l?3:2))return null;
l&&n.push([n[0][0],n[0][1]]);return n};return D}();r.CurveHelper=C;r.PIXEL_TOLERANCE=.03;r.PathHelper=t;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(r,t,C){let D=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(q,p,g){return new x(q,p,g)};return w}();D.instance=null;let x=function(){function w(q,
p,g){this._inputGeometries=q;this._curveHelper=new C.CurveHelper;this._size=(void 0!==p.size?p.size:1)*g;this._offsetFlattenError=C.PIXEL_TOLERANCE*g}w.prototype.next=function(){let q=this._inputGeometries.next();for(;q;){if(t.isExtent(q))if(0<this._size){var p=this._curveHelper.offset([[q.xmin,q.ymin],[q.xmin,q.ymax],[q.xmax,q.ymax],[q.xmax,q.ymin],[q.xmin,q.ymin]],this._size,"Rounded",4,this._offsetFlattenError);if(p)return{rings:[p]}}else if(0>this._size){if(0<Math.min(q.xmax-q.xmin,q.ymax-q.ymin)+
2*this._size)return{xmin:q.xmin-this._size,xmax:q.xmax+this._size,ymin:q.ymin-this._size,ymax:q.ymax+this._size}}else return q;if(t.isPolygon(q)){if(0===this._size)return q;p=[];for(const e of q.rings){var g=this._curveHelper.offset(e,this._size,"Rounded",4,this._offsetFlattenError);g&&p.push(g)}if(p.length)return{rings:p}}if(t.isPolyline(q)&&0<this._size){p=[];for(const e of q.paths)if(e&&1<e.length){g=this._curveHelper.offset(e,this._size,"Rounded",4,this._offsetFlattenError);const l=this._curveHelper.offset(e,
-this._size,"Rounded",4,this._offsetFlattenError);if(g&&l){for(let k=l.length-1;0<=k;k--)g.push(l[k]);g.push([g[0][0],g[0][1]]);p.push(g)}}if(p.length)return{rings:p}}t.isPoint(q);q=this._inputGeometries.next()}return null};return w}();r.EffectBuffer=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor"],function(r,t,C){let D=function(){function w(){}w.local=function(){null===
w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(q,p,g){return new x(q,p,g)};return w}();D.instance=null;let x=function(){function w(p,g,e){var l;this._default_point_size=20;this._inputGeometries=p;this._geomUnitsPerPoint=e;this._rule=null!=(l=g.rule)?l:"FullGeometry";this._default_size=this._default_point_size*e}var q=w.prototype;q.next=function(){let p;for(;p=this._inputGeometries.next();){let g;t.isPoint(p)?g=this._processGeom([[[p.x,p.y]]]):t.isMultipoint(p)?g=this._processGeom([p.points]):
t.isPolyline(p)?g=this._processGeom(p.paths):t.isPolygon(p)&&(g=this._processGeom(p.rings));if(g&&g.length)return{paths:g}}return null};q._clone=function(p){return[p[0],p[1]]};q._mid=function(p,g){return[(p[0]+g[0])/2,(p[1]+g[1])/2]};q._mix=function(p,g,e,l){return[p[0]*g+e[0]*l,p[1]*g+e[1]*l]};q._add=function(p,g){return[p[0]+g[0],p[1]+g[1]]};q._add2=function(p,g,e){return[p[0]+g,p[1]+e]};q._sub=function(p,g){return[p[0]-g[0],p[1]-g[1]]};q._dist=function(p,g){return Math.sqrt((p[0]-g[0])*(p[0]-g[0])+
(p[1]-g[1])*(p[1]-g[1]))};q._norm=function(p){return Math.sqrt(p[0]*p[0]+p[1]*p[1])};q._normalize=function(p,g=1){g/=this._norm(p);p[0]*=g;p[1]*=g};q._leftPerpendicular=function(p){const g=-p[0];p[0]=p[1];p[1]=g};q._leftPerp=function(p){return[p[1],-p[0]]};q._rightPerpendicular=function(p){const g=p[0];p[0]=-p[1];p[1]=g};q._rightPerp=function(p){return[-p[1],p[0]]};q._dotProduct=function(p,g){return p[0]*g[0]+p[1]*g[1]};q._crossProduct=function(p,g){return-(p[0]*g[1]-p[1]*g[0])};q._rotateDirect=function(p,
g,e){e=-e;const l=p[0]*e+p[1]*g;p[0]=p[0]*g-p[1]*e;p[1]=l};q._makeCtrlPt=function(p){p=[p[0],p[1]];C.setId(p,1);return p};q._addAngledTicks=function(p,g,e,l){const k=this._sub(e,g);this._normalize(k);var n=this._crossProduct(k,this._sub(l,g));l=0<n?this._rightPerp(k):this._leftPerp(k);n=Math.abs(n)/2;const d=[];d.push([g[0]+(l[0]-k[0])*n,g[1]+(l[1]-k[1])*n]);d.push(g);d.push(e);d.push([e[0]+(l[0]+k[0])*n,e[1]+(l[1]+k[1])*n]);p.push(d)};q._addBezier2=function(p,g,e,l,k){if(0===k--)p.push(l);else{var n=
this._mid(g,e);e=this._mid(e,l);var d=this._mid(n,e);this._addBezier2(p,g,n,d,k);this._addBezier2(p,d,e,l,k)}};q._addBezier3=function(p,g,e,l,k,n){if(0===n--)p.push(k);else{var d=this._mid(g,e),b=this._mid(e,l);l=this._mid(l,k);e=this._mid(d,b);b=this._mid(b,l);var a=this._mid(e,b);this._addBezier3(p,g,d,e,a,n);this._addBezier3(p,a,b,l,k,n)}};q._add90DegArc=function(p,g,e,l,k){l=null!=k?k:0<this._crossProduct(this._sub(e,g),this._sub(l,g));k=this._mid(g,e);const n=this._sub(k,g);l?this._leftPerpendicular(n):
this._rightPerpendicular(n);k[0]+=n[0];k[1]+=n[1];this._addBezier3(p,g,this._mix(g,.33333,k,.66667),this._mix(e,.33333,k,.66667),e,4)};q._addArrow=function(p,g,e){var l=g[0],k=g[1],n=g[g.length-1],d=this._sub(l,k);this._normalize(d);const b=this._crossProduct(d,this._sub(n,k));k=.5*b;var a=this._leftPerp(d);const c=[n[0]-a[0]*b,n[1]-a[1]*b];var f=g.length-1;n=[];n.push(e?[-a[0],-a[1]]:a);var m=[-d[0],-d[1]];for(e=1;e<f-1;e++){d=this._sub(g[e+1],g[e]);this._normalize(d);var h=this._dotProduct(d,m);
a=this._crossProduct(d,m);h=Math.sqrt((1+h)/2);m=this._sub(d,m);this._normalize(m);m[0]/=h;m[1]/=h;n.push(0>a?[-m[0],-m[1]]:m);m=d}n.push(this._rightPerp(m));for(f=n.length-1;0<f;f--)p.push([g[f][0]+n[f][0]*k,g[f][1]+n[f][1]*k]);p.push([c[0]+n[0][0]*k,c[1]+n[0][1]*k]);p.push([c[0]+n[0][0]*b,c[1]+n[0][1]*b]);p.push(l);p.push([c[0]-n[0][0]*b,c[1]-n[0][1]*b]);p.push([c[0]-n[0][0]*k,c[1]-n[0][1]*k]);for(l=1;l<n.length;l++)p.push([g[l][0]-n[l][0]*k,g[l][1]-n[l][1]*k])};q._cp2=function(p,g,e){return 2<=
p.length?p[1]:this._add2(p[0],g*this._default_size,-e*this._default_size)};q._cp3=function(p,g,e,l){if(3<=p.length)return p[2];e=this._mix(p[0],1-e,g,e);p=this._sub(g,p[0]);this._normalize(p);this._rightPerpendicular(p);return[e[0]+p[0]*l*this._default_size,e[1]+p[1]*l*this._default_size]};q._arrowPath=function(p){if(2<p.length)return p;const g=p[0];p=this._cp2(p,-4,0);const e=this._sub(g,p);this._normalize(e);const l=this._rightPerp(e);return[g,p,[g[0]+(l[0]-e[0])*this._default_size,g[1]+(l[1]-e[1])*
this._default_size]]};q._arrowLastSeg=function(p){var g=p[0];const e=this._cp2(p,-4,0);if(3<=p.length)g=p[p.length-1];else{p=this._sub(g,e);this._normalize(p);const l=this._rightPerp(p);g=[g[0]+(l[0]-p[0])*this._default_size,g[1]+(l[1]-p[1])*this._default_size]}return[e,g]};q._processGeom=function(p){if(!p)return null;const g=[];for(const e of p){if(!e||0===e.length)continue;const l=e.length;let k=e[0];switch(this._rule){case "PerpendicularFromFirstSegment":{const n=this._cp2(e,0,-1),d=this._cp3(e,
n,.5,4),b=[];b.push(d);b.push(this._mid(k,n));g.push(b);break}case "ReversedFirstSegment":{const n=this._cp2(e,0,-1);g.push([n,k]);break}case "PerpendicularToSecondSegment":{const n=this._cp2(e,-4,1),d=this._cp3(e,n,.882353,-1.94),b=[];b.push(this._mid(n,d));b.push(k);g.push(b);break}case "SecondSegmentWithTicks":{const n=this._cp2(e,-4,1),d=this._cp3(e,n,.882353,-1.94),b=this._sub(d,n);let a;a=0<this._crossProduct(b,this._sub(k,n))?this._rightPerp(a):this._leftPerp(b);const c=[];c.push([n[0]+(a[0]-
b[0])/3,n[1]+(a[1]-b[1])/3]);c.push(n);c.push(d);c.push([d[0]+(a[0]+b[0])/3,d[1]+(a[1]+b[1])/3]);g.push(c);break}case "DoublePerpendicular":{const n=this._cp2(e,0,-1),d=this._cp3(e,n,.5,3),b=this._mid(k,n),a=this._sub(b,d);this._normalize(a);const c=this._crossProduct(a,this._sub(k,d));this._leftPerpendicular(a);const f=[];f.push(k);f.push([d[0]+a[0]*c,d[1]+a[1]*c]);g.push(f);const m=[];m.push([d[0]-a[0]*c,d[1]-a[1]*c]);m.push(n);g.push(m);break}case "OppositeToFirstSegment":{const n=this._cp2(e,
0,-1),d=this._cp3(e,n,.5,3),b=this._mid(k,n),a=this._sub(b,d);this._normalize(a);const c=this._crossProduct(a,this._sub(k,d));this._leftPerpendicular(a);const f=[];f.push([d[0]+a[0]*c,d[1]+a[1]*c]);f.push([d[0]-a[0]*c,d[1]-a[1]*c]);g.push(f);break}case "TriplePerpendicular":{const n=this._cp2(e,0,-1),d=this._cp3(e,n,.5,4),b=this._mid(k,n),a=this._sub(b,d);this._normalize(a);const c=this._crossProduct(a,this._sub(k,d));this._leftPerpendicular(a);const f=[];f.push([d[0]+a[0]*c*.8,d[1]+a[1]*c*.8]);f.push([b[0]+
.8*(k[0]-b[0]),b[1]+.8*(k[1]-b[1])]);g.push(f);g.push([d,b]);const m=[];m.push([d[0]-a[0]*c*.8,d[1]-a[1]*c*.8]);m.push([b[0]+.8*(n[0]-b[0]),b[1]+.8*(n[1]-b[1])]);g.push(m);break}case "HalfCircleFirstSegment":{const n=this._cp2(e,0,-1),d=this._cp3(e,n,.5,4),b=this._mid(k,n);let a=this._sub(n,k);const c=Math.cos(Math.PI/18),f=Math.sin(Math.PI/18),m=Math.sqrt((1+c)/2),h=Math.sqrt((1-c)/2),v=[];let u;0<this._crossProduct(a,this._sub(d,k))?(v.push(k),a=this._sub(k,b),u=n):(v.push(n),a=this._sub(n,b),u=
k);this._rotateDirect(a,m,h);a[0]/=m;a[1]/=m;for(let F=1;18>=F;F++)v.push(this._add(b,a)),this._rotateDirect(a,c,f);v.push(u);g.push(v);break}case "HalfCircleSecondSegment":{const n=this._cp2(e,0,-1),d=this._cp3(e,n,1,-1);let b=this._sub(k,n);this._normalize(b);const a=this._crossProduct(b,this._sub(d,n))/2;this._leftPerpendicular(b);const c=[n[0]+b[0]*a,n[1]+b[1]*a];b=this._sub(n,c);const f=Math.cos(Math.PI/18);let m=Math.sin(Math.PI/18);0<a&&(m=-m);const h=[n];for(let v=1;18>=v;v++)this._rotateDirect(b,
f,m),h.push(this._add(c,b));g.push(h);break}case "HalfCircleExtended":{const n=this._cp2(e,0,-2),d=this._cp3(e,n,1,-1);let b;if(4<=l)b=e[3];else{const h=this._sub(k,n);b=this._add(d,h)}const a=this._dist(n,d)/2/.75,c=this._sub(n,k);this._normalize(c,a);const f=this._sub(d,b);this._normalize(f,a);g.push([b,d]);const m=[this._clone(d)];this._addBezier3(m,d,this._add(d,f),this._add(n,c),n,4);m.push(k);g.push(m);break}case "OpenCircle":{const n=this._cp2(e,-2,0),d=this._sub(n,k),b=Math.cos(Math.PI/18),
a=-Math.sin(Math.PI/18),c=[n];for(let f=1;33>=f;f++)this._rotateDirect(d,b,a),c.push(this._add(k,d));g.push(c);break}case "CoverageEdgesWithTicks":{const n=this._cp2(e,0,-1);let d;if(3<=l)d=e[2];else{const m=this._sub(n,k),h=this._leftPerp(m);d=[k[0]+h[0]-.25*m[0],k[1]+h[1]-.25*m[1]]}let b;if(4<=l)b=e[3];else{const m=this._mid(k,n),h=this._sub(k,n);this._normalize(h);this._leftPerpendicular(h);const v=this._crossProduct(h,this._sub(d,m));this._rightPerpendicular(h);b=[d[0]+h[0]*v*2,d[1]+h[1]*v*2]}const a=
this._sub(n,k);let c,f;c=0<this._crossProduct(a,this._sub(d,k))?this._rightPerp(a):this._leftPerp(a);f=[];f.push(d);f.push(k);f.push([k[0]+(c[0]-a[0])/3,k[1]+(c[1]-a[1])/3]);g.push(f);c=0<this._crossProduct(a,this._sub(b,n))?this._rightPerp(c):this._leftPerp(a);f=[];f.push([n[0]+(c[0]+a[0])/3,n[1]+(c[1]+a[1])/3]);f.push(n);f.push(b);g.push(f);break}case "GapExtentWithDoubleTicks":{const n=this._cp2(e,0,2),d=this._cp3(e,n,0,1);let b;if(4<=l)b=e[3];else{const a=this._sub(n,k);b=this._add(d,a)}this._addAngledTicks(g,
k,n,this._mid(d,b));this._addAngledTicks(g,d,b,this._mid(k,n));break}case "GapExtentMidline":{const n=this._cp2(e,2,0),d=this._cp3(e,n,0,1);let b;if(4<=l)b=e[3];else{const c=this._sub(n,k);b=this._add(d,c)}const a=[];a.push(this._mid(k,d));a.push(this._mid(n,b));g.push(a);break}case "Chevron":{const n=this._cp2(e,-1,-1);let d;if(3<=l)d=e[2];else{const b=this._sub(n,k);this._leftPerpendicular(b);d=this._add(k,b)}g.push([n,this._makeCtrlPt(k),d]);break}case "PerpendicularWithArc":{const n=this._cp2(e,
0,-2),d=this._cp3(e,n,.5,-1);let b=this._sub(n,k);const a=this._norm(b);b[0]/=a;b[1]/=a;const c=this._crossProduct(b,this._sub(d,k));let f=this._dotProduct(b,this._sub(d,k));f<.05*a?f=.05*a:f>.95*a&&(f=.95*a);const m=[k[0]+b[0]*f,k[1]+b[1]*f];this._leftPerpendicular(b);let h=[];h.push([m[0]-b[0]*c,m[1]-b[1]*c]);h.push([m[0]+b[0]*c,m[1]+b[1]*c]);g.push(h);const v=[n[0]+b[0]*c,n[1]+b[1]*c];b=this._sub(n,v);const u=Math.cos(Math.PI/18);let F=Math.sin(Math.PI/18);0>c&&(F=-F);h=[k,n];for(let z=1;9>=z;z++)this._rotateDirect(b,
u,F),h.push(this._add(v,b));g.push(h);break}case "ClosedHalfCircle":{const n=this._cp2(e,2,0),d=this._mid(k,n),b=this._sub(n,d),a=Math.cos(Math.PI/18),c=Math.sin(Math.PI/18),f=[k,n];for(let m=1;18>=m;m++)this._rotateDirect(b,a,c),f.push(this._add(d,b));g.push(f);break}case "TripleParallelExtended":{const n=this._cp2(e,0,-2),d=this._cp3(e,n,1,-2),b=this._mid(k,n),a=this._sub(d,n);this._normalize(a);const c=Math.abs(this._crossProduct(a,this._sub(b,n)))/2,f=this._dist(n,d),m=[n,k];m.push([k[0]+a[0]*
f*.5,k[1]+a[1]*f*.5]);g.push(m);const h=[];h.push([b[0]-a[0]*c,b[1]-a[1]*c]);h.push([b[0]+a[0]*f*.375,b[1]+a[1]*f*.375]);C.setId(h[h.length-1],1);h.push([b[0]+a[0]*f*.75,b[1]+a[1]*f*.75]);g.push(h);g.push([n,d]);break}case "ParallelWithTicks":{const n=this._cp2(e,3,0),d=this._cp3(e,n,.5,-1),b=this._sub(d,n);this._normalize(b);const a=this._crossProduct(b,this._sub(d,k));this._leftPerpendicular(b);this._addAngledTicks(g,k,n,d);this._addAngledTicks(g,this._mix(k,1,b,a),this._mix(n,1,b,a),this._mid(k,
n));break}case "Parallel":{const n=this._cp2(e,3,0),d=this._cp3(e,n,.5,-1),b=this._sub(n,k);this._normalize(b);const a=this._leftPerp(b),c=this._crossProduct(b,this._sub(d,k));let f=[k,n];g.push(f);f=[];f.push([k[0]+a[0]*c,k[1]+a[1]*c]);f.push([n[0]+a[0]*c,n[1]+a[1]*c]);g.push(f);break}case "PerpendicularToFirstSegment":{const n=this._cp2(e,3,0),d=this._cp3(e,n,.5,-1),b=this._mid(k,n),a=this._sub(n,k);this._normalize(a);const c=this._crossProduct(a,this._sub(d,k));this._leftPerpendicular(a);const f=
[];f.push([b[0]-a[0]*c*.25,b[1]-a[1]*c*.25]);f.push([b[0]+a[0]*c*1.25,b[1]+a[1]*c*1.25]);g.push(f);break}case "ParallelOffset":{const n=this._cp2(e,3,0),d=this._cp3(e,n,.5,-1),b=this._sub(n,k);this._normalize(b);const a=this._crossProduct(b,this._sub(d,k));this._leftPerpendicular(b);const c=[];c.push([k[0]-b[0]*a,k[1]-b[1]*a]);c.push([n[0]-b[0]*a,n[1]-b[1]*a]);g.push(c);const f=[];f.push([k[0]+b[0]*a,k[1]+b[1]*a]);f.push([n[0]+b[0]*a,n[1]+b[1]*a]);g.push(f);break}case "OffsetOpposite":{const n=this._cp2(e,
3,0),d=this._cp3(e,n,.5,-1),b=this._sub(n,k);this._normalize(b);const a=this._crossProduct(b,this._sub(d,k));this._leftPerpendicular(b);const c=[];c.push([k[0]-b[0]*a,k[1]-b[1]*a]);c.push([n[0]-b[0]*a,n[1]-b[1]*a]);g.push(c);break}case "OffsetSame":{const n=this._cp2(e,3,0),d=this._cp3(e,n,.5,-1),b=this._sub(n,k);this._normalize(b);const a=this._crossProduct(b,this._sub(d,k));this._leftPerpendicular(b);const c=[];c.push([k[0]+b[0]*a,k[1]+b[1]*a]);c.push([n[0]+b[0]*a,n[1]+b[1]*a]);g.push(c);break}case "CircleWithArc":{let n=
this._cp2(e,3,0);const d=this._cp3(e,n,.5,-1);let b,a;if(4<=l)b=e[3],a=0<this._crossProduct(this._sub(b,n),this._sub(d,n));else{b=n;a=0<this._crossProduct(this._sub(b,k),this._sub(d,k));const v=24*this._geomUnitsPerPoint,u=this._sub(b,k);this._normalize(u,v);const F=Math.sqrt(2)/2;this._rotateDirect(u,F,a?F:-F);n=this._add(k,u)}const c=this._sub(n,k),f=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),h=[n];for(let v=1;36>=v;v++)this._rotateDirect(c,f,m),h.push(this._add(k,c));this._add90DegArc(h,n,b,d,
a);C.setId(h[h.length-8],1);g.push(h);break}case "DoubleJog":{let n=this._cp2(e,-3,1),d;d=3<=l?e[2]:this._add(k,this._sub(k,n));let b;if(4<=l)b=e[3];else{const z=k;k=n;b=d;const A=this._dist(k,z),E=this._dist(b,z);let G=30*this._geomUnitsPerPoint;.5*A<G&&(G=.5*A);.5*E<G&&(G=.5*E);n=this._mix(k,G/A,z,(A-G)/A);d=this._mix(b,G/E,z,(E-G)/E)}const a=this._mid(k,n),c=this._mid(b,d),f=this._dist(k,n),m=this._dist(d,b);let h=Math.min(f,m)/8;h=Math.min(h,24*this._geomUnitsPerPoint);const v=Math.cos(Math.PI/
4);let u=this._sub(k,n);this._normalize(u,h);0<this._crossProduct(u,this._sub(b,n))?this._rotateDirect(u,v,-v):this._rotateDirect(u,v,v);let F=[];F.push(n);F.push(this._add(a,u));F.push(this._sub(a,u));F.push(k);g.push(F);u=this._sub(b,d);this._normalize(u,h);0>this._crossProduct(u,this._sub(k,d))?this._rotateDirect(u,v,v):this._rotateDirect(u,v,-v);F=[];F.push(d);F.push(this._add(c,u));F.push(this._sub(c,u));F.push(b);g.push(F);break}case "PerpendicularOffset":{const n=this._cp2(e,-4,1),d=this._cp3(e,
n,.882353,-1.94),b=this._sub(d,n);0<this._crossProduct(b,this._sub(k,n))?this._rightPerpendicular(b):this._leftPerpendicular(b);const a=[b[0]/8,b[1]/8],c=this._sub(this._mid(n,d),a);g.push([c,k]);break}case "LineExcludingLastSegment":{const n=this._arrowPath(e),d=[];let b=n.length-2;for(;b--;)d.push(n[b]);g.push(d);break}case "MultivertexArrow":{const n=this._arrowPath(e),d=[];this._addArrow(d,n,!1);g.push(d);break}case "CrossedArrow":{const n=this._arrowPath(e),d=[];this._addArrow(d,n,!0);g.push(d);
break}case "ChevronArrow":{const [n,d]=this._arrowLastSeg(e),b=10*this._geomUnitsPerPoint,a=this._sub(k,n);this._normalize(a);const c=this._crossProduct(a,this._sub(d,n)),f=this._leftPerp(a),m=[d[0]-f[0]*c*2,d[1]-f[1]*c*2],h=[];h.push([d[0]+a[0]*b,d[1]+a[1]*b]);h.push(k);h.push([m[0]+a[0]*b,m[1]+a[1]*b]);g.push(h);break}case "ChevronArrowOffset":{const [n,d]=this._arrowLastSeg(e),b=this._sub(k,n);this._normalize(b);const a=this._crossProduct(b,this._sub(d,n));this._leftPerpendicular(b);const c=[d[0]-
b[0]*a,d[1]-b[1]*a],f=[];f.push([c[0]+b[0]*a*.5,c[1]+b[1]*a*.5]);f.push(this._mid(c,k));f.push([c[0]-b[0]*a*.5,c[1]-b[1]*a*.5]);g.push(f);break}case "PartialFirstSegment":{const [n,d]=this._arrowLastSeg(e),b=this._sub(k,n);this._normalize(b);const a=this._crossProduct(b,this._sub(d,n));this._leftPerpendicular(b);g.push([n,[d[0]-b[0]*a,d[1]-b[1]*a]]);break}case "Arch":{const n=this._cp2(e,0,-1),d=this._cp3(e,n,.5,1),b=this._sub(k,n),a=this._mix(d,1,b,.55),c=this._mix(d,1,b,-.55),f=[k];this._addBezier2(f,
k,a,d,4);this._addBezier2(f,d,c,n,4);g.push(f);break}case "CurvedParallelTicks":{const n=this._cp2(e,-4,1),d=this._cp3(e,n,.882353,-1.94),b=this._sub(d,n);0<this._crossProduct(b,this._sub(k,n))?this._rightPerpendicular(b):this._leftPerpendicular(b);const a=[b[0]/8,b[1]/8],c=this._sub(this._mid(n,d),a),f=this._sub(this._mix(n,.75,d,.25),a),m=this._sub(this._mix(n,.25,d,.75),a),h=[n];this._addBezier2(h,n,f,c,3);this._addBezier2(h,c,m,d,3);g.push(h);for(let v=0;8>v;v++){const u=h[2*v+1],F=[this._clone(u)];
F.push(this._add(u,[b[0]/4,b[1]/4]));g.push(F)}break}case "Arc90Degrees":{const n=this._cp2(e,0,-1),d=this._cp3(e,n,.5,1),b=[n];this._add90DegArc(b,n,k,d);g.push(b);break}default:g.push(e)}}return g};return w}();r.EffectControlMeasureLine=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===
q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(q){function p(g,e,l){g=q.call(this,g,!0,!0)||this;g._curveHelper=new D.CurveHelper;g._beginCut=(void 0!==e.beginCut?e.beginCut:1)*l;g._endCut=(void 0!==e.endCut?e.endCut:1)*l;g._middleCut=(void 0!==e.middleCut?e.middleCut:0)*l;g._invert=void 0!==e.invert?e.invert:!1;0>g._beginCut&&(g._beginCut=0);0>g._endCut&&(g._endCut=0);0>g._middleCut&&(g._middleCut=
0);return g}t._inheritsLoose(p,q);p.prototype.processPath=function(g){var e=this._beginCut;const l=this._endCut,k=this._middleCut,n=this._curveHelper.calculatePathLength(g),d=[];if(!this._invert)0===e&&0===l&&0===k?d.push(g):e+l+k>=n||(0===k?(g=this._curveHelper.getSubCurve(g,e,n-l))&&d.push(g):((e=this._curveHelper.getSubCurve(g,e,.5*(n-k)))&&d.push(e),(e=this._curveHelper.getSubCurve(g,.5*(n+k),n-l))&&d.push(e)));else if(0!==e||0!==l||0!==k)e+l+k>=n?d.push(g):((e=this._curveHelper.getSubCurve(g,
0,e))&&d.push(e),(e=this._curveHelper.getSubCurve(g,.5*(n-k),.5*(n+k)))&&d.push(e),(e=this._curveHelper.getSubCurve(g,n-l,l))&&d.push(e));return 0===d.length?null:{paths:d}};return p}(C.PathGeometryCursor);r.EffectCut=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../GeometryWalker"],function(r,t,C,D,x){let w=function(){function p(){}p.local=function(){null===
p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(g,e,l){return new q(g,e,l)};return p}();w.instance=null;let q=function(p){function g(e,l,k){var n,d;e=p.call(this,e,!0,!0)||this;e._walker=new x.GeometryWalker;e._walker.updateTolerance(k);e._endings=l.lineDashEnding;e._customDashPos=-(null!=(n=l.offsetAlongLine)?n:0)*k;e._offsetAtEnd=(null!=(d=l.customEndingOffset)?d:0)*k;e._pattern=new x.DashPattern;e._pattern.init(l.dashTemplate,!0);e._pattern.scale(k);return e}t._inheritsLoose(g,
p);g.prototype.processPath=function(e){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[e]};if(!this.iteratePath){var l=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||(l=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var k=
this._walker.calculatePathLength(e);if(this._pattern.isEmpty()||k<.1*this._pattern.length()||!this._walker.init(e,this._pattern,l))return{paths:[e]}}if(this.iteratePath)e=this._pattern.nextValue();else{switch(this._endings){default:l=.5*this._pattern.firstValue();break;case "HalfGap":l=.5*-this._pattern.lastValue();break;case "FullGap":l=-this._pattern.lastValue();break;case "FullPattern":l=0;break;case "NoConstraint":case "Custom":l=-this._customDashPos}e=l/this._pattern.length();e-=Math.floor(e);
l=e*this._pattern.length();this._pattern.reset();e=this._pattern.nextValue();for(k=!1;l>=e;)l-=e,e=this._pattern.nextValue(),k=!k;e-=l;k?(this._walker.nextPosition(e),e=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(e),e=this._pattern.nextValue(),this._walker.nextPosition(e),e=this._pattern.nextValue())}(l=this._walker.nextCurve(e))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),D.PathHelper.mergePath(l,this._firstCurve),
this._firstCurve=null)):(e=this._pattern.nextValue(),!this._walker.nextPosition(e)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(l=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,l=this._firstCurve,this._firstCurve=null);return{paths:[l]}};return g}(C.PathGeometryCursor);r.EffectDashes=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor",
"./CurveHelper"],function(r,t,C,D){let x=function(){function p(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var g=p.prototype;g.isEmpty=function(){return 0===this._values.length};g.size=function(){return this._values.length};g.init=function(e,l,k=!0){this._setEmpty();if(!e||0===e.length)return!1;for(let n=0;n<e.length;n++){let d=Math.abs(e[n]);k&&1E-7>d&&(d=1E-7);this._values.push(d);this._length+=d}l&&e.length&1&&(this._length*=2);if(0===this._length)return!1;
this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};g.scale=function(e){const l=this._values?this._values.length:0;for(let k=0;k<l;++k)this._values[k]*=e;this._length*=e;this.extPtGap*=e;this.ctrlPtGap*=e};g.addValue=function(e){this._length+=e;this._values.push(e)};g.firstValue=function(){return this._values[0]};g.lastValue=function(){return this._values[this._values.length-1]};g.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);
return this._values[this._currentValue]};g.reset=function(){this._currentValue=-1};g.length=function(){return this._length};g._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return p}(),w=function(){function p(){this.reset()}var g=p.prototype;g.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};g.isValid=function(){return-1!==this.segment};g.copyTo=function(e){e.segment=this.segment;e.segmentLength=
this.segmentLength;e.abscissa=this.abscissa;e.isPathEnd=this.isPathEnd;e.isPartEnd=this.isPartEnd};return p}(),q=function(p){function g(l=0,k=!1){l=p.call(this,l,k)||this;l._tolerance=D.PIXEL_TOLERANCE;l._currentPosition=new w;return l}t._inheritsLoose(g,p);var e=g.prototype;e.updateTolerance=function(l){this._tolerance=D.PIXEL_TOLERANCE*l};e.init=function(l,k,n=!0){n?(this._patternLength=k.length(),this._partExtPtGap=k.extPtGap,this._partCtrlPtGap=k.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=
this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=l;this._seg=-1;return this.setPosAtNextPart()};e.curPositionIsValid=function(){return this._currentPosition.isValid()};e.nextPosition=function(l,k=0){const n=new w;if(!this._nextPosition(l,n,null,k))return!1;n.copyTo(this._currentPosition);return!0};e.curPointAndAngle=function(l){l.pt=this._getPoint(this._currentPosition);const [k,n]=this._getAngle(this._currentPosition);l.ca=k;l.sa=n};e.nextPointAndAngle=function(l,
k,n=0){const d=new w;if(!this._nextPosition(l,d,null,n))return!1;d.copyTo(this._currentPosition);k.pt=this._getPoint(d);const [b,a]=this._getAngle(d);k.ca=b;k.sa=a;return!0};e.nextCurve=function(l){if(0===l)return null;const k=[],n=new w;if(!this._nextPosition(l,n,k,1))return null;n.copyTo(this._currentPosition);return k};e.isPathEnd=function(){return this._currentPosition.isPathEnd};e.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+
1]};e._nextPosition=function(l,k,n,d){if(this._currentPosition.isPathEnd)return!1;var b=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(b/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(k);k.abscissa+l*this._partLengthRatio>k.segmentLength+this._tolerance;)if(n&&(0===n.length&&(0===b?(b=this._path[k.segment],n.push([b[0],b[1]])):n.push(this.getSegCoord2D(this._path,k.segment,b))),b=this._path[k.segment+1],n.push([b[0],b[1]])),b=0,l-=(k.segmentLength-k.abscissa)/
this._partLengthRatio,this._partSegCount)k.segment=this.nextSegment(),k.segmentLength=this.calculateSegLength(this._path,k.segment),k.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===d)return!1;k.segmentLength=this.calculateSegLength(this._path,k.segment);k.isPartEnd=!0;1===d?(k.abscissa=k.segmentLength,k.isPathEnd=!0):k.abscissa=k.segmentLength+l;return!0}this._currentPosition.copyTo(k)}k.abscissa+=l*this._partLengthRatio;n&&(0===n.length&&(0===b?(l=this._path[k.segment],
n.push([l[0],l[1]])):n.push(this.getSegCoord2D(this._path,k.segment,b))),l=k.abscissa/k.segmentLength,1===l?(l=this._path[k.segment+1],n.push([l[0],l[1]])):n.push(this.getSegCoord2D(this._path,k.segment,l)));!this._partSegCount&&Math.abs(k.abscissa-k.segmentLength)<this._tolerance&&(k.isPathEnd=this._partIsLast,k.isPartEnd=!0);return!0};e._getPoint=function(l){if(-1===l.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,l.segment,0>=l.segmentLength?0:l.abscissa/l.segmentLength)};
e._getAngle=function(l){if(-1===l.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,l.segment,0>=l.segmentLength?0:l.abscissa/l.segmentLength)};e.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,
1===C.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var l=this._partSegCount;l;)this.previousSegment(),--l;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;l=this.getStartPointIndex();this._ctrlPtBegin=1===C.getId(this._path[l]);l=
l+this._partSegCount+1;l>=this._path.length&&(l=0);this._ctrlPtEnd=1===C.getId(this._path[l]);if(0<this._patternLength){l=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const k=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let n=Math.round((this._partLength-(l+k))/this._patternLength);0>=n&&(n=0<l+k?0:1);this._partLengthRatio=this._partLength/(l+k+n*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};e.hasNextSegment=
function(){return this._seg<this._path.length-2};e.previousSegment=function(){return--this._seg};e.nextSegment=function(){return++this._seg};e.getStartPointIndex=function(){return this._seg};e.getEndPointIndex=function(){return this._seg+1};return g}(D.CurveHelper);r.DashPattern=x;r.GeometryWalker=q;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(r,t,C){let D=function(){function w(){}
w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(q,p,g){return new x(q,p,g)};return w}();D.instance=null;let x=function(){function w(q,p,g){this._inputGeometries=q;this._curveHelper=new C.CurveHelper;this._width=(void 0!==p.width?p.width:2)*g;switch(p.method){default:this._method="Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";break;case "Square":this._method="Square"}this._option=
p.option;this._offsetFlattenError=C.PIXEL_TOLERANCE*g}w.prototype.next=function(){for(var q=this._inputGeometries.next();q;){if(t.isExtent(q)&&0<this._width){if(0>Math.min(q.xmax-q.xmin,q.ymax-q.ymin)-2*this._width)return q;var p=[];p.push([[q.xmin,q.ymin],[q.xmin,q.ymax],[q.xmax,q.ymax],[q.xmax,q.ymin],[q.xmin,q.ymin]]);p.push([[q.xmin+this._width,q.ymin+this._width],[q.xmax-this._width,q.ymin+this._width],[q.xmax-this._width,q.ymax-this._width],[q.xmin+this._width,q.ymax-this._width],[q.xmin+this._width,
q.ymin+this._width]]);return{rings:p}}if(t.isPolygon(q)&&0<this._width){p=[];for(const g of q.rings){q=this._curveHelper.calculatePathLength(g);const e=this._curveHelper.offset(g,this._width,this._method,4,this._offsetFlattenError);e&&(0>q&&e.reverse(),p.push(e))}if(p.length)return{rings:p}}q=this._inputGeometries.next()}return null};return w}();r.EffectDonut=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../CurveHelper"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(q){function p(g,e,l){g=q.call(this,g,!1,!0)||this;g._curveHelper=new D.CurveHelper;g._length=(void 0!==e.length?e.length:20)*l;g._angle=void 0!==e.angle?e.angle:225;g._position=void 0!==e.position?e.position:50;0>g._length&&(g._length=-g._length);
20>g._position&&(g._position=20);80<g._position&&(g._position=80);g._mirror=!1;return g}t._inheritsLoose(p,q);p.prototype.processPath=function(g){if(this._curveHelper.isEmpty(g,!1))return null;const e=g[0];g=g[g.length-1];this._curveHelper.normalize([g[0]-e[0],g[1]-e[1]]);const l=[e[0]+(g[0]-e[0])*this._position/100,e[1]+(g[1]-e[1])*this._position/100],k=Math.cos((90-this._angle)/180*Math.PI);let n=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(n=-n);this._mirror=!this._mirror;return{paths:[[e,
[l[0]-this._length/2*k,l[1]-this._length/2*n],[l[0]+this._length/2*k,l[1]+this._length/2*n],g]]}};return p}(C.PathGeometryCursor);r.EffectJog=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(r,t,C){let D=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(q,p,g){return new x(q,p,g)};
return w}();D.instance=null;let x=function(){function w(p,g,e){this._inputGeometries=p;this._offsetX=void 0!==g.offsetX?g.offsetX*e:0;this._offsetY=void 0!==g.offsetY?-g.offsetY*e:0}var q=w.prototype;q.next=function(){for(var p=this._inputGeometries.next();p;){if(C.isExtent(p))return{xmin:p.xmin+this._offsetX,xmax:p.xmax+this._offsetX,ymin:p.ymin+this._offsetY,ymax:p.ymax+this._offsetY};if(C.isPolygon(p))return p=t.clone(p),this._moveMultipath(p.rings,this._offsetX,this._offsetY),p;if(C.isPolyline(p))return p=
t.clone(p),this._moveMultipath(p.paths,this._offsetX,this._offsetY),p;if(C.isMultipoint(p))return p=t.clone(p),this._movePath(p.points,this._offsetX,this._offsetY),p;if(C.isPoint(p))return{x:p.x+this._offsetX,y:p.y+this._offsetY};p=this._inputGeometries.next()}return null};q._moveMultipath=function(p,g,e){if(p)for(const l of p)this._movePath(l,g,e)};q._movePath=function(p,g,e){if(p)for(const l of p)l[0]+=g,l[1]+=e};return w}();r.EffectMove=D;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports",
"../../../geometry/support/jsonUtils","../CurveHelper"],function(r,t,C){let D=function(){function w(){}w.local=function(){null===w.instance&&(w.instance=new w);return w.instance};w.prototype.execute=function(q,p,g,e){return new x(q,p,g,e)};return w}();D.instance=null;let x=function(){function w(q,p,g,e){var l;this._inputGeometries=q;this._curveHelper=new C.CurveHelper;this._offset=(null!=(l=p.offset)?l:1)*g;e||(this._offset=-this._offset);this._method=p.method;this._option=p.option;this._offsetFlattenError=
C.PIXEL_TOLERANCE*g}w.prototype.next=function(){for(var q=this._inputGeometries.next();q;){if(0===this._offset)return q;if(t.isExtent(q)){if("Rounded"===this._method&&0<this._offset){var p=this._curveHelper.offset([[q.xmin,q.ymin],[q.xmin,q.ymax],[q.xmax,q.ymax],[q.xmax,q.ymin],[q.xmin,q.ymin]],this._offset,this._method,4,this._offsetFlattenError);return p?{rings:[p]}:null}if(0<Math.min(q.xmax-q.xmin,q.ymax-q.ymin)+2*this._offset)return{xmin:q.xmin-this._offset,xmax:q.xmax+this._offset,ymin:q.ymin-
this._offset,ymax:q.ymax+this._offset}}if(t.isPolygon(q)){var g=[];for(p of q.rings){const e=this._curveHelper.offset(p,this._offset,this._method,4,this._offsetFlattenError);e&&g.push(e)}if(g.length)return{rings:g}}if(t.isPolyline(q)){g=[];for(const e of q.paths)(q=this._curveHelper.offset(e,this._offset,this._method,4,this._offsetFlattenError))&&g.push(q);if(g.length)return{paths:g}}q=this._inputGeometries.next()}return null};return w}();r.EffectOffset=D;Object.defineProperty(r,"__esModule",{value:!0})})},
"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(){function q(p,g,e){this._inputGeometries=p;this._reverse=void 0!==g.reverse?g.reverse:!0}q.prototype.next=function(){for(var p=this._inputGeometries.next();p;){if(!this._reverse)return p;
if(C.isPolyline(p))return p=t.clone(p),D.reverseMultipath(p.paths),p;p=this._inputGeometries.next()}return null};return q}();r.EffectReverse=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(r,t,C,D,x){let w=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=
new p);return p.instance};p.prototype.execute=function(g,e,l){return new q(g,e,l)};return p}();w.instance=null;let q=function(){function p(e,l,k){this._inputGeometries=e;this._rotateAngle=void 0!==l.angle?-l.angle*Math.PI/180:0}var g=p.prototype;g.next=function(){for(var e=this._inputGeometries.next();e;){if(0===this._rotateAngle)return e;var l=C.create();D.getBoundsXY(l,e);const k=(l[2]+l[0])/2;l=(l[3]+l[1])/2;if(x.isExtent(e))return e={rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,
e.ymin],[e.xmin,e.ymin]]]},this._rotateMultipath(e.rings,k,l),e;if(x.isPolygon(e))return e=t.clone(e),this._rotateMultipath(e.rings,k,l),e;if(x.isPolyline(e))return e=t.clone(e),this._rotateMultipath(e.paths,k,l),e;if(x.isMultipoint(e))return e=t.clone(e),this._rotatePath(e.points,k,l),e;if(x.isPoint(e))return e;e=this._inputGeometries.next()}return null};g._rotateMultipath=function(e,l,k){if(e)for(const n of e)this._rotatePath(n,l,k)};g._rotatePath=function(e,l,k){if(e){const n=Math.cos(this._rotateAngle),
d=Math.sin(this._rotateAngle);for(const b of e){e=b[0]-l;const a=b[1]-k;b[0]=l+e*n-a*d;b[1]=k+e*d+a*n}}};return p}();r.EffectRotate=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(r,t,C,D,x){let w=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);
return p.instance};p.prototype.execute=function(g,e,l){return new q(g,e,l)};return p}();w.instance=null;let q=function(){function p(e,l,k){this._inputGeometries=e;this._xFactor=void 0!==l.xScaleFactor?l.xScaleFactor:1.15;this._yFactor=void 0!==l.yScaleFactor?l.yScaleFactor:1.15}var g=p.prototype;g.next=function(){for(var e=this._inputGeometries.next();e;){if(1===this._xFactor&&1===this._yFactor)return e;var l=C.create();D.getBoundsXY(l,e);const k=(l[2]+l[0])/2;l=(l[3]+l[1])/2;if(x.isExtent(e))return e=
{rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]},this._scaleMultipath(e.rings,k,l),e;if(x.isPolygon(e))return e=t.clone(e),this._scaleMultipath(e.rings,k,l),e;if(x.isPolyline(e))return e=t.clone(e),this._scaleMultipath(e.paths,k,l),e;if(x.isMultipoint(e))return e=t.clone(e),this._scalePath(e.points,k,l),e;if(x.isPoint(e))return e;e=this._inputGeometries.next()}return null};g._scaleMultipath=function(e,l,k){if(e)for(const n of e)this._scalePath(n,l,k)};g._scalePath=
function(e,l,k){if(e)for(const n of e)e=(n[1]-k)*this._yFactor,n[0]=l+(n[0]-l)*this._xFactor,n[1]=k+e};return p}();r.EffectScale=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,
g,e)};return q}();x.instance=null;let w=function(){function q(g,e,l){this._inputGeometries=g;this._height=(void 0!==e.amplitude?e.amplitude:2)*l;this._period=(void 0!==e.period?e.period:3)*l;this._style=e.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new D.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new D.GeometryWalker;this._walker.updateTolerance(l)}var p=
q.prototype;p.next=function(){for(var g=this._inputGeometries.next();g;){if(0===this._height||0===this._period)return g;if(t.isPolyline(g)){const e=this._processGeom(g.paths);if(e.length)return{paths:e}}if(t.isPolygon(g)&&(g=this._processGeom(g.rings),g.length))return{rings:g};g=this._inputGeometries.next()}return null};p._processGeom=function(g){const e=[];for(const l of g)if(this._walker.init(l,this._pattern))switch(this._style){default:e.push(this._constructCurve(l,!1));break;case "Square":e.push(this._constructSquare(l));
break;case "Triangle":e.push(this._constructTriangle(l));break;case "Random":e.push(this._constructCurve(l,!0))}else e.push(l);return e};p._constructCurve=function(g,e){const l=new C.PathHelper;var k=this._walker.calculatePathLength(g),n=Math.round(k/this._period);0===n&&(n=1);const d=this._period/16,b=1/(16*n+1);k=2*Math.PI*k/(k/n);n=2*Math.PI*Math.random();const a=2*Math.PI*Math.random(),c=2*Math.PI*Math.random(),f=.75-Math.random()/2,m=.75-Math.random()/2,h={};this._walker.curPointAndAngle(h);
l.startPath(h.pt);let v=0;for(;;)if(this._walker.nextPointAndAngle(d,h)){const u=v;v+=b;let F;if(e){const z=this._height/2*(1+.3*Math.sin(f*k*u+n));F=z*Math.sin(k*u+a);F+=z*Math.sin(m*k*u+c);F/=2}else F=.5*this._height*Math.sin(.5*k*u);l.lineTo([h.pt[0]-F*h.sa,h.pt[1]+F*h.ca])}else{l.lineTo(g[g.length-1]);break}return l.path()};p._constructSquare=function(g){const e=new C.PathHelper;g=this._walker.calculatePathLength(g);Math.round(g/this._period);for(g=!0;;){let l=!1;if(this._walker.curPositionIsValid()){const k=
{};this._walker.curPointAndAngle(k);const n={};if(this._walker.nextPointAndAngle(this._period,n)){const d={};this._walker.nextPointAndAngle(this._period,d)&&(g?(e.startPath(k.pt),g=!1):e.lineTo(k.pt),e.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),e.lineTo([n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca]),e.lineTo([n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca]),e.lineTo([d.pt[0]+this._height/2*d.sa,d.pt[1]-this._height/2*d.ca]),l=!0)}}if(!l){e.lineTo(this._walker.getPathEnd());
break}}return e.path()};p._constructTriangle=function(g){const e=new C.PathHelper;g=this._walker.calculatePathLength(g);Math.round(g/this._period);for(g=!0;;){let l=!1;if(this._walker.curPositionIsValid()){const k={};this._walker.curPointAndAngle(k);const n={};if(this._walker.nextPointAndAngle(this._period/2,n)){const d={};this._walker.nextPointAndAngle(this._period,d)&&(this._walker.nextPosition(this._period/2)&&(g?(e.startPath(k.pt),g=!1):e.lineTo(k.pt),e.lineTo([n.pt[0]-this._height/2*n.sa,n.pt[1]+
this._height/2*n.ca]),e.lineTo([d.pt[0]+this._height/2*d.sa,d.pt[1]-this._height/2*d.ca])),l=!0)}}if(!l){e.lineTo(this._walker.getPathEnd());break}}return e.path()};return q}();r.EffectWave=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums","../GeometryWalker"],function(r,t,C,D,x){let w=function(){function p(){}p.local=function(){null===p.instance&&
(p.instance=new p);return p.instance};p.prototype.execute=function(g,e,l){return new q(g,e,l)};return p}();w.instance=null;let q=function(p){function g(l,k,n){var d,b,a,c;l=p.call(this,l,!0,!0)||this;l._geometryWalker=new x.GeometryWalker;l._geometryWalker.updateTolerance(n);l._angleToLine=null!=(d=k.angleToLine)?d:!0;l._offset=(null!=(b=k.offset)?b:0)*n;l._originalEndings=k.endings;l._offsetAtEnd=(null!=(a=k.customEndingOffset)?a:0)*n;l._position=-(null!=(c=k.offsetAlongLine)?c:0)*n;l._pattern=new x.DashPattern;
l._pattern.init(k.placementTemplate,!1);l._pattern.scale(n);l._endings=l._originalEndings;return l}t._inheritsLoose(g,p);var e=g.prototype;e.processPath=function(l){if(this._pattern.isEmpty())return null;if(this.iteratePath)var k=this._pattern.nextValue();else{this._endings=this._originalEndings===D.PlacementEndings.WithFullGap&&this.isClosed?D.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;let n=!0;switch(this._endings){case D.PlacementEndings.NoConstraint:k=-this._position;
k=this._adjustPosition(k);n=!1;break;default:k=-this._pattern.lastValue()/2;break;case D.PlacementEndings.WithFullGap:k=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case D.PlacementEndings.WithMarkers:k=0;break;case D.PlacementEndings.Custom:k=-this._position,k=this._adjustPosition(k),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(l,this._pattern,n))return null;this._pattern.reset();for(l=0;k>l;)k-=l,l=this._pattern.nextValue();k=l-=
k;this.iteratePath=!0}l={};if(!this._geometryWalker.nextPointAndAngle(k,l)||this._endings===D.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===D.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(l.pt[0]-this._offset*l.sa,l.pt[1]+this._offset*l.ca);this._angleToLine&&this.internalPlacement.setRotateCS(l.ca,l.sa);return this.internalPlacement};
e._adjustPosition=function(l){l/=this._pattern.length();l-=Math.floor(l);return l*this._pattern.length()};return g}(C.PathTransformationCursor);r.PlacementAlongLineSameSize=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/enums":function(){define(["exports"],function(r){r.PlacementEndings=void 0;var t=r.PlacementEndings||(r.PlacementEndings={});t.NoConstraint="NoConstraint";t.WithMarkers="WithMarkers";t.WithFullGap="WithFullGap";t.WithHalfGap="WithHalfGap";t.Custom="Custom";
Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(q){function p(e,l,k){e=q.call(this,e,!1,!0)||this;e._curveHelper=
new D.CurveHelper;e._angleToLine=void 0!==l.angleToLine?l.angleToLine:!0;e._offset=void 0!==l.offset?l.offset*k:0;e._type=l.extremityPlacement;e._position=void 0!==l.offsetAlongLine?l.offsetAlongLine*k:0;e._beginProcessed=!1;return e}t._inheritsLoose(p,q);var g=p.prototype;g.processPath=function(e){let l;switch(this._type){default:this._beginProcessed?(l=this._atExtremities(e,this._position,!1),this.iteratePath=this._beginProcessed=!1):(l=this._atExtremities(e,this._position,!0),this.iteratePath=
this._beginProcessed=!0);break;case "JustBegin":l=this._atExtremities(e,this._position,!0);break;case "JustEnd":l=this._atExtremities(e,this._position,!1);case "None":}return l};g._atExtremities=function(e,l,k){var n=e.length;if(2>n)return null;var d=k?1:n-2;const b=k?n:-1,a=k?1:-1;let c=0;k=k?e[0]:e[n-1];for(n=d;n!==b;n+=a){d=k;k=e[n];const f=this._curveHelper.calculateLength(d,k);if(c+f>l){e=(l-c)/f;const [m,h]=this._curveHelper.getAngleCS(d,k,e);e=C.getCoord2D(d,k,e);this.internalPlacement.setTranslate(e[0]-
this._offset*h,e[1]+this._offset*m);this._angleToLine&&this.internalPlacement.setRotateCS(-m,-h);return this.internalPlacement}c+=f}return null};return p}(C.PathTransformationCursor);r.PlacementAtExtremities=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===
q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(q){function p(g,e,l){g=q.call(this,g,!0,!0)||this;g._walker=new D.GeometryWalker;g._walker.updateTolerance(l);g._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;g._offset=void 0!==e.offset?e.offset*l:0;g._beginGap=void 0!==e.beginPosition?e.beginPosition*l:0;g._endGap=void 0!==e.endPosition?e.endPosition*l:0;g._flipFirst=void 0!==e.flipFirst?e.flipFirst:
!0;g._pattern=new D.DashPattern;g._pattern.init(e.positionArray,!1,!1);g._subPathLen=0;g._posCount=g._pattern.size();g._isFirst=!0;g._prevPos=0;return g}t._inheritsLoose(p,q);p.prototype.processPath=function(g){if(this._pattern.isEmpty())return null;if(this.iteratePath){g=this._pattern.nextValue()*this._subPathLen;var e=this._beginGap+g;g=e-this._prevPos;this._prevPos=e}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(g)-this._beginGap-
this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(g,this._pattern,!1))return null;this._pattern.reset();g=this._pattern.nextValue()*this._subPathLen;e=this._beginGap+g;g=e-this._prevPos;this._prevPos=e;this.iteratePath=!0}e={};if(!this._walker.nextPointAndAngle(g,e,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(e.pt[0]-this._offset*e.sa,e.pt[1]+this._offset*e.ca);g=this._isFirst&&this._flipFirst;let l;this._angleToLine?(l=e.ca,e=e.sa):
(l=1,e=0);g&&(l=-l,e=-e);this.internalPlacement.setRotateCS(l,e);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return p}(C.PathTransformationCursor);r.PlacementAtRatioPositions=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements"],function(r,t){let C=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};
x.prototype.execute=function(w,q,p){return new D(w,q,p)};return x}();C.instance=null;let D=function(){function x(q,p,g){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==p.stepX?Math.abs(p.stepX):16)*g;this._stepY=(void 0!==p.stepY?Math.abs(p.stepY):16)*g;if(0!==this._stepX&&0!==this._stepY&&q&&void 0!==q.rings&&q.rings){this._gridType=void 0!==p.gridType?p.gridType:"Fixed";if("Random"===this._gridType)this._randomness=void 0!==p.randomness?p.randomness/
100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==p.gridAngle?p.gridAngle:0;this._shiftOddRows=void 0!==p.shiftOddRows?p.shiftOddRows:!1;this._offsetX=void 0!==p.offsetX?p.offsetX*g:0;this._offsetY=void 0!==p.offsetY?p.offsetY*g:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*
this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new t.Placement;this._calculateMinMax(q);this._geometry=q}}var w=x.prototype;w.next=function(){return this._geometry?this._nextInside():null};w._calculateMinMax=
function(q){this._yMax=this._yMin=this._xMax=this._xMin=0;let p,g,e,l,k;g=e=Number.MAX_VALUE;l=k=-Number.MAX_VALUE;for(const d of q.rings){const b=d?d.length:0;for(let a=0;a<b;++a){var n=d[a][0]-this._graphicOriginX-this._offsetX;p=d[a][1]-this._graphicOriginY-this._offsetY;q=this._cosAngle*n-this._sinAngle*p;n=this._sinAngle*n+this._cosAngle*p;g=Math.min(g,q);l=Math.max(l,q);e=Math.min(e,n);k=Math.max(k,n)}}g+=this._graphicOriginX;l+=this._graphicOriginX;e+=this._graphicOriginY;k+=this._graphicOriginY;
this._xMin=Math.round(g/this._stepX);this._xMax=Math.round(l/this._stepX);this._yMin=Math.round(e/this._stepY);this._yMax=Math.round(k/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};w._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var q=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(q+=.5*this._stepX);
const p=this._currentY*this._stepY+this._offsetY;this._currentX++;let g;"Random"===this._gridType?(g=this._graphicOriginX+q+this._stepX*this._randomness*(.5-Math.random())*2/3,q=this._graphicOriginY+p+this._stepY*this._randomness*(.5-Math.random())*2/3):(g=this._graphicOriginX+this._cosAngle*q+this._sinAngle*p,q=this._graphicOriginY-this._sinAngle*q+this._cosAngle*p);this._internalPlacement.setTranslate(g,q);return this._internalPlacement}};return x}();r.PlacementInsidePolygon=C;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(q){function p(e,l,k){e=q.call(this,e,!0,!0)||this;e._curveHelper=new D.CurveHelper;e._angleToLine=
void 0!==l.angleToLine?l.angleToLine:!0;e._offset=void 0!==l.offset?l.offset*k:0;e._relativeTo=l.relativeTo;e._position=void 0!==l.startPointOffset?l.startPointOffset*k:0;e._epsilon=.001*k;return e}t._inheritsLoose(p,q);var g=p.prototype;g.processPath=function(e){var l=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=e.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var k=this._curSegment;this._curSegment++;l=e[k-
1];k=e[k];const n=this._curveHelper.calculateLength(l,k);if(n<this._epsilon)continue;e=.5+this._position/n;const [d,b]=this._curveHelper.getAngleCS(l,k,e);e=C.getCoord2D(l,k,e);this.internalPlacement.setTranslate(e[0]-this._offset*b,e[1]+this._offset*d);this._angleToLine&&this.internalPlacement.setRotateCS(d,b);return this.internalPlacement}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&C.reversePath(e);l=this.onLine(e,l);"LineEnd"===this._relativeTo&&C.reversePath(e);return l};g.onLine=
function(e,l){let k,n=!1;switch(this._relativeTo){default:k=this._curveHelper.calculatePathLength(e)/2+l;break;case "LineBeginning":k=l;break;case "LineEnd":k=l,n=!0}const d=e.length;let b=0,a=e[0];for(let c=1;c<d;++c){l=a;a=e[c];const f=this._curveHelper.calculateLength(l,a);if(b+f>k){e=(k-b)/f;const [m,h]=this._curveHelper.getAngleCS(l,a,e);e=C.getCoord2D(l,a,e);l=n?this._offset:-this._offset;this.internalPlacement.setTranslate(e[0]-l*h,e[1]+l*m);this._angleToLine&&(n?this.internalPlacement.setRotateCS(-m,
-h):this.internalPlacement.setRotateCS(m,h));return this.internalPlacement}b+=f}return null};return p}(C.PathTransformationCursor);r.PlacementOnLine=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(r,t,C,D){function x(p,g){const e=Math.PI;for(;Math.abs(g-p)>e+2E-15;)g=g-p>e?g-2*e:g+2*e;return(p+g)/2}let w=function(){function p(){}
p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(g,e,l){return new q(g,e,l)};return p}();w.instance=null;let q=function(p){function g(l,k,n){l=p.call(this,l,!0,!0)||this;l._curveHelper=new D.CurveHelper;l._angleToLine=void 0!==k.angleToLine?k.angleToLine:!0;l._offset=void 0!==k.offset?k.offset*n:0;l._endPoints=void 0!==k.placeOnEndPoints?k.placeOnEndPoints:!0;l._controlPoints=void 0!==k.placeOnControlPoints?k.placeOnControlPoints:!0;l._regularVertices=
void 0!==k.placeOnRegularVertices?k.placeOnRegularVertices:!0;l._tags=[];l._tagIterator=0;return l}t._inheritsLoose(g,p);var e=g.prototype;e.processPath=function(l){this.iteratePath||(this._preparePath(l),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;l=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(l[2]);let k=l[0],n=l[1];if(0!==this._offset){const d=Math.cos(l[2]);k-=this._offset*
Math.sin(l[2]);n+=this._offset*d}this.internalPlacement.setTranslate(k,n);this._tagIterator++;return this.internalPlacement};e._preparePath=function(l){this._tagIterator=this._tags.length=0;const k=C.isClosedPath(l),n=l.length-1;let d=0,b=0,a=0,c=0,f=0,m,h;for(;d<n;){d++;m=l[d-1];h=l[d];const v=C.getId(m),u=C.getId(h);if(this._angleToLine||0!==this._offset)c=this._curveHelper.getAngle(m,h,0);1===d?k?(b=c,a=v):(this._endPoints||this._controlPoints&&1===v)&&this._tags.push([m[0],m[1],c]):1===v?this._controlPoints&&
this._tags.push([m[0],m[1],x(f,c)]):this._regularVertices&&this._tags.push([m[0],m[1],x(f,c)]);if(this._angleToLine||0!==this._offset)f=this._curveHelper.getAngle(m,h,1);d===n&&(k?1===u||1===a?this._controlPoints&&this._tags.push([h[0],h[1],x(f,b)]):this._regularVertices&&this._tags.push([h[0],h[1],x(f,b)]):(this._endPoints||this._controlPoints&&1===u)&&this._tags.push([h[0],h[1],f]))}this._tagIterator=0};return g}(C.PathTransformationCursor);r.PlacementOnVertices=w;Object.defineProperty(r,"__esModule",
{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements"],function(r,t,C,D){let x=function(){function q(){}q.local=function(){null===q.instance&&(q.instance=new q);return q.instance};q.prototype.execute=function(p,g,e){return new w(p,g,e)};return q}();x.instance=null;let w=function(){function q(g,e,l){this._geometry=g;this._offsetX=void 0!==e.offsetX?e.offsetX*
l:0;this._offsetY=void 0!==e.offsetY?e.offsetY*l:0;this._method=void 0!==e.method?e.method:"OnPolygon";this._internalPlacement=new D.Placement}var p=q.prototype;p.next=function(){const g=this._geometry;this._geometry=null;return g&&void 0!==g.rings?this._polygonCenter(g):null};p._polygonCenter=function(g){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":{const e=t.create();C.getBoundsXY(e,g);this._internalPlacement.setTranslate((e[2]+e[0])/2+this._offsetX,(e[3]+e[1])/2-this._offsetY)}}return this._internalPlacement};
return q}();r.PlacementPolygonCenter=x;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(r,t,C,D,x,w,q,p,g,e){const l=Math.PI/180;let k=function(){function a(f,
m,h,v){this._rotationT=D.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const u=h.rect,F=new Float32Array(8);f*=v;m*=v;const z=h.code?u.width*v:h.metrics.width,A=h.code?u.height*v:h.metrics.height;F[0]=f;F[1]=m;F[2]=f+z;F[3]=m;F[4]=f;F[5]=m+A;F[6]=f+z;F[7]=m+A;this._data=F;this._setTextureCoords(u);this._scale=v;this._mosaic=h;this.x=f;this.y=m;this.maxOffset=Math.max(f+z,m+A)}var c=a.prototype;c.setTransform=function(f){this._T=f;this._offsets=null};c._setOffsets=
function(f){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const m=this._offsets,h=new Float32Array(8),v=C.multiply(D.create(),this._rotationT,this._T);D.transformMany(h,f,v);m.upperLeft=p.i1616to32(8*h[0],8*h[1]);m.upperRight=p.i1616to32(8*h[2],8*h[3]);m.lowerLeft=p.i1616to32(8*h[4],8*h[5]);m.lowerRight=p.i1616to32(8*h[6],8*h[7])};c._setTextureCoords=function({x:f,y:m,width:h,height:v}){this._texcoords={upperLeft:p.i1616to32(f,m),upperRight:p.i1616to32(f+h,m),
lowerLeft:p.i1616to32(f,m+v),lowerRight:p.i1616to32(f+h,m+v)}};t._createClass(a,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(f){this._angle=f;C.identity(this._rotationT);C.rotate(this._rotationT,this._rotationT,-f);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",
get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:u,
width:F}=this._mosaic.metrics;var f=F*this._scale,m=Math.abs(u)*this._scale,h=new Float32Array(8);h[0]=this.x;h[1]=this.y;h[2]=this.x+f;h[3]=this.y;h[4]=this.x;h[5]=this.y+m;h[6]=this.x+f;h[7]=this.y+m;f=C.multiply(D.create(),this._rotationT,this._T);D.transformMany(h,h,f);m=f=Infinity;let z=0;var v=0;for(let A=0;4>A;A++){const E=h[2*A],G=h[2*A+1];f=Math.min(f,E);m=Math.min(m,G);z=Math.max(z,E);v=Math.max(v,G)}h=z-f;v-=m;this._bounds=new e(f+h/2,m+v/2,h,v)}return this._bounds}}]);return a}();const n=
(a,c)=>({code:0,page:0,sdf:!0,rect:new g(0,0,11,8),textureBinding:c,metrics:{advance:0,height:4,width:a,left:0,top:0}});let d=function(){function a(f,m,h){this._rotation=0;this._decorate(f,m,h);this.glyphs=f;this.bounds=this._createBounds(f);this.isMultiline=1<m.length;this._hasRotation=0!==h.angle;this._T=this._createGlyphTransform(this.bounds,h);for(const v of f)v.setTransform(this._T)}var c=a.prototype;c.setRotation=function(f){if(0!==f||0!==this._rotation){this._rotation=f;var m=this._T;f=C.fromRotation(D.create(),
f);C.multiply(m,f,m);for(const h of this.glyphs)h.setTransform(this._T)}};c._decorate=function(f,m,h){if(h.decoration&&"none"!==h.decoration&&f.length){var v=h.scale;h="underline"===h.decoration?30:20;var u=f[0].textureBinding;for(const F of m)f.push(new k(F.startX*v,F.startY*v+h*v,n((F.width+F.glyphWidthEnd)*v,u),1))}};c._createBounds=function(f){let m=Infinity,h=Infinity,v=0;var u=0;for(const F of f)m=Math.min(m,F.xTopLeft),h=Math.min(h,F.yTopLeft),v=Math.max(v,F.xTopLeft+F.width),u=Math.max(u,
F.yBottomRight);f=v-m;u-=h;return new e(m+f/2,h+u/2,f,u)};c._createGlyphTransform=function(f,m){const h=l*m.angle,v=D.create(),u=w.create();C.translate(v,v,x.set(u,m.xOffset,-m.yOffset));m.isCIM?C.rotate(v,v,h):(C.translate(v,v,x.set(u,f.x,f.y)),C.rotate(v,v,h),C.translate(v,v,x.set(u,-f.x,-f.y)));return v};t._createClass(a,[{key:"boundsT",get:function(){var f=this.bounds;const m=x.set(w.create(),f.x,f.y);x.transformMat2d(m,m,this._T);return this._hasRotation?(f=Math.max(f.width,f.height),new e(m[0],
m[1],f,f)):new e(m[0],m[1],f.width,f.height)}}]);return a}(),b=function(a,c,f,m,h,v){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(c,f));this.end=Math.max(0,Math.max(c,f));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=m;this.yMin=h;this.yMax=v};r.ShapedGlyph=k;r.ShapingInfo=d;r.shapeGlyphs=function(a,c,f){const m=f.scale,h=[];{var v=[];var u=1/f.scale*f.maxLineWidth;var F=c?a.length-1:0;var z=c?-1:a.length;c=c?-1:1;var A=F,E=0,G=0;let J=
A,B=J,y=0,I=Infinity,S=0;for(;A!==z;){const {code:O,metrics:Y}=a[A];var H=Math.abs(Y.top);10!==O&&32!==O&&(I=Math.min(I,H),S=Math.max(S,H+Y.height));10===O?(A!==F&&(v.push(new b(a,J,A-c,E,I,S)),I=Infinity,S=0),E=0,J=A+c,B=A+c,G=0):32===O?(B=A+c,G=0,y=Y.advance,E+=Y.advance):(E>u&&(B!==J?(H=B-2*c,E-=y,v.push(new b(a,J,H,E-G,I,S)),I=Infinity,S=0,J=B,E=G):(v.push(new b(a,J,A-c,E,I,S)),I=Infinity,S=0,B=J=A,E=0)),E+=Y.advance,G+=Y.advance);A+=c}u=new b(a,J,A-c,E,I,S);0<=u.start&&u.end<a.length&&v.push(u)}for(u=
0;u<v.length;u++);u=F=v[0].yMin;F=v[v.length-1].yMax+f.lineHeight*(v.length-1)+("underline"===f.decoration?4:0)-F;const {vAlign:K,hAlign:L}=f;z=K===q.VAlign.Baseline?1:0;u=(1-z)*-u+F/2*(z?0:K-1)+-26*(z?1:0);for(F=0;F<v.length;F++){const {start:J,end:B,width:y}=v[F];z=y/2*(L+1)*-1-3;c=F*f.lineHeight+u-3;v[F].startX=z;v[F].startY=c;for(A=J;A<=B;A++)E=a[A],10!==E.code&&(G=new k(z+E.metrics.left,c-E.metrics.top,E,m),z+=E.metrics.advance,h.push(G))}return new d(h,v,f)};Object.defineProperty(r,"__esModule",
{value:!0})})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(r,t){function C(z,A){z[0]=A[0];z[1]=A[1];z[2]=A[2];z[3]=A[3];z[4]=A[4];z[5]=A[5];return z}function D(z){z[0]=1;z[1]=0;z[2]=0;z[3]=1;z[4]=0;z[5]=0;return z}function x(z,A,E,G,H,K,L){z[0]=A;z[1]=E;z[2]=G;z[3]=H;z[4]=K;z[5]=L;return z}function w(z,A){const E=A[0],G=A[1],H=A[2],K=A[3],L=A[4];A=A[5];let J=E*K-G*H;if(!J)return null;J=1/J;z[0]=K*J;z[1]=-G*J;z[2]=-H*J;z[3]=E*J;z[4]=(H*A-K*L)*J;z[5]=(G*L-E*A)*J;return z}function q(z){return z[0]*
z[3]-z[1]*z[2]}function p(z,A,E){const G=A[0],H=A[1],K=A[2],L=A[3],J=A[4];A=A[5];const B=E[0],y=E[1],I=E[2],S=E[3],O=E[4];E=E[5];z[0]=G*B+K*y;z[1]=H*B+L*y;z[2]=G*I+K*S;z[3]=H*I+L*S;z[4]=G*O+K*E+J;z[5]=H*O+L*E+A;return z}function g(z,A,E){const G=A[0],H=A[1],K=A[2],L=A[3],J=A[4];A=A[5];const B=Math.sin(E);E=Math.cos(E);z[0]=G*E+K*B;z[1]=H*E+L*B;z[2]=G*-B+K*E;z[3]=H*-B+L*E;z[4]=J;z[5]=A;return z}function e(z,A,E){const G=A[1],H=A[2],K=A[3],L=A[4],J=A[5],B=E[0];E=E[1];z[0]=A[0]*B;z[1]=G*B;z[2]=H*E;z[3]=
K*E;z[4]=L;z[5]=J;return z}function l(z,A,E){const G=A[0],H=A[1],K=A[2],L=A[3],J=A[4];A=A[5];const B=E[0];E=E[1];z[0]=G;z[1]=H;z[2]=K;z[3]=L;z[4]=G*B+K*E+J;z[5]=H*B+L*E+A;return z}function k(z,A){const E=Math.sin(A);A=Math.cos(A);z[0]=A;z[1]=E;z[2]=-E;z[3]=A;z[4]=0;z[5]=0;return z}function n(z,A){z[0]=A[0];z[1]=0;z[2]=0;z[3]=A[1];z[4]=0;z[5]=0;return z}function d(z,A){z[0]=1;z[1]=0;z[2]=0;z[3]=1;z[4]=A[0];z[5]=A[1];return z}function b(z){return"mat2d("+z[0]+", "+z[1]+", "+z[2]+", "+z[3]+", "+z[4]+
", "+z[5]+")"}function a(z){return Math.sqrt(z[0]**2+z[1]**2+z[2]**2+z[3]**2+z[4]**2+z[5]**2+1)}function c(z,A,E){z[0]=A[0]+E[0];z[1]=A[1]+E[1];z[2]=A[2]+E[2];z[3]=A[3]+E[3];z[4]=A[4]+E[4];z[5]=A[5]+E[5];return z}function f(z,A,E){z[0]=A[0]-E[0];z[1]=A[1]-E[1];z[2]=A[2]-E[2];z[3]=A[3]-E[3];z[4]=A[4]-E[4];z[5]=A[5]-E[5];return z}function m(z,A,E){z[0]=A[0]*E;z[1]=A[1]*E;z[2]=A[2]*E;z[3]=A[3]*E;z[4]=A[4]*E;z[5]=A[5]*E;return z}function h(z,A,E,G){z[0]=A[0]+E[0]*G;z[1]=A[1]+E[1]*G;z[2]=A[2]+E[2]*G;z[3]=
A[3]+E[3]*G;z[4]=A[4]+E[4]*G;z[5]=A[5]+E[5]*G;return z}function v(z,A){return z[0]===A[0]&&z[1]===A[1]&&z[2]===A[2]&&z[3]===A[3]&&z[4]===A[4]&&z[5]===A[5]}function u(z,A){const E=z[0],G=z[1],H=z[2],K=z[3],L=z[4];z=z[5];const J=A[0],B=A[1],y=A[2],I=A[3],S=A[4];A=A[5];return Math.abs(E-J)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(J))&&Math.abs(G-B)<=t.EPSILON*Math.max(1,Math.abs(G),Math.abs(B))&&Math.abs(H-y)<=t.EPSILON*Math.max(1,Math.abs(H),Math.abs(y))&&Math.abs(K-I)<=t.EPSILON*Math.max(1,Math.abs(K),
Math.abs(I))&&Math.abs(L-S)<=t.EPSILON*Math.max(1,Math.abs(L),Math.abs(S))&&Math.abs(z-A)<=t.EPSILON*Math.max(1,Math.abs(z),Math.abs(A))}const F=Object.freeze({__proto__:null,copy:C,identity:D,set:x,invert:w,determinant:q,multiply:p,rotate:g,scale:e,translate:l,fromRotation:k,fromScaling:n,fromTranslation:d,str:b,frob:a,add:c,subtract:f,multiplyScalar:m,multiplyScalarAndAdd:h,exactEquals:v,equals:u,mul:p,sub:f});r.add=c;r.copy=C;r.determinant=q;r.equals=u;r.exactEquals=v;r.frob=a;r.fromRotation=k;
r.fromScaling=n;r.fromTranslation=d;r.identity=D;r.invert=w;r.mat2d=F;r.mul=p;r.multiply=p;r.multiplyScalar=m;r.multiplyScalarAndAdd=h;r.rotate=g;r.scale=e;r.set=x;r.str=b;r.sub=f;r.subtract=f;r.translate=l})},"esri/chunks/mat2df32":function(){define(["exports"],function(r){function t(){const g=new Float32Array(6);g[0]=1;g[3]=1;return g}function C(g){const e=new Float32Array(6);e[0]=g[0];e[1]=g[1];e[2]=g[2];e[3]=g[3];e[4]=g[4];e[5]=g[5];return e}function D(g,e,l,k,n,d){const b=new Float32Array(6);
b[0]=g;b[1]=e;b[2]=l;b[3]=k;b[4]=n;b[5]=d;return b}function x(g,e){return new Float32Array(g,e,6)}function w(g,e,l,k){const n=e[k];e=e[k+1];g[k]=l[0]*n+l[2]*e+l[4];g[k+1]=l[1]*n+l[3]*e+l[5]}function q(g,e,l,k=0,n=0,d=2){for(n=n||e.length/d;k<n;k++)w(g,e,l,k*d)}const p=Object.freeze({__proto__:null,create:t,clone:C,fromValues:D,createView:x,transform:w,transformMany:q});r.clone=C;r.create=t;r.createView=x;r.fromValues=D;r.mat2df32=p;r.transform=w;r.transformMany=q})},"esri/chunks/vec2f32":function(){define(["exports"],
function(r){function t(){return new Float32Array(2)}function C(b){const a=new Float32Array(2);a[0]=b[0];a[1]=b[1];return a}function D(b,a){const c=new Float32Array(2);c[0]=b;c[1]=a;return c}function x(b,a){return new Float32Array(b,a,2)}function w(){return t()}function q(){return D(1,1)}function p(){return D(1,0)}function g(){return D(0,1)}const e=t(),l=q(),k=p(),n=g(),d=Object.freeze({__proto__:null,create:t,clone:C,fromValues:D,createView:x,zeros:w,ones:q,unitX:p,unitY:g,ZEROS:e,ONES:l,UNIT_X:k,
UNIT_Y:n});r.ONES=l;r.UNIT_X=k;r.UNIT_Y=n;r.ZEROS=e;r.clone=C;r.create=t;r.createView=x;r.fromValues=D;r.ones=q;r.unitX=p;r.unitY=g;r.vec2f32=d;r.zeros=w})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(r,t){return function(){function C(x,w,q,p){this.center=t.fromValues(x,w);this.centerT=t.create();this.halfWidth=q/2;this.halfHeight=p/2;this.width=q;this.height=p}var D=C.prototype;
D.clone=function(){return new C(this.x,this.y,this.width,this.height)};D.serialize=function(x){x.writeF32(this.center[0]);x.writeF32(this.center[1]);x.push(this.width);x.push(this.height);return x};D.findCollisionDelta=function(x,w=4){return Math.log2(Math.min((x.halfWidth+this.halfWidth+w)/Math.abs(x.centerT[0]-this.centerT[0]),(x.halfHeight+this.halfHeight+w)/Math.abs(x.centerT[1]-this.centerT[1])))};D.extend=function(x){const w=Math.min(this.xmin,x.xmin),q=Math.min(this.ymin,x.ymin),p=Math.max(this.xmax,
x.xmax)-w;x=Math.max(this.ymax,x.ymax)-q;this.width=p;this.height=x;this.halfWidth=p/2;this.halfHeight=x/2;this.x=w+p/2;this.y=q+x/2};C.deserialize=function(x){const w=x.readF32(),q=x.readF32(),p=x.readInt32();x=x.readInt32();return new C(w,q,p,x)};r._createClass(C,[{key:"x",get:function(){return this.center[0]},set:function(x){this.center[0]=x}},{key:"y",get:function(){return this.center[1]},set:function(x){this.center[1]=x}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",
get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return C}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe",
"../../../../../../symbols/cim/effects/CIMEffectHelper"],function(r,t){return function(){function C(){}var D=C.prototype;D.bindFeature=function(x,w,q){};D.write=function(x,w,q){var p;if(r.isNone(this._effects)||0===(null==(p=this._effects)?void 0:p.length))return this._write(x,w);q=t.CIMEffectHelper.executeEffects(this._effects,w.readLegacyGeometryForDisplay());for(p=t.CIMEffectHelper.next(q);p;)this._write(x,w,p),p=t.CIMEffectHelper.next(q)};D._write=function(x,w,q){};return C}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports",
"../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(r,t,C,D,x){const w=96/72;let q=function(){function p(){}p.executeEffects=function(g,e){e=C.cloneAndDecodeGeometry(e);e=new D.SimpleGeometryCursor(e);for(const l of g)(g=x.getEffectOperator(l))&&(e=g.execute(e,l,w,!0));return e};p.next=function(g){g=g.next();C.deltaEncodeGeometry(g);return g};p.applyEffects=function(g,e){if(!g)return e;e=new D.SimpleGeometryCursor(e);for(var l of g)(g=x.getEffectOperator(l))&&
(e=g.execute(e,l,1,!1));for(l=null;g=e.next();)l?t.isPolyline(l)?t.isPolyline(g)&&l.paths.push(...g.paths):t.isPolygon(l)&&t.isPolygon(g)&&l.rings.push(...g.rings):l=g;return l};return p}();r.CIMEffectHelper=q;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(r,t){let C=function(){function D(x){this._geometry=x}D.prototype.next=function(){const x=this._geometry;this._geometry=null;return x};return D}();r.SimpleGeometryCursor=
C;r.clone=function(D){return t.clone(D)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(r,
t,C,D,x,w,q,p,g,e,l,k){return function(n){function d(b,a,c,f,m,h,v,u,F,z,A,E,G,H,K,L,J,B,y,I,S,O,Y){var R=n.call(this)||this;R.angle=f;R.height=v;R.width=h;R.xOffset=a*y;R.yOffset=c*y;R._markerPlacement=I;R._effects=S;R._anchorX=.5-(.5+L)*K.width/K.width;R._anchorY=.5-(.5+J)*K.height/K.height;R._minMaxZoom=p.i1616to32(Math.round(O*q.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(Y*q.MIN_MAX_ZOOM_PRECISION_FACTOR));a=(1===H?q.BITSET_MARKER_ALIGNMENT_MAP:q.BITSET_MARKER_ALIGNMENT_SCREEN)|(A?q.BITSET_GENERIC_LOCK_COLOR:
0)|(G?q.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(E?q.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);c=K&&K.sdf;b=g.MarkerMaterialKey.load(b);b.sdf=c;b.pattern=!0;b.textureBinding=K.textureBinding;R._materialKey=b.data;R._fillColor=m;R._outlineColor=F;R._sizeOutlineWidth=p.i8888to32(Math.round(Math.min(Math.sqrt(128*h),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*z),255)),Math.round(Math.min(Math.sqrt(128*u),255)));m=K.rect.x+q.SPRITE_PADDING;u=K.rect.y+q.SPRITE_PADDING;
F=m+K.width;K=u+K.height;R._offsets.xUpperLeft=m;R._offsets.yUpperLeft=u;R._offsets.xUpperRight=F;R._offsets.yUpperRight=u;R._offsets.xBottomLeft=m;R._offsets.yBottomLeft=K;R._offsets.xBottomRight=F;R._offsets.yBottomRight=K;R._texUpperLeft=p.i1616to32(m,u);R._texUpperRight=p.i1616to32(F,u);R._texBottomLeft=p.i1616to32(m,K);R._texBottomRight=p.i1616to32(F,K);h=h*B*y;v=v*B*y;R._bitestAndDistRatio=p.i1616to32(a,Math.round(64*B));R._computedWidth=h;R._computedHeight=v;h=x.create();v=D.create();R._applyTransformation(v,
h);return R}r._inheritsLoose(d,n);d.fromCIMMarker=function(b,a,c){const f=b.size,m=(a&&a.width||1)/(a&&a.height||1)*b.scaleX;var h=b.scaleSymbolsProportionally&&b.frameHeight?f/b.frameHeight:1;let v=w.premultiplyAlphaRGBA(b.color);const u=w.premultiplyAlphaRGBA(b.outlineColor),F=C.pt2px(f),z=F*m,A=C.pt2px(b.offsetX||0),E=C.pt2px(b.offsetY||0);h*=C.pt2px(b.outlineWidth||0);const G=b.alignment||0,H=C.pt2px(b.referenceSize),[K,L]=e.getMinMaxZoom(b.scaleInfo,c);a.sdf||0!==v||(v=-1);c=b.rotation||0;b.rotateClockwise||
(c=-c);let J=0,B=0;const y=b.anchorPoint;y&&(b.isAbsoluteAnchorPoint?f&&(J=-y.x/(f*m),B=y.y/f):(J=y.x,B=y.y));a=new d(b.materialKey,A,E,c,v,z,F,H,u,h,b.colorLocked,b.scaleSymbolsProportionally,!1,G,a,J,B,b.sizeRatio,t.unwrapOr(b.scaleFactor,1),b.markerPlacement,b.effects,K,L);a._vertexBoundsScaleX=b.maxVVSize?b.maxVVSize/z:1;a._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/F:1;return a};d.fromPictureMarker=function(b,a){const c=Math.round(C.pt2px(b.width)),f=Math.round(C.pt2px(b.height)),m=q.PICTURE_FILL_COLOR,
h=Math.round(C.pt2px(b.xoffset||0)),v=Math.round(C.pt2px(b.yoffset||0));a=new d(b.materialKey,h,v,b.angle,m,c,f,f,0,0,!1,!1,!1,0,a,0,0,1,1,null,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);a._vertexBoundsScaleX=b.maxVVSize?b.maxVVSize/b.width:1;a._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/b.height:1;return a};d.fromSimpleMarker=function(b,a){const c=w.premultiplyAlphaRGBAArray(b.color),f=Math.round(C.pt2px(b.size)),m=Math.round(C.pt2px(b.xoffset||0)),h=Math.round(C.pt2px(b.yoffset||0)),v=b.style;
var u=b.outline;const F=(u&&u.color&&w.premultiplyAlphaRGBAArray(u.color))|0;u=(u&&u.width&&Math.round(C.pt2px(u.width)))|0;a=new d(b.materialKey,m,h,b.angle,c,f,f,f,F,u,!1,!1,"esriSMSCross"===v||"esriSMSX"===v,0,a,0,0,1.96875,1,null,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);a.boundsType="esriSMSCircle"===v?"circle":"square";a._vertexBoundsScaleX=b.maxVVSize?b.maxVVSize/b.size:1;a._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/b.size:1;return a};d.fromLineSymbolMarker=function(b,a){const c=w.premultiplyAlphaRGBAArray(b.color),
f=Math.round(C.pt2px(6*b.lineWidth)),m="cross"===b.style||"x"===b.style;switch(b.placement){case "begin-end":var h="Both";break;case "begin":h="JustBegin";break;case "end":h="JustEnd";break;default:h="None"}h={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:h,offsetAlongLine:0};a=new d(b.materialKey,0,0,0,c,f,f,f/6,c,m?Math.round(C.pt2px(b.lineWidth)):0,!1,!1,m,1,a,0,0,1.96875,1,h,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);a.boundsType="circle"===b.style?"circle":
"square";return a};return d}(l(k))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){const k=3.14159265359/180;return n=>function(d){function b(...c){c=d.call(this,...c)||this;c.angle=0;c.xOffset=0;c.yOffset=0;c.width=0;c.height=0;c.boundsType="square";c._anchorX=0;c._anchorY=0;c._computedWidth=0;c._computedHeight=0;c._vertexBoundsScaleX=1;c._vertexBoundsScaleY=1;c._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};c.geometryType=e.WGLGeometryType.MARKER;return c}r._inheritsLoose(b,
d);var a=b.prototype;a._write=function(c,f,m){const h=f.getDisplayId();c.recordStart(h,this._materialKey,this.geometryType,!0);this._writeGeometry(c,f,h,m);c.recordEnd()};a._writeGeometry=function(c,f,m,h){if(t.isSome(this._markerPlacement))return this._writePlacedMarkers(c,f,h);f=h?p.deltaDecodeGeometry(p.convertFromGeometry(h),2):"esriGeometryPolygon"===f.geometryType?f.readCentroid():f.readGeometryForDisplay();if(!t.isNone(f)){if(f.isPoint){const [v,u]=f.coords;return!c.hasAggregates&&c.hasPixelBufferEnabled&&
(0>v||512<=v||0>u||512<=u)?void 0:this._writeVertices(c,m,this._getPos(v,u),v,u)}f.forEachVertex((v,u)=>this._writeVertices(c,m,this._getPos(v,u),v,u))}};a._writePlacedMarkers=function(c,f,m){m=null!=m?m:f.readLegacyGeometryForDisplay();if(m=g.CIMMarkerPlacementHelper.getPlacement(m,t.unwrap(this._markerPlacement),C.pt2px(1))){f=f.getDisplayId();for(var h=q.create(),v=x.create(),u=m.next();null!=u;){const {tx:F,ty:z}=u;-128<=F&&640>=F&&-128<=z&&640>=z&&(this._applyTransformation(v,h,u.getAngle()/
k),this._writeVertices(c,f,this._getPos(F,z),F,z));u=m.next()}}};a._writeVertices=function(c,f,m,h,v){const u=c.vertexCount();c.vertexBounds(h+this.xOffset,v-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);c.vertexWrite(m);c.vertexWrite(this._offsetUpperLeft);c.vertexWrite(this._texUpperLeft);c.vertexWrite(this._bitestAndDistRatio);c.vertexWrite(f);c.vertexWrite(this._fillColor);c.vertexWrite(this._outlineColor);c.vertexWrite(this._sizeOutlineWidth);
c.vertexWrite(this._minMaxZoom);c.vertexEnd();c.vertexWrite(m);c.vertexWrite(this._offsetUpperRight);c.vertexWrite(this._texUpperRight);c.vertexWrite(this._bitestAndDistRatio);c.vertexWrite(f);c.vertexWrite(this._fillColor);c.vertexWrite(this._outlineColor);c.vertexWrite(this._sizeOutlineWidth);c.vertexWrite(this._minMaxZoom);c.vertexEnd();c.vertexWrite(m);c.vertexWrite(this._offsetBottomLeft);c.vertexWrite(this._texBottomLeft);c.vertexWrite(this._bitestAndDistRatio);c.vertexWrite(f);c.vertexWrite(this._fillColor);
c.vertexWrite(this._outlineColor);c.vertexWrite(this._sizeOutlineWidth);c.vertexWrite(this._minMaxZoom);c.vertexEnd();c.vertexWrite(m);c.vertexWrite(this._offsetBottomRight);c.vertexWrite(this._texBottomRight);c.vertexWrite(this._bitestAndDistRatio);c.vertexWrite(f);c.vertexWrite(this._fillColor);c.vertexWrite(this._outlineColor);c.vertexWrite(this._sizeOutlineWidth);c.vertexWrite(this._minMaxZoom);c.vertexEnd();c.indexWrite(u+0);c.indexWrite(u+1);c.indexWrite(u+2);c.indexWrite(u+1);c.indexWrite(u+
3);c.indexWrite(u+2)};a._applyTransformation=function(c,f,m=0){D.identity(c);D.translate(c,c,q.fromValues(this.xOffset,-this.yOffset));0!==this.angle+m&&D.rotate(c,c,k*(this.angle+m));m=this._computedWidth;const h=this._computedHeight,v=(this._anchorX-.5)*m,u=(this._anchorY-.5)*h;w.set(f,v,u);w.transformMat2d(f,f,c);this._offsetUpperLeft=l.i1616to32(16*f[0],16*f[1]);this._offsets.xUpperLeft=f[0];this._offsets.yUpperLeft=f[1];w.set(f,v+m,u);w.transformMat2d(f,f,c);this._offsetUpperRight=l.i1616to32(16*
f[0],16*f[1]);this._offsets.xUpperRight=f[0];this._offsets.yUpperRight=f[1];w.set(f,v,u+h);w.transformMat2d(f,f,c);this._offsetBottomLeft=l.i1616to32(16*f[0],16*f[1]);this._offsets.xBottomLeft=f[0];this._offsets.yBottomLeft=f[1];w.set(f,v+m,u+h);w.transformMat2d(f,f,c);this._offsetBottomRight=l.i1616to32(16*f[0],16*f[1]);this._offsets.xBottomRight=f[0];this._offsets.yBottomRight=f[1]};a._getPos=function(c,f){return l.i1616to32(Math.round(8*c),Math.round(8*f))};return b}(n)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h){function v(K,L){const J=K.length;K.push(null);L.then(B=>K[J]=B);return K}function u(K){return!!(K&1)}const F=D.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),z=[];D={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:0};const A={...w.errorPointSymbolJSON,hash:JSON.stringify(w.errorPointSymbolJSON),materialKey:p.createMaterialKey(q.WGLGeometryType.MARKER,D)},E={...w.errorPolylineSymbolJSON,hash:JSON.stringify(w.errorPolylineSymbolJSON),
materialKey:p.createMaterialKey(q.WGLGeometryType.LINE,D)},G={...w.errorPolygonSymbolJSON,hash:JSON.stringify(w.errorPolygonSymbolJSON),materialKey:p.createMaterialKey(q.WGLGeometryType.FILL,D)};w=function(){function K(J,B){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new c.default;this._fetchResource=J;this._tileInfo=B}var L=K.prototype;
L.createTemplateGroup=function(J,B){this._initErrorTemplates();const y=J.hash;if(this._symbolToTemplate.has(y))return this._symbolToTemplate.get(y);const I=[];B&&this._createMeshTemplates(I,B,!0);this._createMeshTemplates(I,J,!1);J=this._createGroupId("expanded-cim"===J.type&&H(J));this._idToTemplateGroup.set(J,I);this._symbolToTemplate.set(y,J);return J};L.getTemplateGroup=function(J){return this._idToTemplateGroup.has(J)?this._idToTemplateGroup.get(J):z};L.getDynamicTemplateGroup=function(J){if(!this._idToTemplateGroup.has(J))return z;
u(J)||F.error("mapview-template-store",`Id ${J} does not refer to a dynamic template`);return this._idToTemplateGroup.get(J)};L.getMosaicItem=function(J,B){const y=this._createTemplateId(),I=new Promise(S=>this._idToResolver.set(y,S));this._fetchQueue.push({symbol:J,id:y,glyphIds:B});return I};L.finalize=function(J){return this._fetchQueue.length||this._lock.isHeld()?c.withLock(this._lock,this._fetchAllQueuedResources.bind(this),J):Promise.resolve()};L._initErrorTemplates=function(){this._errorTemplates||
(this._errorTemplates={fill:this._createMeshTemplates([],G,!1),marker:this._createMeshTemplates([],A,!1),line:this._createMeshTemplates([],E,!1)})};L._fetchAllQueuedResources=function(J){if(!this._fetchQueue.length)return Promise.resolve();const B=this._fetchQueue,y=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(y).then(()=>this._fetchResource(B,J).then(I=>{for(const {id:S,mosaicItem:O}of I)this._idToResolver.get(S)(O),this._idToResolver.delete(S)})).catch(I=>{x.isAbortError(I)?
this._fetchQueue=this._fetchQueue.concat(B):"worker:port-closed"!==I.name&&F.error(new C("mapview-template-store","Unable to fetch requested texture resources",I))})};L._createGroupId=function(J){return this._idCounter++<<1|(J?1:0)};L._createTemplateId=function(){return this._templateIdCounter++};L._createSMS=function(){var J=t._asyncToGenerator(function*(B){const {spriteMosaicItem:y}=yield this.getMosaicItem(B);return f.ok(y,F)?b.fromSimpleMarker(B,y):this._markerError});return function(B){return J.apply(this,
arguments)}}();L._createPMS=function(){var J=t._asyncToGenerator(function*(B){const {spriteMosaicItem:y}=yield this.getMosaicItem(B);return f.ok(y,F)?b.fromPictureMarker(B,y):this._markerError});return function(B){return J.apply(this,arguments)}}();L._createSFS=function(){var J=t._asyncToGenerator(function*(B,y){const {spriteMosaicItem:I}=yield this.getMosaicItem(B);return f.ok(I,F)?n.fromSimpleFill(B,I,y):this._fillError});return function(B,y){return J.apply(this,arguments)}}();L._createPFS=function(){var J=
t._asyncToGenerator(function*(B,y){const {spriteMosaicItem:I}=yield this.getMosaicItem(B);return f.ok(I,F)?n.fromPictureFill(B,I,y):this._fillError});return function(B,y){return J.apply(this,arguments)}}();L._createSLS=function(){var J=t._asyncToGenerator(function*(B,y){({spriteMosaicItem:y}=yield this.getMosaicItem(B));return f.ok(y,F)?d.fromSimpleLine(B,y):this._lineError});return function(B,y){return J.apply(this,arguments)}}();L._createLMS=function(){var J=t._asyncToGenerator(function*(B){const {spriteMosaicItem:y}=
yield this.getMosaicItem(B);return f.ok(y,F)?b.fromLineSymbolMarker(B,y):this._markerError});return function(B){return J.apply(this,arguments)}}();L._createTS=function(){var J=t._asyncToGenerator(function*(B){const {glyphMosaicItems:y}=yield this.getMosaicItem(B);return a.fromText(B,y)});return function(B){return J.apply(this,arguments)}}();L._createCIMText=function(){var J=t._asyncToGenerator(function*(B){const {glyphMosaicItems:y}=yield this.getMosaicItem(h.cimLayerToRasterizationInfo(B),m.codepoints(B.text));
return f.ok(y,F)?a.fromCIMText(B,y,this._tileInfo):this._textError});return function(B){return J.apply(this,arguments)}}();L._createCIMFill=function(){var J=t._asyncToGenerator(function*(B){const {spriteMosaicItem:y}=yield this.getMosaicItem(h.cimLayerToRasterizationInfo(B));return f.ok(y,F)?n.fromCIMFill(B,y,this._tileInfo):this._fillError});return function(B){return J.apply(this,arguments)}}();L._createCIMLine=function(){var J=t._asyncToGenerator(function*(B){const {spriteMosaicItem:y}=yield this.getMosaicItem(h.cimLayerToRasterizationInfo(B));
return f.ok(y,F)?d.fromCIMLine(B,y,this._tileInfo):this._lineError});return function(B){return J.apply(this,arguments)}}();L._createCIMMarker=function(){var J=t._asyncToGenerator(function*(B){const {spriteMosaicItem:y}=yield this.getMosaicItem(h.cimLayerToRasterizationInfo(B));return f.ok(y,F)?b.fromCIMMarker(B,y,this._tileInfo):this._markerError});return function(B){return J.apply(this,arguments)}}();L._createCIM=function(){var J=t._asyncToGenerator(function*(B){const y=B.templateHash;if(this._cimTemplateCache.has(y))return this._cimTemplateCache.get(y);
let I;switch(B.type){case "marker":I=this._createCIMMarker(B);break;case "line":I=this._createCIMLine(B);break;case "fill":I=this._createCIMFill(B);break;case "text":I=this._createCIMText(B)}I.then(S=>this._cimTemplateCache.set(y,S));return I});return function(B){return J.apply(this,arguments)}}();L._createDynamicCIM=function(J){const B=J.templateHash;if(this._cimTemplateCache.has(B))return this._cimTemplateCache.get(B);let y;switch(J.type){case "marker":y=l.fromCIMMarker(J,this._tileInfo);break;
case "line":y=e.fromCIMLine(J,this._tileInfo);break;case "fill":y=g.fromCIMFill(J,this._tileInfo);break;case "text":y=k.fromCIMText(J,this._tileInfo)}this._cimTemplateCache.set(B,y);return y};L._createPrimitiveMeshTemplates=function(J,B,y){switch(B.type){case "esriSMS":return v(J,this._createSMS(B));case "esriPMS":return v(J,this._createPMS(B));case "esriSFS":return v(J,this._createSFS(B,y));case "line-marker":return v(J,this._createLMS(B));case "esriPFS":return v(J,this._createPFS(B,y));case "esriSLS":return v(J,
this._createSLS(B,!1));case "esriTS":return v(J,this._createTS(B));default:return F.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),J}};L._createMeshTemplates=function(J,B,y){if(-1!==B.type.indexOf("3d"))return F.error("3D symbols are not supported with MapView"),J;if("expanded-cim"===B.type){for(const I of B.layers)"function"===typeof I.materialHash?J.push(this._createDynamicCIM(I)):v(J,this._createCIM(I));return J}if("composite-symbol"===B.type){for(const I of B.layers)this._createPrimitiveMeshTemplates(J,
I,y);return J}return"cim"===B.type||"label"===B.type||"web-style"===B.type?J:this._createPrimitiveMeshTemplates(J,B,y)};t._createClass(K,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return K}();const H=K=>{if(!K.layers)return!1;for(const L of K.layers)if("function"===
typeof L.materialHash)return!0;return!1};r.WGLTemplateStore=w;r.errorPointSchema2D=A;r.errorPolygonSchema2D=G;r.errorPolylineSchema2D=E;r.isDynamicId=u;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){return function(k){function n(d,b,a){var c;var f=k.call(this,d)||this;f._minMaxZoom=w.i1616to32(Math.round(b*D.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(a*D.MIN_MAX_ZOOM_PRECISION_FACTOR));p.isFunction(d.color)?f._dynamicPropertyMap.set("fillColor",(A,E,G)=>(A=d.color(A,E,G))&&C.premultiplyAlphaRGBA(A)||0):(b=d.color,f.fillColor=b&&C.premultiplyAlphaRGBA(b)||0);let m=0;p.isFunction(d.height)||(m=d.height||0);const h="CIMMarkerPlacementInsidePolygon"===(null==(c=d.cim.placement)?
void 0:c.type)&&d.cim.placement.shiftOddRows?2:1;f._dynamicPropertyMap.set("_height",(A,E,G)=>p.isFunction(d.height)?d.height(A,E,G)*h:m*h);let v=0;p.isFunction(d.offsetX)||(v=t.pt2px(d.offsetX||0)+128,255<v&&(v=255));f._dynamicPropertyMap.set("_offsetX",(A,E,G)=>p.isFunction(d.offsetX)?(A=t.pt2px(d.offsetX(A,E,G))+128,255<A&&(A=255),A):v);let u=1;p.isFunction(d.scaleX)||(u=d.scaleX||1);f._dynamicPropertyMap.set("_scaleX",(A,E,G)=>p.isFunction(d.scaleX)?d.scaleX(A,E,G):u);let F=0;p.isFunction(d.offsetY)||
(F=t.pt2px(-d.offsetY||0)+128,255<F&&(F=255));f._dynamicPropertyMap.set("_offsetY",(A,E,G)=>p.isFunction(d.offsetY)?(A=t.pt2px(-d.offsetY(A,E,G))+128,255<A&&(A=255),A):F);let z=0;p.isFunction(d.angle)||(z=x.radToByte(d.angle)||0);f._dynamicPropertyMap.set("_angle",(A,E,G)=>p.isFunction(d.angle)?x.radToByte(d.angle(A,E,G)):z);f._effects=d.effects;f._cimFillLayer=d;f._fillMaterialKey=q.FillMaterialKey.load(d.materialKey);return f}r._inheritsLoose(n,k);n.fromCIMFill=function(d,b){const [a,c]=p.getMinMaxZoom(d.scaleInfo,
b);return new n(d,a,c)};n.prototype.bindFeature=function(d,b,a){const c=d.readLegacyFeature();this._dynamicPropertyMap.forEach((h,v)=>{this[v]=h(c,b,a)});d=this._fillMaterialKey;var f=this._materialCache,m=this._cimFillLayer.materialHash;m=m(c,b,a);m=f.get(m);f=null;m&&l.ok(m.spriteMosaicItem)&&(f=m.spriteMosaicItem);if(f){const {rect:h,width:v,height:u}=f;m=h.x+D.SPRITE_PADDING;const F=h.y+D.SPRITE_PADDING,z=m+v,A=F+u;let E=Math.round(t.pt2px(this._height));255<E?E=255:0>=E&&(E=A-F);let G=Math.round(t.pt2px(this._height/
u*v||0));255<G?G=255:0>=G&&(G=z-m);const H=this._scaleX;this.tl=w.i1616to32(m,F);this.br=w.i1616to32(z,A);this.aux2=w.i8888to32(G,E,this._offsetX,this._offsetY);this.aux3=w.i8888to32(H,1,this._angle,0);d.sdf=f.sdf;d.pattern=!0;d.textureBinding=f.textureBinding}else this.aux3=this.aux2=this.br=this.tl=0,d.sdf=!1,d.pattern=!1,d.textureBinding=0;this._materialKey=d.data};return n}(g(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(r,t,C,D,x,w,q,p){return g=>function(e){function l(...n){n=e.call(this,...n)||this;n.forceLibtess=!1;n._bitset=0;n._lineTemplate=null;n.geometryType=D.WGLGeometryType.FILL;return n}r._inheritsLoose(l,e);var k=l.prototype;k._maybeAddLineTemplate=function(n){this._lineTemplate=p.fromFillOutline(n)};k._write=function(n,d,b){const a="esriGeometryPoint"===d.geometryType,c=w.FillMaterialKey.load(this._materialKey);n.recordStart(d.getDisplayId(),this._materialKey,this.geometryType,a);this._writeGeometry(n,
d,c,b,a);c.outlinedFill&&t.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(n,d,b,a);n.recordEnd()};k._writeGeometry=function(n,d,b,a,c){c=this._getGeometry(d,a,c);if(!t.isNone(c))if(a=n.indexCount(),100<c.maxLength||this.forceLibtess||!q.triangulate(n,c)){c=q.triangulateLibtess(n,c);var f=n.indexCount();a!==f&&this._writeVertices(n,d,c,[c.length/2],b)}else f=n.indexCount(),a!==f&&this._writeVertices(n,d,c.coords,c.lengths,b)};k._writeVertices=function(n,d,b,a,c){var f=d.getDisplayId();
f|=this._bitset<<24;let m=0;var h=a.reduce((v,u)=>v+u);n.vertexEnsureSize((c.dotDensity?4:10)*h);for(const v of a){h=m;for(a=v+m;h<a;h++){const u=b[2*h],F=b[2*h+1],z=x.i1616to32(1*u,1*F);n.vertexBounds(u,F,0,0);n.vertexWrite(z);n.vertexWrite(f);c.dotDensity?n.vertexWriteF32(1/Math.abs(d.readGeometryArea())):(n.vertexWrite(this.fillColor),c.simple||(n.vertexWrite(this.tl),n.vertexWrite(this.br)),n.vertexWrite(this.aux2),n.vertexWrite(this.aux3),c.simple||n.vertexWrite(this._minMaxZoom))}m+=v}};k._getGeometry=
function(n,d,b){return(n=d?C.deltaDecodeGeometry(C.convertFromGeometry(d),2):n.readGeometryForDisplay())?q.clipMarshall(n,b?256:8):null};return l}(g)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut".split(" "),function(r,t,C,D,x,w,q,p){function g(n,d,b){let a=0;for(let c=
1;c<b;c++)a+=(n[2*(d+c)]-n[2*(d+c-1)])*(n[2*(d+c)+1]+n[2*(d+c-1)+1]);return a}function e(n,d,b,a,c){let f=0;for(;b<a;b+=3){const m=2*(n.getValue(b)-c),h=2*(n.getValue(b+1)-c),v=2*(n.getValue(b+2)-c);f+=Math.abs((d[m]-d[v])*(d[h+1]-d[m+1])-(d[m]-d[h])*(d[v+1]-d[m+1]))}return f}const l=new q.TileClipper(0,0,0,1,0),k=new q.TileClipper(0,0,0,1,0);l.setExtent(w.TILE_SIZE);k.setExtent(w.TILE_SIZE);r.area=g;r.clipLinesMarshall=function(n,d){k.setPixelMargin(d);const b=-d;d=w.TILE_SIZE+d;let a=[];var c=!1;
let f=0;for(;f<n.length;){const m=[],h=n[f];if(!h)return null;k.reset(2);let [v,u]=h[0];if(c)k.moveTo(v,u);else{if(v<b||v>d||u<b||u>d){c=!0;continue}m.push({x:v,y:u})}let F=!1;const z=h.length;for(let A=1;A<z;++A)if(v+=h[A][0],u+=h[A][1],c)k.lineTo(v,u);else{if(v<b||v>d||u<b||u>d){F=!0;break}m.push({x:v,y:u})}if(F)c=!0;else{if(c){if(c=k.resultWithStarts())for(const A of c)a.push(A)}else a.push({line:m,start:0});f++;c=!1}}a=a.filter(m=>1<m.line.length);return 0===a.length?null:a};r.clipMarshall=function(n,
d){if(t.isNone(n))return null;a:{var b=w.TILE_SIZE+128;var a=0;for(var c=0;c<n.lengths.length;c++){var f=n.lengths[c];for(var m=0;m<f;m++){const h=n.coords[2*(m+a)],v=n.coords[2*(m+a)+1];if(-128>h||h>b||-128>v||v>b){b=!0;break a}}a+=f}b=!1}if(!b)return n;l.setPixelMargin(d);l.reset(3);d=0;for(b=0;b<n.lengths.length;b++){a=n.lengths[b];c=n.coords[2*(0+d)];f=n.coords[2*(0+d)+1];l.moveTo(c,f);for(m=1;m<a;m++)c=n.coords[2*(m+d)],f=n.coords[2*(m+d)+1],l.lineTo(c,f);l.close();d+=a}b=l.result(!1);if(!b)return null;
n=[];d=[];for(const h of b){b=0;for(const v of h)d.push(v.x),d.push(v.y),b++;n.push(b)}return new x(n,d)};r.triangleArea=e;r.triangulate=function(n,d){const {coords:b,lengths:a,hasIndeterminateRingOrder:c}=d;d=n.indexWriter();n=n.vertexCount();if(c)return!1;const f=d.length;let m=0;for(var h=0;h<a.length;){let F=h,z=a[h];h=g(b,m,z);for(var v=[];++F<a.length;){var u=a[F];const A=g(b,m+z,u);if(!(0<A))break;h+=A;v.push(m+z);z+=u}u=d.length;p.bufcut(d,b,m,m+z,v,2,n);v=e(d,b,u,d.length,n);h=Math.abs(h);
if(1E-5<Math.abs((v-h)/Math.max(1E-7,h)))return d.seek(f),!1;h=F;m+=z}return!0};r.triangulateEarcut=function(n,d,b){const {coords:a,lengths:c,hasIndeterminateRingOrder:f}=d;if(f)return!1;let m=0;for(var h=0;h<c.length;){let u=h,F=c[h];for(h=[];++u<c.length;){var v=c[u];if(!(0<g(a,m+F,v)))break;h.push(m+F-m);F+=v}v=d.coords.slice(2*m,2*(m+F));h=C.earcut(v,h,2);for(const z of h)n.push(z+b+m);h=u;m+=F}return!0};r.triangulateLibtess=function(n,d){const b=n.indexWriter();n=n.vertexCount();const {coords:a,
lengths:c}=d,{buffer:f,vertexCount:m}=D.triangulate(a,c);b.ensureSize(m);for(d=0;d<m;d++)b.push(d+n);return f};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(r){function t(u,F,z,A,E,G,H){let K;z=0;for(let L=A,J=E-G;L<E;L+=G)z+=(u[J+F*G]-u[L+F*G])*(u[L+1+F*G]+u[J+1+F*G]),J=L;if(H===0<z)for(;A<E;A+=G)K=w(A+F*G,u[A+F*G],u[A+1+F*G],K);else for(E-=G;E>=A;E-=G)K=w(E+F*G,u[E+F*G],u[E+1+F*G],K);K&&a(K,K.next)&&(q(K),K=K.next);
return K}function C(u,F=u){if(!u)return u;let z;do if(z=!1,u.steiner||!a(u,u.next)&&0!==l(u.prev,u,u.next))u=u.next;else{q(u);u=F=u.prev;if(u===u.next)break;z=!0}while(z||u!==F);return F}function D(u,F,z,A,E,G,H,K){if(u){!K&&G&&(u=e(u,A,E,G));for(var L=u;u.prev!==u.next;){var J=u.prev,B=u.next;if(G)var y=x(u,A,E,G);else a:{y=u;var I=y.prev,S=y;const O=y.next;if(0<=l(I,S,O)){y=!1;break a}let Y=y.next.next;const R=Y;let Q=0;for(;Y!==y.prev&&(0===Q||Y!==R);){Q++;if(n(I.x,I.y,S.x,S.y,O.x,O.y,Y.x,Y.y)&&
0<=l(Y.prev,Y,Y.next)){y=!1;break a}Y=Y.next}y=!0}if(y)F.push(J.index/z+H),F.push(u.index/z+H),F.push(B.index/z+H),q(u),L=u=B.next;else if(u=B,u===L){if(!K)D(C(u),F,z,A,E,G,H,1);else if(1===K){K=F;L=z;J=H;B=u;do y=B.prev,I=B.next.next,!a(y,I)&&k(y,B,B.next,I)&&d(y,I)&&d(I,y)&&(K.push(y.index/L+J),K.push(B.index/L+J),K.push(I.index/L+J),q(B),q(B.next),B=u=I),B=B.next;while(B!==u);u=B;D(u,F,z,A,E,G,H,2)}else if(2===K)a:{K=u;do{for(L=K.next.next;L!==K.prev;){if(J=K.index!==L.index){y=y=y=void 0;J=K;
B=L;if(y=J.next.index!==B.index&&J.prev.index!==B.index){b:{y=J;do{if(y.index!==J.index&&y.next.index!==J.index&&y.index!==B.index&&y.next.index!==B.index&&k(y,y.next,J,B)){y=!0;break b}y=y.next}while(y!==J);y=!1}y=!y}if(y=y&&d(J,B)&&d(B,J)){y=J;I=!1;S=(J.x+B.x)/2;B=(J.y+B.y)/2;do y.y>B!==y.next.y>B&&y.next.y!==y.y&&S<(y.next.x-y.x)*(B-y.y)/(y.next.y-y.y)+y.x&&(I=!I),y=y.next;while(y!==J);y=I}J=y}if(J){u=f(K,L);K=C(K,K.next);u=C(u,u.next);D(K,F,z,A,E,G,H,0);D(u,F,z,A,E,G,H,0);break a}L=L.next}K=K.next}while(K!==
u)}break}}}}function x(u,F,z,A){const E=u.prev,G=u.next;if(0<=l(E,u,G))return!1;const H=E.x>u.x?E.x>G.x?E.x:G.x:u.x>G.x?u.x:G.x,K=E.y>u.y?E.y>G.y?E.y:G.y:u.y>G.y?u.y:G.y,L=b(E.x<u.x?E.x<G.x?E.x:G.x:u.x<G.x?u.x:G.x,E.y<u.y?E.y<G.y?E.y:G.y:u.y<G.y?u.y:G.y,F,z,A);F=b(H,K,F,z,A);z=u.prevZ;for(A=u.nextZ;z&&z.z>=L&&A&&A.z<=F;){if(z!==u.prev&&z!==u.next&&n(E.x,E.y,u.x,u.y,G.x,G.y,z.x,z.y)&&0<=l(z.prev,z,z.next))return!1;z=z.prevZ;if(A!==u.prev&&A!==u.next&&n(E.x,E.y,u.x,u.y,G.x,G.y,A.x,A.y)&&0<=l(A.prev,
A,A.next))return!1;A=A.nextZ}for(;z&&z.z>=L;){if(z!==u.prev&&z!==u.next&&n(E.x,E.y,u.x,u.y,G.x,G.y,z.x,z.y)&&0<=l(z.prev,z,z.next))return!1;z=z.prevZ}for(;A&&A.z<=F;){if(A!==u.prev&&A!==u.next&&n(E.x,E.y,u.x,u.y,G.x,G.y,A.x,A.y)&&0<=l(A.prev,A,A.next))return!1;A=A.nextZ}return!0}function w(u,F,z,A){u=m.create(u,F,z);A?(u.next=A.next,u.prev=A,A.next.prev=u,A.next=u):(u.prev=u,u.next=u);return u}function q(u){u.next.prev=u.prev;u.prev.next=u.next;u.prevZ&&(u.prevZ.nextZ=u.nextZ);u.nextZ&&(u.nextZ.prevZ=
u.prevZ)}function p(u){let F=u,z=u;do{if(F.x<z.x||F.x===z.x&&F.y<z.y)z=F;F=F.next}while(F!==u);return z}function g(u,F){let z=F;const A=u.x,E=u.y;let G=-Infinity,H;do{if(E<=z.y&&E>=z.next.y&&z.next.y!==z.y){var K=z.x+(E-z.y)*(z.next.x-z.x)/(z.next.y-z.y);if(K<=A&&K>G){G=K;if(K===A){if(E===z.y)return z;if(E===z.next.y)return z.next}H=z.x<z.next.x?z:z.next}}z=z.next}while(z!==F);if(!H)return null;if(A===G)return H.prev;F=H;K=H.x;const L=H.y;let J=Infinity,B;for(z=H.next;z!==F;)A>=z.x&&z.x>=K&&A!==z.x&&
n(E<L?A:G,E,K,L,E<L?G:A,E,z.x,z.y)&&(B=Math.abs(E-z.y)/(A-z.x),(B<J||B===J&&z.x>H.x)&&d(z,u)&&(H=z,J=B)),z=z.next;return H}function e(u,F,z,A){for(var E;E!==u;E=E.next){E=E||u;null===E.z&&(E.z=b(E.x,E.y,F,z,A));if(E.prev.next!==E||E.next.prev!==E)return E.prev.next=E,E.next.prev=E,e(u,F,z,A);E.prevZ=E.prev;E.nextZ=E.next}u.prevZ.nextZ=null;u.prevZ=null;a:for(z=1;;){A=u;F=u=null;let G=0;for(;A;){G++;E=A;let H=0;for(;H<z&&E;H++)E=E.nextZ;let K=z;for(;0<H||0<K&&E;){let L;0===H?(L=E,E=E.nextZ,K--):0!==
K&&E?A.z<=E.z?(L=A,A=A.nextZ,H--):(L=E,E=E.nextZ,K--):(L=A,A=A.nextZ,H--);F?F.nextZ=L:u=L;L.prevZ=F;F=L}A=E}F.nextZ=null;z*=2;if(2>G)break a}return u}function l(u,F,z){return(F.y-u.y)*(z.x-F.x)-(F.x-u.x)*(z.y-F.y)}function k(u,F,z,A){return a(u,F)&&a(z,A)||a(u,A)&&a(z,F)?!0:0<l(u,F,z)!==0<l(u,F,A)&&0<l(z,A,u)!==0<l(z,A,F)}function n(u,F,z,A,E,G,H,K){return 0<=(E-H)*(F-K)-(u-H)*(G-K)&&0<=(u-H)*(A-K)-(z-H)*(F-K)&&0<=(z-H)*(G-K)-(E-H)*(A-K)}function d(u,F){return 0>l(u.prev,u,u.next)?0<=l(u,F,u.next)&&
0<=l(u,u.prev,F):0>l(u,F,u.prev)||0>l(u,u.next,F)}function b(u,F,z,A,E){u=32767*(u-z)*E;F=32767*(F-A)*E;u=(u|u<<8)&16711935;u=(u|u<<4)&252645135;u=(u|u<<2)&858993459;F=(F|F<<8)&16711935;F=(F|F<<4)&252645135;F=(F|F<<2)&858993459;return(u|u<<1)&1431655765|((F|F<<1)&1431655765)<<1}function a(u,F){return u.x===F.x&&u.y===F.y}function c(u,F){return u.x-F.x}function f(u,F){const z=m.create(u.index,u.x,u.y),A=m.create(F.index,F.x,F.y),E=u.next,G=F.prev;u.next=F;F.prev=u;z.next=E;E.prev=z;A.next=z;z.prev=
A;G.next=A;A.prev=G;return A}let m=function(){function u(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}u.create=function(F,z,A){const E=v<h.length?h[v++]:new u;E.index=F;E.x=z;E.y=A;E.prev=null;E.next=null;E.z=null;E.prevZ=null;E.nextZ=null;E.steiner=!1;return E};return u}();const h=[];let v=0;for(let u=0;8096>u;u++)h.push(new m);r.bufcut=function(u,F,z,A,E,G,H){v=0;var K=(A-z)*G,L=E&&E.length;const J=L?(E[0]-z)*G:K;var B=t(F,z,A,0,J,G,!0);if(B&&
B.next!==B.prev){var y;if(L){L=[];for(let Y=0,R=E.length;Y<R;Y++){const Q=t(F,z,A,E[Y]*G,Y<R-1?E[Y+1]*G:A*G,G,!1);Q===Q.next&&(Q.steiner=!0);L.push(p(Q))}L.sort(c);for(var I of L){A=I;E=B;if(E=g(A,E))A=f(E,A),C(A,A.next);B=C(B,B.next)}}if(K>80*G){var S=K=F[z*G];var O=y=F[1+z*G];for(I=G;I<J;I+=G)A=F[I+z*G],E=F[I+1+z*G],S=Math.min(S,A),O=Math.min(O,E),K=Math.max(K,A),y=Math.max(y,E);y=Math.max(K-S,y-O);y=0!==y?1/y:0}D(B,u,G,S,O,y,H,0)}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){const k=t.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(n){function d(b,a,c,f,m,h,v,u,F,z,A,E,G,H,K,L,J,B,y){var I=n.call(this)||this;b=p.LineMaterialKey.load(b);a&&(b.sdf=a.sdf,b.pattern=!0,b.textureBinding=a.textureBinding);I._capType=f;I._joinType=m;I._miterLimitCosine=g.getLimitCosine(h);I.tessellationProperties._fillColor=v;I.tessellationProperties._tl=u;I.tessellationProperties._br=F;I._hasPattern=z;I._isDashed=A;I._zOrder=L;I._effects=
J;I._minMaxZoom=w.i1616to32(Math.round(B*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(y*x.MIN_MAX_ZOOM_PRECISION_FACTOR));I._materialKey=b.data;I.tessellationProperties._bitset=(G?x.BITSET_GENERIC_LOCK_COLOR:0)|(H?x.BITSET_TYPE_FILL_OUTLINE:0)|(E?x.BITSET_LINE_SCALE_DASH:0);I.tessellationProperties._halfWidth=.5*c;I.tessellationProperties._halfReferenceWidth=.5*K;I.tessellationProperties.offset=0;I._initializeTessellator(!1);return I}r._inheritsLoose(d,n);d.fromCIMLine=function(b,a,c){var f=b.color,
m=b.scaleFactor||1;const h=!!b.dashTemplate;let v=b.cap;h&&1===v&&(v=2);const u=b.join;m*=C.pt2px(b.width);const F=C.pt2px(b.referenceWidth),z=C.pt2px(b.miterLimit);f=f&&D.premultiplyAlphaRGBA(f)||0;const [A,E]=g.getMinMaxZoom(b.scaleInfo,c);if(!a)return new d(b.materialKey,a,m,v,u,z,f,0,0,!1,h,b.scaleDash,b.colorLocked,!1,F,b.zOrder,b.effects,A,E);const {rect:G,width:H,height:K}=a;var L=G.x+x.SPRITE_PADDING;const J=G.y+x.SPRITE_PADDING;c=L+H;const B=J+K;L=w.i1616to32(L,J);c=w.i1616to32(c,B);return new d(b.materialKey,
a,m,v,u,z,f,L,c,!0,h,b.scaleDash,b.colorLocked,!1,F,b.zOrder,b.effects,A,E)};d.fromFillOutline=function(b){var a;return b.isOutlinedFill&&b.outline&&"esriSLSSolid"===(null==(a=b.outline)?void 0:a.style)?d.fromSimpleLine({hash:"",materialKey:b.materialKey,...b.outline},null,!0):null};d.fromSimpleLine=function(b,a,c=!1){var {color:f}=b;const m="esriSLSSolid"!==b.style&&"esriSLSNull"!==b.style,h=q.getCapType(b.cap||"round"),v=q.getJoinType(b.join||"round");f=f&&"esriSLSNull"!==b.style&&D.premultiplyAlphaRGBAArray(f)||
0;"esriSLSNull"===b.style&&(f=0);const u=C.pt2px(b.width),F=b.miterLimit;if(!a)return new d(b.materialKey,a,u,h,v,F,f,0,0,!1,m,!0,!1,c,u,0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM);const {rect:z,width:A,height:E}=a;var G=z.x+x.SPRITE_PADDING;const H=z.y+x.SPRITE_PADDING;var K=G+A;const L=H+E;G=w.i1616to32(G,H);K=w.i1616to32(K,L);return new d(b.materialKey,a,u,h,v,F,f,G,K,!0,m,!0,!1,c,u,0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM)};d.fromPictureLineSymbol=function(b,a,c,f){k.error("PictureLineSymbol support does not exist!");
return null};return d}(e(l))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(r,t,C,D,x,w,q,p){const g=(k,n,d)=>(b,a,c,f,m,h,v,u,F,z,A)=>{c=x.i1616to32(A,Math.ceil(16*k._halfWidth));v=x.i8888to32(Math.round(16*v),Math.round(16*u),Math.round(16*F),Math.round(16*
z));m=x.i8888to32(16*m,16*h,0,k._bitset);h=k.out;h.vertexBounds(b,a,n,d);h.vertexWrite(x.i1616to32(8*b,8*a));h.vertexWrite(k.id);h.vertexWrite(k._fillColor);h.vertexWrite(v);h.vertexWrite(c);h.vertexWrite(k._tl);h.vertexWrite(k._br);h.vertexWrite(m);h.vertexWrite(x.i1616to32(Math.ceil(16*k._halfReferenceWidth),0));h.vertexWrite(k.minMaxZoom);h.vertexEnd();return k.offset+k.vertexCount++},e=(k,n,d)=>(b,a,c,f,m,h,v,u,F,z,A)=>{c=x.i8888to32(0,0,16*k._halfWidth,16*k._halfReferenceWidth);v=x.i8888to32(16*
v+128,16*u+128,16*F+128,16*z+128);u=k.out;F=k._bitset<<24|k.id;u.vertexBounds(b,a,n,d);u.vertexWrite(x.i1616to32(8*b,8*a));u.vertexWrite(F);u.vertexWrite(k._fillColor);k.key.simple||(u.vertexWrite(0),u.vertexWrite(0));u.vertexWrite(c);u.vertexWrite(v);k.key.simple||u.vertexWrite(k.minMaxZoom);u.vertexEnd();return k.offset+k.vertexCount++},l=k=>(n,d,b)=>{const a=k.out;a.indexWrite(n);a.indexWrite(d);a.indexWrite(b);k.indexCount+=3};return k=>function(n){function d(...a){a=n.call(this,...a)||this;a.tessellationProperties=
{};a._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};a.geometryType=D.WGLGeometryType.LINE;return a}r._inheritsLoose(d,n);var b=d.prototype;b.writeGeometry=function(a,c,f,m){this._writeGeometry(a,c,f,m)};b._initializeTessellator=function(a){var c=q.LineMaterialKey.load(this._materialKey);const f=q.FillMaterialKey.load(this._materialKey);var m=this._tessellationOptions;c=c.vvSizeFieldStops||c.vvSizeMinMaxValue||c.vvSizeScaleStops||c.vvSizeUnitValue;a=this.tessellationProperties._halfWidth<
C.THIN_LINE_HALF_WIDTH_THRESHOLD&&!a&&!c;this.tessellationProperties.minMaxZoom=this._minMaxZoom;m.wrapDistance=65535;m.textured=this._isDashed||this._hasPattern;m.offset=this.tessellationProperties.offset;m.halfWidth=this.tessellationProperties._halfWidth;m=a?0:1;this._lineTessellator=new w.LineTessellation((f.outlinedFill?e:g)(this.tessellationProperties,m,m),l(this.tessellationProperties),a)};b._write=function(a,c,f){const m="esriGeometryPoint"===c.geometryType;a.recordStart(c.getDisplayId(),this._materialKey,
this.geometryType,m);this._writeGeometry(a,c,f,m);a.recordEnd()};b._writeGeometry=function(a,c,f,m){f=null!=f?f:c.readLegacyGeometryForDisplay();m=this._getLines(f,m);t.isNone(m)||this._writeVertices(a,c,m)};b._getLines=function(a,c){if(t.isNone(a))return null;a=a.paths||a.rings;return t.isNone(a)?null:p.clipLinesMarshall(a,c?256:16)};b._writeVertices=function(a,c,f){const m=c.getDisplayId(),h=a.vertexCount(),v=this.tessellationProperties;c=this._tessellationOptions;v.out=a;v.id=m;v.indexCount=0;
v.vertexCount=0;v.offset=h;c.capType=this._capType;c.joinType=this._joinType;a=q.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=a.outlinedFill?a:q.LineMaterialKey.load(this._materialKey);for(const {line:u,start:F}of f)c.initialDistance=F%65535,this._lineTessellator.tessellate(u,c)};return d}(k)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer",
"../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(r,t,C,D,x){const w=t.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(q){function p(g){var e=q.call(this)||this;e._ongoingMaterialRequestMap=new Map;e._materialCache=new Map;e._dynamicPropertyMap=new Map;e._cimLayer=g;return e}r._inheritsLoose(p,q);p.prototype.analyze=function(g,e,l,k,n){e=e.readLegacyFeature();const d=this._materialCache;var b=this._cimLayer.materialHash;if(!b)return w.error("A Dynamic mesh template must have a material hash value or function!"),
Promise.reject(null);const a="function"===typeof b?b(e,l,k):b;if(d.has(a))return g=d.get(a),Promise.resolve(g);if(this._ongoingMaterialRequestMap.has(a))return this._ongoingMaterialRequestMap.get(a);b=this._cimLayer;var c=C.analyzeCIMResource(b.cim,this._cimLayer.materialOverrides);const {type:f,url:m}=b;c={cim:c,type:f,mosaicHash:a,url:m,size:null,dashTemplate:null,text:null,fontName:null};switch(f){case "marker":c.size=D.evaluateValueOrFunction(b.size,e,l,k);break;case "line":c.dashTemplate=b.dashTemplate;
break;case "text":c.text=D.evaluateValueOrFunction(b.text,e,l,k),c.fontName=D.evaluateValueOrFunction(b.fontName,e,l,k)}g=g.getMosaicItem(c,n).then(h=>{this._ongoingMaterialRequestMap.delete(a);d.set(a,h);return h}).catch(h=>{this._ongoingMaterialRequestMap.delete(a);w.error(".analyze()",h.message);return null});this._ongoingMaterialRequestMap.set(a,g);return g};return p}(x)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n){function d(P){switch(P){case "Butt":return 0;case "Square":return 2;default:return 1}}function b(P){switch(P){case "Bevel":return 0;case "Miter":return 2;default:return 1}}function a(P){switch(P){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function c(P){switch(P){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function f(P){let fa="",
oa="";P&&(P=P.toLowerCase(),-1!==P.indexOf("italic")?fa="italic":-1!==P.indexOf("oblique")&&(fa="oblique"),-1!==P.indexOf("bold")?oa="bold":-1!==P.indexOf("light")&&(oa="lighter"));return{style:fa,weight:oa}}function m(P,fa,oa,pa){let sa;P[fa]?sa=P[fa]:(sa={},P[fa]=sa);sa[oa]=pa}function h(P){return(P=P.markerPlacement)&&P.angleToLine?1:0}function v(){v=t._asyncToGenerator(function*(P,fa,oa,pa,sa){pa=null!=pa?pa:[];if(!P)return pa;let ra;const ua={};if("CIMSymbolReference"===P.type){if(ra=P.symbol,
P=P.primitiveOverrides){var M=[];for(const ha of P){var T=ha.valueExpressionInfo;T&&fa?(T=p.createRendererExpression(T.expression,fa.spatialReference,fa.fields).then(V=>{V&&m(ua,ha.primitiveName,ha.propertyName,V)}),M.push(T)):null!=ha.value&&m(ua,ha.primitiveName,ha.propertyName,ha.value)}0<M.length&&(yield Promise.all(M))}}else return W.error("Expect cim type to be 'CIMSymbolReference'"),pa;M=[];Q(ra,oa,M);0<M.length&&(yield Promise.all(M));switch(ra.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":u(ra,
P,ua,fa,pa,oa,sa)}return pa});return v.apply(this,arguments)}function u(P,fa,oa,pa,sa,ra,ua){if(P){var M=P.symbolLayers;if(M){var T=P.effects,ha,V=g.CIMSymbolHelper.getSize(P);"CIMPointSymbol"===P.type&&"Map"===P.angleAlignment&&(ha=1);for(var Z=M.length;Z--;){var ca=M[Z];if(!ca||!1===ca.enable)continue;let Fa;T&&T.length&&(Fa=[...T]);var ea=ca.effects;ea&&ea.length&&(T?Fa.push(...ea):Fa=[...ea]);var ja=[];g.OverrideHelper.findApplicableOverrides(ca,fa,ja);switch(ca.type){case "CIMSolidFill":F(ca,
Fa,oa,ja,pa,sa);break;case "CIMPictureFill":z(ca,Fa,oa,ja,pa,ra,sa);break;case "CIMHatchFill":A(ca,Fa,oa,ja,pa,sa);break;case "CIMGradientFill":{ea=Fa;var la=oa,aa=pa,da=sa;const [Ga,Ia]=R(ja,ca.primitiveName);var ia=q.numericHash(JSON.stringify(ca)+Ia).toString();da.push({type:"fill",templateHash:ia,materialHash:Ga?Y(ia,la,ja,aa):ia,cim:ca,materialOverrides:null,colorLocked:ca.colorLocked,effects:ea,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}break;case "CIMSolidStroke":E(ca,
Fa,oa,ja,pa,sa,"CIMPolygonSymbol"===P.type,V);break;case "CIMPictureStroke":G(ca,Fa,oa,ja,pa,sa,"CIMPolygonSymbol"===P.type,V);break;case "CIMGradientStroke":{ea=Fa;la=oa;aa=pa;da=sa;ia="CIMPolygonSymbol"===P.type;var va=V,wa=ca.primitiveName,Aa=void 0!==ca.width?ca.width:4,Ba=d(ca.capStyle),Da=b(ca.joinStyle),Ka=ca.miterLimit;const [Ga,Ia]=R(ja,wa),Ja=q.numericHash(JSON.stringify(ca)+Ia).toString();da.push({type:"line",templateHash:Ja,materialHash:Ga?Y(Ja,la,ja,aa):Ja,cim:ca,materialOverrides:null,
isOutline:ia,colorLocked:ca.colorLocked,effects:ea,color:{r:128,g:128,b:128,a:1},width:O(wa,la,"Width",aa,Aa),cap:O(wa,la,"CapStyle",aa,Ba),join:O(wa,la,"JoinStyle",aa,Da),miterLimit:O(wa,la,"MiterLimit",aa,Ka),referenceWidth:va,zOrder:I(ca.name),dashTemplate:null,scaleDash:!1})}break;case "CIMCharacterMarker":H(ca,Fa,oa,ja,pa,sa);break;case "CIMPictureMarker":if(H(ca,Fa,oa,ja,pa,sa))break;"CIMLineSymbol"===P.type&&(ha=h(ca));K(ca,Fa,oa,ja,pa,ra,sa,ha,V);break;case "CIMVectorMarker":if(H(ca,Fa,oa,
ja,pa,sa))break;"CIMLineSymbol"===P.type&&(ha=h(ca));ea=Fa;la=oa;aa=pa;da=sa;ia=ra;va=ha;wa=V;Aa=ua;if(Da=ca.markerGraphics){Ba=0;ca.scaleSymbolsProportionally&&(Ka=ca.frame)&&(Ba=Ka.ymax-Ka.ymin);for(const Ga of Da)if(Ga&&(Da=Ga.symbol))switch(Da.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":J(ca,ea,Ga,ja,la,aa,da,ia,va,wa,Ba,Aa);break;case "CIMTextSymbol":L(ca,ea,Ga,la,ja,aa,da,va,wa,Ba)}}break;default:W.error("Cannot analyze CIM layer",ca.type)}}}}}function F(P,fa,oa,
pa,sa,ra){const ua=P.primitiveName,M=l.fromCIMColor(P.color),[T,ha]=R(pa,ua),V=q.numericHash(JSON.stringify(P)+ha).toString();ra.push({type:"fill",templateHash:V,materialHash:T?()=>V:V,cim:P,materialOverrides:null,colorLocked:P.colorLocked,color:O(ua,oa,"Color",sa,M,S),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:fa})}function z(P,fa,oa,pa,sa,ra,ua){const M=P.primitiveName,T=P.tintColor?l.fromCIMColor(P.tintColor):{r:255,g:255,b:255,a:1},[ha,V]=R(pa,M);pa=q.numericHash(JSON.stringify(P)+
V).toString();const Z=q.numericHash(`${P.url}${JSON.stringify(P.colorSubstitutions)}`).toString();let ca=l.getValue(P.scaleX);if("width"in P){const ea=P.width;let ja=1;ra=ra.getResource(P.url);x.isSome(ra)&&(ja=ra.width/ra.height);ca/=P.height/ea*ja}ua.push({type:"fill",templateHash:pa,materialHash:ha?()=>Z:Z,cim:P,materialOverrides:null,colorLocked:P.colorLocked,effects:fa,color:O(M,oa,"TintColor",sa,T,S),height:O(M,oa,"Height",sa,P.height),scaleX:O(M,oa,"ScaleX",sa,ca),angle:O(M,oa,"Rotation",sa,
l.getValue(P.rotation)),offsetX:O(M,oa,"OffsetX",sa,l.getValue(P.offsetX)),offsetY:O(M,oa,"OffsetY",sa,l.getValue(P.offsetY)),url:P.url})}function A(P,fa,oa,pa,sa,ra){const ua=["Rotation","OffsetX","OffsetY"],M=pa.filter(ca=>ca.primitiveName!==P.primitiveName&&-1===ua.indexOf(ca.propertyName)),T=P.primitiveName,[ha,V]=R(pa,T);pa=q.numericHash(JSON.stringify(P)+V).toString();const Z=q.numericHash(`${P.separation}${JSON.stringify(P.lineSymbol)}`).toString();ra.push({type:"fill",templateHash:pa,materialHash:ha?
Y(Z,oa,M,sa):Z,cim:P,materialOverrides:M,colorLocked:P.colorLocked,effects:fa,color:{r:255,g:255,b:255,a:1},height:O(T,oa,"Separation",sa,P.separation),scaleX:1,angle:O(T,oa,"Rotation",sa,l.getValue(P.rotation)),offsetX:O(T,oa,"OffsetX",sa,l.getValue(P.offsetX)),offsetY:O(T,oa,"OffsetY",sa,l.getValue(P.offsetY))})}function E(P,fa,oa,pa,sa,ra,ua,M){const T=P.primitiveName,ha=l.fromCIMColor(P.color),V=void 0!==P.width?P.width:4,Z=d(P.capStyle),ca=b(P.joinStyle),ea=P.miterLimit,[ja,la]=R(pa,T),aa=q.numericHash(JSON.stringify(P)+
la).toString();let da;if(fa&&0<fa.length&&(pa=fa[fa.length-1],"CIMGeometricEffectDashes"===pa.type&&"NoConstraint"===pa.lineDashEnding)){fa=[...P.effects];var ia=fa.pop();da=ia.dashTemplate;ia=ia.scaleDash}ra.push({type:"line",templateHash:aa,materialHash:ja?()=>aa:aa,cim:P,materialOverrides:null,isOutline:ua,colorLocked:P.colorLocked,effects:fa,color:O(T,oa,"Color",sa,ha,S),width:O(T,oa,"Width",sa,V),cap:O(T,oa,"CapStyle",sa,Z),join:O(T,oa,"JoinStyle",sa,ca),miterLimit:O(T,oa,"MiterLimit",sa,ea),
referenceWidth:M,zOrder:I(P.name),dashTemplate:da,scaleDash:ia})}function G(P,fa,oa,pa,sa,ra,ua,M){const T=q.numericHash(`${P.url}${JSON.stringify(P.colorSubstitutions)}`).toString(),ha=P.primitiveName,V=l.fromCIMColor(P.tintColor),Z=void 0!==P.width?P.width:4,ca=d(P.capStyle),ea=b(P.joinStyle),ja=P.miterLimit,[la,aa]=R(pa,ha);pa=q.numericHash(JSON.stringify(P)+aa).toString();ra.push({type:"line",templateHash:pa,materialHash:la?()=>T:T,cim:P,materialOverrides:null,isOutline:ua,colorLocked:P.colorLocked,
effects:fa,color:O(ha,oa,"TintColor",sa,V,S),width:O(ha,oa,"Width",sa,Z),cap:O(ha,oa,"CapStyle",sa,ca),join:O(ha,oa,"JoinStyle",sa,ea),miterLimit:O(ha,oa,"MiterLimit",sa,ja),referenceWidth:M,zOrder:I(P.name),dashTemplate:null,scaleDash:!1,url:P.url})}function H(P,fa,oa,pa,sa,ra){const ua=P.markerPlacement;if(!ua||"CIMMarkerPlacementInsidePolygon"!==ua.type)return!1;const M=["Rotation","OffsetX","OffsetY"],T=pa.filter(la=>la.primitiveName!==P.primitiveName&&-1===M.indexOf(la.propertyName)),ha="url"in
P?P.url:null,[V,Z]=R(pa,ua.primitiveName);pa=q.numericHash(JSON.stringify(P)+Z).toString();let ca=ua.stepY,ea=null,ja=1;ua.shiftOddRows&&(ca*=2,ea=function(la){return la?2*la:0},ja=.5);ra.push({type:"fill",templateHash:pa,materialHash:V?Y(pa,oa,T,sa):pa,cim:P,materialOverrides:T,colorLocked:P.colorLocked,effects:fa,color:{r:255,g:255,b:255,a:1},height:O(ua.primitiveName,oa,"StepY",sa,ca,ea),scaleX:ja,angle:O(ua.primitiveName,oa,"GridAngle",sa,ua.gridAngle),offsetX:O(ua.primitiveName,oa,"OffsetX",
sa,l.getValue(ua.offsetX)),offsetY:O(ua.primitiveName,oa,"OffsetY",sa,l.getValue(ua.offsetY)),url:ha});return!0}function K(P,fa,oa,pa,sa,ra,ua,M,T){var ha;const V=P.primitiveName,Z=l.getValue(P.size);let ca=l.getValue(P.scaleX);const ea=l.getValue(P.rotation),ja=l.getValue(P.offsetX),la=l.getValue(P.offsetY),aa=P.tintColor?l.fromCIMColor(P.tintColor):{r:255,g:255,b:255,a:1},da=q.numericHash(`${P.url}${JSON.stringify(P.colorSubstitutions)}`).toString(),[ia,va]=R(pa,V);pa=q.numericHash(JSON.stringify(P)+
va).toString();const wa=null!=(ha=P.anchorPoint)?ha:{x:0,y:0};if("width"in P){ha=P.width;let Aa=1;ra=ra.getResource(P.url);x.isSome(ra)&&(Aa=ra.width/ra.height);ca/=Z/ha*Aa}ua.push({type:"marker",templateHash:pa,materialHash:ia?()=>da:da,cim:P,materialOverrides:null,colorLocked:P.colorLocked,effects:fa,scaleSymbolsProportionally:!1,alignment:M,size:O(V,oa,"Size",sa,Z),scaleX:O(V,oa,"ScaleX",sa,ca),rotation:O(V,oa,"Rotation",sa,ea),offsetX:O(V,oa,"OffsetX",sa,ja),offsetY:O(V,oa,"OffsetY",sa,la),color:O(V,
oa,"TintColor",sa,aa,S),anchorPoint:{x:wa.x,y:-wa.y},isAbsoluteAnchorPoint:"Relative"!==P.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:P.rotateClockwise,referenceSize:T,sizeRatio:1,markerPlacement:P.markerPlacement,url:P.url})}function L(P,fa,oa,pa,sa,ra,ua,M,T,ha){g.OverrideHelper.findApplicableOverrides(oa,sa,[]);var V=oa.geometry;if("x"in V&&"y"in V){var Z=oa.symbol;var ca=Z.underline?"underline":Z.strikethrough?"line-through":"none";var ea=f(Z.fontStyleName),
ja=l.toKebabCase(Z.fontFamilyName);Z.font={family:ja,decoration:ca,...ea};var la=P.frame,aa=V.x-.5*(la.xmin+la.xmax),da=V.y-.5*(la.ymin+la.ymax),ia=P.size/ha;ha=P.primitiveName;V=l.getValue(Z.height)*ia;la=l.getValue(Z.angle);aa=(l.getValue(Z.offsetX)+aa)*ia;da=(l.getValue(Z.offsetY)+da)*ia;var va=l.fromCIMColor(g.CIMSymbolHelper.getFillColor(Z)),wa=l.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(Z)),Aa=g.CIMSymbolHelper.getStrokeWidth(Z);Aa||(wa=l.fromCIMColor(g.CIMSymbolHelper.getFillColor(Z.haloSymbol)),
Aa=Z.haloSize*ia);var [Ba,Da]=R(sa,ha);sa=JSON.stringify(P.effects)+Number(P.colorLocked)+JSON.stringify(P.anchorPoint)+P.anchorPointUnits+JSON.stringify(P.markerPlacement);sa=q.numericHash(JSON.stringify(oa)+sa+Da).toString();var Ka=q.numericHash(JSON.stringify(Z.font)).toString(),Fa=O(oa.primitiveName,pa,"TextString",ra,oa.textString,l._adjustTextCase,Z.textCase);({fontStyleName:oa}=Z);ja+=oa?"-"+oa.toLowerCase():"-regular";ua.push({type:"text",templateHash:sa,materialHash:Ba||"function"===typeof Fa||
Fa.match(/\[([\w]+)\]/)?(Ga,Ia,Ja)=>Ka+"-"+l.evaluateValueOrFunction(Fa,Ga,Ia,Ja):Ka+"-"+q.numericHash(Fa),cim:Z,materialOverrides:null,colorLocked:P.colorLocked,effects:fa,alignment:M,anchorPoint:{x:P.anchorPoint?P.anchorPoint.x:0,y:P.anchorPoint?P.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==P.anchorPointUnits,fontName:ja,decoration:ca,weight:O(ha,pa,"Weight",ra,ea.weight),style:O(ha,pa,"Size",ra,ea.style),size:O(ha,pa,"Size",ra,V),angle:O(ha,pa,"Rotation",ra,la),offsetX:O(ha,pa,"OffsetX",
ra,aa),offsetY:O(ha,pa,"OffsetY",ra,da),horizontalAlignment:a(Z.horizontalAlignment),verticalAlignment:c(Z.verticalAlignment),text:Fa,color:va,outlineColor:wa,outlineSize:Aa,referenceSize:T,sizeRatio:1,markerPlacement:P.markerPlacement})}}function J(P,fa,oa,pa,sa,ra,ua,M,T,ha,V,Z){var ca=oa.symbol;const ea=ca.symbolLayers;if(ea)if(Z)y(P,fa,oa,sa,pa,ra,ua,M,T,ha,V);else if(Z=ea.length,ea&&2===ea.length&&ea[0].enable&&ea[1].enable&&"CIMSolidStroke"===ea[0].type&&"CIMSolidFill"===ea[1].type&&!ea[0].effects&&
!ea[1].effects)B(P,oa,ea,pa,sa,ra,ua,T,ha,V);else if(ca=k.CIMEffectHelper.applyEffects(ca.effects,oa.geometry))for(;Z--;){var ja=ea[Z];if(ja&&!1!==ja.enable)switch(ja.type){case "CIMSolidFill":case "CIMSolidStroke":{var la,aa=k.CIMEffectHelper.applyEffects(ja.effects,ca),da=e.getExtent(aa);if(!da)continue;const [wa,Aa,Ba]=e.getSDFMetrics(da,P.frame,P.size,P.anchorPoint,"Relative"!==P.anchorPointUnits);var ia="CIMSolidFill"===ja.type;aa={type:"sdf",geom:aa,asFill:ia};var va=P.primitiveName;da=null!=
(la=l.getValue(P.size))?la:10;const Da=l.getValue(P.rotation),Ka=l.getValue(P.offsetX),Fa=l.getValue(P.offsetY),Ga=ja.path,Ia=ja.primitiveName,Ja=ia?l.fromCIMColor(g.CIMSymbolHelper.getFillColor(ja)):l.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(ja)),Ma=ia?{r:0,g:0,b:0,a:0}:l.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(ja)),xa=g.CIMSymbolHelper.getStrokeWidth(ja);if(!ia&&!xa)break;ia=!1;let $a="";for(const Ra of pa)if(Ra.primitiveName===Ia||Ra.primitiveName===va)void 0!==Ra.value?$a+=`-${Ra.primitiveName}-${Ra.propertyName}-${JSON.stringify(Ra.value)}`:
Ra.valueExpressionInfo&&(ia=!0);va=JSON.stringify({...P,markerGraphics:null});const Sa=q.numericHash(JSON.stringify(aa)+Ga).toString();ja={type:"marker",templateHash:q.numericHash(JSON.stringify(oa)+JSON.stringify(ja)+va+$a).toString(),materialHash:ia?()=>Sa:Sa,cim:aa,materialOverrides:null,colorLocked:P.colorLocked,effects:fa,scaleSymbolsProportionally:P.scaleSymbolsProportionally,alignment:T,anchorPoint:{x:Aa,y:Ba},isAbsoluteAnchorPoint:!1,size:O(P.primitiveName,sa,"Size",ra,da),rotation:O(P.primitiveName,
sa,"Rotation",ra,Da),offsetX:O(P.primitiveName,sa,"OffsetX",ra,Ka),offsetY:O(P.primitiveName,sa,"OffsetY",ra,Fa),scaleX:1,frameHeight:V,rotateClockwise:P.rotateClockwise,referenceSize:ha,sizeRatio:wa,color:O(Ia,sa,"Color",ra,Ja,S),outlineColor:O(Ia,sa,"Color",ra,Ma,S),outlineWidth:O(Ia,sa,"Width",ra,xa),markerPlacement:P.markerPlacement,path:Ga};ua.push(ja);break}default:y(P,fa,oa,sa,pa,ra,ua,M,T,ha,V)}}}function B(P,fa,oa,pa,sa,ra,ua,M,T,ha){var V=fa.geometry;const Z=oa[0];oa=oa[1];var ca=e.getExtent(V);
if(ca){var [ea,ja,la]=e.getSDFMetrics(ca,P.frame,P.size,P.anchorPoint,"Relative"!==P.anchorPointUnits);V={type:"sdf",geom:V,asFill:!0};var aa=P.primitiveName;ca=l.getValue(P.size);var da=l.getValue(P.rotation),ia=l.getValue(P.offsetX),va=l.getValue(P.offsetY),wa=oa.path,Aa=oa.primitiveName,Ba=Z.primitiveName,Da=l.fromCIMColor(g.CIMSymbolHelper.getFillColor(oa)),Ka=l.fromCIMColor(g.CIMSymbolHelper.getStrokeColor(Z)),Fa=g.CIMSymbolHelper.getStrokeWidth(Z),Ga=!1,Ia="";for(const Ma of pa)if(Ma.primitiveName===
Aa||Ma.primitiveName===Ba||Ma.primitiveName===aa)void 0!==Ma.value?Ia+=`-${Ma.primitiveName}-${Ma.propertyName}-${JSON.stringify(Ma.value)}`:Ma.valueExpressionInfo&&(Ga=!0);pa=JSON.stringify({...P,markerGraphics:null});var Ja=q.numericHash(JSON.stringify(V)+wa).toString();P={type:"marker",templateHash:q.numericHash(JSON.stringify(fa)+JSON.stringify(oa)+JSON.stringify(Z)+pa+Ia).toString(),materialHash:Ga?()=>Ja:Ja,cim:V,materialOverrides:null,colorLocked:P.colorLocked,effects:P.effects,scaleSymbolsProportionally:P.scaleSymbolsProportionally,
alignment:M,anchorPoint:{x:ja,y:la},isAbsoluteAnchorPoint:!1,size:O(P.primitiveName,sa,"Size",ra,ca),rotation:O(P.primitiveName,sa,"Rotation",ra,da),offsetX:O(P.primitiveName,sa,"OffsetX",ra,ia),offsetY:O(P.primitiveName,sa,"OffsetY",ra,va),scaleX:1,frameHeight:ha,rotateClockwise:P.rotateClockwise,referenceSize:T,sizeRatio:ea,color:O(Aa,sa,"Color",ra,Da,S),outlineColor:O(Ba,sa,"Color",ra,Ka,S),outlineWidth:O(Ba,sa,"Width",ra,Fa),markerPlacement:P.markerPlacement,path:wa};ua.push(P)}}function y(P,
fa,oa,pa,sa,ra,ua,M,T,ha,V){oa={type:P.type,enable:!0,name:P.name,colorLocked:P.colorLocked,primitiveName:P.primitiveName,anchorPoint:P.anchorPoint,anchorPointUnits:P.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:P.rotateClockwise,rotation:0,size:P.size,billboardMode3D:P.billboardMode3D,depth3D:P.depth3D,frame:P.frame,markerGraphics:[oa],scaleSymbolsProportionally:P.scaleSymbolsProportionally,respectFrame:P.respectFrame,clippingPath:P.clippingPath};let Z=[];const ca=["Rotation","OffsetX","OffsetY"];
Z=sa.filter(va=>va.primitiveName!==P.primitiveName||-1===ca.indexOf(va.propertyName));var ea="";for(var ja of sa)void 0!==ja.value&&(ea+=`-${ja.primitiveName}-${ja.propertyName}-${JSON.stringify(ja.value)}`);const [la,aa,da]=g.CIMSymbolHelper.getTextureAnchor(oa,M);sa=P.primitiveName;M=l.getValue(P.rotation);ja=l.getValue(P.offsetX);const ia=l.getValue(P.offsetY);ea=q.numericHash(JSON.stringify(oa)+ea).toString();fa={type:"marker",templateHash:ea,materialHash:0===Z.length?ea:Y(ea,pa,Z,ra),cim:oa,
materialOverrides:Z,colorLocked:P.colorLocked,effects:fa,scaleSymbolsProportionally:P.scaleSymbolsProportionally,alignment:T,anchorPoint:{x:la,y:aa},isAbsoluteAnchorPoint:!1,size:P.size,rotation:O(sa,pa,"Rotation",ra,M),offsetX:O(sa,pa,"OffsetX",ra,ja),offsetY:O(sa,pa,"OffsetY",ra,ia),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:V,rotateClockwise:P.rotateClockwise,referenceSize:ha,sizeRatio:da/w.pt2px(P.size),markerPlacement:P.markerPlacement};ua.push(fa)}
function I(P){return P&&0===P.indexOf("Level_")?parseInt(P.substr(6),10):0}function S(P){if(!P||0===P.length)return null;P=(new C(P)).toRgba();return{r:P[0],g:P[1],b:P[2],a:P[3]}}function O(P,fa,oa,pa,sa,ra,ua){if(P=fa[P]){const M=P[oa];if("string"===typeof M||"number"===typeof M||M instanceof Array)return ra?ra.call(null,M,ua):M;if(null!=M&&M instanceof p.ArcadeExpression)return(T,ha,V)=>{T=n(M,T,{$view:V},pa.geometryType,ha);null!==T&&ra&&(T=ra.call(null,T,ua));return null!==T?T:sa}}return sa}function Y(P,
fa,oa,pa){for(const sa of oa)if(sa.valueExpressionInfo){const ra=fa[sa.primitiveName]&&fa[sa.primitiveName][sa.propertyName];ra instanceof p.ArcadeExpression&&(sa.fn=(ua,M,T)=>n(ra,ua,{$view:T},pa.geometryType,M))}return(sa,ra,ua)=>{for(const M of oa)M.fn&&(M.value=M.fn(sa,ra,ua));return q.numericHash(P+g.OverrideHelper.buildOverrideKey(oa)).toString()}}function R(P,fa){let oa=!1,pa="";for(const sa of P)sa.primitiveName===fa&&(void 0!==sa.value?pa+=`-${sa.primitiveName}-${sa.propertyName}-${JSON.stringify(sa.value)}`:
sa.valueExpressionInfo&&(oa=!0));return[oa,pa]}function Q(P,fa,oa){if(P&&fa)switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(P=P.symbolLayers)for(const pa of P)switch(pa.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in pa&&pa.url&&oa.push(fa.fetchResource(pa.url,null));break;case "CIMVectorMarker":if(P=pa.markerGraphics)for(const sa of P)sa&&
(P=sa.symbol)&&Q(P,fa,oa)}}}const W=D.getLogger("esri.symbols.cim.cimAnalyzer");r.analyzeCIMResource=function(P,fa){if(!fa||0===fa.length)return P;P=JSON.parse(JSON.stringify(P));g.OverrideHelper.applyOverrides(P,fa);return P};r.analyzeCIMSymbol=function(P,fa,oa,pa,sa){return v.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/BidiText ../../core/floatRGBA ../../core/lang ../../core/Logger ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ./CIMPlacements ./CIMSymbolDrawHelper ./utils ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c){function f(R,Q){switch(Q.type){case "CIMSymbolReference":return f(R,Q.symbol);case "CIMPointSymbol":R.drawSymbol(Q,{x:0,y:0});break;case "CIMLineSymbol":R.drawSymbol(Q,{paths:[[[0,0],[0,1]]]});break;case "CIMPolygonSymbol":R.drawSymbol(Q,{rings:[[[0,0],[0,1],[0,0]]]});break;case "CIMTextSymbol":R.drawSymbol(Q,{x:0,y:0});break;case "CIMVectorMarker":{const W=new k.Placement;R.drawMarker(Q,W)}}return R.envelope()}function m(R){if(!R)return 0;switch(R.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(R.offset);
case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(R.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(R.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(R.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(R.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(R.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(R.offset);case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}
function h(R){if(!R)return 0;switch(R.type){case "CIMGeometricEffectArrow":return Math.abs(.5*R.width);case "CIMGeometricEffectBuffer":return Math.abs(R.size);case "CIMGeometricEffectExtension":return Math.abs(R.length);case "CIMGeometricEffectJog":return Math.abs(.5*R.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(d.getValue(R.offsetX)),Math.abs(d.getValue(R.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(R.offset);case "CIMGeometricEffectOffsetTangent":return Math.abs(R.offset);
case "CIMGeometricEffectRadial":return Math.abs(R.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(R.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(R.fromWidth),Math.abs(R.toWidth));case "CIMGeometricEffectWave":return Math.abs(R.amplitude);default:return 0}}function v(R){if(!R)return 0;let Q=0;for(const W of R)Q+=h(W);return Q}const u=Math.PI,F=u/2,z=96/72,A=Math.PI/180,E=w.getLogger("esri.symbols.cim.CIMSymbolHelper");
w=function(){function R(){}var Q=R.prototype;Q.getSymbolInflateSize=function(W,P,fa,oa,pa){W||(W=[0,0,0,0]);return P?this._getInflateSize(W,P,fa,oa,pa):W};R.SafeSize=function(W){const P=Math.max(Math.abs(W[0]),Math.abs(W[2]));W=Math.max(Math.abs(W[1]),Math.abs(W[3]));return Math.sqrt(P*P+W*W)};Q._vectorMarkerBounds=function(W,P,fa,oa){let pa=!0;const sa=e.create();if(P&&P.markerGraphics)for(const ra of P.markerGraphics)P=[0,0,0,0],ra.geometry&&(l.getBoundsXY(sa,ra.geometry),P[0]=0,P[1]=0,P[2]=0,P[3]=
0,this.getSymbolInflateSize(P,ra.symbol,fa,0,oa),sa[0]+=P[0],sa[1]+=P[1],sa[2]+=P[2],sa[3]+=P[3],pa?(W[0]=sa[0],W[1]=sa[1],W[2]=sa[2],W[3]=sa[3],pa=!1):(W[0]=Math.min(W[0],sa[0]),W[1]=Math.min(W[1],sa[1]),W[2]=Math.max(W[2],sa[2]),W[3]=Math.max(W[3],sa[3])));return W};Q._getInflateSize=function(W,P,fa,oa,pa){return void 0!==P.symbolLayers?(W=this._getLayersInflateSize(W,P.symbolLayers,fa,oa,pa),P=v(P.effects),0<P&&(W[0]-=P,W[1]-=P,W[2]+=P,W[3]+=P),W):this._getTextInflatedSize(W,P,pa)};Q._getLayersInflateSize=
function(W,P,fa,oa,pa){let sa=!0;if(!P)return W;for(const V of P)if(V){var ra=[0,0,0,0];switch(V.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":P=V;var ua=P.width;ua="Square"===P.capStyle||"Miter"===P.joinStyle?ua/1.4142135623730951:ua/2;ra[0]=-ua;ra[1]=-ua;ra[2]=ua;ra[3]=ua;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":P=V;if("CIMVectorMarker"===V.type){if(ua=V,ra=this._vectorMarkerBounds(ra,ua,fa,pa),ua.frame){var M=(ua.frame.xmin+ua.frame.xmax)/
2,T=(ua.frame.ymin+ua.frame.ymax)/2;ra[0]-=M;ra[1]-=T;ra[2]-=M;ra[3]-=T;ua=ua.size/(ua.frame.ymax-ua.frame.ymin);ra[0]*=ua;ra[1]*=ua;ra[2]*=ua;ra[3]*=ua}}else"CIMPictureMarker"===V.type?(ra=V,M=fa.getResource(ra.url),ua=1,p.isSome(M)&&M.height&&(ua=M.width/M.height),M=P.size/2,ra=P.size*ua*ra.scaleX/2,ra=[-ra,-M,ra,M]):(ra=P.size/2,ra=[-ra,-ra,ra,ra]);P.anchorPoint&&("Absolute"===P.anchorPointUnits?(ua=P.anchorPoint.x,M=P.anchorPoint.y):(ua=P.anchorPoint.x*(ra[2]-ra[0]),M=P.anchorPoint.y*(ra[3]-ra[1])),
ra[0]-=ua,ra[1]-=M,ra[2]-=ua,ra[3]-=M);ua=d.getValue(P.rotation);P.rotateClockwise&&(ua=-ua);oa&&(ua-=oa);ua&&(M=A*ua,ua=Math.cos(M),M=Math.sin(M),T=e.create([b.C_INFINITY,b.C_INFINITY,-b.C_INFINITY,-b.C_INFINITY]),e.expandPointInPlace(T,[ra[0]*ua-ra[1]*M,ra[0]*M+ra[1]*ua]),e.expandPointInPlace(T,[ra[0]*ua-ra[3]*M,ra[0]*M+ra[3]*ua]),e.expandPointInPlace(T,[ra[2]*ua-ra[1]*M,ra[2]*M+ra[1]*ua]),e.expandPointInPlace(T,[ra[2]*ua-ra[3]*M,ra[2]*M+ra[3]*ua]),ra=T);ua=d.getValue(P.offsetX);M=d.getValue(P.offsetY);
if(oa){var ha=A*oa;T=Math.cos(ha);ha=Math.sin(ha);const Z=ua*ha+M*T;ua=ua*T-M*ha;M=Z}ra[0]+=ua;ra[1]+=M;ra[2]+=ua;ra[3]+=M;P=m(P.markerPlacement);0<P&&(ra[0]-=P,ra[1]-=P,ra[2]+=P,ra[3]+=P)}P=v(V.effects);0<P&&(ra[0]-=P,ra[1]-=P,ra[2]+=P,ra[3]+=P);sa?(W[0]=ra[0],W[1]=ra[1],W[2]=ra[2],W[3]=ra[3],sa=!1):(W[0]=Math.min(W[0],ra[0]),W[1]=Math.min(W[1],ra[1]),W[2]=Math.max(W[2],ra[2]),W[3]=Math.max(W[3],ra[3]))}return W};Q._getTextInflatedSize=function(W,P,fa){var oa,pa;const sa=null!=(oa=P.height)?oa:10;
W[0]=-sa/2;W[1]=-sa/2;W[2]=sa/2;W[3]=sa/2;if(!fa)return W;fa=fa.get(P);if(!fa)return W;const {text:ra,mosaicItem:ua}=fa;if(!ua||0===ua.glyphMosaicItems.length)return W;fa=n.lineGapType2LineHeight(P.lineGapType,null!=(pa=P.lineGap)?pa:0,sa);pa=C.bidiText(ra)[1];P=c.shapeGlyphs(ua.glyphMosaicItems,pa,{scale:sa/a.GLYPH_SIZE,angle:d.getValue(P.angle),xOffset:d.getValue(P.offsetX),yOffset:d.getValue(P.offsetY),hAlign:n.horizontalAlignment2HAlign(P.horizontalAlignment),vAlign:n.verticalAlignment2VAlign(P.verticalAlignment),
maxLineWidth:512,lineHeight:a.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(fa||1,4)),decoration:P.font.decoration||"none",isCIM:!0}).boundsT;W[0]=P.x-P.halfWidth;W[1]=-P.y-P.halfHeight;W[2]=P.x+P.halfWidth;W[3]=-P.y+P.halfHeight;return W};return R}();let G=function(){function R(){}R.getEnvelope=function(Q,W){W=new n.EnvDrawHelper(W);if(Array.isArray(Q)){let P;for(const fa of Q)P?P.union(f(W,fa)):P=f(W,fa);return P}return f(W,Q)};R.getTextureAnchor=function(Q,W){Q=this.getEnvelope(Q,W);if(!Q)return[0,
0,0];W=Q.height*z+2;return[(Q.x+.5*Q.width)*z/(Q.width*z+2),-(Q.y+.5*Q.height)*z/W,W]};R.rasterize=function(Q,W,P,fa,oa=!0){var pa=P||this.getEnvelope(W,fa);if(!pa)return[null,0,0,0,0];const sa=(pa.x+.5*pa.width)*z,ra=(pa.y+.5*pa.height)*z;Q.width=pa.width*z;Q.height=pa.height*z;P||(Q.width+=2,Q.height+=2);P=Q.getContext("2d");pa=n.Transformation.createScale(z,-z);pa.translate(.5*Q.width-sa,.5*Q.height+ra);fa=new n.CanvasDrawHelper(P,fa,pa);switch(W.type){case "CIMPointSymbol":fa.drawSymbol(W,{type:"point",
x:0,y:0});break;case "CIMVectorMarker":pa=new k.Placement,fa.drawMarker(W,pa)}W=P.getImageData(0,0,Q.width,Q.height);W=new Uint8Array(W.data);if(oa)for(fa=0;fa<W.length;fa+=4)oa=W[fa+3]/255,W[fa]*=oa,W[fa+1]*=oa,W[fa+2]*=oa;return[W,Q.width,Q.height,-sa/Q.width,-ra/Q.height]};R.fromTextSymbol=function(Q){const {angle:W,color:P,font:fa,haloColor:oa,haloSize:pa,horizontalAlignment:sa,kerning:ra,text:ua,verticalAlignment:M,xoffset:T,yoffset:ha}=Q;let V,Z;if(fa){var ca=fa.family;var ea=fa.style;var ja=
fa.weight;V=fa.size;Z=fa.decoration}Q=!1;ua&&(Q=C.bidiText(ua)[1]);ca=ca||"Tahoma";b:{if(ja)switch(ja.toLowerCase()){case "bold":case "bolder":ja="bold";break b}ja=""}b:{if(ea)switch(ea.toLowerCase()){case "italic":case "oblique":ea="italic";break b}ea=""}ja=ja&&ea?`${ja}-${ea}`:`${ja}${ea}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",
geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:W,blockProgression:2,depth3D:1,extrapolateBaselines:!0,fontEffects:0,fontEncoding:1,fontFamilyName:ca,fontStyleName:ja,fontType:0,haloSize:pa,height:V,hinting:1,horizontalAlignment:B(null!=sa?sa:"center"),kerning:ra,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:d.getValue(T),offsetY:d.getValue(ha),strikethrough:"line-through"===Z,underline:"underline"===Z,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,
color:I(P)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:I(oa)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:Q?1:0,verticalAlignment:y(null!=M?M:"baseline"),verticalGlyphOrientation:0,wordSpacing:100,billboardMode3D:2},textString:ua}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};R.fromPictureFillSymbol=function(Q){const {height:W,outline:P,width:fa,xoffset:oa,xscale:pa,yoffset:sa,
yscale:ra}=Q,ua=[],M={type:"CIMPolygonSymbol",symbolLayers:ua};if(P){const {cap:ha,join:V,miterLimit:Z,width:ca}=P;ua.push({type:"CIMSolidStroke",color:I(P.color),capStyle:L(ha),joinStyle:J(V),miterLimit:Z,width:ca})}let T=Q.url;"esriPFS"===Q.type&&Q.imageData&&(T=Q.imageData);Q="angle"in Q?Q.angle:0;ua.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:T,height:W*(ra||1),width:fa*(pa||1),offsetX:d.getValue(oa),offsetY:d.getValue(sa),rotation:d.getValue(-Q),
colorSubstitutions:null});return M};R.fromSimpleFillSymbol=function(Q){const {color:W,style:P,outline:fa}=Q;Q=[];const oa={type:"CIMPolygonSymbol",symbolLayers:Q};var pa=null;if(fa){const {cap:ra,join:ua,style:M}=fa;"solid"!==M&&"none"!==M&&"esriSLSSolid"!==M&&"esriSLSNull"!==M&&(pa=[{type:"CIMGeometricEffectDashes",dashTemplate:S(M,ra),lineDashEnding:"NoConstraint",scaleDash:!0}]);Q.push({type:"CIMSolidStroke",color:I(fa.color),capStyle:L(ra),joinStyle:J(ua),miterLimit:fa.miterLimit,width:fa.width,
effects:pa})}if(P&&"solid"!==P&&"none"!==P&&"esriSFSSolid"!==P&&"esriSFSNull"!==P){pa={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:I(W),capStyle:"Butt",joinStyle:"Miter",width:.75}]};let ra=0;var sa=q.nextPowerOfTwo(Math.ceil(window.devicePixelRatio));sa=Y(P)?8*sa:10*sa;switch(P){case "vertical":case "esriSFSVertical":ra=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":ra=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":ra=45;break;case "cross":case "esriSFSCross":ra=
0;break;case "diagonal-cross":case "esriSFSDiagonalCross":ra=-45}Q.push({type:"CIMHatchFill",lineSymbol:pa,offsetX:0,offsetY:0,rotation:ra,separation:sa});"cross"===P||"esriSFSCross"===P?Q.push({type:"CIMHatchFill",lineSymbol:x.clone(pa),offsetX:0,offsetY:0,rotation:90,separation:sa}):("diagonal-cross"===P||"esriSFSDiagonalCross"===P)&&Q.push({type:"CIMHatchFill",lineSymbol:x.clone(pa),offsetX:0,offsetY:0,rotation:45,separation:sa})}else!P||"solid"!==P&&"esriSFSSolid"!==P||Q.push({type:"CIMSolidFill",
enable:!0,color:I(W)});return oa};R.fromSimpleLineSymbol=function(Q){const {cap:W,color:P,join:fa,marker:oa,miterLimit:pa,style:sa,width:ra}=Q;Q=null;"solid"!==sa&&"none"!==sa&&"esriSLSSolid"!==sa&&"esriSLSNull"!==sa&&(Q=[{type:"CIMGeometricEffectDashes",dashTemplate:S(sa,W),lineDashEnding:"NoConstraint",scaleDash:!0}]);const ua=[];if(oa){let M;switch(oa.placement){case "begin-end":M="Both";break;case "begin":M="JustBegin";break;case "end":M="JustEnd";break;default:M="None"}const T=R.fromSimpleMarker(oa,
ra,P).symbolLayers[0];T.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:M,offsetAlongLine:0};ua.push(T)}"none"!==sa&&"esriSLSNull"!==sa&&ua.push({type:"CIMSolidStroke",color:I(P),capStyle:L(W),joinStyle:J(fa),miterLimit:pa,width:ra,effects:Q});return{type:"CIMLineSymbol",symbolLayers:ua}};R.fromPictureMarker=function(Q){const {angle:W,height:P,width:fa,xoffset:oa,yoffset:pa}=Q;let sa=Q.url;"esriPMS"===Q.type&&Q.imageData&&(sa=Q.imageData);return{type:"CIMPointSymbol",
symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:sa,size:P,width:fa,offsetX:d.getValue(oa),offsetY:d.getValue(pa),rotation:d.getValue(-W)}]}};R.fromSimpleMarker=function(Q,W,P){var fa,{style:oa}=Q;P=null!=(fa=Q.color)?fa:P;if("path"===oa){W=[];"outline"in Q&&Q.outline&&(fa=Q.outline,W.push({type:"CIMSolidStroke",enable:!0,width:g.pt2px(Math.round(g.px2pt(fa.width))),color:I(fa.color)}));W.push({type:"CIMSolidFill",enable:!0,color:I(P),
path:Q.path});const [ua,M]=O("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:d.getValue(-Q.angle),size:d.getValue(Q.size||6),offsetX:d.getValue(Q.xoffset),offsetY:d.getValue(Q.yoffset),frame:ua,markerGraphics:[{type:"CIMMarkerGraphic",geometry:M,symbol:{type:"CIMPolygonSymbol",symbolLayers:W}}]}]}}const [pa,sa]=O(oa);let ra;sa&&pa&&(fa=[],"outline"in Q&&Q.outline?(oa=Q.outline,fa.push({type:"CIMSolidStroke",enable:!0,width:g.pt2px(Math.round(g.px2pt(oa.width))),
color:I(oa.color)})):!W||"line-marker"!==Q.type||"cross"!==Q.style&&"x"!==Q.style||fa.push({type:"CIMSolidStroke",enable:!0,width:W,color:I(P)}),fa.push({type:"CIMSolidFill",enable:!0,color:I(P)}),P={type:"CIMPolygonSymbol",symbolLayers:fa},ra={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:d.getValue(-Q.angle),size:d.getValue(Q.size||6*W),offsetX:d.getValue(Q.xoffset),offsetY:d.getValue(Q.yoffset),frame:pa,markerGraphics:[{type:"CIMMarkerGraphic",geometry:sa,symbol:P}]}]});
return ra};R.fromCIMHatchFill=function(Q){var W;const P=null!=(W=Q.separation)?W:4;W=P/2;for(var fa=this._getLineSymbolPeriod(Q.lineSymbol)||4;4>fa;)fa*=2;fa/=2;return{type:"CIMVectorMarker",frame:{xmin:-fa,xmax:fa,ymin:-W,ymax:W},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-fa,0],[fa,0]]]},symbol:Q.lineSymbol}],size:P}};R._getLineSymbolPeriod=function(Q){if(Q){const W=this._getEffectsRepeat(Q.effects);if(W)return W;if(Q.symbolLayers)for(const P of Q.symbolLayers)if((Q=this._getEffectsRepeat(P.effects))||
P&&(Q=this._getPlacementRepeat(P.markerPlacement)))return Q}return 0};R._getEffectsRepeat=function(Q){if(Q)for(var W of Q)if(W)switch(W.type){case "CIMGeometricEffectDashes":if((Q=W.dashTemplate)&&Q.length){W=0;for(const P of Q)W+=P;Q.length&1&&(W*=2);return W}break;case "CIMGeometricEffectWave":return W.period;default:E.error(`unsupported geometric effect type ${W.type}`)}return 0};R._getPlacementRepeat=function(Q){if(Q)switch(Q.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((Q=
Q.placementTemplate)&&Q.length){let W=0;for(const P of Q)W+=P;Q.length&1&&(W*=2);return W}}return 0};R.fromCIMInsidePolygon=function(Q){var W=Q.markerPlacement;const P={type:Q.type,...Q,markerPlacement:null,anchorPoint:null};let fa,oa;!0===W.shiftOddRows?(Q=W.stepX/2,fa=W.stepY,oa=2*W.stepY,W=[{x:-Q,y:0},{x:Q,y:0},{x:0,y:fa},{x:0,y:-fa}].map(pa=>({type:"CIMMarkerGraphic",geometry:pa,symbol:{type:"CIMPointSymbol",symbolLayers:[P]}}))):(Q=W.stepX/2,fa=W.stepY/2,oa=W.stepY,W=[{type:"CIMMarkerGraphic",
geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[P]}}]);return{type:"CIMVectorMarker",frame:{xmin:-Q,xmax:Q,ymin:-fa,ymax:fa},markerGraphics:W,size:oa}};R.getFillColor=function(Q){if(!Q)return null;switch(Q.type){case "CIMPolygonSymbol":if(Q.symbolLayers)for(const W of Q.symbolLayers)if(Q=R.getFillColor(W),null!=Q)return Q;break;case "CIMTextSymbol":return R.getFillColor(Q.symbol);case "CIMSolidFill":return Q.color}};R.getStrokeColor=function(Q){if(Q)switch(Q.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(Q.symbolLayers)for(const W of Q.symbolLayers)if(Q=
R.getStrokeColor(W),void 0!==Q)return Q;break;case "CIMTextSymbol":return R.getStrokeColor(Q.symbol);case "CIMSolidStroke":return Q.color}};R.getStrokeWidth=function(Q){if(Q)switch(Q.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(Q.symbolLayers)for(const W of Q.symbolLayers)if(Q=R.getStrokeWidth(W),void 0!==Q)return Q;break;case "CIMTextSymbol":return R.getStrokeWidth(Q.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return Q.width}};R.getSize=function(Q){if(Q)switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let W=
0;if(Q.symbolLayers)for(const P of Q.symbolLayers)Q=R.getSize(P),Q>W&&(W=Q);return W}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return Q.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return Q.size}};R.getMarkerScaleRatio=function(Q){if(Q)switch(Q.type){case "CIMVectorMarker":if(!1!==Q.scaleSymbolsProportionally&&Q.frame)return Q.size/(Q.frame.ymax-Q.frame.ymin)}return 1};return R}(),H=function(){function R(){}R.rasterizeSimpleFill=function(Q,
W,P){"solid"!==W&&"none"!==W&&"esriSFSSolid"!==W&&"esriSFSNull"!==W||console.error("Unexpected: style does not require rasterization");P=q.nextPowerOfTwo(Math.ceil(P));var fa=Y(W)?8*P:16*P;const oa=2*P;Q.width=fa;Q.height=fa;const pa=Q.getContext("2d");pa.strokeStyle="#FFFFFF";pa.lineWidth=P;pa.beginPath();if("vertical"===W||"cross"===W||"esriSFSCross"===W||"esriSFSVertical"===W)pa.moveTo(fa/2,-oa),pa.lineTo(fa/2,fa+oa);if("horizontal"===W||"cross"===W||"esriSFSCross"===W||"esriSFSHorizontal"===W)pa.moveTo(-oa,
fa/2),pa.lineTo(fa+oa,fa/2);if("forward-diagonal"===W||"diagonal-cross"===W||"esriSFSDiagonalCross"===W||"esriSFSForwardDiagonal"===W)pa.moveTo(-oa,-oa),pa.lineTo(fa+oa,fa+oa),pa.moveTo(fa-oa,-oa),pa.lineTo(fa+oa,oa),pa.moveTo(-oa,fa-oa),pa.lineTo(oa,fa+oa);if("backward-diagonal"===W||"diagonal-cross"===W||"esriSFSBackwardDiagonal"===W||"esriSFSDiagonalCross"===W)pa.moveTo(fa+oa,-oa),pa.lineTo(-oa,fa+oa),pa.moveTo(oa,-oa),pa.lineTo(-oa,oa),pa.moveTo(fa+oa,fa-oa),pa.lineTo(fa-oa,fa+oa);pa.stroke();
W=pa.getImageData(0,0,Q.width,Q.height);W=new Uint8Array(W.data);for(fa=0;fa<W.length;fa+=4)P=W[fa+3]/255,W[fa]*=P,W[fa+1]*=P,W[fa+2]*=P;return[W,Q.width,Q.height]};R.rasterizeSimpleLine=function(Q,W){return this.rasterizeDash(Q,W)};R.rasterizeDash=function(Q,W){var P="Butt"===W,fa="Square"===W;W=!P&&!fa;1===Q.length%2&&(Q=[...Q,...Q]);var oa=0;for(var pa of Q)oa+=pa;pa=Math.round(15.5*oa);oa=new Float32Array(31*pa);let sa=0,ra=0,ua=.5,M=!0;for(var T of Q){sa=ra;for(ra+=15.5*T;ua<=ra;){for(Q=.5;31>
Q;){const ha=W?(Q-15.5)*(Q-15.5):Math.abs(Q-15.5);oa[(Q-.5)*pa+ua-.5]=M?P?Math.max(Math.max(sa+7.75-ua,ha),Math.max(ua-ra+7.75,ha)):ha:W?Math.min((ua-sa)*(ua-sa)+ha,(ua-ra)*(ua-ra)+ha):fa?Math.min(Math.max(ua-sa,ha),Math.max(ra-ua,ha)):Math.min(Math.max(ua-sa+7.75,ha),Math.max(ra+7.75-ua,ha));Q++}ua++}M=!M}P=oa.length;T=new Uint8Array(4*P);for(fa=0;fa<P;++fa)D.packFloatRGBA((W?Math.sqrt(oa[fa]):oa[fa])/15.5,T,4*fa);return[T,pa,31]};return R}(),K=function(){function R(){}R.findApplicableOverrides=
function(Q,W,P){if(W){if(Q.primitiveName){let fa=!1;for(const oa of P)if(oa.primitiveName===Q.primitiveName){fa=!0;break}if(!fa)for(const oa of W)oa.primitiveName===Q.primitiveName&&P.push(oa)}switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(Q.effects)for(const fa of Q.effects)R.findApplicableOverrides(fa,W,P);if(Q.symbolLayers)for(const fa of Q.symbolLayers)R.findApplicableOverrides(fa,W,P);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(Q.effects)for(const fa of Q.effects)R.findApplicableOverrides(fa,
W,P);Q.markerPlacement&&R.findApplicableOverrides(Q.markerPlacement,W,P);if("CIMVectorMarker"===Q.type){if(Q.markerGraphics)for(const fa of Q.markerGraphics)R.findApplicableOverrides(fa,W,P),R.findApplicableOverrides(fa.symbol,W,P)}else"CIMCharacterMarker"===Q.type?R.findApplicableOverrides(Q.symbol,W,P):"CIMHatchFill"===Q.type&&R.findApplicableOverrides(Q.lineSymbol,W,P)}}};R.applyOverrides=function(Q,W,P,fa){if(W){if(Q.primitiveName)for(const pa of W)if(pa.primitiveName===Q.primitiveName){var oa=
(oa=pa.propertyName)?oa.charAt(0).toLowerCase()+oa.substr(1):oa;fa&&fa.push({cim:Q,nocapPropertyName:oa,value:Q[oa]});pa.expression&&(pa.value=R.toValue(pa.propertyName,pa.expression));if(P){let sa=!1;for(const ra of P)ra.primitiveName===Q.primitiveName&&(sa=!0);sa||P.push(pa)}Q[oa]=pa.value}switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(Q.effects)for(const pa of Q.effects)R.applyOverrides(pa,W,P,fa);if(Q.symbolLayers)for(const pa of Q.symbolLayers)R.applyOverrides(pa,
W,P,fa);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(Q.effects)for(const pa of Q.effects)R.applyOverrides(pa,W,P,fa);if("CIMVectorMarker"===Q.type&&Q.markerGraphics)for(const pa of Q.markerGraphics)R.applyOverrides(pa,W,P,fa),R.applyOverrides(pa.symbol,W,P,fa)}}};R.restoreOverrides=function(Q){for(const W of Q)W.cim[W.nocapPropertyName]=W.value};R.buildOverrideKey=function(Q){let W="";for(const P of Q)void 0!==P.value&&(W+=`${P.primitiveName}${P.propertyName}${JSON.stringify(P.value)}`);
return W};R.toValue=function(Q,W){return"DashTemplate"===Q?W.split(" ").map(P=>Number(P)):"Color"===Q?(Q=(new t(W)).toRgba(),Q[3]*=255,Q):W};return R}();const L=R=>{if(!R)return"Butt";switch(R){case "butt":return"Butt";case "square":return"Square";case "round":return"Round"}},J=R=>{if(!R)return"Miter";switch(R){case "miter":return"Miter";case "round":return"Round";case "bevel":return"Bevel"}},B=R=>{if(!R)return"Center";switch(R){case "left":return"Left";case "right":return"Right";case "center":return"Center";
case "justify":return"Justify"}},y=R=>{if(!R)return"Center";switch(R){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},I=R=>{if(!R)return[0,0,0,0];const {r:Q,g:W,b:P,a:fa}=R;return[Q,W,P,255*fa]},S=(R,Q)=>{Q="butt"===Q;switch(R){case "dash":case "esriSLSDash":return Q?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return Q?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return Q?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return Q?
[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return Q?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return Q?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return Q?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return Q?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return Q?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return Q?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return E.error("Unexpected: style does not require rasterization"),
[0,0];default:return E.error(`Tried to rasterize SLS, but found an unexpected style: ${R}!`),[0,0]}},O=R=>{if("circle"===R||"esriSMSCircle"===R){var Q=Math.acos(.995);R=Math.ceil(u/Q/4);0===R&&(R=1);Q=F/R;R*=4;var W=[];W.push([50,0]);for(let P=1;P<R;P++)W.push([50*Math.cos(P*Q),-50*Math.sin(P*Q)]);W.push([50,0]);Q={rings:[W]};W={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===R||"esriSMSCross"===R?(Q={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,
50],[0,50]]]},W={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===R||"esriSMSDiamond"===R?(Q={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},W={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===R||"esriSMSSquare"===R?(Q={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},W={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===R||"esriSMSX"===R?(Q={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},W={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===
R||"esriSMSTriangle"===R?(R=2/3*100,W=R-100,Q={rings:[[[-57.735026918962575,W],[0,R],[57.735026918962575,W],[-57.735026918962575,W]]]},W={xmin:-57.735026918962575,ymin:W,xmax:57.735026918962575,ymax:R}):"arrow"===R&&(Q={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},W={xmin:-50,ymin:-50,xmax:50,ymax:50});return[W,Q]},Y=R=>"vertical"===R||"horizontal"===R||"cross"===R||"esriSFSCross"===R||"esriSFSVertical"===R||"esriSFSHorizontal"===R;r.CIMSimbolInflatedSizeHelper=w;r.CIMSymbolHelper=
G;r.OverrideHelper=K;r.SymbolHelper=H;r.slsDashToTemplateArray=S;r.symbolToCIM=function(R){if(!R||!R.type)return null;let Q;switch(R.type){case "cim":return R.data;case "web-style":return R;case "simple-marker":Q=G.fromSimpleMarker(R);break;case "picture-marker":Q=G.fromPictureMarker(R);break;case "simple-line":Q=G.fromSimpleLineSymbol(R);break;case "simple-fill":Q=G.fromSimpleFillSymbol(R);break;case "picture-fill":Q=G.fromPictureFillSymbol(R);break;case "text":Q=G.fromTextSymbol(R)}return{type:"CIMSymbolReference",
symbol:Q}};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(r,t){function C(p,g=0){let e=0;for(let l=0;4>l;l++)e+=p[g+l]*w[l];return e}function D(p){return p-Math.floor(p)}const x=[1,256,65536,16777216],w=[1/256,1/65536,1/16777216,1/4294967296],q=C(new Uint8ClampedArray([255,255,255,255]));r.packFloatRGBA=function(p,g,e=0){p=t.clamp(p,0,q);for(let l=0;4>l;l++)g[e+l]=Math.floor(256*D(p*x[l]))};r.unpackFloatRGBA=C;Object.defineProperty(r,
"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./CIMResourceManager ./Rect ./TextRasterizer ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m){const h=Math.PI/180,v=D.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let u=function(){function L(B){this._t=B}L.createIdentity=function(){return new L([1,0,0,0,1,0])};var J=L.prototype;J.clone=function(){return new L(this._t.slice())};J.transform=function(B){const y=this._t;return[y[0]*B[0]+y[1]*B[1]+y[2],y[3]*B[0]+y[4]*B[1]+y[5]]};L.createScale=function(B,y){return new L([B,0,0,0,y,0])};J.scale=function(B,y){const I=this._t;I[0]*=B;I[1]*=B;I[2]*=
B;I[3]*=y;I[4]*=y;I[5]*=y;return this};J.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};L.createTranslate=function(B,y){return new L([0,0,B,0,0,y])};J.translate=function(B,y){const I=this._t;I[2]+=B;I[5]+=y;return this};L.createRotate=function(B){const y=Math.cos(B);B=Math.sin(B);return new L([y,-B,0,B,y,0])};J.rotate=function(B){return L.multiply(this,L.createRotate(B),this)};L.multiply=function(B,y,I){B=B._t;y=y._t;const S=B[1]*y[0]+B[4]*y[1],O=B[2]*y[0]+B[5]*
y[1]+y[2],Y=B[0]*y[3]+B[3]*y[4],R=B[1]*y[3]+B[4]*y[4],Q=B[2]*y[3]+B[5]*y[4]+y[5],W=I._t;W[0]=B[0]*y[0]+B[3]*y[1];W[1]=S;W[2]=O;W[3]=Y;W[4]=R;W[5]=Q;return I};J.invert=function(){const B=this._t;let y=B[0]*B[4]-B[1]*B[3];if(0===y)return new L([0,0,0,0,0,0]);y=1/y;return new L([B[4]*y,-B[1]*y,(B[1]*B[5]-B[2]*B[4])*y,-B[3]*y,B[0]*y,(B[2]*B[3]-B[0]*B[5])*y])};return L}();D=function(){function L(B,y){this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._flippedYs=!1;this._placementPool=
new w(n.Placement,null,null,100);this._earlyReturn=!1;this._mapRotation=0;this._resourceManager=B||new d;this._transfos.push(y||u.createIdentity());this._sizeTransfos.push(y?y.scaleRatio():1)}var J=L.prototype;J.setTransform=function(B,y){this._transfos=[B||u.createIdentity()];this._sizeTransfos=[y?y:B?B.scaleRatio():1]};J.setGeomUnitsPerPoint=function(B){this._geomUnitsPerPoint=B};J.setFlippedYs=function(B){this._flippedYs=B};J.transformPt=function(B){return this._transfos[this._transfos.length-
1].transform(B)};J.transformSize=function(B){return B*this._sizeTransfos[this._sizeTransfos.length-1]};J.reverseTransformPt=function(B){return this._transfos[this._transfos.length-1].invert().transform(B)};J.reverseTransformSize=function(B){return B/this._sizeTransfos[this._sizeTransfos.length-1]};J.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};J.flippedYs=function(){return this.isEmbedded()?!1:this._flippedYs};J.isEmbedded=function(){return 1<this._transfos.length};
J.back=function(){return this._transfos[this._transfos.length-1]};J.push=function(B,y){y=y?B.scaleRatio():1;u.multiply(B,this.back(),B);this._transfos.push(B);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*y)};J.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};J.drawSymbol=function(B,y){if(B)switch(B.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(B,y);break;case "CIMTextSymbol":this.drawTextSymbol(B,
y)}};J.drawMultiLayerSymbol=function(B,y){if(B){var I=B.symbolLayers;if(I)if((B=B.effects)&&0<B.length){if(y=this.executeEffects(B,y))for(B=y.next();B;)this.drawSymbolLayers(I,B),B=y.next()}else this.drawSymbolLayers(I,y)}};J.executeEffects=function(B,y){y=new l.SimpleGeometryCursor(y);for(const I of B)(B=k.getEffectOperator(I))&&(y=B.execute(y,I,this.geomUnitsPerPoint(),this.flippedYs()));return y};J.drawSymbolLayers=function(B,y){let I=B.length;for(;I--;){const O=B[I];if(O&&!1!==O.enable){var S=
O.effects;if(S&&0<S.length){if(S=this.executeEffects(S,y)){let Y=null;for(;(Y=S.next())&&(this.drawSymbolLayer(O,Y),!this._earlyReturn););}}else this.drawSymbolLayer(O,y);if(this._earlyReturn)break}}};J.drawSymbolLayer=function(B,y){switch(B.type){case "CIMSolidFill":this.drawSolidFill(y,B.color);break;case "CIMHatchFill":this.drawHatchFill(y,B);break;case "CIMPictureFill":this.drawPictureFill(y,B);break;case "CIMGradientFill":this.drawGradientFill(y,B);break;case "CIMSolidStroke":this.drawSolidStroke(y,
B.color,B.width,B.capStyle,B.joinStyle,B.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(y,B);break;case "CIMGradientStroke":this.drawGradientStroke(y,B);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(B,y)}};J.drawHatchFill=function(B,y){const I=this._buildHatchPolyline(y,B,this.geomUnitsPerPoint());I&&(this.pushClipPath(B),this.drawMultiLayerSymbol(y.lineSymbol,I),this.popClipPath())};J.drawPictureFill=function(B,y){};J.drawGradientFill=
function(B,y){};J.drawPictureStroke=function(B,y){};J.drawGradientStroke=function(B,y){};J.drawMarkerLayer=function(B,y){var I=B.markerPlacement;if(I){const O=k.getPlacementOperator(I);if(O){var S="CIMMarkerPlacementInsidePolygon"===I.type;S&&this.pushClipPath(y);if(y=O.execute(y,I,this.geomUnitsPerPoint()))for(I=null;(I=y.next())&&(this.drawMarker(B,I),!this._earlyReturn););S&&this.popClipPath()}}else{I=this._placementPool.acquire();if(e.isPoint(y))I.tx=y.x,I.ty=y.y,this.drawMarker(B,I);else for(S of y.points)if(I.tx=
S[0],I.ty=S[1],this.drawMarker(B,I),this._earlyReturn)break;this._placementPool.release(I)}};J.drawMarker=function(B,y){switch(B.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(B,y);break;case "CIMVectorMarker":this.drawVectorMarker(B,y)}};J.drawPictureMarker=function(B,y){var I,S,O,Y,R;if(B){var Q=this._resourceManager.getResource(B.url),W=null!=(I=B.size)?I:10;if(!(x.isNone(Q)||0>=W)&&(I=Q.width,Q=Q.height,I&&Q)){Q=I/Q;I=null!=(S=B.scaleX)?S:1;S=u.createIdentity();
var P=B.anchorPoint;if(P){let fa=P.x;P=P.y;"Absolute"!==B.anchorPointUnits&&(fa*=W*Q*I,P*=W);S.translate(-fa,-P)}Q=null!=(O=B.rotation)?O:0;B.rotateClockwise&&(Q=-Q);this._mapRotation&&(Q+=this._mapRotation);Q&&S.rotate(Q*h);O=null!=(Y=B.offsetX)?Y:0;Y=null!=(R=B.offsetY)?R:0;if(O||Y)this._mapRotation&&(Q=h*this._mapRotation,R=Math.cos(Q),Q=Math.sin(Q),I=O*Q+Y*R,O=O*R-Y*Q,Y=I),S.translate(O,Y);R=this.geomUnitsPerPoint();1!==R&&S.scale(R,R);(R=y.getAngle())&&S.rotate(R);S.translate(y.tx,y.ty);this.push(S,
!1);this.drawImage(B.url,W,B.scaleX);this.pop()}}};J.drawVectorMarker=function(B,y){var I,S,O,Y;if(B){var R=B.markerGraphics;if(R){var Q=null!=(I=B.size)?I:10,W=(I=B.frame)?I.ymax-I.ymin:0;W=Q&&W?Q/W:1;Q=u.createIdentity();I&&Q.translate(.5*-(I.xmax+I.xmin),.5*-(I.ymax+I.ymin));var P=B.anchorPoint;if(P){let fa=P.x;P=P.y;"Absolute"!==B.anchorPointUnits?I&&(fa*=I.xmax-I.xmin,P*=I.ymax-I.ymin):(fa/=W,P/=W);Q.translate(-fa,-P)}1!==W&&Q.scale(W,W);I=null!=(S=B.rotation)?S:0;B.rotateClockwise&&(I=-I);this._mapRotation&&
(I+=this._mapRotation);I&&Q.rotate(I*h);S=null!=(O=B.offsetX)?O:0;O=null!=(Y=B.offsetY)?Y:0;if(S||O)this._mapRotation&&(I=h*this._mapRotation,Y=Math.cos(I),I=Math.sin(I),W=S*I+O*Y,S=S*Y-O*I,O=W),Q.translate(S,O);Y=this.geomUnitsPerPoint();1!==Y&&Q.scale(Y,Y);(Y=y.getAngle())&&Q.rotate(Y);Q.translate(y.tx,y.ty);this.push(Q,B.scaleSymbolsProportionally);for(const fa of R)if(fa&&fa.symbol&&fa.geometry||v.error("Invalid marker graphic",fa),this.drawSymbol(fa.symbol,fa.geometry),this._earlyReturn)break;
this.pop()}}};J.drawTextSymbol=function(B,y){var I,S,O,Y;if(B&&e.isPoint(y)&&!(0>=(null!=(I=B.height)?I:10))){I=u.createIdentity();var R=null!=(S=B.angle)?S:0;(R=-R)&&I.rotate(R*h);S=null!=(O=B.offsetX)?O:0;O=null!=(Y=B.offsetY)?Y:0;(S||O)&&I.translate(S,O);Y=this.geomUnitsPerPoint();1!==Y&&I.scale(Y,Y);I.translate(y.x,y.y);this.push(I,!1);this.drawText(B);this.pop()}};J._buildHatchPolyline=function(B,y,I){var S=(void 0!==B.separation?B.separation:4)*I,O=void 0!==B.rotation?B.rotation:0;if(0===S)return null;
0>S&&(S=-S);for(var Y=0,R=.5*S;Y>R;)Y-=S;for(;Y<-R;)Y+=S;Y=p.create();g.getBoundsXY(Y,y);Y[0]-=R;Y[1]-=R;Y[2]+=R;Y[3]+=R;for(var Q=[[Y[0],Y[1]],[Y[0],Y[3]],[Y[2],Y[3]],[Y[2],Y[1]]];180<O;)O-=180;for(;0>O;)O+=180;R=Math.cos(O*h);var W=Math.sin(O*h);O=-S*W;y=S*R;Y=(void 0!==B.offsetX?B.offsetX*I:0)*W-(void 0!==B.offsetY?B.offsetY*I:0)*R;let P;var fa=B=Number.MAX_VALUE;P=I=-Number.MAX_VALUE;for(var oa of Q){var pa=oa[0];const sa=oa[1];Q=R*pa+W*sa;pa=-W*pa+R*sa;fa=Math.min(fa,Q);B=Math.min(B,pa);P=Math.max(P,
Q);I=Math.max(I,pa)}B=Math.floor(B/S)*S;oa=R*fa-W*B-O*Y/S;fa=W*fa+R*B-y*Y/S;Q=R*P-W*B-O*Y/S;Y=W*P+R*B-y*Y/S;S=1+Math.round((I-B)/S);R=[];for(W=0;W<S;W++)oa+=O,fa+=y,Q+=O,Y+=y,R.push([[oa,fa],[Q,Y]]);return{paths:R}};return L}();let F=function(L){function J(y,I){y=L.call(this,y,I)||this;y.reset();return y}t._inheritsLoose(J,L);var B=J.prototype;B.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};B.envelope=function(){return new b(this._xmin,this._ymin,
this._xmax-this._xmin,this._ymax-this._ymin)};B.bounds=function(){return p.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};B.drawSolidFill=function(y){!y||0<this._clipCount||(e.isPolygon(y)?this._processPath(y.rings,0):e.isPolyline(y)?this._processPath(y.paths,0):e.isExtent(y)?(y=E(y))&&this._processPath(y.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};B.drawSolidStroke=function(y,I,S){!y||0<this._clipCount||(I=.5*this.transformSize(S),e.isPolygon(y)?this._processPath(y.rings,
I):e.isPolyline(y)?this._processPath(y.paths,I):e.isExtent(y)?(y=E(y))&&this._processPath(y.rings,I):console.error("drawSolidStroke unexpected geometry type!"))};B.pushClipPath=function(y){this.drawSolidFill(y);++this._clipCount};B.popClipPath=function(){--this._clipCount};B.drawImage=function(y,I,S){let O=S*I,Y=I;y=this._resourceManager.getResource(y);!I&&x.isSome(y)&&(O=S*y.width,Y=y.height);this._merge(this.transformPt([-O/2,-Y/2]),0);this._merge(this.transformPt([-O/2,Y/2]),0);this._merge(this.transformPt([O/
2,-Y/2]),0);this._merge(this.transformPt([O/2,Y/2]),0)};B.drawText=function(y){this._textRasterizer||(this._textRasterizer=new a.TextRasterizer)};B._processPath=function(y,I){if(y)for(const S of y)if(y=S?S.length:0,1<y){this._merge(this.transformPt(S[0]),I);for(let O=1;O<y;++O)this._merge(this.transformPt(S[O]),I)}};B._merge=function(y,I){y[0]-I<this._xmin&&(this._xmin=y[0]-I);y[0]+I>this._xmax&&(this._xmax=y[0]+I);y[1]-I<this._ymin&&(this._ymin=y[1]-I);y[1]+I>this._ymax&&(this._ymax=y[1]+I)};return J}(D),
z=function(L){function J(){var y=L.apply(this,arguments)||this;y._searchPoint=[0,0];y._searchDistPoint=0;return y}t._inheritsLoose(J,L);var B=J.prototype;B.hitTest=function(y,I,S,O,Y,R){R*=q.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(R);this._searchPoint=[(y[0]+y[2])/2,(y[1]+y[3])/2];this._searchDistPoint=(y[2]-y[0])/2/R;this._textInfo=O;this._mapRotation=I&&("CIMPointSymbol"===I.type&&"Map"!==I.angleAlignment||"CIMTextSymbol"===I.type)?Y:0;this._earlyReturn=!1;this.drawSymbol(I,S);return this._earlyReturn};
B.drawSolidFill=function(y,I){this._hitTestFill(y)};B.drawHatchFill=function(y,I){this._hitTestFill(y)};B.drawPictureFill=function(y,I){this._hitTestFill(y)};B.drawGradientFill=function(y,I){this._hitTestFill(y)};B.drawSolidStroke=function(y,I,S,O,Y,R){this._hitTestStroke(y,S)};B.drawPictureStroke=function(y,I){this._hitTestStroke(y,I.width)};B.drawGradientStroke=function(y,I){this._hitTestStroke(y,I.width)};B.pushClipPath=function(y){};B.popClipPath=function(){};B.drawImage=function(y,I,S){y=this._resourceManager.getResource(y);
if(!x.isNone(y)&&0!==y.height&&0!==I){I*=this.geomUnitsPerPoint();S=y.width/y.height*S*I;y=this.reverseTransformPt(this._searchPoint);var O=this._searchDistPoint;Math.abs(y[0])<S/2+O&&Math.abs(y[1])<I/2+O&&(this._earlyReturn=!0)}};B.drawText=function(y){var I,S,O=this._textInfo;if(O&&(O=O.get(y))){var {text:Y,mosaicItem:R}=O;if(R&&0!==R.glyphMosaicItems.length){O=null!=(I=y.height)?I:10;I=K(y.lineGapType,null!=(S=y.lineGap)?S:0,O);S=C.bidiText(Y)[1];y=m.shapeGlyphs(R.glyphMosaicItems,S,{scale:O/f.GLYPH_SIZE,
angle:0,xOffset:0,yOffset:0,hAlign:G(y.horizontalAlignment),vAlign:H(y.verticalAlignment),maxLineWidth:512,lineHeight:f.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(I||1,4)),decoration:y.font.decoration||"none",isCIM:!0});I=this.reverseTransformPt(this._searchPoint);S=I[0];I=I[1];for(const Q of y.glyphs)if(S>Q.xTopLeft&&S<Q.xBottomRight&&I>-Q.yBottomRight&&I<-Q.yTopLeft){this._earlyReturn=!0;break}}}};B._hitTestFill=function(y){let I=null;if(e.isExtent(y))I=[[[y.xmin,y.ymin],[y.xmin,y.ymax],[y.xmax,
y.ymax],[y.xmax,y.ymin],[y.xmin,y.ymin]]];else if(e.isPolygon(y))I=y.rings;else if(e.isPolyline(y))I=y.paths;else return;y=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(y,I)&&(this._earlyReturn=!0);const S=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(y,I,S)&&(this._earlyReturn=!0)};B._hitTestStroke=function(y,I){let S=null;if(e.isExtent(y))S=[[[y.xmin,y.ymin],[y.xmin,y.ymax],[y.xmax,y.ymax],[y.xmax,y.ymin],[y.xmin,y.ymin]]];else if(e.isPolygon(y))S=
y.rings;else if(e.isPolyline(y))S=y.paths;else return;y=this.reverseTransformPt(this._searchPoint);I*=this.geomUnitsPerPoint();const O=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(y,S,I/2+O)&&(this._earlyReturn=!0)};B._pointInPolygon=function(y,I){let S=0;for(const O of I){I=O.length;for(let Y=1;Y<I;++Y){const R=O[Y-1],Q=O[Y];R[1]>y[1]!==Q[1]>y[1]&&(0<(Q[0]-R[0])*(y[1]-R[1])-(Q[1]-R[1])*(y[0]-R[0])?S++:S--)}}return 0!==S};B._nearLine=function(y,I,S){for(const Y of I){I=
Y.length;for(let R=1;R<I;++R){var O=Y[R-1];const Q=Y[R];let W=(Q[0]-O[0])*(Q[0]-O[0])+(Q[1]-O[1])*(Q[1]-O[1]);if(0!==W&&(W=Math.sqrt(W),Math.abs(((Q[0]-O[0])*(y[1]-O[1])-(Q[1]-O[1])*(y[0]-O[0]))/W)<S&&(O=((Q[0]-O[0])*(y[0]-O[0])+(Q[1]-O[1])*(y[1]-O[1]))/W,O>-S&&O<W+S)))return!0}}return!1};return J}(D),A=function(L){function J(y,I,S){I=L.call(this,I,S)||this;I._ctx=y;return I}t._inheritsLoose(J,L);var B=J.prototype;B.drawSolidFill=function(y,I){if(y){if(e.isPolygon(y))this._buildPath(y.rings,!0);else if(e.isPolyline(y))this._buildPath(y.paths,
!0);else if(e.isExtent(y))this._buildPath(E(y).rings,!0);else if(e.isMultipoint(y))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;y=this._ctx;y.fillStyle="string"===typeof I?I:"rgba("+Math.round(I[0])+","+Math.round(I[1])+","+Math.round(I[2])+","+I[3]/255+")";y.fill("evenodd")}};B.drawSolidStroke=function(y,I,S,O,Y,R){if(y&&I&&0!==S){if(e.isPolygon(y))this._buildPath(y.rings,!0);else if(e.isPolyline(y))this._buildPath(y.paths,!1);else if(e.isExtent(y))this._buildPath(E(y).rings,
!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}y=this._ctx;y.strokeStyle="string"===typeof I?I:"rgba("+Math.round(I[0])+","+Math.round(I[1])+","+Math.round(I[2])+","+I[3]/255+")";y.lineWidth=this.transformSize(S)+.5;this._setCapStyle(O);this._setJoinStyle(Y);y.miterLimit=R;y.stroke()}};B.pushClipPath=function(y){this._ctx.save();if(e.isPolygon(y))this._buildPath(y.rings,!0);else if(e.isPolyline(y))this._buildPath(y.paths,!0);else if(e.isExtent(y))this._buildPath(E(y).rings,
!0);else return;this._ctx.clip("evenodd")};B.popClipPath=function(){this._ctx.restore()};B.drawImage=function(y,I,S){y=this._resourceManager.getResource(y);if(!x.isNone(y)){var O=this._ctx,Y=O.canvas.width;O=O.canvas.height;var R=y.width/y.height*S*I,Q=S*I;I||(R=S*y.width,Q=S*y.height);this._ctx.drawImage(y,0,0,y.width,y.height,0,0,Math.min(this.transformSize(R),Y),Math.min(this.transformSize(Q),O))}};B.drawText=function(y){this._textRasterizer||(this._textRasterizer=new a.TextRasterizer)};B._buildPath=
function(y,I){const S=this._ctx;S.beginPath();if(y)for(const O of y)if(y=O?O.length:0,1<y){let Y=this.transformPt(O[0]);S.moveTo(Y[0],Y[1]);for(let R=1;R<y;++R)Y=this.transformPt(O[R]),S.lineTo(Y[0],Y[1]);I&&S.closePath()}};B._setCapStyle=function(y){switch(y){case "Butt":this._ctx.lineCap="butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};B._setJoinStyle=function(y){switch(y){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin=
"round";break;case "Miter":this._ctx.lineJoin="miter"}};return J}(D);const E=L=>L?{spatialReference:L.spatialReference,rings:[[[L.xmin,L.ymin],[L.xmin,L.ymax],[L.xmax,L.ymax],[L.xmax,L.ymin],[L.xmin,L.ymin]]]}:null,G=L=>{switch(L){case "Left":return c.HAlign.Left;case "Right":return c.HAlign.Right;case "Center":case "Justify":return c.HAlign.Center}},H=L=>{switch(L){case "Top":return c.VAlign.Top;case "Center":return c.VAlign.Center;case "Bottom":return c.VAlign.Bottom;case "Baseline":return c.VAlign.Baseline}},
K=(L,J,B)=>{switch(L){case "ExtraLeading":return 1+J/B;case "Multiple":return J;case "Exact":return J/B}};r.CIMSymbolDrawHelper=D;r.C_DEG_TO_RAD=h;r.CanvasDrawHelper=A;r.EnvDrawHelper=F;r.HittestDrawHelper=z;r.Transformation=u;r.horizontalAlignment2HAlign=G;r.lineGapType2LineHeight=K;r.verticalAlignment2VAlign=H;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/CIMResourceManager":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/promiseUtils"],
function(r,t,C,D){function x(w,q){if(w.includes(";base64,")){const p=new Image;p.src=w;return p.decode().then(()=>({ok:!0,value:p})).catch(g=>D.isAbortError(g)?{ok:!1,error:g}:{ok:!1,error:new C("invalid-resource",`Could not fetch requested resource at ${w}`)})}return t(w,{responseType:"image",...q}).then(p=>({ok:!0,value:p.data})).catch(p=>D.isAbortError(p)?{ok:!1,error:p}:{ok:!1,error:new C("invalid-resource",`Could not fetch requested resource at ${w}`)})}return function(){function w(){this._resourceMap=
new Map;this._inFlightResourceMap=new Map}var q=w.prototype;q.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};q.getResource=function(p){var g;return null!=(g=this._resourceMap.get(p))?g:null};q.fetchResource=function(){var p=r._asyncToGenerator(function*(g,e){const l={width:0,height:0},k=this._resourceMap;var n=k.get(g);if(n)return l.width=n.width,l.height=n.height,l;if(n=this._inFlightResourceMap.get(g))return n;n=x(g,e);this._inFlightResourceMap.set(g,n);return n=
n.then(d=>{this._inFlightResourceMap.delete(g);d.ok&&(k.set(g,d.value),d=d.value,l.width=d.width,l.height=d.height);return l})});return function(g,e){return p.apply(this,arguments)}}();q.deleteResource=function(p){this._inFlightResourceMap.delete(p);this._resourceMap.delete(p)};return w}()})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(r){return function(){function t(C=0,D=0,x=0,w=0){this.x=C;this.y=D;this.width=x;this.height=w}t.prototype.union=function(C){this.x=
Math.min(this.x,C.x);this.y=Math.min(this.y,C.y);this.width=Math.max(this.width,C.width);this.height=Math.max(this.height,C.height)};r._createClass(t,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return t}()})},"esri/symbols/cim/TextRasterizer":function(){define(["exports","../../core/screenUtils"],function(r,t){let C=function(){function x(){}var w=x.prototype;w.rasterizeText=function(q,p){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));
var g=this._textRasterizationCanvas,e=g.getContext("2d");this.setFontProperties(e,p);this.parameters=p;this.textLines=q.split(/\r?\n/);this.lineHeight=this.computeLineHeight();q=this.computeTextWidth(e,p);const {decoration:l,weight:k}=p.font;this.lineThroughWidthOffset=l&&"line-through"===l?.1*this.lineHeight:0;var n=this.lineHeight*this.textLines.length;g.width=q+2*this.lineThroughWidthOffset;g.height=n;this.renderedLineHeight=Math.round(this.lineHeight*p.pixelRatio);this.renderedHaloSize=p.halo.size*
p.pixelRatio;this.renderedWidth=q*p.pixelRatio;this.renderedHeight=n*p.pixelRatio;this.lineThroughWidthOffset*=p.pixelRatio;g=p.color;this.fillStyle=`rgba(${g.slice(0,3).toString()},${g[3]})`;this.haloStyle=`rgb(${p.halo.color.slice(0,3).toString()})`;g=this.renderedLineHeight;q=this.renderedHaloSize;this.setFontProperties(e,p);n=e.textAlign;var d=this.renderedWidth;n=("center"===n?.5*d:"right"===n?d:0)+q;d=this.lineThroughWidthOffset;let b=0;0<q&&this.renderHalo(e,n,q,d,b,p);b+=q;d+=n;for(var a of this.textLines)e.globalCompositeOperation=
"destination-out",e.fillStyle="rgb(0, 0, 0)",e.fillText(a,d,b),e.globalCompositeOperation="source-over",e.fillStyle=this.fillStyle,e.fillText(a,d,b),l&&"none"!==l&&this.renderDecoration(e,d,b,l,k),b+=g;a=this.renderedWidth+2*this.lineThroughWidthOffset;g=this.renderedHeight;e=e.getImageData(0,0,a,g);e=new Uint8Array(e.data);if(p.premultiplyColors)for(q=0;q<e.length;q+=4)p=e[q+3]/255,e[q]*=p,e[q+1]*=p,e[q+2]*=p;return{size:[a,g],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};
w.renderHalo=function(q,p,g,e,l,k){const n=this.renderedWidth,d=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=n;this._haloRasterizationCanvas.height=d;const b=this._haloRasterizationCanvas,a=b.getContext("2d");a.clearRect(0,0,n,d);this.setFontProperties(a,k);const {decoration:c,weight:f}=k.font;a.fillStyle=this.haloStyle;a.strokeStyle=this.haloStyle;k=3>this.renderedHaloSize;a.lineJoin=k?"miter":
"round";k?this.renderHaloEmulated(a,p,g,c,f):this.renderHaloNative(a,p,g,c,f);q.globalAlpha=this.parameters.halo.color[3];q.drawImage(b,0,0,n,d,e,l,n,d);q.globalAlpha=1};w.renderHaloEmulated=function(q,p,g,e,l){const k=this.renderedLineHeight,n=this.renderedHaloSize;for(const d of this.textLines){for(const [b,a]of D)q.fillText(d,p+n*b,g+n*a);e&&"none"!==e&&this.renderDecoration(q,p,g,e,l);g+=k}};w.renderHaloNative=function(q,p,g,e,l){const k=this.renderedLineHeight,n=this.renderedHaloSize;for(const d of this.textLines){const b=
2*n;for(let a=0;5>a;a++)q.lineWidth=(.6+.1*a)*b,q.strokeText(d,p,g),e&&"none"!==e&&this.renderDecoration(q,p,g,e,l);g+=k}};w.setFontProperties=function(q,p){var g=p.font;g=`${g.style} ${g.weight} ${t.pt2px(p.size*p.pixelRatio)}px ${g.family}, sans-serif`;q.font=g;q.textBaseline="top";switch(p.horizontalAlignment){case "left":p="left";break;case "right":p="right";break;case "center":p="center";break;default:p="left"}q.textAlign=p};w.computeTextSize=function(q,p){this._textRasterizationCanvas||(this._textRasterizationCanvas=
document.createElement("canvas"));const g=this._textRasterizationCanvas;var e=g.getContext("2d");this.setFontProperties(e,p);this.parameters=p;this.textLines=q.split(/\r?\n/);this.lineHeight=this.computeLineHeight();q=this.computeTextWidth(e,p);e=this.lineHeight*this.textLines.length;g.width=q;g.height=e;return[q*p.pixelRatio,e*p.pixelRatio]};w.computeTextWidth=function(q,p){let g=0;for(const e of this.textLines)g=Math.max(g,q.measureText(e).width);p=p.font;if("italic"===p.style||"oblique"===p.style||
"string"===typeof p.weight&&("bold"===p.weight||"bolder"===p.weight)||"number"===typeof p.weight&&600<p.weight)g+=.3*q.measureText("w").width;g+=2*this.parameters.halo.size;return Math.round(g)};w.computeLineHeight=function(){let q=1.275*this.parameters.size;const p=this.parameters.font.decoration;p&&"underline"===p&&(q*=1.3);return Math.round(q+2*this.parameters.halo.size)};w.renderDecoration=function(q,p,g,e,l){const k=.9*this.lineHeight;l="bold"===l?.06:"bolder"===l?.09:.04;switch(q.textAlign){case "center":p-=
this.renderedWidth/2;break;case "right":p-=this.renderedWidth}const n=q.textBaseline;if("underline"===e)switch(n){case "top":g+=k;break;case "middle":g+=k/2}else if("line-through"===e)switch(n){case "top":g+=k/1.5;break;case "middle":g+=k/3}q.save();q.beginPath();q.strokeStyle=q.fillStyle;q.lineWidth=Math.ceil(k*l);q.moveTo(p-this.lineThroughWidthOffset,g);q.lineTo(p+this.renderedWidth+2*this.lineThroughWidthOffset,g);q.stroke();q.restore()};return x}();const D=[];for(let x=0;360>x;x+=22.5)D.push([Math.cos(Math.PI*
x/180),Math.sin(Math.PI*x/180)]);r.TextRasterizer=C;r.default=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/utils":function(){define(["exports"],function(r){function t(C,D){"string"!==typeof C&&(C=String(C));switch(D){case "LowerCase":return C.toLowerCase();case "Allcaps":return C.toUpperCase();default:return C}}r._adjustTextCase=t;r.colorToArray=function(C){return[C.r,C.g,C.b,C.a]};r.createLabelOverrideFunction=function(C,D,x){const w=e=>{let l=e.length;for(;l--;)if(-1===
" /-,\n".indexOf(e.charAt(l)))return!1;return!0},q=[];var p=0;let g=-1;do g=D.indexOf("[",p),g>=p&&(g>p&&(p=D.substr(p,g-p),q.push([p,null,w(p)])),p=g+1,g=D.indexOf("]",p),g>=p&&(g>p&&(p=D.substr(p,g-p),(p=C[p])&&q.push([null,p,!1])),p=g+1));while(-1!==g);p<D.length-1&&(C=D.substr(p),q.push([C,null,w(C)]));return e=>{let l="",k=null;for(const n of q){const [d,b,a]=n;if(d)a?k=d:(k&&(l+=k,k=null),l+=d);else{const c=e.attributes[b];c&&(k&&(l+=k,k=null),l+=c)}}return t(l,x)}};r.evaluateValueOrFunction=
function(C,D,x,w){return"function"===typeof C?C(D,x,w):C};r.fromCIMColor=function(C){return C?{r:C[0],g:C[1],b:C[2],a:C[3]/255}:{r:0,g:0,b:0,a:0}};r.getValue=C=>isNaN(C)||!C?0:C;r.isCIMFill=function(C){return"CIMGradientFill"===C.type||"CIMHatchFill"===C.type||"CIMPictureFill"===C.type||"CIMSolidFill"===C.type||"CIMWaterFill"===C.type};r.isCIMMarker=function(C){return"CIMVectorMarker"===C.type||"CIMPictureMarker"===C.type||"CIMBarChartMarker"===C.type||"CIMCharacterMarker"===C.type||"CIMPieChartMarker"===
C.type||"CIMStackedBarChartMarker"===C.type};r.isCIMMarkerStrokePlacement=function(C){return"CIMMarkerPlacementAlongLineRandomSize"===C.type||"CIMMarkerPlacementAlongLineSameSize"===C.type||"CIMMarkerPlacementAlongLineVariableSize"===C.type||"CIMMarkerPlacementAtExtremities"===C.type||"CIMMarkerPlacementAtMeasuredUnits"===C.type||"CIMMarkerPlacementAtRatioPositions"===C.type||"CIMMarkerPlacementOnLine"===C.type||"CIMMarkerPlacementOnVertices"===C.type};r.isCIMStroke=function(C){return"CIMGradientStroke"===
C.type||"CIMPictureStroke"===C.type||"CIMSolidStroke"===C.type};r.resampleHermite=function(C,D,x,w,q,p,g=!0){const e=D/q;x/=p;const l=Math.ceil(e/2),k=Math.ceil(x/2);for(let b=0;b<p;b++)for(let a=0;a<q;a++){const c=4*(a+(g?p-b-1:b)*q);var n=0;let f=0,m=0,h=0,v=0,u=0,F=0;const z=(b+.5)*x;for(let A=Math.floor(b*x);A<(b+1)*x;A++){var d=Math.abs(z-(A+.5))/k;const E=(a+.5)*e;d*=d;for(let G=Math.floor(a*e);G<(a+1)*e;G++){let H=Math.abs(E-(G+.5))/l;n=Math.sqrt(d+H*H);-1<=n&&1>=n&&(n=2*n*n*n-3*n*n+1,0<n&&
(H=4*(G+A*D),F+=n*C[H+3],m+=n,255>C[H+3]&&(n=n*C[H+3]/250),h+=n*C[H],v+=n*C[H+1],u+=n*C[H+2],f+=n))}}w[c]=h/f;w[c+1]=v/f;w[c+2]=u/f;w[c+3]=F/m}};r.toCIMSymbolJSON=function(C){var D;return null==(D=C.data)?void 0:D.symbol};r.toKebabCase=C=>C&&C.toLowerCase().replace(/\s+/g,"-");Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(r,t,C,D){function x(q){if(!q)return null;
switch(q.type){case "CIMPointSymbol":var p=q.symbolLayers;if(!p||1!==p.length)break;return x(p[0]);case "CIMVectorMarker":q=q.markerGraphics;if(!q||1!==q.length)break;var g=q[0];if(!g)break;q=g.geometry;if(!q)break;g=g.symbol;if(!g||"CIMPolygonSymbol"!==g.type&&"CIMLineSymbol"!==g.type||null!=(p=g.symbolLayers)&&p.some(e=>!!e.effects))break;return{geom:q,asFill:"CIMPolygonSymbol"===g.type};case "sdf":return{geom:q.geom,asFill:q.asFill}}return null}function w(q){let p=Infinity,g=-Infinity,e=Infinity,
l=-Infinity;for(const k of q)for(const n of k)n[0]<p&&(p=n[0]),n[0]>g&&(g=n[0]),n[1]<e&&(e=n[1]),n[1]>l&&(l=n[1]);return[p,e,g,l]}r.buildSDF=function(q){var p=q.geom;var g=p?p.rings?p.rings:p.paths?p.paths:void 0!==p.xmin&&void 0!==p.ymin&&void 0!==p.xmax&&void 0!==p.ymax?[[[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,p.ymin]]]:null:null;p=Infinity;var e=-Infinity;var l=Infinity,k=-Infinity;for(var n of g)for(var d of n)d[0]<p&&(p=d[0]),d[0]>e&&(e=d[0]),d[1]<l&&(l=d[1]),
d[1]>k&&(k=d[1]);e=new D(p,l,e-p,k-l);l=64/Math.max(e.width,e.height);n=Math.round(e.width*l)+62;d=Math.round(e.height*l)+62;p=[];for(var b of g)if(b&&1<b.length){g=[];for(var a of b){let [E,G]=a;E-=e.x;G-=e.y;E*=l;G*=l;E+=30.5;G+=30.5;q.asFill?g.push([E,G]):g.push([Math.round(E),Math.round(G)])}q.asFill&&(k=g.length-1,g[0][0]===g[k][0]&&g[0][1]===g[k][1]||g.push(g[0]));p.push(g)}var c;b=n*d;a=Array(b);for(g=0;g<b;++g)a[g]=962;for(c of p)for(g=c.length,e=1;e<g;++e){l=c[e-1];k=c[e];var f=void 0,m=
void 0;l[0]<k[0]?(f=l[0],m=k[0]):(f=k[0],m=l[0]);var h=void 0,v=void 0;l[1]<k[1]?(h=l[1],v=k[1]):(h=k[1],v=l[1]);var u=Math.floor(f)-31;m=Math.floor(m)+31;h=Math.floor(h)-31;v=Math.floor(v)+31;0>u&&(u=0);m>n&&(m=n);0>h&&(h=0);v>d&&(v=d);f=k[0]-l[0];const E=k[1]-l[1],G=f*f+E*E;for(;u<m;u++)for(let H=h;H<v;H++){var F=(u-l[0])*f+(H-l[1])*E,z=void 0;0>F?(z=l[0],F=l[1]):F>G?(z=k[0],F=k[1]):(F/=G,z=l[0]+F*f,F=l[1]+F*E);z=(u-z)*(u-z)+(H-F)*(H-F);F=(d-H-1)*n+u;z<a[F]&&(a[F]=z)}}for(c=0;c<b;++c)a[c]=Math.sqrt(a[c]);
c=a;if(q.asFill)for(var A of p)for(q=A.length,p=1;p<q;++p)for(b=A[p-1],a=A[p],b[0]<a[0]?(g=b[0],e=a[0]):(g=a[0],e=b[0]),b[1]<a[1]?(k=b[1],l=a[1]):(k=a[1],l=b[1]),g=Math.floor(g),e=Math.floor(e)+1,k=Math.floor(k),l=Math.floor(l)+1,31>g&&(g=31),e>n-31&&(e=n-31),31>k&&(k=31),l>d-31&&(l=d-31);k<l;++k)if(b[1]>k!==a[1]>k){m=(d-k-1)*n;for(h=g;h<e;++h)h<(a[0]-b[0])*(k-b[1])/(a[1]-b[1])+b[0]&&(c[m+h]=-c[m+h]);for(h=31;h<g;++h)c[m+h]=-c[m+h]}A=c.length;q=new Uint8Array(4*A);for(p=0;p<A;++p)t.packFloatRGBA(.5-
c[p]/62,q,4*p);A=q;return[A,n,d]};r.getExtent=function(q){return q?q.rings?w(q.rings):q.paths?w(q.paths):C.isExtent(q)?[q.xmin,q.ymin,q.xmax,q.ymax]:null:null};r.getSDFInfo=x;r.getSDFMetrics=function(q,p,g,e,l){const [k,n,d,b]=q;if(d<k||b<n)return[0,0,0];var a=d-k,c=b-n;q=64/Math.max(a,c);a=Math.round(a*q);c=Math.round(c*q)+62;let f=1;p&&(f=c/q/(p.ymax-p.ymin));let m=0,h=0;e&&(l?p&&g&&0<p.ymax-p.ymin&&(m=e.x/((p.xmax-p.xmin)/(p.ymax-p.ymin)*g),h=e.y/g):(m=e.x,h=e.y));m=.5*(p.xmax+p.xmin)+m*(p.xmax-
p.xmin);h=.5*(p.ymax+p.ymin)+h*(p.ymax-p.ymin);m=(m-k)*q+31;h=(h-n)*q+31;return[f,m/(a+62)-.5,-(h/c-.5)]};r.getSDFSymbol=function(q){q=q.markerGraphics;if(!q||1!==q.length)return null;q=q[0];if(!q)return null;q=q.symbol;return!q||"CIMPolygonSymbol"!==q.type&&"CIMLineSymbol"!==q.type?null:q};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],
function(r,t,C){function D(w){const q={};switch(w){case "esriGeometryPoint":return(p,g,e,l)=>C.unquantizePoint(g,q,p,e,l);case "esriGeometryPolygon":return(p,g,e,l)=>C.unquantizePolygon(g,q,p,e,l);case "esriGeometryPolyline":return(p,g,e,l)=>C.unquantizePolyline(g,q,p,e,l);case "esriGeometryMultipoint":return(p,g,e,l)=>C.unquantizeMultipoint(g,q,p,e,l);default:return t.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r("mapview-arcade",`Unable to handle geometryType: ${w}`)),p=>p}}const x=
new Map;return function(w,q,p,g,e){if(w.referencesGeometry()&&e){{const {transform:l,hasZ:k,hasM:n}=e;x.has(g)||x.set(g,D(g));g=x.get(g)(q.geometry,l,k,n);q={...q,geometry:g}}}q=w.repurposeFeature(q);try{return w.evaluate({...p,$feature:q})}catch(l){return t.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",l),null}}})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(r,t){r.ok=function(C,D){return C&&
"name"in C?(D&&D.error(new t(C.name,C.message,C.details)),!1):!0};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(r,t,C,D,x,w,q,p,g,e){return function(l){function k(n,
d,b){var a=l.call(this,n)||this;a._minMaxZoom=x.i1616to32(Math.round(d*D.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(b*D.MIN_MAX_ZOOM_PRECISION_FACTOR));a._cimLineLayer=n;let c=0;q.isFunction(n.width)||(c=.5*t.pt2px(n.width));a._dynamicPropertyMap.set("_halfWidth",(f,m,h)=>q.isFunction(n.width)?.5*t.pt2px(n.width(f,m,h)):c);q.isFunction(n.cap)?a._dynamicPropertyMap.set("_capType",n.cap):a._capType=n.cap;q.isFunction(n.join)?a._dynamicPropertyMap.set("_joinType",n.join):a._joinType=n.join;q.isFunction(n.color)?
a._dynamicPropertyMap.set("_fillColor",(f,m,h)=>(f=n.color(f,m,h))&&C.premultiplyAlphaRGBA(f)||0):(d=n.color,a._fillColor=d&&C.premultiplyAlphaRGBA(d)||0);q.isFunction(n.miterLimit)?a._dynamicPropertyMap.set("_miterLimitCosine",(f,m,h)=>q.getLimitCosine(n.miterLimit(f,m,h))):a._miterLimitCosine=q.getLimitCosine(n.miterLimit);a._scaleFactor=n.scaleFactor||1;a._isDashed=null!=n.dashTemplate;a._effects=n.effects;a.tessellationProperties._bitset=(n.colorLocked?1:0)|(n.scaleDash?1:0)<<1;a._materialKey=
n.materialKey;a._initializeTessellator(!0);return a}r._inheritsLoose(k,l);k.fromCIMLine=function(n,d){const [b,a]=q.getMinMaxZoom(n.scaleInfo,d);return new k(n,b,a)};k.prototype.bindFeature=function(n,d,b){const a=n.readLegacyFeature();this._dynamicPropertyMap.forEach((f,m)=>{this[m]=f(a,d,b)});this._halfWidth*=this._scaleFactor;n=this._materialCache;var c=this._cimLineLayer.materialHash;c=c(a,d,b);c=n.get(c);n=null;c&&e.ok(c.spriteMosaicItem)&&(n=c.spriteMosaicItem);if(n){this._hasPattern=!0;const {rect:f,
width:m,height:h}=n;c=f.x+D.SPRITE_PADDING;const v=f.y+D.SPRITE_PADDING,u=c+m,F=v+h;this.tessellationProperties._tl=x.i1616to32(c,v);this.tessellationProperties._br=x.i1616to32(u,F)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;
c=w.LineMaterialKey.load(this._materialKey);n&&(c.sdf=n.sdf,c.pattern=!0,c.textureBinding=n.textureBinding);this._materialKey=c.data};return k}(p(g))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b){const a=q.create(),c=w.create(),f=C.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(m){function h(v,u,F){var z=m.call(this,v)||this;z._cimMarkerLayer=v;z._minMaxZoom=e.i1616to32(Math.round(u*g.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(F*g.MIN_MAX_ZOOM_PRECISION_FACTOR));k.isFunction(v.color)?z._dynamicPropertyMap.set("_fillColor",(A,E,G)=>p.premultiplyAlphaRGBA(v.color(A,E,G))):z._fillColor=p.premultiplyAlphaRGBA(v.color);k.isFunction(v.outlineColor)?
z._dynamicPropertyMap.set("_outlineColor",(A,E,G)=>p.premultiplyAlphaRGBA(v.outlineColor(A,E,G))):z._outlineColor=p.premultiplyAlphaRGBA(v.outlineColor);k.isFunction(v.size)?z._dynamicPropertyMap.set("_size",(A,E,G)=>x.pt2px(v.size(A,E,G))):z._size=x.pt2px(v.size)||0;k.isFunction(v.scaleX)?z._dynamicPropertyMap.set("_scaleX",v.scaleX):z._scaleX=v.scaleX||1;k.isFunction(v.offsetX)?z._dynamicPropertyMap.set("xOffset",(A,E,G)=>x.pt2px(v.offsetX(A,E,G))):z.xOffset=x.pt2px(v.offsetX)||0;k.isFunction(v.offsetY)?
z._dynamicPropertyMap.set("yOffset",(A,E,G)=>x.pt2px(v.offsetY(A,E,G))):z.yOffset=x.pt2px(v.offsetY)||0;k.isFunction(v.outlineWidth)?z._dynamicPropertyMap.set("_outlineWidth",(A,E,G)=>x.pt2px(v.outlineWidth(A,E,G))):z._outlineWidth=x.pt2px(v.outlineWidth)||0;k.isFunction(v.rotation)?z._dynamicPropertyMap.set("_angle",v.rotation):z._angle=v.rotation||0;z._scaleFactor=D.unwrapOr(v.scaleFactor,1);z._markerPlacement=v.markerPlacement;z._effects=v.effects;z._bitSet=(1===v.alignment?1:0)|(v.colorLocked?
1:0)<<1|(v.scaleSymbolsProportionally?1:0)<<3;z._materialKey=v.materialKey;return z}r._inheritsLoose(h,m);h.fromCIMMarker=function(v,u){const [F,z]=k.getMinMaxZoom(v.scaleInfo,u);return new h(v,F,z)};h.prototype.bindFeature=function(v,u,F){const z=v.readLegacyFeature();this._dynamicPropertyMap.forEach((Y,R)=>{this[R]=Y(z,u,F)});v=this._cimMarkerLayer.materialHash;v="function"===typeof v?v(z,u,F):v;if((v=this._materialCache.get(v))&&b.ok(v.spriteMosaicItem)&&v.spriteMosaicItem){v=v.spriteMosaicItem;
var A=this._cimMarkerLayer.sizeRatio,E=v.width/v.height*this._scaleX,G=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,H=this._size,K=H*E,L=this.xOffset,J=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var B=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/x.pt2px(this._cimMarkerLayer.frameHeight):1,y=this._outlineWidth*B,I=x.pt2px(this._cimMarkerLayer.referenceSize),S=B=0,O=this._cimMarkerLayer.anchorPoint;O&&
(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(B=-O.x/(this._size*E),S=O.y/this._size):(B=O.x,S=O.y));this._sizeOutlineWidth=e.i8888to32(Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*H),255)),Math.round(Math.min(Math.sqrt(128*y),255)),Math.round(Math.min(Math.sqrt(128*I),255)));this.angle=G;this._bitestAndDistRatio=e.i1616to32(this._bitSet,Math.round(64*A));E=v.rect.x+g.SPRITE_PADDING;G=v.rect.y+g.SPRITE_PADDING;y=E+v.width;I=G+v.height;this._texUpperLeft=
e.i1616to32(E,G);this._texUpperRight=e.i1616to32(y,G);this._texBottomLeft=e.i1616to32(E,I);this._texBottomRight=e.i1616to32(y,I);E=l.MarkerMaterialKey.load(this._materialKey);E.sdf=v.sdf;E.pattern=!0;E.textureBinding=v.textureBinding;this._materialKey=E.data;this._anchorX=.5-(.5+B)*v.width/v.width;this._anchorY=.5-(.5+S)*v.height/v.height;K=K*A*this._scaleFactor;H=H*A*this._scaleFactor;K*=v.rect.width/v.width;H*=v.rect.height/v.height;this._computedWidth=K;this._computedHeight=H;this._applyTransformation(c,
a);this.xOffset=L;this.yOffset=J}else f.error(new t("mapview-cim","Encountered an error when binding feature"))};return h}(n(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l){return function(k){function n(b,a,c){var f=k.call(this,b)||this;f._horizontalAlignment="center";f._verticalAlignment="middle";f._textToGlyphs=new Map;f._minMaxZoom=w.i1616to32(Math.round(a*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(c*x.MIN_MAX_ZOOM_PRECISION_FACTOR));a=b.scaleFactor||1;f._cimTextLayer=b;p.isFunction(b.color)?f._dynamicPropertyMap.set("_color",(u,F,z)=>D.premultiplyAlphaRGBA(b.color(u,F,z))):f._color=D.premultiplyAlphaRGBA(b.color);p.isFunction(b.color)?
f._dynamicPropertyMap.set("_haloColor",(u,F,z)=>D.premultiplyAlphaRGBA(b.outlineColor(u,F,z))):f._haloColor=D.premultiplyAlphaRGBA(b.outlineColor);let m;p.isFunction(b.size)||(m=Math.min(Math.round(t.pt2px(b.size*b.sizeRatio)),127));f._dynamicPropertyMap.set("_size",(u,F,z)=>p.isFunction(b.size)?Math.min(Math.round(t.pt2px(b.size(u,F,z)*b.sizeRatio)),127):m);p.isFunction(b.outlineSize)?f._dynamicPropertyMap.set("_haloSize",(u,F,z)=>Math.min(Math.floor(5*t.pt2px(b.outlineSize(u,F,z)*b.sizeRatio)),
127)):f._haloSize=Math.min(Math.floor(5*t.pt2px(b.outlineSize*b.sizeRatio)),127);let h;p.isFunction(b.offsetX)||(h=Math.round(t.pt2px(b.offsetX*b.sizeRatio)));f._dynamicPropertyMap.set("_xOffset",(u,F,z)=>p.isFunction(b.offsetX)?Math.round(t.pt2px(b.offsetX(u,F,z)*b.sizeRatio)):h);let v;p.isFunction(b.offsetY)||(v=Math.round(t.pt2px(b.offsetY*b.sizeRatio)));f._dynamicPropertyMap.set("_yOffset",(u,F,z)=>p.isFunction(b.offsetY)?Math.round(t.pt2px(b.offsetY(u,F,z)*b.sizeRatio)):v);p.isFunction(b.angle)?
f._dynamicPropertyMap.set("_angle",b.angle):f._angle=b.angle;p.isFunction(b.horizontalAlignment)?f._dynamicPropertyMap.set("_horizontalAlignment",b.horizontalAlignment):f._horizontalAlignment=b.horizontalAlignment;p.isFunction(b.verticalAlignment)?f._dynamicPropertyMap.set("_verticalAlignment",b.verticalAlignment):f._verticalAlignment=b.verticalAlignment;f._scaleFactor=a;p.isFunction(b.text)?f._dynamicPropertyMap.set("_text",b.text):f._text=b.text;a=Math.min(Math.round(t.pt2px(b.referenceSize*b.sizeRatio)),
127);f._referenceSize=Math.round(Math.sqrt(256*a));f._materialKey=b.materialKey;a=q.TextMaterialKey.load(f._materialKey);a.sdf=!0;f._bitset=(1===b.alignment?1:0)|(b.colorLocked?1:0)<<1;f._materialKey=a.data;f._decoration="none";f._lineHeight=1;f._lineWidth=512;f._textPlacement=b.markerPlacement;f._effects=b.effects;f._isCIM=!0;return f}r._inheritsLoose(n,k);n.fromCIMText=function(b,a){const [c,f]=p.getMinMaxZoom(b.scaleInfo,a);return new n(b,c,f)};var d=n.prototype;d.analyze=function(){var b=r._asyncToGenerator(function*(a,
c,f,m){var h=c.readLegacyFeature();var v=this._cimTextLayer;h="string"===typeof v.text?v.text:"function"===typeof v.text?v.text(h,f,m):"";a=yield k.prototype.analyze.call(this,a,c,f,m,l.codepoints(h));this._textToGlyphs.set(h,a.glyphMosaicItems);return a});return function(a,c,f,m){return b.apply(this,arguments)}}();d.bindFeature=function(b,a,c){const f=b.readLegacyFeature();this._dynamicPropertyMap.forEach((m,h)=>{this[h]=m(f,a,c)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,
this._scale=this._size/x.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=C.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=C.getYAnchorDirection(this._verticalAlignment||"baseline"),b=this._textToGlyphs.get(this._text),this.bindTextInfo(b,!1)):this._shapingInfo=null};return n}(g(e))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(r){r.codepoints=function(t){const C=Array(t.length);for(let D=0;D<t.length;D++)C[D]=
t.charCodeAt(D);return C};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(r,t,C,D,x,w,q,p,g,e){return function(l){function k(n,d,b,a,c,f,m,h,v,u,F,z,A,E,G,H){var K=l.call(this)||
this;K._effects=E;n=q.FillMaterialKey.load(n);d&&(n.sdf=d.sdf,n.pattern=!0,n.textureBinding=d.textureBinding);K.fillColor=b;K.tl=a;K.br=c;K.aux2=w.i8888to32(f,m,h,v);K.aux3=w.i8888to32(u,F,z,0);K._bitset=A;K._minMaxZoom=w.i1616to32(Math.round(G*D.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(H*D.MIN_MAX_ZOOM_PRECISION_FACTOR));K._materialKey=n.data;return K}r._inheritsLoose(k,l);k.fromCIMFill=function(n,d,b){var a=n.color;a=a&&C.premultiplyAlphaRGBA(a)||0;const c=n.materialKey,[f,m]=p.getMinMaxZoom(n.scaleInfo,
b);if(!d)return new k(c,null,a,0,0,0,0,0,0,0,0,0,n.colorLocked?1:0,n.effects,f,m);const {rect:h,width:v,height:u}=d;var F=n.scaleX||1,z=h.x+D.SPRITE_PADDING;const A=h.y+D.SPRITE_PADDING;var E=z+v;const G=A+u;var H=n.height;b=Math.round(H);255<b?b=255:0>=b&&(b=G-A);F=Math.round(F*H);255<F?F=255:0>=F&&(F=E-z);H=t.pt2px(n.offsetX||0)+128;255<H&&(H=255);let K=t.pt2px(-n.offsetY||0)+128;255<K&&(K=255);z=w.i1616to32(z,A);E=w.i1616to32(E,G);return new k(c,d,a,z,E,F,b,H,K,128,128,x.degToByte(n.angle),n.colorLocked?
1:0,n.effects,f,m)};k.fromSimpleFill=function(n,d,b=!1){var {color:a}=n;a=a&&"esriSFSNull"!==n.style&&C.premultiplyAlphaRGBAArray(a)||0;b=b?D.BITSET_GENERIC_LOCK_COLOR:0;const c=n.materialKey;if(d){const {rect:h,width:v,height:u}=d;var f=h.x+D.SPRITE_PADDING;const F=h.y+D.SPRITE_PADDING;var m=f+v;const z=F+u;f=w.i1616to32(f,F);m=w.i1616to32(m,z);d=new k(c,d,a,f,m,v,u,0,0,128,128,0,b,null,p.DEFAULT_MIN_ZOOM,p.DEFAULT_MAX_ZOOM)}else d=new k(c,null,a,0,0,0,0,0,0,0,0,0,b,null,p.DEFAULT_MIN_ZOOM,p.DEFAULT_MAX_ZOOM);
d._maybeAddLineTemplate(n);return d};k.fromPictureFill=function(n,d,b=!1){const a=D.PICTURE_FILL_COLOR,{rect:c,width:f,height:m}=d;var h=c.x+D.SPRITE_PADDING,v=c.y+D.SPRITE_PADDING,u=h+f,F=v+m;h=w.i1616to32(h,v);u=w.i1616to32(u,F);F=Math.round(t.pt2px(n.width));255<F&&(F=255);v=Math.round(t.pt2px(n.height));255<v&&(v=255);let z=t.pt2px(n.xoffset)+128;255<z&&(z=255);let A=t.pt2px(-n.yoffset)+128;255<A&&(A=255);d=new k(n.materialKey,d,a,h,u,F,v,z,A,128*n.xscale,128*n.yscale,0,b?D.BITSET_GENERIC_LOCK_COLOR:
0,null,p.DEFAULT_MIN_ZOOM,p.DEFAULT_MAX_ZOOM);d._maybeAddLineTemplate(n);return d};return k}(g(e))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(r,t,C){function D(){D=t._asyncToGenerator(function*(w,q,p){try{yield w.acquire(),yield q(p),w.release()}catch(g){throw w.release(),g;}});return D.apply(this,arguments)}let x=function(){function w(){this._resolver=null}var q=w.prototype;
q.isHeld=function(){return!!this._resolver};q.acquire=function(){var p=t._asyncToGenerator(function*(){if(!this._resolver)return this._resolver=C.createResolver(),Promise.resolve();yield this._resolver.promise;yield this.acquire()});return function(){return p.apply(this,arguments)}}();q.release=function(){const p=this._resolver;this._resolver=null;p.resolve()};return w}();r.default=x;r.withLock=function(w,q,p){return D.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(r,t,C,D,x){const w=function(){var g=t._asyncToGenerator(function*(e,l,k,n){return Promise.all(e.map(d=>p(d,l,k,n)))});return function(e,l,k,n){return g.apply(this,arguments)}}(),q=function(){var g=t._asyncToGenerator(function*(e,l,k){return new D.ExpandedCIM(yield C.analyzeCIMSymbol(e.data,l,k),e.data,e.rendererKey,e.maxVVSize)});return function(e,
l,k){return g.apply(this,arguments)}}(),p=function(){var g=t._asyncToGenerator(function*(e,l,k,n){return e?"cim"===e.type?q(e,l,k):"web-style"===e.type?(e={type:"cim",data:yield x.fetchCIMSymbolReference(e,null,n),rendererKey:e.rendererKey,maxVVSize:e.maxVVSize},q(e,l,k)):e:null});return function(e,l,k,n){return g.apply(this,arguments)}}();r.cimLayerToRasterizationInfo=function(g){if(!g)return null;const {type:e,cim:l,url:k,materialHash:n}=g,d={cim:l,type:e,mosaicHash:n,url:k,size:null,dashTemplate:null,
path:null,text:null,fontName:null};switch(e){case "marker":d.size=g.size;d.path=g.path;break;case "line":d.dashTemplate=g.dashTemplate;break;case "text":d.text=g.text,d.fontName=g.fontName}return d};r.expandSymbol=p;r.expandSymbols=w;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(r,t,C,D){const x=
{marker:C.WGLGeometryType.MARKER,fill:C.WGLGeometryType.FILL,line:C.WGLGeometryType.LINE,text:C.WGLGeometryType.TEXT};C=function(){function w(q,p,g,e){const l={minScale:null==p?void 0:p.minScale,maxScale:null==p?void 0:p.maxScale};var k=l.minScale||l.maxScale?l.minScale+"-"+l.maxScale:"";this.layers=q;this.data=p;this.hash=this._createHash()+k;this.rendererKey=g;p={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:g};for(const n of q)n.materialKey=D.createMaterialKey(x[n.type],
p),n.maxVVSize=e,n.scaleInfo=l,n.templateHash+=k}w.prototype._createHash=function(){let q="";for(const p of this.layers)q+=p.templateHash;return q};t._createClass(w,[{key:"type",get:function(){return"expanded-cim"}}]);return w}();r.ExpandedCIM=C;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(r,t,C,D,x,w,q,p,g){function e(){e=t._asyncToGenerator(function*(b,a,c){if(!b.name)return Promise.reject(new D("style-symbol-reference-name-missing","Missing name in style symbol reference"));if(b.styleName&&"Esri2DPointSymbolsStyle"===b.styleName)return l(b,c);try{const f=yield g.fetchStyle(b,a,c);return n(f,b.name,a,c)}catch(f){return x.throwIfAborted(f),null}});return e.apply(this,arguments)}function l(b,a){return k.apply(this,arguments)}function k(){k=t._asyncToGenerator(function*(b,a){b=
g.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,b.name);try{const c=yield g.requestJSON(b,a);return g.makeCIMSymbolRef(c.data)}catch(c){return x.throwIfAborted(c),null}});return k.apply(this,arguments)}function n(b,a,c,f){return d.apply(this,arguments)}function d(){d=t._asyncToGenerator(function*(b,a,c,f){var m=b.data;b={portal:c&&c.portal||q.getDefault(),url:w.urlToObject(b.baseUrl),origin:"portal-item"};m=m.items.find(h=>h.name===a);if(!m)throw new D("symbolstyleutils:symbol-name-not-found",`The symbol name '${a}' could not be found`,
{symbolName:a});m=p.fromJSON(g.symbolUrlFromStyleItem(m,"cimRef"),b);C.isDevEnvironment()&&(m=C.adjustStaticAGOUrl(m));try{const h=yield g.requestJSON(m,f);return g.makeCIMSymbolRef(h.data)}catch(h){return x.throwIfAborted(h),null}});return d.apply(this,arguments)}r.fetchCIMSymbolReference=function(b,a,c){return e.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(r){const t=/^devext.arcgis.com$/,C=/^qaext.arcgis.com$/,
D=/^[\w-]*\.mapsdevext.arcgis.com$/,x=/^[\w-]*\.mapsqa.arcgis.com$/,w=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,t,C,/^jsapps.esri.com$/,D,x];r.adjustStaticAGOUrl=function(q,p){return q?(p=p||globalThis.location.hostname)?null!=p.match(t)||null!=p.match(D)?q.replace("static.arcgis.com","staticdev.arcgis.com"):null!=p.match(C)||null!=p.match(x)?q.replace("static.arcgis.com","staticqa.arcgis.com"):q:q:q};r.isDevEnvironment=function(q){q=q||globalThis.location.hostname;return w.some(p=>{var g;return null!=
(null==(g=q)?void 0:g.match(p))})};r.isTelemetryDevEnvironment=function(q){q=q||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(w).some(p=>{var g;return null!=(null==(g=q)?void 0:g.match(p))})};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/portal/Portal":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/deprecate ../core/Error ../core/JSONSupport ../core/Loadable ../core/Logger ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k,n,d,b,a,c,f,m,h,v,u,F,z,A){const E=L=>Object.freeze({__proto__:null,default:L});var G;let H;const K={PortalGroup:()=>new Promise((L,J)=>r(["./PortalGroup"],B=>L(E(B)),J)),PortalItem:()=>new Promise((L,J)=>r(["./PortalItem"],B=>L(E(B)),J)),PortalUser:()=>new Promise((L,J)=>r(["./PortalUser"],B=>L(E(B)),J))};g=G=function(L){function J(y){y=L.call(this,y)||this;y.access=null;y.allSSL=!1;y.authMode="auto";y.authorizedCrossOriginDomains=null;y.basemapGalleryGroupQuery=
null;y.bingKey=null;y.canListApps=!1;y.canListData=!1;y.canListPreProvisionedItems=!1;y.canProvisionDirectPurchase=!1;y.canSearchPublic=!0;y.canShareBingPublic=!1;y.canSharePublic=!1;y.canSignInArcGIS=!1;y.canSignInIDP=!1;y.colorSetsGroupQuery=null;y.commentsEnabled=!1;y.created=null;y.culture=null;y.customBaseUrl=null;y.defaultBasemap=null;y.defaultDevBasemap=null;y.defaultExtent=null;y.defaultVectorBasemap=null;y.description=null;y.devBasemapGalleryGroupQuery=null;y.eueiEnabled=null;y.featuredGroups=
null;y.featuredItemsGroupQuery=null;y.galleryTemplatesGroupQuery=null;y.livingAtlasGroupQuery=null;y.hasCategorySchema=!1;y.helperServices=null;y.homePageFeaturedContent=null;y.homePageFeaturedContentCount=null;y.httpPort=null;y.httpsPort=null;y.id=null;y.ipCntryCode=null;y.isPortal=!1;y.isReadOnly=!1;y.layerTemplatesGroupQuery=null;y.maxTokenExpirationMinutes=null;y.modified=null;y.name=null;y.portalHostname=null;y.portalMode=null;y.portalProperties=null;y.region=null;y.rotatorPanels=null;y.showHomePageDescription=
!1;y.sourceJSON=null;y.supportsHostedServices=!1;y.symbolSetsGroupQuery=null;y.templatesGroupQuery=null;y.units=null;y.url=D.portalUrl;y.urlKey=null;y.user=null;y.useStandardizedQuery=!1;y.useVectorBasemaps=!1;y.vectorBasemapGalleryGroupQuery=null;return y}t._inheritsLoose(J,L);var B=J.prototype;B.normalizeCtorArgs=function(y){return"string"===typeof y?{url:y}:y};B.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=
null)};B.readAuthorizedCrossOriginDomains=function(y){if(y)for(const I of y)-1===D.request.trustedServers.indexOf(I)&&D.request.trustedServers.push(I);return y};B.readDefaultBasemap=function(y){return this._readBasemap(y)};B.readDefaultDevBasemap=function(y){return this._readBasemap(y)};B.readDefaultVectorBasemap=function(y){return this._readBasemap(y)};B.readUrlKey=function(y){return y?y.toLowerCase():y};B.readUser=function(y){let I=null;y&&(I=z.fromJSON(y),I.portal=this);return I};B.load=function(y){const I=
(new Promise((S,O)=>r(["../Basemap"],Y=>S(E(Y)),O))).then(({default:S})=>{n.throwIfAborted(y);H=S}).then(()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,y)).then(S=>{if(x.id){const O=x.id;this.credential=O.findCredential(this.restUrl);this.credential||this.authMode!==G.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=O.on("credential-create",()=>{O.findCredential(this.restUrl)&&this._signIn()}))}this.sourceJSON=S;this.read(S)});this.addResolvingPromise(I);return Promise.resolve(this)};
B.createClosestFacilityTask=function(){var y=t._asyncToGenerator(function*(){q.deprecatedFunction(l.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/closestFacility",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("closestFacility");return new (yield new Promise((S,O)=>r(["../tasks/ClosestFacilityTask"],Y=>S(E(Y)),O))).default(I)});return function(){return y.apply(this,arguments)}}();B.createElevationLayers=function(){var y=t._asyncToGenerator(function*(){yield this.load();
const I=this._getHelperService("defaultElevationLayers"),S=(yield new Promise((O,Y)=>r(["../layers/ElevationLayer"],R=>O(E(R)),Y))).default;return I?I.map(O=>new S({id:O.id,url:O.url})):[]});return function(){return y.apply(this,arguments)}}();B.createGeometryService=function(){var y=t._asyncToGenerator(function*(){q.deprecatedFunction(l.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/geometryService",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("geometry");
return new (yield new Promise((S,O)=>r(["../tasks/GeometryService"],Y=>S(E(Y)),O))).default({url:I})});return function(){return y.apply(this,arguments)}}();B.createPrintTask=function(){var y=t._asyncToGenerator(function*(){q.deprecatedFunction(l.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/print",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("printTask");return new (yield new Promise((S,O)=>r(["../tasks/PrintTask"],Y=>S(E(Y)),O))).default(I)});
return function(){return y.apply(this,arguments)}}();B.createRouteTask=function(){var y=t._asyncToGenerator(function*(){q.deprecatedFunction(l.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/route",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("route");return new (yield new Promise((S,O)=>r(["../tasks/RouteTask"],Y=>S(E(Y)),O))).default(I)});return function(){return y.apply(this,arguments)}}();B.createServiceAreaTask=function(){var y=t._asyncToGenerator(function*(){q.deprecatedFunction(l.getLogger(this.declaredClass),
null,{replacement:"Use helperServices url with esri/rest/serviceArea",version:"4.21"});yield this.load();const I=this._getHelperServiceUrl("serviceArea");return new (yield new Promise((S,O)=>r(["../tasks/ServiceAreaTask"],Y=>S(E(Y)),O))).default(I)});return function(){return y.apply(this,arguments)}}();B.fetchBasemaps=function(y,I){const S=new u;S.query=y||(D.apiKey&&A.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);
S.disableExtraQuery=!0;return this.queryGroups(S,I).then(O=>{S.num=100;S.query='type:"Web Map" -type:"Web Application"';return O.total?(O=O.results[0],S.sortField=O.sortField||"name",S.sortOrder=O.sortOrder||"desc",O.queryItems(S,I)):null}).then(O=>O&&O.total?O.results.filter(Y=>"Web Map"===Y.type).map(Y=>new H({portalItem:Y})):[])};B.fetchCategorySchema=function(y){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",y).then(I=>I.categorySchema):n.isAborted(y)?
Promise.reject(n.createAbortError()):Promise.resolve([])};B.fetchFeaturedGroups=function(y){const I=this.featuredGroups,S=new u;S.num=100;S.sortField="title";if(I&&I.length){const O=[];for(const Y of I)O.push(`(title:"${Y.title}" AND owner:${Y.owner})`);S.query=O.join(" OR ");return this.queryGroups(S,y).then(Y=>Y.results)}return n.isAborted(y)?Promise.reject(n.createAbortError()):Promise.resolve([])};B.fetchRegions=function(y){const I=this.user&&this.user.culture||this.culture||v.getLocale();return this._request(this.restUrl+
"/portals/regions",{...y,query:{culture:I}})};J.getDefault=function(){if(!G._default||G._default.destroyed)G._default=new G;return G._default};B.queryGroups=function(y,I){return this._queryPortal("/community/groups",y,"PortalGroup",I)};B.queryItems=function(y,I){return this._queryPortal("/search",y,"PortalItem",I)};B.queryUsers=function(y,I){y.sortField||(y.sortField="username");return this._queryPortal("/community/users",y,"PortalUser",I)};B.toJSON=function(){throw new p("internal:not-yet-implemented",
"Portal.toJSON is not yet implemented");};J.fromJSON=function(y){if(!y)return null;if(y.declaredClass)throw Error("JSON object is already hydrated");return new G({sourceJSON:y})};B._getHelperService=function(y){const I=this.helperServices&&this.helperServices[y];if(!I)throw new p("portal:service-not-found",`The \`helperServices\` do not include an entry named "${y}"`);return I};B._getHelperServiceUrl=function(y){const I=this._getHelperService(y);if(!I.url)throw new p("portal:service-url-not-found",
`The \`helperServices\` entry "${y}" does not include a \`url\` value`);return I.url};B._fetchSelf=function(y=this.authMode,I=!1,S){const O=this.restUrl+"/portals/self";y={authMode:y,query:{culture:v.getLocale().toLowerCase()},...S};"auto"===y.authMode&&(y.authMode="no-prompt");I&&(y.query.default=!0);return this._request(O,y)};B._queryPortal=function(y,I,S,O){const Y=c.ensureType(u,I),R=Q=>this._request(this.restUrl+y,{...Y.toRequestOptions(this),...O}).then(W=>{const P=Y.clone();P.start=W.nextStart;
return new F({nextQueryParams:P,queryParams:Y,total:W.total,results:G._resultsToTypedArray(Q,{portal:this},W,O)})}).then(W=>Promise.all(W.results.map(P=>"function"===typeof P.when?P.when():W)).then(()=>W,P=>{n.throwIfAbortError(P);return W}));return S&&K[S]?K[S]().then(({default:Q})=>{n.throwIfAborted(O);return R(Q)}):R()};B._signIn=function(){if(this.authMode===G.AUTH_MODE_ANONYMOUS)return Promise.reject(new p("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===
this.loadStatus)return Promise.reject(this.loadError);const y=I=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return I||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=I;return this._fetchSelf("immediate")});if(this.user&&this.credential===I)return null;this.credential=I;return this._fetchSelf("immediate")}).then(S=>{S&&(this.sourceJSON=S,this.read(S))});return x.id?x.id.getCredential(this.restUrl).then(I=>
y(I)):y(this.credential)};B._normalizeSSL=function(y){return y.replace(/^http:/i,"https:").replace(":7080",":7443")};B._normalizeUrl=function(y){const I=this.credential&&this.credential.token;return this._normalizeSSL(I?y+(-1<y.indexOf("?")?"\x26":"?")+"token\x3d"+I:y)};B._requestToTypedArray=function(y,I,S){return this._request(y,I).then(O=>{const Y=G._resultsToTypedArray(S,{portal:this},O);return Promise.all(Y.map(R=>"function"===typeof R.when?R.when():O)).then(()=>Y,()=>Y)})};B._readBasemap=function(y){return y?
(y=H.fromJSON(y),y.portalItem={portal:this},y):null};B._request=function(y,I={}){const S={f:"json",...I.query},{authMode:O=this.authMode===G.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:Y=null,cacheBust:R=!1,method:Q="auto",responseType:W="json",signal:P}=I;I={authMode:O,body:Y,cacheBust:R,method:Q,query:S,responseType:W,timeout:0,signal:P};return w(this._normalizeSSL(y),I).then(fa=>fa.data)};J._resultsToTypedArray=function(y,I,S,O){if(S){const Y=k.isSome(O)?O.signal:null;S=S.listings||S.notifications||
S.userInvitations||S.tags||S.items||S.groups||S.comments||S.provisions||S.results||S.relatedItems||S;if(y||I)S=S.map(R=>{R=Object.assign(y?y.fromJSON(R):R,I);"function"===typeof R.load&&R.load(Y);return R})}else S=[];return S};t._createClass(J,[{key:"extraQuery",get:function(){const y=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!y?` AND orgid:${this.id}`:null}},{key:"isOrganization",get:function(){return!!this.access}},{key:"restUrl",get:function(){let y=this.url;if(y){const I=
y.indexOf("/sharing");y=0<I?y.substring(0,I):this.url.replace(/\/+$/,"");y+="/sharing/rest"}return y}},{key:"stylesGroupQuery",get:function(){q.deprecatedProperty(l.getLogger(this.declaredClass),"stylesGroupQuery",{replacement:"stylesGroupQuery3d",version:"4.21"});return this.stylesGroupQuery3d}},{key:"thumbnailUrl",get:function(){const y=this.restUrl,I=this.thumbnail;return y&&I?this._normalizeSSL(y+"/portals/self/resources/"+I):null}}]);return J}(g.JSONSupportMixin(e));g.AUTH_MODE_ANONYMOUS="anonymous";
g.AUTH_MODE_AUTO="auto";g.AUTH_MODE_IMMEDIATE="immediate";C.__decorate([d.property()],g.prototype,"access",void 0);C.__decorate([d.property()],g.prototype,"allSSL",void 0);C.__decorate([d.property()],g.prototype,"authMode",void 0);C.__decorate([d.property()],g.prototype,"authorizedCrossOriginDomains",void 0);C.__decorate([f.reader("authorizedCrossOriginDomains")],g.prototype,"readAuthorizedCrossOriginDomains",null);C.__decorate([d.property()],g.prototype,"basemapGalleryGroupQuery",void 0);C.__decorate([d.property()],
g.prototype,"bingKey",void 0);C.__decorate([d.property()],g.prototype,"canListApps",void 0);C.__decorate([d.property()],g.prototype,"canListData",void 0);C.__decorate([d.property()],g.prototype,"canListPreProvisionedItems",void 0);C.__decorate([d.property()],g.prototype,"canProvisionDirectPurchase",void 0);C.__decorate([d.property()],g.prototype,"canSearchPublic",void 0);C.__decorate([d.property()],g.prototype,"canShareBingPublic",void 0);C.__decorate([d.property()],g.prototype,"canSharePublic",void 0);
C.__decorate([d.property()],g.prototype,"canSignInArcGIS",void 0);C.__decorate([d.property()],g.prototype,"canSignInIDP",void 0);C.__decorate([d.property()],g.prototype,"colorSetsGroupQuery",void 0);C.__decorate([d.property()],g.prototype,"commentsEnabled",void 0);C.__decorate([d.property({type:Date})],g.prototype,"created",void 0);C.__decorate([d.property()],g.prototype,"credential",void 0);C.__decorate([d.property()],g.prototype,"culture",void 0);C.__decorate([d.property()],g.prototype,"currentVersion",
void 0);C.__decorate([d.property()],g.prototype,"customBaseUrl",void 0);C.__decorate([d.property()],g.prototype,"defaultBasemap",void 0);C.__decorate([f.reader("defaultBasemap")],g.prototype,"readDefaultBasemap",null);C.__decorate([d.property()],g.prototype,"defaultDevBasemap",void 0);C.__decorate([f.reader("defaultDevBasemap")],g.prototype,"readDefaultDevBasemap",null);C.__decorate([d.property({type:h})],g.prototype,"defaultExtent",void 0);C.__decorate([d.property()],g.prototype,"defaultVectorBasemap",
void 0);C.__decorate([f.reader("defaultVectorBasemap")],g.prototype,"readDefaultVectorBasemap",null);C.__decorate([d.property()],g.prototype,"description",void 0);C.__decorate([d.property()],g.prototype,"devBasemapGalleryGroupQuery",void 0);C.__decorate([d.property()],g.prototype,"eueiEnabled",void 0);C.__decorate([d.property({readOnly:!0})],g.prototype,"extraQuery",null);C.__decorate([d.property()],g.prototype,"featuredGroups",void 0);C.__decorate([d.property()],g.prototype,"featuredItemsGroupQuery",
void 0);C.__decorate([d.property()],g.prototype,"galleryTemplatesGroupQuery",void 0);C.__decorate([d.property()],g.prototype,"livingAtlasGroupQuery",void 0);C.__decorate([d.property()],g.prototype,"hasCategorySchema",void 0);C.__decorate([d.property()],g.prototype,"helpBase",void 0);C.__decorate([d.property()],g.prototype,"helperServices",void 0);C.__decorate([d.property()],g.prototype,"helpMap",void 0);C.__decorate([d.property()],g.prototype,"homePageFeaturedContent",void 0);C.__decorate([d.property()],
g.prototype,"homePageFeaturedContentCount",void 0);C.__decorate([d.property()],g.prototype,"httpPort",void 0);C.__decorate([d.property()],g.prototype,"httpsPort",void 0);C.__decorate([d.property()],g.prototype,"id",void 0);C.__decorate([d.property()],g.prototype,"ipCntryCode",void 0);C.__decorate([d.property({readOnly:!0})],g.prototype,"isOrganization",null);C.__decorate([d.property()],g.prototype,"isPortal",void 0);C.__decorate([d.property()],g.prototype,"isReadOnly",void 0);C.__decorate([d.property()],
g.prototype,"layerTemplatesGroupQuery",void 0);C.__decorate([d.property()],g.prototype,"maxTokenExpirationMinutes",void 0);C.__decorate([d.property({type:Date})],g.prototype,"modified",void 0);C.__decorate([d.property()],g.prototype,"name",void 0);C.__decorate([d.property()],g.prototype,"portalHostname",void 0);C.__decorate([d.property()],g.prototype,"portalMode",void 0);C.__decorate([d.property()],g.prototype,"portalProperties",void 0);C.__decorate([d.property()],g.prototype,"region",void 0);C.__decorate([d.property({readOnly:!0})],
g.prototype,"restUrl",null);C.__decorate([d.property()],g.prototype,"rotatorPanels",void 0);C.__decorate([d.property()],g.prototype,"showHomePageDescription",void 0);C.__decorate([d.property()],g.prototype,"sourceJSON",void 0);C.__decorate([d.property()],g.prototype,"staticImagesUrl",void 0);C.__decorate([d.property({readOnly:!0,json:{read:!1}})],g.prototype,"stylesGroupQuery",null);C.__decorate([d.property({json:{name:"2DStylesGroupQuery"}})],g.prototype,"stylesGroupQuery2d",void 0);C.__decorate([d.property({json:{name:"stylesGroupQuery"}})],
g.prototype,"stylesGroupQuery3d",void 0);C.__decorate([d.property()],g.prototype,"supportsHostedServices",void 0);C.__decorate([d.property()],g.prototype,"symbolSetsGroupQuery",void 0);C.__decorate([d.property()],g.prototype,"templatesGroupQuery",void 0);C.__decorate([d.property()],g.prototype,"thumbnail",void 0);C.__decorate([d.property({readOnly:!0})],g.prototype,"thumbnailUrl",null);C.__decorate([d.property()],g.prototype,"units",void 0);C.__decorate([d.property()],g.prototype,"url",void 0);C.__decorate([d.property()],
g.prototype,"urlKey",void 0);C.__decorate([f.reader("urlKey")],g.prototype,"readUrlKey",null);C.__decorate([d.property()],g.prototype,"user",void 0);C.__decorate([f.reader("user")],g.prototype,"readUser",null);C.__decorate([d.property()],g.prototype,"useStandardizedQuery",void 0);C.__decorate([d.property()],g.prototype,"useVectorBasemaps",void 0);C.__decorate([d.property()],g.prototype,"vectorBasemapGalleryGroupQuery",void 0);return g=G=C.__decorate([m.subclass("esri.portal.Portal")],g)})},"esri/core/Loadable":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p){const g=e=>{e=function(l){function k(...d){var b=l.call(this,...d)||this;b._loadController=null;b.loadError=null;b.loadStatus="not-loaded";b._set("loadWarnings",[]);b.addResolvingPromise(new Promise(a=>{const c=b.load.bind(r._assertThisInitialized(b));b.load=f=>{const m=new Promise((h,v)=>{const u=x.onAbortOrThrow(f,v);b.destroyed&&v(new C("load:instance-destroyed",`Instance of '${b.declaredClass||b.constructor.name}' is already destroyed`,{instance:r._assertThisInitialized(b)}));
b._promiseProps.when(h,v).finally(()=>{u&&u.remove()})});if("not-loaded"===b.loadStatus){b._set("loadStatus","loading");const h=b._loadController=new AbortController;c({signal:h.signal});x.onAbort(h.signal,()=>{b._promiseProps.abort()})}a();return m}}));b.when(()=>{b._set("loadStatus","loaded");b._loadController=null},a=>{b._set("loadStatus","failed");b._set("loadError",a);b._loadController=null});return b}r._inheritsLoose(k,l);var n=k.prototype;n.load=function(){return null};n.cancelLoad=function(){var d;
if(this.isFulfilled())return this;this._set("loadError",new C("load:cancelled","Cancelled"));null==(d=this._loadController)?void 0:d.abort();return this};r._createClass(k,[{key:"loaded",get:function(){return"loaded"===this.loadStatus}},{key:"loadWarnings",get:function(){return this._get("loadWarnings")}}]);return k}(e);t.__decorate([q.property({readOnly:!0})],e.prototype,"loaded",null);t.__decorate([q.property({readOnly:!0})],e.prototype,"loadError",void 0);t.__decorate([q.property()],e.prototype,
"loadStatus",void 0);t.__decorate([q.property({type:[w],readOnly:!0})],e.prototype,"loadWarnings",null);return e=t.__decorate([p.subclass("esri.core.Loadable")],e)};D=function(e){function l(){return e.apply(this,arguments)||this}r._inheritsLoose(l,e);return l}(g(D.EsriPromise));D=t.__decorate([p.subclass("esri.core.Loadable")],D);(function(e){e.LoadableMixin=g;e.isLoadable=function(l){return!(!l||!l.load)}})(D||(D={}));return D})},"esri/core/Promise":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./maybe ./promiseUtils ./accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q){let p=function(){function e(k){this.instance=k;this._resolver=w.createDeferred();this._status=0;this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=1;this._cleanUp()},()=>{this._status=2;this._cleanUp()})}var l=e.prototype;l.addResolvingPromise=function(k){this._resolvingPromises.push(k);this._tryResolve()};l.isResolved=function(){return 1===this._status};l.isRejected=function(){return 2===this._status};l.isFulfilled=function(){return 0!==this._status};
l.abort=function(){this._resolver.reject(w.createAbortError())};l.when=function(k,n){return this._resolver.promise.then(k,n)};l._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};l._tryResolve=function(){if(!this.isFulfilled()){var k=w.createDeferred(),n=[...this._resolvingPromises,x.assumeNonNull(k.promise)],d=this._allPromise=Promise.all(n);d.then(()=>{this.isFulfilled()||this._allPromise!==d||this._resolver.resolve(this.instance)},b=>{this.isFulfilled()||this._allPromise!==
d||w.isAbortError(b)||this._resolver.reject(b)});k.resolve()}};return e}();const g=e=>{e=function(l){function k(...d){d=l.call(this,...d)||this;d._promiseProps=new p(t._assertThisInitialized(d));d.addResolvingPromise(Promise.resolve());return d}t._inheritsLoose(k,l);var n=k.prototype;n.isResolved=function(){return this._promiseProps.isResolved()};n.isRejected=function(){return this._promiseProps.isRejected()};n.isFulfilled=function(){return this._promiseProps.isFulfilled()};n.when=function(d,b){return(new Promise((a,
c)=>{this._promiseProps.when(a,c)})).then(d,b)};n.catch=function(d){return this.when(null,d)};n.addResolvingPromise=function(d){d&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in d?d.when():d)};return k}(e);return e=C.__decorate([q.subclass("esri.core.Promise")],e)};r.EsriPromise=function(e){function l(){return e.apply(this,arguments)||this}t._inheritsLoose(l,e);return l}(g(D));r.EsriPromise=C.__decorate([q.subclass("esri.core.Promise")],r.EsriPromise);
r.EsriPromiseMixin=g;Object.defineProperty(r,"__esModule",{value:!0})})},"esri/intl/locale":function(){define(["exports"],function(r){function t(){var b,a;return null!=(b=null!=l?l:null==(a=globalThis.navigator)?void 0:a.language)?b:"en"}function C(){void 0===e&&(e=t());return e}function D(b=C()){b=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(b);return null==b?void 0:b[1].toLowerCase()}function x(){var b;const a=null!=(b=g)?b:t();e!==a&&(e=a,[...d].forEach(c=>{c.call(null,a)}),[...n].forEach(c=>{c.call(null,
a)}))}var w,q,p;let g=void 0,e=void 0;const l=null!=(w=null==(q=globalThis.esriConfig)?void 0:q.locale)?w:null==(p=globalThis.dojoConfig)?void 0:p.locale,k={he:!0,ar:!0},n=[],d=[];null==globalThis.addEventListener?void 0:globalThis.addEventListener("languagechange",x);r.beforeLocaleChange=function(b){d.push(b);return{remove(){n.splice(d.indexOf(b),1)}}};r.getDefaultLocale=t;r.getLanguage=D;r.getLocale=C;r.onLocaleChange=function(b){n.push(b);return{remove(){n.splice(n.indexOf(b),1)}}};r.prefersRTL=
function(b=C()){b=D(b);return void 0!==b&&(k[b]||!1)};r.setLocale=function(b){g=b?b:void 0;x()};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/portal/PortalQueryParams":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k){var n;const d=new D.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});C=n=function(b){function a(f){f=b.call(this,f)||this;f.categories=null;f.disableExtraQuery=!1;f.extent=null;f.filter=null;f.num=10;f.query=null;f.sortField=null;f.start=1;return f}r._inheritsLoose(a,b);var c=a.prototype;c.clone=function(){return new n({categories:this.categories?x.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,
extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};c.toRequestOptions=function(f,m){let h;this.categories&&(h=this.categories.map(F=>Array.isArray(F)?JSON.stringify(F):F));let v;if(this.extent){var u=k.project(this.extent,l.WGS84);w.isSome(u)&&(v=`${u.xmin},${u.ymin},${u.xmax},${u.ymax}`)}u=this.query;!this.disableExtraQuery&&f.extraQuery&&(u="("+u+")"+f.extraQuery);f={categories:h,bbox:v,
q:u,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(f.sortField=this.sortField.split(",").map(F=>d.toJSON(F.trim())).join(","),f.sortOrder=this.sortOrder);return{query:{...m,...f}}};r._createClass(a,[{key:"sortOrder",get:function(){return this._get("sortOrder")||"asc"},set:function(f){"asc"!==f&&"desc"!==f||this._set("sortOrder",f)}}]);return a}(C);t.__decorate([q.property()],C.prototype,"categories",void 0);t.__decorate([q.property()],C.prototype,
"disableExtraQuery",void 0);t.__decorate([q.property({type:e})],C.prototype,"extent",void 0);t.__decorate([q.property()],C.prototype,"filter",void 0);t.__decorate([q.property()],C.prototype,"num",void 0);t.__decorate([q.property()],C.prototype,"query",void 0);t.__decorate([q.property()],C.prototype,"sortField",void 0);t.__decorate([q.property()],C.prototype,"sortOrder",null);t.__decorate([q.property()],C.prototype,"start",void 0);return C=n=t.__decorate([g.subclass("esri.portal.PortalQueryParams")],
C)})},"esri/portal/PortalQueryResult":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),function(r,t,C,D,x,w,q,p){C=function(g){function e(l){l=g.call(this,l)||this;l.nextQueryParams=null;l.queryParams=null;l.results=null;l.total=null;return l}r._inheritsLoose(e,g);return e}(C);t.__decorate([D.property()],
C.prototype,"nextQueryParams",void 0);t.__decorate([D.property()],C.prototype,"queryParams",void 0);t.__decorate([D.property()],C.prototype,"results",void 0);t.__decorate([D.property()],C.prototype,"total",void 0);return C=t.__decorate([p.subclass("esri.portal.PortalQueryResult")],C)})},"esri/portal/PortalUser":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(r,t,C,D,x,w,q,p,g,e,l,k){var n;x=n=function(d){function b(...c){c=d.call(this,...c)||this;c.access=null;c.created=null;c.culture=null;c.description=null;c.email=null;c.fullName=null;c.modified=null;c.orgId=null;c.portal=null;c.preferredView=null;c.privileges=null;c.region=null;c.role=null;c.roleId=null;c.sourceJSON=null;c.units=null;c.username=null;c.userType=null;return c}t._inheritsLoose(b,d);var a=b.prototype;a.addItem=function(c){const f=c&&c.item;var m=c&&c.data;c=c&&c.folder;const h=
{method:"post"};f&&(h.query=f.createPostQuery(),null!=m&&("string"===typeof m?h.query.text=m:"object"===typeof m&&(h.query.text=JSON.stringify(m))));m=this.userContentUrl;c&&(m+="/"+("string"===typeof c?c:c.id));return this.portal._request(m+"/addItem",h).then(v=>{f.id=v.id;f.portal=this.portal;return f.loaded?f.reload():f.load()})};a.deleteItem=function(c){let f=this.userContentUrl;c.ownerFolder&&(f+="/"+c.ownerFolder);return this.portal._request(f+`/items/${c.id}/delete`,{method:"post"}).then(()=>
{c.id=null;c.portal=null})};a.deleteItems=function(c){const f=this.userContentUrl+"/deleteItems";var m=c.map(h=>h.id);return m.length?(m={method:"post",query:{items:m.join(",")}},this.portal._request(f,m).then(()=>{c.forEach(h=>{h.id=null;h.portal=null})})):Promise.resolve(void 0)};a.fetchFolders=function(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then(c=>c&&c.folders?c.folders.map(f=>{f=l.fromJSON(f);f.portal=this.portal;return f}):[])};a.fetchGroups=function(){return this.portal._request(this.url).then(c=>
c&&c.groups?c.groups.map(f=>{f=k.fromJSON(f);f.portal=this.portal;return f}):[])};a.fetchItems=function(c){c||(c={});let f=this.userContentUrl;c.folder&&(f+="/"+c.folder.id);let m;return(new Promise((h,v)=>r(["./PortalItem"],u=>h(Object.freeze({__proto__:null,default:u})),v))).then(({default:h})=>{m=h;return this.portal._request(f,{query:{folders:!1,num:c.num||10,start:c.start||1,sortField:c.sortField||"created",sortOrder:c.sortOrder||"asc"}})}).then(h=>{let v;return h&&h.items?(v=h.items.map(u=>
{u=m.fromJSON(u);u.portal=this.portal;return u}),Promise.all(v.map(u=>u.load())).catch(u=>u).then(()=>({items:v,nextStart:h.nextStart,total:h.total}))):{items:[],nextStart:-1,total:0}})};a.fetchTags=function(){return this.portal._request(this.url+"/tags").then(c=>c.tags)};a.getThumbnailUrl=function(c){let f=this.thumbnailUrl;f&&c&&(f+=`&w=${c}`);return f};a.queryFavorites=function(c){return this.favGroupId?(this._favGroup||(this._favGroup=new k({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(c)):
Promise.reject(new D("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};a.toJSON=function(){throw new D("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};b.fromJSON=function(c){if(!c)return null;if(c.declaredClass)throw Error("JSON object is already hydrated");const f=new n;f.sourceJSON=c;f.read(c);return f};t._createClass(b,[{key:"thumbnailUrl",get:function(){const c=this.url,f=this.thumbnail;return c&&f?this.portal._normalizeUrl(`${c}/info/${f}?f=json`):
null}},{key:"userContentUrl",get:function(){const c=this.get("portal.restUrl");return c?`${c}/content/users/${this.username}`:null}},{key:"url",get:function(){const c=this.get("portal.restUrl");return c?`${c}/community/users/${this.username}`:null}}]);return b}(x.JSONSupport);C.__decorate([w.property()],x.prototype,"access",void 0);C.__decorate([w.property({type:Date})],x.prototype,"created",void 0);C.__decorate([w.property()],x.prototype,"culture",void 0);C.__decorate([w.property()],x.prototype,
"description",void 0);C.__decorate([w.property()],x.prototype,"email",void 0);C.__decorate([w.property()],x.prototype,"favGroupId",void 0);C.__decorate([w.property()],x.prototype,"fullName",void 0);C.__decorate([w.property({type:Date})],x.prototype,"modified",void 0);C.__decorate([w.property()],x.prototype,"orgId",void 0);C.__decorate([w.property()],x.prototype,"portal",void 0);C.__decorate([w.property()],x.prototype,"preferredView",void 0);C.__decorate([w.property()],x.prototype,"privileges",void 0);
C.__decorate([w.property()],x.prototype,"region",void 0);C.__decorate([w.property()],x.prototype,"role",void 0);C.__decorate([w.property()],x.prototype,"roleId",void 0);C.__decorate([w.property()],x.prototype,"sourceJSON",void 0);C.__decorate([w.property()],x.prototype,"thumbnail",void 0);C.__decorate([w.property({readOnly:!0})],x.prototype,"thumbnailUrl",null);C.__decorate([w.property()],x.prototype,"units",void 0);C.__decorate([w.property({readOnly:!0})],x.prototype,"userContentUrl",null);C.__decorate([w.property({readOnly:!0})],
x.prototype,"url",null);C.__decorate([w.property()],x.prototype,"username",void 0);C.__decorate([w.property()],x.prototype,"userType",void 0);return x=n=C.__decorate([e.subclass("esri.portal.PortalUser")],x)})},"esri/portal/PortalFolder":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p,g){D=function(e){function l(k){k=e.call(this,k)||this;k.created=null;k.id=null;k.portal=null;k.title=null;k.username=null;return k}r._inheritsLoose(l,e);l.prototype.toJSON=function(){throw new C("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};r._createClass(l,[{key:"url",get:function(){const k=this.get("portal.restUrl");return k?`${k}/content/users/${this.username}/${this.id}`:null}}]);return l}(D.JSONSupport);t.__decorate([x.property({type:Date})],
D.prototype,"created",void 0);t.__decorate([x.property()],D.prototype,"id",void 0);t.__decorate([x.property()],D.prototype,"portal",void 0);t.__decorate([x.property()],D.prototype,"title",void 0);t.__decorate([x.property({readOnly:!0})],D.prototype,"url",null);t.__decorate([x.property()],D.prototype,"username",void 0);return D=t.__decorate([g.subclass("esri.portal.PortalFolder")],D)})},"esri/portal/PortalGroup":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(r,t,C,D,x,w,q,p,g,e){D=function(l){function k(d){d=l.call(this,d)||this;d.access=null;d.created=null;d.description=null;d.id=null;d.isInvitationOnly=!1;d.modified=null;d.owner=null;d.portal=null;d.snippet=null;d.sortField=null;d.sortOrder=null;d.tags=null;d.title=null;return d}r._inheritsLoose(k,l);var n=k.prototype;n.fetchCategorySchema=function(d){return this.portal._request(this.url+"/categorySchema",d).then(b=>{b=b.categorySchema||[];return b.some(a=>"contentCategorySetsGroupQuery.LivingAtlas"===
a.source)?this._fetchCategorySchemaSet("LivingAtlas",d):b})};n.fetchMembers=function(d){return this.portal._request(this.url+"/users",d)};n.getThumbnailUrl=function(d){let b=this.thumbnailUrl;b&&d&&(b+=`&w=${d}`);return b};n.toJSON=function(){throw new C("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};n.queryItems=function(d,b){d=p.ensureType(e,d);if(5<parseFloat(this.portal.currentVersion))return d=d||new e,this.portal._queryPortal(`/content/groups/${this.id}/search`,
d,"PortalItem",b);d=d?d.clone():new e;d.query="group:"+this.id+(d.query?" "+d.query:"");return this.portal.queryItems(d,b)};n._fetchCategorySchemaSet=function(d,b){return this.portal._fetchSelf(this.portal.authMode,!0,b).then(a=>{if(a=a.contentCategorySetsGroupQuery){const c=new e;c.disableExtraQuery=!0;c.num=1;c.query=a;return this.portal.queryGroups(c,b)}throw new C("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(a=>{if(a.total){a=a.results[0];const c=
new e;c.num=1;c.query=`typekeywords:"${d}"`;return a.queryItems(c,b)}throw new C("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(a=>a.total?a.results[0].fetchData("json",b).then(c=>(c=c&&c.categorySchema)&&c.length?c:[]):[])};r._createClass(k,[{key:"thumbnailUrl",get:function(){const d=this.url,b=this.thumbnail;return d&&b?this.portal._normalizeUrl(`${d}/info/${b}?f=json`):null}},{key:"url",get:function(){const d=this.get("portal.restUrl");return d?d+"/community/groups/"+
this.id:null}}]);return k}(D.JSONSupport);t.__decorate([x.property()],D.prototype,"access",void 0);t.__decorate([x.property({type:Date})],D.prototype,"created",void 0);t.__decorate([x.property()],D.prototype,"description",void 0);t.__decorate([x.property()],D.prototype,"id",void 0);t.__decorate([x.property()],D.prototype,"isInvitationOnly",void 0);t.__decorate([x.property({type:Date})],D.prototype,"modified",void 0);t.__decorate([x.property()],D.prototype,"owner",void 0);t.__decorate([x.property()],
D.prototype,"portal",void 0);t.__decorate([x.property()],D.prototype,"snippet",void 0);t.__decorate([x.property()],D.prototype,"sortField",void 0);t.__decorate([x.property()],D.prototype,"sortOrder",void 0);t.__decorate([x.property()],D.prototype,"tags",void 0);t.__decorate([x.property()],D.prototype,"thumbnail",void 0);t.__decorate([x.property({readOnly:!0})],D.prototype,"thumbnailUrl",null);t.__decorate([x.property()],D.prototype,"title",void 0);t.__decorate([x.property({readOnly:!0})],D.prototype,
"url",null);return D=t.__decorate([g.subclass("esri.portal.PortalGroup")],D)})},"esri/symbols/support/styleUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags".split(" "),function(r,t,C,D,x,w,q,p,g){function e(a,c){return l.apply(this,arguments)}function l(){l=t._asyncToGenerator(function*(a,c){try{return{data:(yield d(a,c)).data,
baseUrl:w.removeFile(a),styleUrl:a}}catch(f){return x.throwIfAbortError(f),null}});return l.apply(this,arguments)}function k(a,c,f){c=c&&c.portal||q.getDefault();let m;const h=`${c.url} - ${c.user&&c.user.username} - ${a}`;b[h]||(b[h]=n(a,c,f).then(v=>{m=v;return v.fetchData()}).then(v=>({data:v,baseUrl:m.itemUrl,styleName:a})));return b[h]}function n(a,c,f){return c.load(f).then(()=>{const m=new p({disableExtraQuery:!0,query:`owner:${"esri_en"} AND type:${"Style"} AND typekeywords:"${a}"`});return c.queryItems(m,
f)}).then(({results:m})=>{let h=null;const v=a.toLowerCase();if(m&&Array.isArray(m))for(const u of m)if(u.typeKeywords.some(F=>F.toLowerCase()===v)&&"Style"===u.type&&"esri_en"===u.owner){h=u;break}if(!h)throw new D("symbolstyleutils:style-not-found",`The style '${a}' could not be found`,{styleName:a});return h.load(f)})}function d(a,c){c={responseType:"json",query:{f:"json"},...c};return C(w.normalize(a),c)}const b={};r.Style2DUrlTemplate="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson";
r.fetchStyle=function(a,c,f){return a.styleUrl?e(a.styleUrl,f):a.styleName?k(a.styleName,c,f):Promise.reject(new D("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))};r.makeCIMSymbolRef=function(a){return null===a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}};r.requestJSON=d;r.styleNameFromItem=function(a){for(const c of a.typeKeywords)if(/^Esri.*Style$/.test(c)&&"Esri Style"!==c)return c};r.symbolUrlFromStyleItem=
function(a,c){if("cimRef"===c)return a.cimRef;if(a.formatInfos&&!g.enableWebStyleForceWOSR())for(const f of a.formatInfos)if("gltf"===f.type)return f.href;return a.webRef};Object.defineProperty(r,"__esModule",{value:!0})})},"esri/support/featureFlags":function(){define(["exports","../core/has"],function(r,t){r.disableContextNavigation=()=>!!t("enable-feature:disable-context-navigation");r.enableDirect3DObjectFeatureLayerDisplay=()=>!!t("enable-feature:direct-3d-object-feature-layer-display");r.enableWebStyleForceWOSR=
()=>!!t("enable-feature:force-wosr");Object.defineProperty(r,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/utils ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),function(r,t,C,D,x,w,q,p,g,e){function l(z,
A,E,G){return k.apply(this,arguments)}function k(){k=C._asyncToGenerator(function*(z,A,E,G){switch(z.type){case "simple":return f.fromBasicRenderer(z,A,E,G);case "map":return v.fromUVRenderer(z,A,E,G);case "interval":return h.fromCBRenderer(z,A,E,G);case "dictionary":return F.fromDictionaryRenderer(z,A,E,G);case "subtype":return m.fromSubtypes(z,A,E,G)}});return k.apply(this,arguments)}function n(z,A){return d.apply(this,arguments)}function d(){d=C._asyncToGenerator(function*(z,A){const E=z||1;if("number"===
typeof E)return(H,K,L)=>E;const G=yield q.createRendererExpression(E,A.spatialReference,A.fields);return(H,K,L)=>g(G,H,{$view:L},A.geometryType,K)||1});return d.apply(this,arguments)}function b(){return a.apply(this,arguments)}function a(){a=C._asyncToGenerator(function*(){u||(u=new Promise((z,A)=>r(["../../../layers/features/schemaUtils"],z,A)));return u});return a.apply(this,arguments)}const c=x.getLogger("esri/views/2d/engine/webgl/util/Matcher");let f=function(){function z(){this.type="feature";
this._defaultResult=null}z.fromBasicRenderer=function(){var E=C._asyncToGenerator(function*(G,H,K,L){const J=new z;G.symbol&&(G=yield e.expandSymbol(G.symbol,K,L),H=H.createTemplateGroup(G,null),J.setDefault(H));return J});return function(G,H,K,L){return E.apply(this,arguments)}}();var A=z.prototype;A.size=function(){return 1};A.getDefault=function(){return this._defaultResult};A.setDefault=function(E){this._defaultResult=E};A.match=function(E,G,H,K,L){return this.getDefault()};A.analyze=function(){var E=
C._asyncToGenerator(function*(G,H,K,L,J,B){return null});return function(G,H,K,L,J,B){return E.apply(this,arguments)}}();return z}(),m=function(z){function A(E,G){var H=z.call(this)||this;H._subMatchers=E;H._subtypeField=G;return H}C._inheritsLoose(A,z);A.fromSubtypes=function(){var E=C._asyncToGenerator(function*(G,H,K,L){const J=new Map,B=[];for(const y in G.renderers){const I=parseInt(y,10),S=l(G.renderers[y],H,K,L).then(O=>J.set(I,O));B.push(S)}yield Promise.all(B);return new A(J,G.subtypeField)});
return function(G,H,K,L){return E.apply(this,arguments)}}();A.prototype.match=function(E,G,H,K,L){var J=G.readAttribute(this._subtypeField);return(J=this._subMatchers.get(J))?J.match(E,G,H,K,L):null};return A}(f),h=function(z){function A(G,H,K,L){var J=z.call(this)||this;J.type="interval";J._intervals=[];J._isMaxInclusive=H;J._fieldIndex=L;J._field=G;J._normalizationInfo=K;return J}C._inheritsLoose(A,z);A.fromCBRenderer=function(){var G=C._asyncToGenerator(function*(H,K,L,J){const {isMaxInclusive:B,
normalizationField:y,normalizationTotal:I,normalizationType:S}=H,O=new A(H.field,B,{normalizationField:y,normalizationTotal:I,normalizationType:S},H.fieldIndex),Y=yield e.expandSymbol(H.backgroundFillSymbol,L,J);yield Promise.all(H.intervals.map(function(){var R=C._asyncToGenerator(function*(Q){var W=yield e.expandSymbol(Q.symbol,L,J);W=yield K.createTemplateGroup(W,Y);O.add({min:Q.min,max:Q.max},W)});return function(Q){return R.apply(this,arguments)}}()));if(H=yield e.expandSymbol(H.defaultSymbol,
L,J))H=yield K.createTemplateGroup(H,Y),O.setDefault(H);return O});return function(H,K,L,J){return G.apply(this,arguments)}}();var E=A.prototype;E.add=function(G,H){this._intervals.push({interval:G,result:H});this._intervals.sort((K,L)=>K.interval.min-L.interval.min)};E.size=function(){return z.prototype.size.call(this)+this._intervals.length};E.match=function(G,H,K,L,J){if(null==this._fieldIndex&&!this._field)return this.getDefault();G=null!=this._fieldIndex?H.getComputedNumericAtIndex(this._fieldIndex):
this._getValueFromField(H);if(!G&&(null===G||void 0===G||isNaN(G)))return this.getDefault();for(H=0;H<this._intervals.length;H++){const {interval:B,result:y}=this._intervals[H];K=this._isMaxInclusive?G<=B.max:G<B.max;if(G>=B.min&&K)return y}return this.getDefault()};E._needsNormalization=function(){const G=this._normalizationInfo;return G&&(G.normalizationField||G.normalizationTotal||G.normalizationType)};E._getValueFromField=function(G){const H=G.readAttribute(this._field);if(!this._needsNormalization()||
null==H)return H;const {normalizationField:K,normalizationTotal:L,normalizationType:J}=this._normalizationInfo;G=!!K&&G.readAttribute(K);if(J)switch(J){case "esriNormalizeByField":return(G||void 0)&&H/G;case "esriNormalizeByLog":return Math.log(H)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return H/L*100;default:c.error(`Found unknown normalization type: ${J}`)}else c.error("Normalization is required, but no type was set!")};return A}(f),v=function(z){function A(G,H,K){var L=z.call(this)||this;
L.type="map";L._nullResult=null;L._resultsMap=new Map;L._fieldsIndex=K;L._fields=G;L._seperator=H||"";return L}C._inheritsLoose(A,z);A.fromUVRenderer=function(){var G=C._asyncToGenerator(function*(H,K,L,J){const B=H.fieldDelimiter,y=[H.field];H.field2&&y.push(H.field2);H.field3&&y.push(H.field3);const I=yield e.expandSymbol(H.backgroundFillSymbol,L,J),S=new A(y,B,H.fieldIndex);yield Promise.all(H.map.map(function(){var O=C._asyncToGenerator(function*(Y){var R=yield e.expandSymbol(Y.symbol,L,J);R=
yield K.createTemplateGroup(R,I);"\x3cNull\x3e"===Y.value?S.setNullResult(R):S.add(Y.value,R)});return function(Y){return O.apply(this,arguments)}}()));if(H=yield e.expandSymbol(H.defaultSymbol,L,J))H=yield K.createTemplateGroup(H,I),S.setDefault(H);return S});return function(H,K,L,J){return G.apply(this,arguments)}}();var E=A.prototype;E.setNullResult=function(G){this._nullResult=G};E.add=function(G,H){this._resultsMap.set(G.toString(),H)};E.size=function(){return z.prototype.size.call(this)+this._resultsMap.size};
E.match=function(G,H,K,L,J){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();G=null!=this._fieldsIndex?H.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(H);if(null!==this._nullResult&&(null==G||""===G||"\x3cNull\x3e"===G))return this._nullResult;if(!G&&null==G)return this.getDefault();G=G.toString();return this._resultsMap.has(G)?this._resultsMap.get(G):this.getDefault()};E._getValueFromFields=function(G){const H=[];for(const K of this._fields){const L=G.readAttribute(K);
null==L||""===L?H.push("\x3cNull\x3e"):H.push(L)}return H.join(this._seperator)};return A}(f),u,F=function(z){function A(G,H,K,L,J){var B=z.call(this)||this;B.type="dictionary";B._groupIdCache=new w(100);B._renderer=G;B._fieldMap=G.fieldMap;B._symbolFields=G.getSymbolFields();B._templates=H;B._info=K;B._scaleFn=L;B._schemaUtilsModule=J;return B}C._inheritsLoose(A,z);A.fromDictionaryRenderer=function(){var G=C._asyncToGenerator(function*(H,K,L,J){const [{default:B},y]=yield Promise.all([new Promise((I,
S)=>r(["../../../../../renderers/DictionaryRenderer"],O=>I(Object.freeze({__proto__:null,default:O})),S)),b()]);H=B.fromJSON(H.renderer);yield H.fetchResources({spatialReference:L.spatialReference,fields:L.fields});J=yield n(H.scaleExpression,L);return new A(H,K,L,J,y)});return function(H,K,L,J){return G.apply(this,arguments)}}();var E=A.prototype;E._analyzeFeature=function(){var G=C._asyncToGenerator(function*(H,K,L,J,B){H=H.readLegacyFeature();const y=this._scaleFn(H,L,J);L=this._attributeHash(H)+
"-"+y;const I=this._groupIdCache.get(L);if(I)return I;J=yield this._renderer.getSymbolAsync(H,{...J,spatialReference:this._info.spatialReference,abortOptions:B,fields:this._info.fields});J=this._schemaUtilsModule.createSymbolSchema(J,this._renderer);K=e.expandSymbol(J,this._info,K,B).then(S=>{if("expanded-cim"!==S.type)return c.error(new D("mapview-bad-type",`Found unexpected type ${S.type} in dictionary response`)),null;S.hash+="-"+y;for(const O of S.layers)O.scaleFactor=y,O.templateHash+="-"+y,
"text"===O.type&&"string"===typeof O.text&&-1<O.text.indexOf("[")&&(O.text=p.createLabelOverrideFunction(this._fieldMap,O.text,O.cim.textCase));return this._templates.createTemplateGroup(S,null)});this._groupIdCache.put(L,K,1);return K});return function(H,K,L,J,B){return G.apply(this,arguments)}}();E.analyze=function(){var G=C._asyncToGenerator(function*(H,K,L,J,B,y){H=K.getCursor();for(K=[];H.next();)K.push(this._analyzeFeature(H,L,J,B,y));return Promise.all(K)});return function(H,K,L,J,B,y){return G.apply(this,
arguments)}}();E.match=function(G,H,K,L,J){return null};E._attributeHash=function(G){let H="";for(const K of this._symbolFields){const L=this._fieldMap[K];L&&(H+=G.attributes[L]+"-")}return H};return A}(f);t.DictionaryMatcher=F;t.FeatureMatcher=f;t.IntervalMatcher=h;t.MapMatcher=v;t.SubtypeMatcher=m;t.createMatcher=l;Object.defineProperty(t,"__esModule",{value:!0})})},"esri/core/LRUCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(r,t){return function(){function C(x,
w){this._storage=new t.MemCacheStorage;this._storage.maxSize=x;w&&this._storage.registerRemoveFunc("",w)}var D=C.prototype;D.put=function(x,w,q){this._storage.put(x,w,q,1)};D.pop=function(x){return this._storage.pop(x)};D.get=function(x){return this._storage.get(x)};D.clear=function(){this._storage.clearAll()};D.destroy=function(){this._storage.destroy()};r._createClass(C,[{key:"maxSize",get:function(){return this._storage.maxSize},set:function(x){this._storage.maxSize=x}}]);return C}()})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(r,t,C,D,x,w,q,p){C=function(g){function e(){return g.apply(this,arguments)||this}r._inheritsLoose(e,g);var l=e.prototype;l.initialize=function(){};l.destroy=function(){};r._createClass(e,[{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){const k=this.get("tileStore.tileScheme.spatialReference");return k&&k.toJSON()||null}}]);return e}(C.HandleOwner);t.__decorate([D.property({readOnly:!0})],C.prototype,"supportsTileUpdates",null);t.__decorate([D.property({constructOnly:!0})],
C.prototype,"remoteClient",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,"service",void 0);t.__decorate([D.property()],C.prototype,"spatialReference",null);t.__decorate([D.property({constructOnly:!0})],C.prototype,"tileInfo",void 0);t.__decorate([D.property({constructOnly:!0})],C.prototype,"tileStore",void 0);return C=t.__decorate([p.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],C)})},"esri/views/2d/layers/features/support/ResourceManagerProxy":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/promiseUtils"],function(r,t){return function(){function C(x){this._remoteClient=x;this._resourceMap=new Map;this._inFlightResourceMap=new Map}var D=C.prototype;D.destroy=function(){};D.fetchResource=function(){var x=r._asyncToGenerator(function*(w,q){const p=this._resourceMap;var g=p.get(w);if(g||(g=this._inFlightResourceMap.get(w)))return g;try{g=this._remoteClient.invoke("tileRenderer.fetchResource",{url:w},{...q}),this._inFlightResourceMap.set(w,g),g.then(e=>{this._inFlightResourceMap.delete(w);
p.set(w,e);return e})}catch(e){return t.isAbortError(e)?null:{width:0,height:0}}return g});return function(w,q){return x.apply(this,arguments)}}();D.getResource=function(x){var w;return null!=(w=this._resourceMap.get(x))?w:null};return C}()})},"*noref":1}});
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/has ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../layers/support/TileInfo ./processors ./controllers/FeatureController2D ./support/TileStore ./support/UpdateToken ../../tiling/TileInfoView".split(" "),function(r,t,C,D,x,w,
q,p,g,e,l,k,n,d,b){const a=new Set;D=function(c){function f(){var h=c.apply(this,arguments)||this;h.controller=null;h.processor=null;h.remoteClient=null;h.tileStore=null;h.service=null;h.viewState=null;h._paused=!1;h._pendingTileUpdates=[];return h}t._inheritsLoose(f,c);var m=f.prototype;m.initialize=function(){this.handles.add(this.watch("updating",h=>{this.remoteClient.invoke("setUpdating",h).catch(v=>{})}))};m.destroy=function(){var h,v,u;null==(h=this.controller)?void 0:h.destroy();null==(v=this.processor)?
void 0:v.destroy();null==(u=this.tileStore)?void 0:u.destroy();this.controller=this.processor=this.tileStore=this.remoteClient=null};m.startup=function(){var h=t._asyncToGenerator(function*({service:v,config:u,tileInfo:F,tiles:z}){this._paused=!0;this.service=v;this.tileStore||(v=new b(e.fromJSON(F)),this.tileStore=new n(v));yield this._createProcessorAndController(u);yield this.update({config:u},!0);this.tileStore.clear();this.tileStore.updateTiles(z);for(this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())});
return function(v){return h.apply(this,arguments)}}();m.updateTiles=function(){var h=t._asyncToGenerator(function*(v){this._paused?this._pendingTileUpdates.push(v):this.tileStore.updateTiles(v)});return function(v){return h.apply(this,arguments)}}();m.update=function(){var h=t._asyncToGenerator(function*({config:v},u=!1){const F=d.UpdateToken.empty();u||this.controller.pause();yield Promise.all([this.processor.update(F,v),this.controller.update(F,v)]);return F.toJSON()});return function(v){return h.apply(this,
arguments)}}();m.applyUpdate=function(){var h=t._asyncToGenerator(function*(v){return this.controller.applyUpdate(d.UpdateToken.create(v))});return function(v){return h.apply(this,arguments)}}();m._createProcessorAndController=function(){var h=t._asyncToGenerator(function*(v){yield Promise.all([this._handleControllerConfig(v),this._handleProcessorConfig(v)]);this.controller.processor=this.processor});return function(v){return h.apply(this,arguments)}}();m._handleControllerConfig=function(){var h=
t._asyncToGenerator(function*(v){v=yield this._createController(this.service,v);yield v.startup();return v});return function(v){return h.apply(this,arguments)}}();m._handleProcessorConfig=function(){var h=t._asyncToGenerator(function*(v){return this._createProcessor(this.service,v)});return function(v){return h.apply(this,arguments)}}();m._createController=function(){var h=t._asyncToGenerator(function*(v,u){this.controller&&this.controller.destroy();const {tileStore:F,remoteClient:z}=this;return this.controller=
v=new k({service:v,config:u,tileStore:F,remoteClient:z})});return function(v,u){return h.apply(this,arguments)}}();m._createProcessor=function(){var h=t._asyncToGenerator(function*(v,u){const F=(yield l.loadProcessorModule(u.schema.processors[0].type)).default,{remoteClient:z,tileStore:A}=this;v=new F({service:v,config:u,tileStore:A,remoteClient:z});this.processor&&this.processor.destroy();return this.processor=v});return function(v,u){return h.apply(this,arguments)}}();t._createClass(f,[{key:"updating",
get:function(){return!this.controller||this.controller.updating}}]);return f}(D.HandleOwner);C.__decorate([w.property()],D.prototype,"controller",void 0);C.__decorate([w.property()],D.prototype,"processor",void 0);C.__decorate([w.property()],D.prototype,"updating",null);C.__decorate([w.property()],D.prototype,"viewState",void 0);D=C.__decorate([g.subclass("esri.views.2d.layers.features.Pipeline")],D);r.default=D;r.getInstances=function(){return a};Object.defineProperty(r,"__esModule",{value:!0})});