// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../engine/RasterTileContainer ./BaseImageryTileSubView2D ../support/util".split(" "),function(n,l,m,p,h,C,D,v,w,x,y){h=function(q){function r(){var b=q.apply(this,arguments)||this;b.container=null;
b.layer=null;b.type="raster";return b}n._inheritsLoose(r,q);var e=r.prototype;e.canUseWebGLForProcessing=function(){return this.useWebGLForProcessing&&this.layer.symbolizer.canRenderInWebGL&&!("majority"===this.layer.interpolation&&y.canUseMajorityInterpolationOnDataSource(this.layer))};e.fetchTile=function(b,a){return this.layer.fetchTile(b.level,b.row,b.col,a)};e.updateTileSource=function(){var b=n._asyncToGenerator(function*(a,c){const {bandIds:t}=this.layer,k=this._getLayerInterpolation(),f=this.canUseWebGLForProcessing(),
{source:d,symbolizerParams:g,globalSymbolizerParams:u,suspended:z,coords:A,resolution:B}=c;({bitmap:a}=a);[a.x,a.y]=A;a.resolution=B;d&&m.isSome(d)&&m.isSome(d.pixelBlock)?(c={extent:d.extent,pixelBlock:d.pixelBlock},a.rawPixelData=c,f?(a.source=d.pixelBlock,a.isRendereredSource=!1):(c=yield this.layer.applyRenderer(c,"stretch"===(null==u?void 0:u.type)?u:null),a.source=c,a.isRendereredSource=!0),a.symbolizerParameters=f?g:null,f?a.transformGrid||(a.transformGrid=d.transformGrid):a.transformGrid=
null):(c=this.createEmptyTilePixelBlock(),a.source=c,a.symbolizerParameters=f?g:null,a.transformGrid=null);a.bandIds=f?t:null;a.width=this._tileInfoView.tileInfo.size[0];a.height=this._tileInfoView.tileInfo.size[1];a.interpolation=k;a.suspended=z;a.invalidateTexture()});return function(a,c){return b.apply(this,arguments)}}();e.updateTileSymbolizerParameters=function(){var b=n._asyncToGenerator(function*(a,c){const {local:t,global:k}=c;({bandIds:c}=this.layer);const f=this._getLayerInterpolation(),
d=this.canUseWebGLForProcessing();({bitmap:a}=a);const {rawPixelData:g}=a;!d&&m.isSome(g)?(a.source=yield this.layer.applyRenderer(g,"stretch"===(null==k?void 0:k.type)?k:null),a.isRendereredSource=!0):(a.isRendereredSource&&m.isSome(g)&&(a.source=g.pixelBlock),a.isRendereredSource=!1);a.symbolizerParameters=d?k||t:null;a.bandIds=d?c:null;a.interpolation=f;a.suspended=!1});return function(a,c){return b.apply(this,arguments)}}();e.install=function(b){this.container=new w.RasterTileContainer(this._tileInfoView);
this.container.isCustomTilingScheme=this._isCustomTilingScheme;b.addChild(this.container)};e.uninstall=function(){this.container.removeAllChildren();this.container.remove();q.prototype.uninstall.call(this)};e._getLayerInterpolation=function(){var b=this.layer.renderer.type;if("raster-colormap"===b||"unique-value"===b||"class-breaks"===b)return"nearest";({interpolation:b}=this.layer);const {renderer:a}=this.layer;return"raster-stretch"===a.type&&null!=a.colorRamp?"bilinear"===b||"cubic"===b?"bilinear":
"nearest":b};return r}(x.BaseImageryTileSubView2D);l.__decorate([p.property()],h.prototype,"container",void 0);l.__decorate([p.property()],h.prototype,"layer",void 0);l.__decorate([p.property()],h.prototype,"type",void 0);return h=l.__decorate([v.subclass("esri.views.2d.layers.imagery.ImageryTileView2D")],h)});