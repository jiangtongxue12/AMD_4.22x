// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../PopupTemplate ../../../core/Collection ../../../core/watchUtils ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/set ../../../core/accessorSupport/decorators/subclass ../../../renderers/SimpleRenderer ../../../renderers/support/jsonUtils ../../../rest/support/FeatureSet ./LayerView2D ./graphics/GraphicContainer ./graphics/GraphicsView2D ../../layers/LayerView".split(" "),
function(m,p,q,r,f,g,C,D,E,F,t,h,u,v,w,x,y,z){g=function(n){function k(){var a=n.apply(this,arguments)||this;a._graphicsViewMap={};a._popupTemplates=new Map;a.graphicsViews=[];return a}m._inheritsLoose(k,n);var e=k.prototype;e.hitTest=function(){var a=m._asyncToGenerator(function*(b,c){if(!this.graphicsViews.length)return null;c=this.graphicsViews.reverse().map(d=>d.hitTest(b));return(yield Promise.all(c)).flat().filter((d,l)=>{d&&(d.popupTemplate=this._popupTemplates.get(this.graphicsViews[l]),d.layer=
this.layer,d.sourceLayer=this.layer);return!!d})});return function(b,c){return a.apply(this,arguments)}}();e.update=function(a){if(this.graphicsViews)for(const b of this.graphicsViews)b.processUpdate(a)};e.attach=function(){this.handles.add([f.init(this.layer,"featureCollections",a=>{this._clear();for(const {popupInfo:d,featureSet:l,layerDefinition:A}of a){a=v.fromJSON(l);var b=new r(a.features),c=A.drawingInfo;const B=d?q.fromJSON(d):null;c=u.fromJSON(c.renderer);b=new y({requestUpdateCallback:()=>
this.requestUpdate(),view:this.view,graphics:b,renderer:c,container:new x(this.view.featuresTilingScheme)});this._graphicsViewMap[a.geometryType]=b;this._popupTemplates.set(b,B);"polygon"!==a.geometryType||this.layer.polygonSymbol?"polyline"!==a.geometryType||this.layer.lineSymbol?"point"!==a.geometryType||this.layer.pointSymbol||(this.layer.pointSymbol=c.symbol):this.layer.lineSymbol=c.symbol:this.layer.polygonSymbol=c.symbol;this.graphicsViews.push(b);this.container.addChild(b.container)}}),f.init(this.layer,
"polygonSymbol",a=>{this._graphicsViewMap.polygon.renderer=new h({symbol:a})}),f.init(this.layer,"lineSymbol",a=>{this._graphicsViewMap.polyline.renderer=new h({symbol:a})}),f.init(this.layer,"pointSymbol",a=>{this._graphicsViewMap.point.renderer=new h({symbol:a})})],"georsslayerview")};e.detach=function(){this.handles.remove("georsslayerview");this._clear()};e.moveStart=function(){};e.moveEnd=function(){};e.viewChange=function(){for(const a of this.graphicsViews)a.viewChange()};e._clear=function(){this.container.removeAllChildren();
for(const a of this.graphicsViews)a.destroy();this._graphicsViewMap={};this._popupTemplates.clear();this.graphicsViews.length=0};return k}(w.LayerView2DMixin(z));return g=p.__decorate([t.subclass("esri.views.2d.layers.GeoRSSLayerView2D")],g)});