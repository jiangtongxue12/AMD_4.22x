// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../libs/maquette/projection ../../libs/maquette/projector ../support/WatchUpdatingTracking".split(" "),function(n,g,d,t,h,w,x,y,u,z,p,v){d=function(q){function l(){var a=q.apply(this,arguments)||this;a.items=new t;a._watchUpdatingTracking=
new v.WatchUpdatingTracking;a._callbacks=new Map;a._projector=p.createProjector();a._hiddenProjector=p.createProjector();return a}n._inheritsLoose(l,q);var e=l.prototype;e.initialize=function(){const a=document.createElement("div");a.className="esri-overlay-surface";this._set("surface",a);this._hiddenSurface=document.createElement("div");this._hiddenSurface.setAttribute("style","visibility: hidden;");a.appendChild(this._hiddenSurface);this._watchUpdatingTracking.addOnCollectionChange(this.items,b=>
{for(const c of b.added){const f=()=>c.render();this._callbacks.set(c,f);this._projector.append(this.surface,f)}for(const c of b.removed)b=this._projector.detach(this._callbacks.get(c)),this.surface.removeChild(b.domNode),this._callbacks.delete(c)})};e.addItem=function(a){this.items.add(a)};e.removeItem=function(a){this.items.remove(a)};e.destroy=function(){this.items.removeAll();this._callbacks.forEach(a=>this._projector.detach(a));this._projector=this._callbacks=null;this._watchUpdatingTracking.destroy()};
e.render=function(){this._projector.renderNow()};e.computeBoundingRect=function(a){const b=this._hiddenSurface,c=this._hiddenProjector;let f=null;const r=()=>f=a.render();c.append(b,r);c.renderNow();const k={left:0,top:0,right:0,bottom:0};if(f&&f.domNode){const m=f.domNode.getBoundingClientRect();k.left=m.left;k.top=m.top;k.right=m.right;k.bottom=m.bottom}for(c.detach(r);b.firstChild;)b.removeChild(b.firstChild);return k};e.overlaps=function(a,b){a=this.computeBoundingRect(a);b=this.computeBoundingRect(b);
return Math.max(a.left,b.left)<=Math.min(a.right,b.right)&&Math.max(a.top,b.top)<=Math.min(a.bottom,b.bottom)};e.renderCanvas=function(a){if(this.items.some(c=>c.visible)){var b=a.getContext("2d");b.save();b.font=`10px ${getComputedStyle(this.surface).fontFamily}`;this.items.forEach(c=>{b.save();c.renderCanvas(b);b.restore()});b.restore()}};n._createClass(l,[{key:"needsRender",get:function(){return 0<this.items.length}},{key:"hasVisibleItems",get:function(){return this.items.some(a=>a.visible)}}]);
return l}(d);g.__decorate([h.property({readOnly:!0})],d.prototype,"surface",void 0);g.__decorate([h.property({readOnly:!0})],d.prototype,"items",void 0);g.__decorate([h.property({readOnly:!0})],d.prototype,"needsRender",null);g.__decorate([h.property({readOnly:!0})],d.prototype,"_watchUpdatingTracking",void 0);g.__decorate([h.property({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],d.prototype,"updating",void 0);return d=g.__decorate([u.subclass("esri.views.overlay.ViewOverlay")],d)});