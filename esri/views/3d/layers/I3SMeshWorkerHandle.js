// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Logger ../../../core/maybe ../../../core/PooledArray ../../../core/workers/WorkerHandle ../../../geometry/projection".split(" "),function(p,w,q,x,y,z,u){function v(c,f,h){a.clear();var b=Infinity;let d=Infinity,l=-Infinity,k=-Infinity,r=!1;for(const t of f){var e="clip"===t.type?2:"mask"===t.type?1:0;const m=t.geometry;f=g=>g;if(m.spatialReference){if(!u.canProjectWithoutEngine(m.spatialReference,h)){A.warn("Can't project modification polygon into layer spatial reference, ignoring modification");
continue}f=g=>{u.projectVectorToVector(g,m.spatialReference,n,h);return n}}else m.hasZ||(n[2]=0,f=g=>{n[0]=g[0];n[1]=g[1];return n});r=r||1===e;a.push(e);a.push(m.rings.length);for(const g of m.rings){a.push(g.length);for(const B of g)e=f(B),a.push(e[0]),a.push(e[1]),a.push(e[2]),b=Math.min(b,e[0]),d=Math.min(d,e[1]),l=Math.max(l,e[0]),k=Math.max(k,e[1])}}x.isSome(c)&&(r?(a.push(2),a.push(2),a.push(4),a.push(b-1E-4),a.push(d-1E-4),a.push(0),a.push(l+1E-4),a.push(d-1E-4),a.push(0),a.push(l+1E-4),a.push(k+
1E-4),a.push(0),a.push(b-1E-4),a.push(k+1E-4),a.push(0)):(a.push(1),a.push(1)),a.push(4),a.push(c[0]),a.push(c[1]),a.push(0),a.push(c[2]),a.push(c[1]),a.push(0),a.push(c[2]),a.push(c[3]),a.push(0),a.push(c[0]),a.push(c[3]),a.push(0));a.push(3);c=new Float64Array(a.length);for(b=0;b<a.length;++b)c[b]=a.getItemAt(b);return c}const A=q.getLogger("esri.views.3d.layers.I3SMeshWorkerHandle");q=function(c){function f(b){return c.call(this,"SceneLayerWorker","process",b,{hasInitialize:!0})||this}w._inheritsLoose(f,
c);var h=f.prototype;h.getTransferList=function(b){return[b.geometryBuffer]};h.setModifications=function(b,d,l,k){b={context:b,modifications:v(d,l,k),isGeodetic:k.isGeographic};this.broadcast(b,"setModifications")};h.setLegacySchema=function(b,d){d=JSON.stringify(d);this.broadcast({context:b,jsonSchema:d},"setLegacySchema")};h.destroyContext=function(b){return this.broadcast(b,"destroyContext")};return f}(z.WorkerHandle);const a=new y({deallocator:null}),n=[0,0,0];p.I3SMeshWorkerHandle=q;p.toWasmModification=
v;Object.defineProperty(p,"__esModule",{value:!0})});