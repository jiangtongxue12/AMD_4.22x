// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../shaders/MeasurementArrowTechnique".split(" "),function(z,A,c,n,G,H,B,C){let L=function(h){function e(a){a=h.call(this,a,I)||this;a.techniqueConfig=new C.MeasurementArrowTechniqueConfiguration;return a}A._inheritsLoose(e,h);var b=e.prototype;b.getTechniqueConfig=function(a,f){var p;this.techniqueConfig.polygonOffsetEnabled=
this.parameters.polygonOffset;this.techniqueConfig.transparent=1>this.parameters.stripeEvenColor[3]||1>this.parameters.stripeOddColor[3]||1>this.parameters.outlineColor[3];this.techniqueConfig.transparencyPassType=null!=(p=null==f?void 0:f.transparencyPassType)?p:3;return this.techniqueConfig};b.dispose=function(){};b.getPassParameters=function(){return this.parameters};b.intersect=function(){};b.requiresSlot=function(a){return 2===a};b.createGLMaterial=function(a){return 0===a.output?new J(a):null};
b.createBufferWriter=function(){return new K};return e}(B.Material),J=function(h){function e(){return h.apply(this,arguments)||this}A._inheritsLoose(e,h);var b=e.prototype;b.updateParameters=function(a){return this.ensureTechnique(C.MeasurementArrowTechnique,a)};b.beginSlot=function(a){return this.updateParameters(a)};b.bind=function(a,f){f.bindPass(this._material.getPassParameters(),a)};return e}(H);const I={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],
stripeOddColor:[1,.5,0,1],polygonOffset:!1,...B.materialParametersDefaults},M=G.newLayout().vec3f("position").vec3f("normal").vec2f("uv0").f32("auxpos1"),k=n.create(),q=n.create(),u=n.create(),l=n.create(),v=n.create();let K=function(){function h(){this.vertexBufferLayout=M}var e=h.prototype;e.allocate=function(b){return this.vertexBufferLayout.createBuffer(b)};e.elementCount=function(b){return 2*(b.indices.get("position").length/2+1)};e.write=function(b,a,f,p){var g=a.vertexAttributes.get("position").data;
const y=a.vertexAttributes.get("normal").data,r=g.length/3;(a=a&&a.indices&&a.indices.get("position"))&&a.length!==2*(r-1)&&console.warn("MeasurementArrowMaterial does not support indices");a=b.transformation;const D=b.invTranspTransformation,E=f.position,F=f.normal,w=f.uv0;b=0;for(let m=0;m<r;++m){var d=3*m;c.set(k,g[d],g[d+1],g[d+2]);m<r-1&&(d=3*(m+1),c.set(q,g[d],g[d+1],g[d+2]),c.set(v,y[d],y[d+1],y[d+2]),c.normalize(v,v),c.subtract(u,q,k),c.normalize(u,u),c.cross(l,v,u),c.normalize(l,l));d=c.distance(k,
q);a&&D&&(c.transformMat4(k,k,a),c.transformMat4(q,q,a),c.transformMat4(l,l,D));const t=p+2*m,x=t+1;E.setVec(t,k);E.setVec(x,k);F.setVec(t,l);F.setVec(x,l);w.set(t,0,b);w.set(t,1,-1);w.set(x,0,b);w.set(x,1,1);m<r-1&&(b+=d)}f=f.auxpos1;for(g=0;g<2*r;++g)f.set(p+g,b)};return h}();z.MeasurementArrowMaterial=L;Object.defineProperty(z,"__esModule",{value:!0})});