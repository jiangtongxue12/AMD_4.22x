// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4f32 ./glUtil3D ../shaders/ShadowHighlightTechnique ../../../webgl/Util".split(" "),function(k,m,e,f,g,n,p,q,r,t){let u=function(){function h(a,b){this._rctx=a;this._viewingMode=b;this._maxOpacity=1;this._parameters={shadowColor:p.fromValues(1,0,1,1),shadowOpacity:.2,occludedShadowOpacity:.1,opacityElevation:1,dayNightTerminator:1};
this._vao=q.createQuadVAO(this._rctx)}var c=h.prototype;c.render=function(a,b){this._updateParameters(a);if(a.shadowMap.enabled&&a.linearDepthTexture&&this.isVisible){var d=this.technique;this._rctx.bindFramebuffer(b);this._rctx.useProgram(d.program);d.bindPipelineState(this._rctx);d.bindPass(this._parameters,a);this._rctx.bindVAO(this._vao);this._rctx.drawArrays(d.primitiveType,0,t.vertexCount(this._vao,"geometry"))}};c.setDefaultOptions=function(a){this._parameters={...this._parameters,...a};this._updateMaxOpacity()};
c._updateParameters=function(a){this._parameters.opacityElevation=1-e.smoothstep(4E4,5E4,a.camera.relativeElevation);const b=1===this._viewingMode?g.normalize(l,a.camera.center):g.set(l,0,0,1);a=g.dot(b,a.lighting.lightingMainDirection);this._parameters.dayNightTerminator=e.smoothstep(0,1,e.clamp(30*a,0,1))};c.dispose=function(){this._vao=f.disposeMaybe(this._vao);this._technique=f.disposeMaybe(this._technique)};c._updateMaxOpacity=function(){const a=this._parameters;this._maxOpacity=Math.max(a.shadowOpacity,
a.occludedShadowOpacity)*a.shadowColor[3]};m._createClass(h,[{key:"technique",get:function(){f.isNone(this._technique)&&(this._technique=new r.ShadowHighlightTechnique({rctx:this._rctx,viewingMode:this._viewingMode},null));return this._technique}},{key:"gpuMemoryUsage",get:function(){var a,b;return null!=(a=null==(b=this._vao)?void 0:b.size)?a:0}},{key:"isVisible",get:function(){return.001953125<=this._maxOpacity*this._parameters.opacityElevation*this._parameters.dayNightTerminator}}]);return h}();
const l=n.create();k.ShadowHighlightHelper=u;Object.defineProperty(k,"__esModule",{value:!0})});