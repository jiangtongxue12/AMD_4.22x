// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe"],function(h,b){let g=function(){function d(a){this._getFadeDuration=a;this._delayedTime=this._fadeStart=0}var e=d.prototype;e.clear=function(){this._current=b.destroyMaybe(this._current);this._next=b.destroyMaybe(this._next);this._waiting=b.destroyMaybe(this._waiting);this._delayed=b.destroyMaybe(this._delayed)};e.push=function(a,c=0){this._delayed=b.destroyMaybe(this._delayed);this._push(a,c)};e._push=function(a,c){this._isFadingEnabled||
this.clear();if(b.isNone(this._current))this._current=a;else{var f=d.test.fadeMoment||performance.now();0!==c?(this._delayed=a,this._delayedTime=f+c):b.isNone(this._next)?(this._next=a,this._fadeStart=this._alignFadeStart(f)):b.isNone(a)||(b.destroyMaybe(this._waiting),this._waiting=a)}};e._alignFadeStart=function(a){const c=this._getFadeDuration();return a+c-a%c};h._createClass(d,[{key:"current",get:function(){if(b.isNone(this._current))return null;if(!this._isFadingEnabled){var a=this._delayed||
this._waiting||this._next||this._current;a!==this._current&&(this._current=null,this.clear(),this._current=a)}a=d.test.fadeMoment;b.isSome(this._delayed)&&(a=a||performance.now(),a>=this._delayedTime&&(this._push(this._delayed,0),this._delayed=null));if(b.isSome(this._next)){a=a||performance.now();var c=this._fadeDuration;const f=b.isSome(this._current)&&this._next.texture===this._current.texture,k=0!==this._next.type;c=a-this._fadeStart>=c;if(f||k||c)b.destroyMaybe(this._current),this._current=this._next,
this._next=this._waiting,this._waiting=null,this._fadeStart=this._alignFadeStart(a)}return this._current}},{key:"next",get:function(){return this._next}},{key:"fadeFactor",get:function(){if(b.isNone(this._next))return 1;var a=d.test.fadeMoment||performance.now();a=Math.max(0,a-this._fadeStart);const c=this._fadeDuration;return a>c?0:1-a/c}},{key:"isFading",get:function(){return b.isSome(this._next)||b.isSome(this._delayed)}},{key:"_fadeDuration",get:function(){return b.isNone(this._waiting)?this._getFadeDuration():
.5*this._getFadeDuration()}},{key:"_isFadingEnabled",get:function(){return 0<this._getFadeDuration()}}]);return d}();g.test={fadeMoment:0};return g});