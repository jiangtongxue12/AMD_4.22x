// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./scheduling ./accessorSupport/decorators/property ./accessorSupport/ensureType ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking ./accessorSupport/tracking/SimpleObservable".split(" "),function(B,A,y,L,M,F,N,O,G,H,P,I,f,Q){function C(g){return g?g instanceof z?g.toArray():g.length?Array.prototype.slice.apply(g):[]:[]}function D(g){if(g&&
g.length)return g[0]}function J(g,r,p,d){r&&r.forEach((a,b,c)=>{g.push(a);J(g,p.call(d,a,b,c),p,d)})}var u;let R=function(){function g(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var r=g.prototype;r.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};r.reset=function(p){this.defaultPrevented=!1;this.item=p};return g}();const t=new N(R,void 0,g=>{g.item=null;g.target=null;g.defaultPrevented=!1;g.cancellable=!1}),S=()=>{},v=new Set,w=new Set,
x=new Set,E=new Map;let T=0,z=u=function(g,r){function p(a){a=g.call(this,a)||this;a._chgListeners=[];a._notifications=null;a._timer=null;a._observable=new Q.SimpleObservable;a.length=0;a._items=[];Object.defineProperty(B._assertThisInitialized(a),"uid",{value:T++});return a}B._inheritsLoose(p,g);p.isCollection=function(a){return null!=a&&a instanceof u};var d=p.prototype;d.normalizeCtorArgs=function(a){return a?Array.isArray(a)||a instanceof u?{items:a}:a:{}};d.destroy=function(){this.removeAll()};
d[r]=function*(){yield*this.items};d.hasEventListener=function(a){return"change"===a?0<this._chgListeners.length:this._emitter.hasEventListener(a)};d.on=function(a,b){if("change"===a){const c=this._chgListeners,h={removed:!1,callback:b};c.push(h);this._notifications&&this._notifications.push({listeners:c.slice(),items:this._items.slice(),changes:[]});return{remove(){this.remove=S;h.removed=!0;c.splice(c.indexOf(h),1)}}}return this._emitter.on(a,b)};d.once=function(a,b){const c=this.on(a,b);return{remove(){c.remove()}}};
d.add=function(a,b){f.trackAccess(this._observable);if(this._emitBeforeChanges(1))return this;b=this.getNextIndex(null!=b?b:null);this._splice(b,0,[a]);this._emitAfterChanges(1);return this};d.addMany=function(a,b=this._items.length){f.trackAccess(this._observable);if(!a||!a.length||this._emitBeforeChanges(1))return this;b=this.getNextIndex(b);this._splice(b,0,C(a));this._emitAfterChanges(1);return this};d.removeAll=function(){f.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(2))return[];
const a=this._splice(0,this.length)||[];this._emitAfterChanges(2);return a};d.clone=function(){f.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(M.clone)})};d.concat=function(...a){f.trackAccess(this._observable);a=a.map(C);return this._createNewInstance({items:this._items.concat(...a)})};d.drain=function(a,b){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var c=F.assumeNonNull(this._splice(0,this.length)),h=c.length;for(let n=0;n<
h;n++)a.call(b,c[n],n,c);this._emitAfterChanges(2)}};d.every=function(a,b){f.trackAccess(this._observable);return this._items.every(a,b)};d.filter=function(a,b){f.trackAccess(this._observable);let c;c=2===arguments.length?this._items.filter(a,b):this._items.filter(a);return this._createNewInstance({items:c})};d.find=function(a,b){f.trackAccess(this._observable);return this._items.find(a,b)};d.findIndex=function(a,b){f.trackAccess(this._observable);return this._items.findIndex(a,b)};d.flatten=function(a,
b){f.trackAccess(this._observable);const c=[];J(c,this,a,b);return new u(c)};d.forEach=function(a,b){f.trackAccess(this._observable);return this._items.forEach(a,b)};d.getItemAt=function(a){f.trackAccess(this._observable);return this._items[a]};d.getNextIndex=function(a){f.trackAccess(this._observable);const b=this.length;a=null==a?b:a;0>a?a=0:a>b&&(a=b);return a};d.includes=function(a,b=0){f.trackAccess(this._observable);return this._items.includes(a,b)};d.indexOf=function(a,b=0){f.trackAccess(this._observable);
return this._items.indexOf(a,b)};d.join=function(a=","){f.trackAccess(this._observable);return this._items.join(a)};d.lastIndexOf=function(a,b=this.length-1){f.trackAccess(this._observable);return this._items.lastIndexOf(a,b)};d.map=function(a,b){f.trackAccess(this._observable);a=this._items.map(a,b);return new u({items:a})};d.reorder=function(a,b=this.length-1){f.trackAccess(this._observable);const c=this.indexOf(a);if(-1!==c){0>b?b=0:b>=this.length&&(b=this.length-1);if(c!==b){if(this._emitBeforeChanges(4))return a;
this._splice(c,1);this._splice(b,0,[a]);this._emitAfterChanges(4)}return a}};d.pop=function(){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var a=D(this._splice(this.length-1,1));this._emitAfterChanges(2);return a}};d.push=function(...a){f.trackAccess(this._observable);if(this._emitBeforeChanges(1))return this.length;this._splice(this.length,0,a);this._emitAfterChanges(1);return this.length};d.reduce=function(a,b){f.trackAccess(this._observable);const c=this._items;
return 2===arguments.length?c.reduce(a,b):c.reduce(a)};d.reduceRight=function(a,b){f.trackAccess(this._observable);const c=this._items;return 2===arguments.length?c.reduceRight(a,b):c.reduceRight(a)};d.remove=function(a){f.trackAccess(this._observable);return this.removeAt(this.indexOf(a))};d.removeAt=function(a){f.trackAccess(this._observable);if(!(0>a||a>=this.length||this._emitBeforeChanges(2)))return a=D(this._splice(a,1)),this._emitAfterChanges(2),a};d.removeMany=function(a){f.trackAccess(this._observable);
if(!a||!a.length||this._emitBeforeChanges(2))return[];a=a instanceof u?a.toArray():a;const b=this._items,c=[],h=a.length;for(let k=0;k<h;k++){var n=b.indexOf(a[k]);if(-1<n){{var m=k+1;var l=n+1;const q=Math.min(a.length-m,b.length-l);let e=0;for(;e<q&&a[m+e]===b[l+e];)e++;m=e}m=1+m;(n=this._splice(n,m))&&0<n.length&&c.push.apply(c,n);k+=m-1}}this._emitAfterChanges(2);return c};d.reverse=function(){f.trackAccess(this._observable);if(this._emitBeforeChanges(4))return this;const a=this._splice(0,this.length);
a&&(a.reverse(),this._splice(0,0,a));this._emitAfterChanges(4);return this};d.shift=function(){f.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(2)){var a=D(this._splice(0,1));this._emitAfterChanges(2);return a}};d.slice=function(a=0,b=this.length){f.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(a,b)})};d.some=function(a,b){f.trackAccess(this._observable);return this._items.some(a,b)};d.sort=function(a){f.trackAccess(this._observable);
if(!this.length||this._emitBeforeChanges(4))return this;const b=F.assumeNonNull(this._splice(0,this.length));arguments.length?b.sort(a):b.sort();this._splice(0,0,b);this._emitAfterChanges(4);return this};d.splice=function(a,b,...c){f.trackAccess(this._observable);const h=(b?2:0)|(c.length?1:0);if(this._emitBeforeChanges(h))return[];a=this._splice(a,b,c)||[];this._emitAfterChanges(h);return a};d.toArray=function(){f.trackAccess(this._observable);return this._items.slice()};d.toJSON=function(){f.trackAccess(this._observable);
return this.toArray()};d.toLocaleString=function(){f.trackAccess(this._observable);return this._items.toLocaleString()};d.toString=function(){f.trackAccess(this._observable);return this._items.toString()};d.unshift=function(...a){f.trackAccess(this._observable);if(!a.length||this._emitBeforeChanges(1))return this.length;this._splice(0,0,a);this._emitAfterChanges(1);return this.length};d._createNewInstance=function(a){return new this.constructor(a)};d._splice=function(a,b,c){const h=this._items;var n=
this.itemType;let m=void 0;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=O.schedule(()=>this._dispatchChange()));if(b){m=h.splice(a,b);if(this.hasEventListener("before-remove")){var l=t.acquire();l.target=this;l.cancellable=!0;for(let e=0,K=m.length;e<K;e++)b=m[e],l.reset(b),this.emit("before-remove",l),l.defaultPrevented&&(m.splice(e,1),h.splice(a,
0,b),a+=1,--e,--K);t.release(l)}this.length=this._items.length;if(this.hasEventListener("after-remove")){b=t.acquire();b.target=this;b.cancellable=!1;l=m.length;for(let e=0;e<l;e++)b.reset(m[e]),this.emit("after-remove",b);t.release(b)}}if(c&&c.length){if(n){b=[];for(var k of c)c=n.ensureType(k),null==c&&null!=k||b.push(c);c=b}n=this.hasEventListener("before-add");k=this.hasEventListener("after-add");b=a===this.length;if(n||k){var q=t.acquire();q.target=this;q.cancellable=!0;l=t.acquire();l.target=
this;l.cancellable=!1;for(const e of c)n?(q.reset(e),this.emit("before-add",q),q.defaultPrevented||(b?h.push(e):h.splice(a++,0,e),this._set("length",h.length),k&&(l.reset(e),this.emit("after-add",l)))):(b?h.push(e):h.splice(a++,0,e),this._set("length",h.length),l.reset(e),this.emit("after-add",l));t.release(l);t.release(q)}else{if(b)for(q of c)h.push(q);else h.splice(a,0,...c);this._set("length",h.length)}}(c&&c.length||m&&m.length)&&this._notifyChangeEvent(c,m);return m};d._emitBeforeChanges=function(a){let b=
!1;if(this.hasEventListener("before-changes")){const c=t.acquire();c.target=this;c.cancellable=!0;c.type=a;this.emit("before-changes",c);b=c.defaultPrevented;t.release(c)}return b};d._emitAfterChanges=function(a){if(this.hasEventListener("after-changes")){const b=t.acquire();b.target=this;b.cancellable=!1;b.type=a;this.emit("after-changes",b);t.release(b)}this._observable.notify()};d._notifyChangeEvent=function(a,b){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-
1].changes.push({added:a,removed:b})};d._dispatchChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var a=this._notifications;this._notifications=null;for(const b of a){a=b.changes;v.clear();w.clear();x.clear();for(const {added:k,removed:q}of a){if(k)if(0===x.size&&0===w.size)for(const e of k)v.add(e);else for(const e of k)w.has(e)?(x.add(e),w.delete(e)):x.has(e)||v.add(e);if(q)if(0===x.size&&0===v.size)for(const e of q)w.add(e);else for(const e of q)v.has(e)?
v.delete(e):(x.delete(e),w.add(e))}const c=y.acquire();v.forEach(k=>{c.push(k)});const h=y.acquire();w.forEach(k=>{h.push(k)});const n=this._items,m=b.items,l=y.acquire();x.forEach(k=>{m.indexOf(k)!==n.indexOf(k)&&l.push(k)});if(b.listeners&&(c.length||h.length||l.length)){a={target:this,added:c,removed:h,moved:l};const k=b.listeners.length;for(let q=0;q<k;q++){const e=b.listeners[q];e.removed||e.callback.call(this,a)}}y.release(c);y.release(h);y.release(l)}v.clear();w.clear();x.clear()}};B._createClass(p,
[{key:"items",get:function(){f.trackAccess(this._observable);return this._items},set:function(a){this._emitBeforeChanges(1)||(this._splice(0,this.length,C(a)),this._emitAfterChanges(1))}}]);return p}(L.EventedAccessor,Symbol.iterator);z.ofType=g=>{if(!g)return u;if(E.has(g))return E.get(g);let r=null;if("function"===typeof g)r=g.prototype.declaredClass;else if(g.base)r=g.base.prototype.declaredClass;else for(var p in g.typeMap){const d=g.typeMap[p].prototype.declaredClass;r=r?r+` | ${d}`:d}p=function(d){function a(){return d.apply(this,
arguments)||this}B._inheritsLoose(a,d);return a}(u);A.__decorate([P.shared({Type:g,ensureType:"function"===typeof g?H.ensureType(g):H.ensureOneOfType(g)})],p.prototype,"itemType",void 0);p=A.__decorate([I.subclass(`esri.core.Collection<${r}>`)],p);E.set(g,p);return p};A.__decorate([G.property()],z.prototype,"length",void 0);A.__decorate([G.property()],z.prototype,"items",null);return z=u=A.__decorate([I.subclass("esri.core.Collection")],z)});