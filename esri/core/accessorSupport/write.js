// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.22/esri/copyright.txt for details.
//>>built
define("exports ../arrayUtils ../Error ../Logger ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(m,u,v,w,p,k,q){function x(a,g,b,e,d){var f,c;const h={};null==(f=g.write)?void 0:null==(c=f.writer)?void 0:c.call(a,e,h,b,d);return h}function r(a,g,b,e,d,f){if(!e||!e.write)return!1;var c=a.get(b);if(!d&&e.write.overridePolicy){var h=e.write.overridePolicy.call(a,c,b,f);void 0!==h&&(d=h)}d||(d=e.write);if(!d||!1===d.enabled)return!1;if((null===c&&!d.allowNull&&!d.writerEnsuresNonNull||
void 0===c)&&d.isRequired)return(g=new v("web-document-write:property-required",`Missing value for required property '${b}' on '${a.declaredClass}'`,{propertyName:b,target:a}),f)&&f.messages?f.messages.push(g):g&&!f&&y.error(g.name,g.message),!1;if(void 0===c||null===c&&!d.allowNull&&!d.writerEnsuresNonNull)return!1;h=e.default;void 0===h?c=!1:null!=e.defaultEquals?c=e.defaultEquals(c):"function"===typeof h?Array.isArray(c)?(a=h.call(a,b,f),c=u.equals(a,c)):c=!1:c=h===c;return c?!1:void 0!==e.default?
!0:!d.ignoreOrigin&&f&&f.origin&&g.store.originOf(b)<p.nameToId(f.origin)?!1:!0}function t(a,g,b){if(a&&"function"===typeof a.toJSON&&(!a.toJSON.isDefaultToJSON||!a.write))return k.merge(g,a.toJSON());const e=k.getProperties(a),d=e.metadatas;for(const h in d){const l=q.originSpecificWritePropertyDefinition(d[h],b);if(!r(a,e,h,l,void 0,b))continue;const z=a.get(h),n=x(a,l,l.write&&"string"===typeof l.write.target?l.write.target:h,z,b);if(0<Object.keys(n).length){var f,c;g=k.merge(g,n);null!=b&&null!=
(f=b.resources)&&null!=(c=f.pendingOperations)&&c.length&&Promise.all(b.resources.pendingOperations).then(()=>k.merge(g,n));b&&b.writtenProperties&&b.writtenProperties.push({target:a,propName:h,oldOrigin:p.idToReadableName(e.store.originOf(h)),newOrigin:b.origin})}}return g}const y=w.getLogger("esri.core.accessorSupport.write");m.default=t;m.willPropertyWrite=function(a,g,b,e){const d=k.getProperties(a),f=q.originSpecificWritePropertyDefinition(d.metadatas[g],e);return f?r(a,d,g,f,b,e):!1};m.write=
t;Object.defineProperty(m,"__esModule",{value:!0})});